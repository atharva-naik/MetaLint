{
    "blob_id": "0dc38b5ce96f3cedb10b11870c56bae3bfdd6c0b",
    "violations": [
        {
            "start_lineno": 31,
            "end_lineno": 69,
            "pep": "634",
            "line": "if \"查单\" in msg.text: \n num = re.sub(\"查单\", \"\", msg.text) \n if num == \"\": \n for row in sqlQuery('select * from orderStatus order by id desc limit 10 '): \n itchat.send_msg('利达单号'+ row[1] + ' ,国内快递号'+row[2], msg['FromUserName']) \n else: \n for row in sqlQuery('select * from orderStatus order by id desc limit'+num): \n itchat.send_msg('利达单号'+ row[1] + ' ,国内快递号'+row[2], msg['FromUserName']) \n elif \"查买\" in msg.text: \n for row in sqlQuery('select * from Products order by P_id desc limit 10'): \n itchat.send_msg('最近需要购买'+ row[1]+' ,共需要' + str(row[2]), msg['FromUserName']) \n elif \"买\" in msg.text: \n print(msg.text) \n reString = re.sub(\"买\", \"\", msg.text) \n itemQua = re.findall(u\"([^\u4e00-\u9fa5])\", reString) \n itemName = re.findall(u\"([\\u4e00-\\u9fa5])\", reString) \n itemQua = ''.join(itemQua) \n itemName = ''.join(itemName) \n sql = \"\"\"insert into Products (Pname, Pquality) values (  \"\"\" + \"\\\"\"+itemName+\"\\\"\" + \", \" + itemQua + \")\" \n conn = pymysql.connect(host='192.168.31.168', port=3307, user='test', password='123456', db='test', use_unicode=True) \n cursor = conn.cursor() \n cursor.execute(sql) \n conn.commit() \n conn.close() \n itchat.send_msg(itemName + itemQua, msg['FromUserName']) \n elif msg.text == \"功能\": \n itchat.send_msg('回复查单+数字显示最近单号，默认显示10，例:查单 15显示最近15个订单', msg['FromUserName']) \n itchat.send_msg('回复查买+数字显示最近下单买的东西，默认显示是，例：查买 15显示最近15个需要购买的状态', msg['FromUserName']) \n itchat.send_msg('回复买+物品+数量,下单购买物品，例：买 小熊糖 10', msg['FromUserName']) \n itchat.send_msg('回复再见退出神奇的下单模式', msg['FromUserName']) \n elif msg.text == \"再见\": \n users.remove(msg['FromUserName']) \n itchat.send_msg('小同志忙完了？再会再会~记得我们的接头暗号：刘主任辛苦了，要不然没人搭理你哦', msg['FromUserName']) \n return \n else: \n itchat.send_msg('没有找到指定命令，请发送 功能 查看具体命令', msg['FromUserName'])",
            "span": "if \"查单\" in msg.text",
            "fix": [
                {
                    "before": "if \"查单\" in msg.text: \n num = re.sub(\"查单\", \"\", msg.text) \n if num == \"\": \n for row in sqlQuery('select * from orderStatus order by id desc limit 10 '): \n itchat.send_msg('利达单号'+ row[1] + ' ,国内快递号'+row[2], msg['FromUserName']) \n else: \n for row in sqlQuery('select * from orderStatus order by id desc limit'+num): \n itchat.send_msg('利达单号'+ row[1] + ' ,国内快递号'+row[2], msg['FromUserName']) \n elif \"查买\" in msg.text: \n for row in sqlQuery('select * from Products order by P_id desc limit 10'): \n itchat.send_msg('最近需要购买'+ row[1]+' ,共需要' + str(row[2]), msg['FromUserName']) \n elif \"买\" in msg.text: \n print(msg.text) \n reString = re.sub(\"买\", \"\", msg.text) \n itemQua = re.findall(u\"([^\u4e00-\u9fa5])\", reString) \n itemName = re.findall(u\"([\\u4e00-\\u9fa5])\", reString) \n itemQua = ''.join(itemQua) \n itemName = ''.join(itemName) \n sql = \"\"\"insert into Products (Pname, Pquality) values (  \"\"\" + \"\\\"\"+itemName+\"\\\"\" + \", \" + itemQua + \")\" \n conn = pymysql.connect(host='192.168.31.168', port=3307, user='test', password='123456', db='test', use_unicode=True) \n cursor = conn.cursor() \n cursor.execute(sql) \n conn.commit() \n conn.close() \n itchat.send_msg(itemName + itemQua, msg['FromUserName']) \n elif msg.text == \"功能\": \n itchat.send_msg('回复查单+数字显示最近单号，默认显示10，例:查单 15显示最近15个订单', msg['FromUserName']) \n itchat.send_msg('回复查买+数字显示最近下单买的东西，默认显示是，例：查买 15显示最近15个需要购买的状态', msg['FromUserName']) \n itchat.send_msg('回复买+物品+数量,下单购买物品，例：买 小熊糖 10', msg['FromUserName']) \n itchat.send_msg('回复再见退出神奇的下单模式', msg['FromUserName']) \n elif msg.text == \"再见\": \n users.remove(msg['FromUserName']) \n itchat.send_msg('小同志忙完了？再会再会~记得我们的接头暗号：刘主任辛苦了，要不然没人搭理你哦', msg['FromUserName']) \n return \n else: \n itchat.send_msg('没有找到指定命令，请发送 功能 查看具体命令', msg['FromUserName'])",
                    "after": "match msg.text: \n case _ if \"查单\" in msg.text: \n num = re.sub(\"查单\", \"\", msg.text) \n query = f\"select * from orderStatus order by id desc limit {num or 10}\" \n for row in sqlQuery(query): \n itchat.send_msg(f\"利达单号{row[1]} ,国内快递号{row[2]}\", msg['FromUserName']) \n case _ if \"查买\" in msg.text: \n for row in sqlQuery('select * from Products order by P_id desc limit 10'): \n itchat.send_msg(f\"最近需要购买{row[1]} ,共需要{row[2]}\", msg['FromUserName']) \n case _ if \"买\" in msg.text: \n reString = re.sub(\"买\", \"\", msg.text) \n itemQua = ''.join(re.findall(u\"([^\u4e00-\\u9fa5])\", reString)) \n itemName = ''.join(re.findall(u\"([\\u4e00-\\u9fa5])\", reString)) \n sql = f'insert into Products (Pname, Pquality) values (\"{itemName}\", {itemQua})' \n conn = pymysql.connect(host='192.168.31.168', port=3307, user='test', password='123456', db='test', use_unicode=True) \n with conn.cursor() as cursor: \n cursor.execute(sql) \n conn.commit() \n itchat.send_msg(f\"{itemName} {itemQua}\", msg['FromUserName']) \n case \"功能\": \n itchat.send_msg('回复查单+数字显示最近单号，默认显示10，例:查单 15显示最近15个订单', msg['FromUserName']) \n itchat.send_msg('回复查买+数字显示最近下单买的东西，默认显示是，例：查买 15显示最近15个需要购买的状态', msg['FromUserName']) \n itchat.send_msg('回复买+物品+数量,下单购买物品，例：买 小熊糖 10', msg['FromUserName']) \n itchat.send_msg('回复再见退出神奇的下单模式', msg['FromUserName']) \n case \"再见\": \n users.remove(msg['FromUserName']) \n itchat.send_msg('小同志忙完了？再会再会~记得我们的接头暗号：刘主任辛苦了，要不然没人搭理你哦', msg['FromUserName']) \n return \n case _: \n itchat.send_msg('没有找到指定命令，请发送 功能 查看具体命令', msg['FromUserName'])"
                }
            ]
        }
    ]
}