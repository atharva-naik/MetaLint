{
    "what-it-does": "Checks for non-literal strings being passed to markupsafe.Markup.",
    "why-is-this-bad": "markupsafe.Markup does not perform any escaping, so passing dynamic\ncontent, like f-strings, variables or interpolated strings will potentially\nlead to XSS vulnerabilities.\n\n\nInstead you should interpolate the markupsafe.Markup object.\n\n\nUsing lint.ruff.extend-markup-names additional objects can be\ntreated like markupsafe.Markup.\n\n\nThis rule was originally inspired by flake8-markupsafe but doesn't carve\nout any exceptions for i18n related calls by default.\n\n\nYou can use lint.ruff.allowed-markup-calls to specify exceptions.",
    "example": "Given:\n\n\nfrom markupsafe import Markup\n\ncontent = \"<script>alert('Hello, world!')</script>\"\nhtml = Markup(f\"<b>{content}</b>\")  # XSS\n\n\n\nUse instead:\n\n\nfrom markupsafe import Markup\n\ncontent = \"<script>alert('Hello, world!')</script>\"\nhtml = Markup(\"<b>{}</b>\").format(content)  # Safe\n\n\n\nGiven:\n\n\nfrom markupsafe import Markup\n\nlines = [\n    Markup(\"<b>heading</b>\"),\n    \"<script>alert('XSS attempt')</script>\",\n]\nhtml = Markup(\"<br>\".join(lines))  # XSS\n\n\n\nUse instead:\n\n\nfrom markupsafe import Markup\n\nlines = [\n    Markup(\"<b>heading</b>\"),\n    \"<script>alert('XSS attempt')</script>\",\n]\nhtml = Markup(\"<br>\").join(lines)  # Safe",
    "example-split": {
        "example-before": "Given:\n\n\nfrom markupsafe import Markup\n\ncontent = \"<script>alert('Hello, world!')</script>\"\nhtml = Markup(f\"<b>{content}</b>\")  # XSS\n\n",
        "example-after": "\nfrom markupsafe import Markup"
    }
}