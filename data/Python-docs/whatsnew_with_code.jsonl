{"index": 0, "python_version": "2.6", "url": "https://docs.python.org/2.6/whatsnew/2.6.html", "sections": {"python-3-0": {"text": "Python 3.0\n\nThe development cycle for Python versions 2.6 and 3.0 was\nsynchronized, with the alpha and beta releases for both versions being\nmade on the same days.  The development of 3.0 has influenced many\nfeatures in 2.6.\nPython 3.0 is a far-ranging redesign of Python that breaks\ncompatibility with the 2.x series.  This means that existing Python\ncode will need some conversion in order to run on\nPython 3.0.  However, not all the changes in 3.0 necessarily break\ncompatibility.  In cases where new features won’t cause existing code\nto break, they’ve been backported to 2.6 and are described in this\ndocument in the appropriate place.  Some of the 3.0-derived features\nare:\n\nA __complex__() method for converting objects to a complex number.\nAlternate syntax for catching exceptions: except TypeError as exc.\nThe addition of functools.reduce() as a synonym for the built-in\nreduce() function.\n\nPython 3.0 adds several new built-in functions and changes the\nsemantics of some existing builtins.  Functions that are new in 3.0\nsuch as bin() have simply been added to Python 2.6, but existing\nbuiltins haven’t been changed; instead, the future_builtins\nmodule has versions with the new 3.0 semantics.  Code written to be\ncompatible with 3.0 can do from future_builtins import hex, map as\nnecessary.\nA new command-line switch, -3, enables warnings\nabout features that will be removed in Python 3.0.  You can run code\nwith this switch to see how much work will be necessary to port\ncode to 3.0.  The value of this switch is available\nto Python code as the boolean variable sys.py3kwarning,\nand to C extension code as Py_Py3kWarningFlag.\n\nSee also\nThe 3xxx series of PEPs, which contains proposals for Python 3.0.\nPEP 3000 describes the development process for Python 3.0.\nStart with PEP 3100 that describes the general goals for Python\n3.0, and then explore the higher-numbered PEPS that propose\nspecific features.", "code_blocks": []}, "changes-to-the-development-process - new-issue-tracker-roundup": {"text": "New Issue Tracker: Roundup\n\nFor a long time, the Python developers had been growing increasingly\nannoyed by SourceForge’s bug tracker.  SourceForge’s hosted solution\ndoesn’t permit much customization; for example, it wasn’t possible to\ncustomize the life cycle of issues.\nThe infrastructure committee of the Python Software Foundation\ntherefore posted a call for issue trackers, asking volunteers to set\nup different products and import some of the bugs and patches from\nSourceForge.  Four different trackers were examined: Jira,\nLaunchpad,\nRoundup, and\nTrac.\nThe committee eventually settled on Jira\nand Roundup as the two candidates.  Jira is a commercial product that\noffers no-cost hosted instances to free-software projects; Roundup\nis an open-source project that requires volunteers\nto administer it and a server to host it.\nAfter posting a call for volunteers, a new Roundup installation was\nset up at http://bugs.python.org.  One installation of Roundup can\nhost multiple trackers, and this server now also hosts issue trackers\nfor Jython and for the Python web site.  It will surely find\nother uses in the future.  Where possible,\nthis edition of “What’s New in Python” links to the bug/patch\nitem for each change.\nHosting of the Python bug tracker is kindly provided by\nUpfront Systems\nof Stellenbosch, South Africa.  Martin von Loewis put a\nlot of effort into importing existing bugs and patches from\nSourceForge; his scripts for this import operation are at\nhttp://svn.python.org/view/tracker/importer/ and may be useful to\nother projects wishing to move from SourceForge to Roundup.\n\nSee also\n\nhttp://bugs.python.org\nThe Python bug tracker.\nhttp://bugs.jython.org:\nThe Jython bug tracker.\nhttp://roundup.sourceforge.net/\nRoundup downloads and documentation.\nhttp://svn.python.org/view/tracker/importer/\nMartin von Loewis’s conversion scripts.", "code_blocks": []}, "changes-to-the-development-process - new-documentation-format-restructuredtext-using-sphinx": {"text": "New Documentation Format: reStructuredText Using Sphinx\n\nThe Python documentation was written using LaTeX since the project\nstarted around 1989.  In the 1980s and early 1990s, most documentation\nwas printed out for later study, not viewed online. LaTeX was widely\nused because it provided attractive printed output while remaining\nstraightforward to write once the basic rules of the markup were\nlearned.\nToday LaTeX is still used for writing publications destined for\nprinting, but the landscape for programming tools has shifted.  We no\nlonger print out reams of documentation; instead, we browse through it\nonline and HTML has become the most important format to support.\nUnfortunately, converting LaTeX to HTML is fairly complicated and Fred\nL. Drake Jr., the long-time Python documentation editor, spent a lot\nof time maintaining the conversion process.  Occasionally people would\nsuggest converting the documentation into SGML and later XML, but\nperforming a good conversion is a major task and no one ever committed\nthe time required to finish the job.\nDuring the 2.6 development cycle, Georg Brandl put a lot of effort\ninto building a new toolchain for processing the documentation.  The\nresulting package is called Sphinx, and is available from\nhttp://sphinx.pocoo.org/.\nSphinx concentrates on HTML output, producing attractively styled and\nmodern HTML; printed output is still supported through conversion to\nLaTeX.  The input format is reStructuredText, a markup syntax\nsupporting custom extensions and directives that is commonly used in\nthe Python community.\nSphinx is a standalone package that can be used for writing, and\nalmost two dozen other projects\n(listed on the Sphinx web site)\nhave adopted Sphinx as their documentation tool.\n\nSee also\n\nDocumenting Python\nDescribes how to write for Python’s documentation.\nSphinx\nDocumentation and code for the Sphinx toolchain.\nDocutils\nThe underlying reStructuredText parser and toolset.", "code_blocks": []}, "pep-343-the-with-statement - writing-context-managers": {"text": "Writing Context Managers\n\nUnder the hood, the ‘with‘ statement is fairly complicated. Most\npeople will only use ‘with‘ in company with existing objects and\ndon’t need to know these details, so you can skip the rest of this section if\nyou like.  Authors of new objects will need to understand the details of the\nunderlying implementation and should keep reading.\nA high-level explanation of the context management protocol is:\n\nThe expression is evaluated and should result in an object called a “context\nmanager”.  The context manager must have __enter__() and __exit__()\nmethods.\nThe context manager’s __enter__() method is called.  The value returned\nis assigned to VAR.  If no as VAR clause is present, the value is simply\ndiscarded.\nThe code in BLOCK is executed.\nIf BLOCK raises an exception, the context manager’s __exit__() method\nis called with three arguments, the exception details (type, value, traceback,\nthe same values returned by sys.exc_info(), which can also be None\nif no exception occurred).  The method’s return value controls whether an exception\nis re-raised: any false value re-raises the exception, and True will result\nin suppressing it.  You’ll only rarely want to suppress the exception, because\nif you do the author of the code containing the ‘with‘ statement will\nnever realize anything went wrong.\nIf BLOCK didn’t raise an exception,  the __exit__() method is still\ncalled, but type, value, and traceback are all None.\n\nLet’s think through an example.  I won’t present detailed code but will only\nsketch the methods necessary for a database that supports transactions.\n(For people unfamiliar with database terminology: a set of changes to the\ndatabase are grouped into a transaction.  Transactions can be either committed,\nmeaning that all the changes are written into the database, or rolled back,\nmeaning that the changes are all discarded and the database is unchanged.  See\nany database textbook for more information.)\nLet’s assume there’s an object representing a database connection. Our goal will\nbe to let the user write code like this:\ndb_connection = DatabaseConnection()\nwith db_connection as cursor:\n    cursor.execute('insert into ...')\n    cursor.execute('delete from ...')\n    # ... more operations ...\n\n\nThe transaction should be committed if the code in the block runs flawlessly or\nrolled back if there’s an exception. Here’s the basic interface for\nDatabaseConnection that I’ll assume:\nclass DatabaseConnection:\n    # Database interface\n    def cursor(self):\n        \"Returns a cursor object and starts a new transaction\"\n    def commit(self):\n        \"Commits current transaction\"\n    def rollback(self):\n        \"Rolls back current transaction\"\n\n\nThe __enter__() method is pretty easy, having only to start a new\ntransaction.  For this application the resulting cursor object would be a useful\nresult, so the method will return it.  The user can then add as cursor to\ntheir ‘with‘ statement to bind the cursor to a variable name.\nclass DatabaseConnection:\n    ...\n    def __enter__(self):\n        # Code to start a new transaction\n        cursor = self.cursor()\n        return cursor\n\n\nThe __exit__() method is the most complicated because it’s where most of\nthe work has to be done.  The method has to check if an exception occurred.  If\nthere was no exception, the transaction is committed.  The transaction is rolled\nback if there was an exception.\nIn the code below, execution will just fall off the end of the function,\nreturning the default value of None.  None is false, so the exception\nwill be re-raised automatically.  If you wished, you could be more explicit and\nadd a return statement at the marked location.\nclass DatabaseConnection:\n    ...\n    def __exit__(self, type, value, tb):\n        if tb is None:\n            # No exception, so commit\n            self.commit()\n        else:\n            # Exception occurred, so rollback.\n            self.rollback()\n            # return False", "code_blocks": ["db_connection = DatabaseConnection()\nwith db_connection as cursor:\n    cursor.execute('insert into ...')\n    cursor.execute('delete from ...')\n    # ... more operations ...\n", "class DatabaseConnection:\n    # Database interface\n    def cursor(self):\n        \"Returns a cursor object and starts a new transaction\"\n    def commit(self):\n        \"Commits current transaction\"\n    def rollback(self):\n        \"Rolls back current transaction\"\n", "class DatabaseConnection:\n    ...\n    def __enter__(self):\n        # Code to start a new transaction\n        cursor = self.cursor()\n        return cursor\n", "class DatabaseConnection:\n    ...\n    def __exit__(self, type, value, tb):\n        if tb is None:\n            # No exception, so commit\n            self.commit()\n        else:\n            # Exception occurred, so rollback.\n            self.rollback()\n            # return False\n"]}, "pep-343-the-with-statement - the-contextlib-module": {"text": "The contextlib module\n\nThe contextlib module provides some functions and a decorator that\nare useful when writing objects for use with the ‘with‘ statement.\nThe decorator is called contextmanager(), and lets you write a single\ngenerator function instead of defining a new class.  The generator should yield\nexactly one value.  The code up to the yield will be executed as the\n__enter__() method, and the value yielded will be the method’s return\nvalue that will get bound to the variable in the ‘with‘ statement’s\nas clause, if any.  The code after the yield will be\nexecuted in the __exit__() method.  Any exception raised in the block will\nbe raised by the yield statement.\nUsing this decorator, our database example from the previous section\ncould be written as:\nfrom contextlib import contextmanager\n\n@contextmanager\ndef db_transaction(connection):\n    cursor = connection.cursor()\n    try:\n        yield cursor\n    except:\n        connection.rollback()\n        raise\n    else:\n        connection.commit()\n\ndb = DatabaseConnection()\nwith db_transaction(db) as cursor:\n    ...\n\n\nThe contextlib module also has a nested(mgr1, mgr2, ...) function\nthat combines a number of context managers so you don’t need to write nested\n‘with‘ statements.  In this example, the single ‘with‘\nstatement both starts a database transaction and acquires a thread lock:\nlock = threading.Lock()\nwith nested (db_transaction(db), lock) as (cursor, locked):\n    ...\n\n\nFinally, the closing() function returns its argument so that it can be\nbound to a variable, and calls the argument’s .close() method at the end\nof the block.\nimport urllib, sys\nfrom contextlib import closing\n\nwith closing(urllib.urlopen('http://www.yahoo.com')) as f:\n    for line in f:\n        sys.stdout.write(line)\n\n\n\nSee also\n\nPEP 343 - The “with” statement\nPEP written by Guido van Rossum and Nick Coghlan; implemented by Mike Bland,\nGuido van Rossum, and Neal Norwitz.  The PEP shows the code generated for a\n‘with‘ statement, which can be helpful in learning how the statement\nworks.\n\nThe documentation  for the contextlib module.", "code_blocks": ["from contextlib import contextmanager\n\n@contextmanager\ndef db_transaction(connection):\n    cursor = connection.cursor()\n    try:\n        yield cursor\n    except:\n        connection.rollback()\n        raise\n    else:\n        connection.commit()\n\ndb = DatabaseConnection()\nwith db_transaction(db) as cursor:\n    ...\n", "lock = threading.Lock()\nwith nested (db_transaction(db), lock) as (cursor, locked):\n    ...\n", "import urllib, sys\nfrom contextlib import closing\n\nwith closing(urllib.urlopen('http://www.yahoo.com')) as f:\n    for line in f:\n        sys.stdout.write(line)\n"]}, "pep-366-explicit-relative-imports-from-a-main-module": {"text": "PEP 366: Explicit Relative Imports From a Main Module\n\nPython’s -m switch allows running a module as a script.\nWhen you ran a module that was located inside a package, relative\nimports didn’t work correctly.\nThe fix for Python 2.6 adds a __package__ attribute to\nmodules.  When this attribute is present, relative imports will be\nrelative to the value of this attribute instead of the\n__name__ attribute.\nPEP 302-style importers can then set __package__ as necessary.\nThe runpy module that implements the -m switch now\ndoes this, so relative imports will now work correctly in scripts\nrunning from inside a package.", "code_blocks": []}, "pep-370-per-user-site-packages-directory": {"text": "PEP 370: Per-user site-packages Directory\n\nWhen you run Python, the module search path sys.path usually\nincludes a directory whose path ends in \"site-packages\".  This\ndirectory is intended to hold locally-installed packages available to\nall users using a machine or a particular site installation.\nPython 2.6 introduces a convention for user-specific site directories.\nThe directory varies depending on the platform:\n\nUnix and Mac OS X: ~/.local/\nWindows: %APPDATA%/Python\n\nWithin this directory, there will be version-specific subdirectories,\nsuch as lib/python2.6/site-packages on Unix/Mac OS and\nPython26/site-packages on Windows.\nIf you don’t like the default directory, it can be overridden by an\nenvironment variable.  PYTHONUSERBASE sets the root\ndirectory used for all Python versions supporting this feature.  On\nWindows, the directory for application-specific data can be changed by\nsetting the APPDATA environment variable.  You can also\nmodify the site.py file for your Python installation.\nThe feature can be disabled entirely by running Python with the\n-s option or setting the PYTHONNOUSERSITE\nenvironment variable.\n\nSee also\n\nPEP 370 - Per-user site-packages Directory\nPEP written and implemented by Christian Heimes.", "code_blocks": []}, "pep-371-the-multiprocessing-package": {"text": "PEP 371: The multiprocessing Package\n\nThe new multiprocessing package lets Python programs create new\nprocesses that will perform a computation and return a result to the\nparent.  The parent and child processes can communicate using queues\nand pipes, synchronize their operations using locks and semaphores,\nand can share simple arrays of data.\nThe multiprocessing module started out as an exact emulation of\nthe threading module using processes instead of threads.  That\ngoal was discarded along the path to Python 2.6, but the general\napproach of the module is still similar.  The fundamental class\nis the Process, which is passed a callable object and\na collection of arguments.  The start() method\nsets the callable running in a subprocess, after which you can call\nthe is_alive() method to check whether the subprocess is still running\nand the join() method to wait for the process to exit.\nHere’s a simple example where the subprocess will calculate a\nfactorial.  The function doing the calculation is written strangely so\nthat it takes significantly longer when the input argument is a\nmultiple of 4.\nimport time\nfrom multiprocessing import Process, Queue\n\n\ndef factorial(queue, N):\n    \"Compute a factorial.\"\n    # If N is a multiple of 4, this function will take much longer.\n    if (N % 4) == 0:\n        time.sleep(.05 * N/4)\n\n    # Calculate the result\n    fact = 1L\n    for i in range(1, N+1):\n        fact = fact * i\n\n    # Put the result on the queue\n    queue.put(fact)\n\nif __name__ == '__main__':\n    queue = Queue()\n\n    N = 5\n\n    p = Process(target=factorial, args=(queue, N))\n    p.start()\n    p.join()\n\n    result = queue.get()\n    print 'Factorial', N, '=', result\n\n\nA Queue is used to communicate the input parameter N and\nthe result.  The Queue object is stored in a global variable.\nThe child process will use the value of the variable when the child\nwas created; because it’s a Queue, parent and child can use\nthe object to communicate.  (If the parent were to change the value of\nthe global variable, the child’s value would be unaffected, and vice\nversa.)\nTwo other classes, Pool and Manager, provide\nhigher-level interfaces.  Pool will create a fixed number of\nworker processes, and requests can then be distributed to the workers\nby calling apply() or apply_async() to add a single request,\nand map() or map_async() to add a number of\nrequests.  The following code uses a Pool to spread requests\nacross 5 worker processes and retrieve a list of results:\nfrom multiprocessing import Pool\n\ndef factorial(N, dictionary):\n    \"Compute a factorial.\"\n    ...\np = Pool(5)\nresult = p.map(factorial, range(1, 1000, 10))\nfor v in result:\n    print v\n\n\nThis produces the following output:\n1\n39916800\n51090942171709440000\n8222838654177922817725562880000000\n33452526613163807108170062053440751665152000000000\n...\n\n\nThe other high-level interface, the Manager class, creates a\nseparate server process that can hold master copies of Python data\nstructures.  Other processes can then access and modify these data\nstructures using proxy objects.  The following example creates a\nshared dictionary by calling the dict() method; the worker\nprocesses then insert values into the dictionary.  (Locking is not\ndone for you automatically, which doesn’t matter in this example.\nManager‘s methods also include Lock(), RLock(),\nand Semaphore() to create shared locks.)\nimport time\nfrom multiprocessing import Pool, Manager\n\ndef factorial(N, dictionary):\n    \"Compute a factorial.\"\n    # Calculate the result\n    fact = 1L\n    for i in range(1, N+1):\n        fact = fact * i\n\n    # Store result in dictionary\n    dictionary[N] = fact\n\nif __name__ == '__main__':\n    p = Pool(5)\n    mgr = Manager()\n    d = mgr.dict()         # Create shared dictionary\n\n    # Run tasks using the pool\n    for N in range(1, 1000, 10):\n        p.apply_async(factorial, (N, d))\n\n    # Mark pool as closed -- no more tasks can be added.\n    p.close()\n\n    # Wait for tasks to exit\n    p.join()\n\n    # Output results\n    for k, v in sorted(d.items()):\n        print k, v\n\n\nThis will produce the output:\n1 1\n11 39916800\n21 51090942171709440000\n31 8222838654177922817725562880000000\n41 33452526613163807108170062053440751665152000000000\n51 15511187532873822802242430164693032110632597200169861120000...\n\n\nSee also\nThe documentation for the multiprocessing module.\n\nPEP 371 - Addition of the multiprocessing package\nPEP written by Jesse Noller and Richard Oudkerk;\nimplemented by Richard Oudkerk and Jesse Noller.", "code_blocks": ["import time\nfrom multiprocessing import Process, Queue\n\n\ndef factorial(queue, N):\n    \"Compute a factorial.\"\n    # If N is a multiple of 4, this function will take much longer.\n    if (N % 4) == 0:\n        time.sleep(.05 * N/4)\n\n    # Calculate the result\n    fact = 1L\n    for i in range(1, N+1):\n        fact = fact * i\n\n    # Put the result on the queue\n    queue.put(fact)\n\nif __name__ == '__main__':\n    queue = Queue()\n\n    N = 5\n\n    p = Process(target=factorial, args=(queue, N))\n    p.start()\n    p.join()\n\n    result = queue.get()\n    print 'Factorial', N, '=', result\n", "from multiprocessing import Pool\n\ndef factorial(N, dictionary):\n    \"Compute a factorial.\"\n    ...\np = Pool(5)\nresult = p.map(factorial, range(1, 1000, 10))\nfor v in result:\n    print v\n", "1\n39916800\n51090942171709440000\n8222838654177922817725562880000000\n33452526613163807108170062053440751665152000000000\n...\n", "import time\nfrom multiprocessing import Pool, Manager\n\ndef factorial(N, dictionary):\n    \"Compute a factorial.\"\n    # Calculate the result\n    fact = 1L\n    for i in range(1, N+1):\n        fact = fact * i\n\n    # Store result in dictionary\n    dictionary[N] = fact\n\nif __name__ == '__main__':\n    p = Pool(5)\n    mgr = Manager()\n    d = mgr.dict()         # Create shared dictionary\n\n    # Run tasks using the pool\n    for N in range(1, 1000, 10):\n        p.apply_async(factorial, (N, d))\n\n    # Mark pool as closed -- no more tasks can be added.\n    p.close()\n\n    # Wait for tasks to exit\n    p.join()\n\n    # Output results\n    for k, v in sorted(d.items()):\n        print k, v\n"]}, "pep-3101-advanced-string-formatting": {"text": "PEP 3101: Advanced String Formatting\n\nIn Python 3.0, the % operator is supplemented by a more powerful string\nformatting method, format().  Support for the str.format() method\nhas been backported to Python 2.6.\nIn 2.6, both 8-bit and Unicode strings have a .format() method that\ntreats the string as a template and takes the arguments to be formatted.\nThe formatting template uses curly brackets ({, }) as special characters:\n>>> # Substitute positional argument 0 into the string.\n>>> \"User ID: {0}\".format(\"root\")\n'User ID: root'\n>>> # Use the named keyword arguments\n>>> \"User ID: {uid}   Last seen: {last_login}\".format(\n...    uid=\"root\",\n...    last_login = \"5 Mar 2008 07:20\")\n'User ID: root   Last seen: 5 Mar 2008 07:20'\n\n\nCurly brackets can be escaped by doubling them:\n>>> \"Empty dict: {{}}\".format()\n\"Empty dict: {}\"\n\n\nField names can be integers indicating positional arguments, such as\n{0}, {1}, etc. or names of keyword arguments.  You can also\nsupply compound field names that read attributes or access dictionary keys:\n>>> import sys\n>>> print 'Platform: {0.platform}\\nPython version: {0.version}'.format(sys)\nPlatform: darwin\nPython version: 2.6a1+ (trunk:61261M, Mar  5 2008, 20:29:41)\n[GCC 4.0.1 (Apple Computer, Inc. build 5367)]'\n\n>>> import mimetypes\n>>> 'Content-type: {0[.mp4]}'.format(mimetypes.types_map)\n'Content-type: video/mp4'\n\n\nNote that when using dictionary-style notation such as [.mp4], you\ndon’t need to put any quotation marks around the string; it will look\nup the value using .mp4 as the key.  Strings beginning with a\nnumber will be converted to an integer.  You can’t write more\ncomplicated expressions inside a format string.\nSo far we’ve shown how to specify which field to substitute into the\nresulting string.  The precise formatting used is also controllable by\nadding a colon followed by a format specifier.  For example:\n>>> # Field 0: left justify, pad to 15 characters\n>>> # Field 1: right justify, pad to 6 characters\n>>> fmt = '{0:15} ${1:>6}'\n>>> fmt.format('Registration', 35)\n'Registration    $    35'\n>>> fmt.format('Tutorial', 50)\n'Tutorial        $    50'\n>>> fmt.format('Banquet', 125)\n'Banquet         $   125'\n\n\nFormat specifiers can reference other fields through nesting:\n>>> fmt = '{0:{1}}'\n>>> width = 15\n>>> fmt.format('Invoice #1234', width)\n'Invoice #1234  '\n>>> width = 35\n>>> fmt.format('Invoice #1234', width)\n'Invoice #1234                      '\n\n\nThe alignment of a field within the desired width can be specified:\n\n\n\n\n\n\nCharacter\nEffect\n\n\n\n< (default)\nLeft-align\n\n>\nRight-align\n\n^\nCenter\n\n=\n(For numeric types only) Pad after the sign.\n\n\n\nFormat specifiers can also include a presentation type, which\ncontrols how the value is formatted.  For example, floating-point numbers\ncan be formatted as a general number or in exponential notation:\n>>> '{0:g}'.format(3.75)\n'3.75'\n>>> '{0:e}'.format(3.75)\n'3.750000e+00'\n\n\nA variety of presentation types are available.  Consult the 2.6\ndocumentation for a complete list; here’s a sample:\n\n\n\n\n\n\nb\nBinary. Outputs the number in base 2.\n\nc\nCharacter. Converts the integer to the corresponding Unicode character\nbefore printing.\n\nd\nDecimal Integer. Outputs the number in base 10.\n\no\nOctal format. Outputs the number in base 8.\n\nx\nHex format. Outputs the number in base 16, using lower-case letters for\nthe digits above 9.\n\ne\nExponent notation. Prints the number in scientific notation using the\nletter ‘e’ to indicate the exponent.\n\ng\nGeneral format. This prints the number as a fixed-point number, unless\nthe number is too large, in which case it switches to ‘e’ exponent\nnotation.\n\nn\nNumber. This is the same as ‘g’ (for floats) or ‘d’ (for integers),\nexcept that it uses the current locale setting to insert the appropriate\nnumber separator characters.\n\n%\nPercentage. Multiplies the number by 100 and displays in fixed (‘f’)\nformat, followed by a percent sign.\n\n\n\nClasses and types can define a __format__() method to control how they’re\nformatted.  It receives a single argument, the format specifier:\ndef __format__(self, format_spec):\n    if isinstance(format_spec, unicode):\n        return unicode(str(self))\n    else:\n        return str(self)\n\n\nThere’s also a format() builtin that will format a single\nvalue.  It calls the type’s __format__() method with the\nprovided specifier:\n>>> format(75.6564, '.2f')\n'75.66'\n\n\n\nSee also\n\nFormat String Syntax\nThe reference documentation for format fields.\nPEP 3101 - Advanced String Formatting\nPEP written by Talin. Implemented by Eric Smith.", "code_blocks": [">>> # Substitute positional argument 0 into the string.\n>>> \"User ID: {0}\".format(\"root\")\n'User ID: root'\n>>> # Use the named keyword arguments\n>>> \"User ID: {uid}   Last seen: {last_login}\".format(\n...    uid=\"root\",\n...    last_login = \"5 Mar 2008 07:20\")\n'User ID: root   Last seen: 5 Mar 2008 07:20'\n", ">>> \"Empty dict: {{}}\".format()\n\"Empty dict: {}\"\n", ">>> import sys\n>>> print 'Platform: {0.platform}\\nPython version: {0.version}'.format(sys)\nPlatform: darwin\nPython version: 2.6a1+ (trunk:61261M, Mar  5 2008, 20:29:41)\n[GCC 4.0.1 (Apple Computer, Inc. build 5367)]'\n\n>>> import mimetypes\n>>> 'Content-type: {0[.mp4]}'.format(mimetypes.types_map)\n'Content-type: video/mp4'\n", ">>> # Field 0: left justify, pad to 15 characters\n>>> # Field 1: right justify, pad to 6 characters\n>>> fmt = '{0:15} ${1:>6}'\n>>> fmt.format('Registration', 35)\n'Registration    $    35'\n>>> fmt.format('Tutorial', 50)\n'Tutorial        $    50'\n>>> fmt.format('Banquet', 125)\n'Banquet         $   125'\n", ">>> fmt = '{0:{1}}'\n>>> width = 15\n>>> fmt.format('Invoice #1234', width)\n'Invoice #1234  '\n>>> width = 35\n>>> fmt.format('Invoice #1234', width)\n'Invoice #1234                      '\n", ">>> '{0:g}'.format(3.75)\n'3.75'\n>>> '{0:e}'.format(3.75)\n'3.750000e+00'\n", "def __format__(self, format_spec):\n    if isinstance(format_spec, unicode):\n        return unicode(str(self))\n    else:\n        return str(self)\n", ">>> format(75.6564, '.2f')\n'75.66'\n"]}, "pep-3105-print-as-a-function": {"text": "PEP 3105: print As a Function\n\nThe print statement becomes the print() function in Python 3.0.\nMaking print() a function makes it possible to replace the function\nby doing def print(...) or importing a new function from somewhere else.\nPython 2.6 has a __future__ import that removes print as language\nsyntax, letting you use the functional form instead.  For example:\n>>> from __future__ import print_function\n>>> print('# of entries', len(dictionary), file=sys.stderr)\n\n\nThe signature of the new function is:\ndef print(*args, sep=' ', end='\\n', file=None)\n\nThe parameters are:\n\n\nargs: positional arguments whose values will be printed out.\nsep: the separator, which will be printed between arguments.\nend: the ending text, which will be printed after all of the\narguments have been output.\nfile: the file object to which the output will be sent.\n\n\n\nSee also\n\nPEP 3105 - Make print a function\nPEP written by Georg Brandl.", "code_blocks": [">>> from __future__ import print_function\n>>> print('# of entries', len(dictionary), file=sys.stderr)\n"]}, "pep-3110-exception-handling-changes": {"text": "PEP 3110: Exception-Handling Changes\n\nOne error that Python programmers occasionally make\nis writing the following code:\ntry:\n    ...\nexcept TypeError, ValueError:  # Wrong!\n    ...\n\n\nThe author is probably trying to catch both TypeError and\nValueError exceptions, but this code actually does something\ndifferent: it will catch TypeError and bind the resulting\nexception object to the local name \"ValueError\".  The\nValueError exception will not be caught at all.  The correct\ncode specifies a tuple of exceptions:\ntry:\n    ...\nexcept (TypeError, ValueError):\n    ...\n\n\nThis error happens because the use of the comma here is ambiguous:\ndoes it indicate two different nodes in the parse tree, or a single\nnode that’s a tuple?\nPython 3.0 makes this unambiguous by replacing the comma with the word\n“as”.  To catch an exception and store the exception object in the\nvariable exc, you must write:\ntry:\n    ...\nexcept TypeError as exc:\n    ...\n\n\nPython 3.0 will only support the use of “as”, and therefore interprets\nthe first example as catching two different exceptions.  Python 2.6\nsupports both the comma and “as”, so existing code will continue to\nwork.  We therefore suggest using “as” when writing new Python code\nthat will only be executed with 2.6.\n\nSee also\n\nPEP 3110 - Catching Exceptions in Python 3000\nPEP written and implemented by Collin Winter.", "code_blocks": ["try:\n    ...\nexcept TypeError, ValueError:  # Wrong!\n    ...\n", "try:\n    ...\nexcept (TypeError, ValueError):\n    ...\n", "try:\n    ...\nexcept TypeError as exc:\n    ...\n"]}, "pep-3112-byte-literals": {"text": "PEP 3112: Byte Literals\n\nPython 3.0 adopts Unicode as the language’s fundamental string type and\ndenotes 8-bit literals differently, either as b'string'\nor using a bytes constructor.  For future compatibility,\nPython 2.6 adds bytes as a synonym for the str type,\nand it also supports the b'' notation.\nThe 2.6 str differs from 3.0’s bytes type in various\nways; most notably, the constructor is completely different.  In 3.0,\nbytes([65, 66, 67]) is 3 elements long, containing the bytes\nrepresenting ABC; in 2.6, bytes([65, 66, 67]) returns the\n12-byte string representing the str() of the list.\nThe primary use of bytes in 2.6 will be to write tests of\nobject type such as isinstance(x, bytes).  This will help the 2to3\nconverter, which can’t tell whether 2.x code intends strings to\ncontain either characters or 8-bit bytes; you can now\nuse either bytes or str to represent your intention\nexactly, and the resulting code will also be correct in Python 3.0.\nThere’s also a __future__ import that causes all string literals\nto become Unicode strings.  This means that \\u escape sequences\ncan be used to include Unicode characters:\nfrom __future__ import unicode_literals\n\ns = ('\\u751f\\u3080\\u304e\\u3000\\u751f\\u3054'\n     '\\u3081\\u3000\\u751f\\u305f\\u307e\\u3054')\n\nprint len(s)               # 12 Unicode characters\n\n\nAt the C level, Python 3.0 will rename the existing 8-bit\nstring type, called PyStringObject in Python 2.x,\nto PyBytesObject.  Python 2.6 uses #define\nto support using the names PyBytesObject(),\nPyBytes_Check(), PyBytes_FromStringAndSize(),\nand all the other functions and macros used with strings.\nInstances of the bytes type are immutable just\nas strings are.  A new bytearray type stores a mutable\nsequence of bytes:\n>>> bytearray([65, 66, 67])\nbytearray(b'ABC')\n>>> b = bytearray(u'\\u21ef\\u3244', 'utf-8')\n>>> b\nbytearray(b'\\xe2\\x87\\xaf\\xe3\\x89\\x84')\n>>> b[0] = '\\xe3'\n>>> b\nbytearray(b'\\xe3\\x87\\xaf\\xe3\\x89\\x84')\n>>> unicode(str(b), 'utf-8')\nu'\\u31ef \\u3244'\n\n\nByte arrays support most of the methods of string types, such as\nstartswith()/endswith(), find()/rfind(),\nand some of the methods of lists, such as append(),\npop(),  and reverse().\n>>> b = bytearray('ABC')\n>>> b.append('d')\n>>> b.append(ord('e'))\n>>> b\nbytearray(b'ABCde')\n\n\nThere’s also a corresponding C API, with\nPyByteArray_FromObject(),\nPyByteArray_FromStringAndSize(),\nand various other functions.\n\nSee also\n\nPEP 3112 - Bytes literals in Python 3000\nPEP written by Jason Orendorff; backported to 2.6 by Christian Heimes.", "code_blocks": ["from __future__ import unicode_literals\n\ns = ('\\u751f\\u3080\\u304e\\u3000\\u751f\\u3054'\n     '\\u3081\\u3000\\u751f\\u305f\\u307e\\u3054')\n\nprint len(s)               # 12 Unicode characters\n", ">>> bytearray([65, 66, 67])\nbytearray(b'ABC')\n>>> b = bytearray(u'\\u21ef\\u3244', 'utf-8')\n>>> b\nbytearray(b'\\xe2\\x87\\xaf\\xe3\\x89\\x84')\n>>> b[0] = '\\xe3'\n>>> b\nbytearray(b'\\xe3\\x87\\xaf\\xe3\\x89\\x84')\n>>> unicode(str(b), 'utf-8')\nu'\\u31ef \\u3244'\n", ">>> b = bytearray('ABC')\n>>> b.append('d')\n>>> b.append(ord('e'))\n>>> b\nbytearray(b'ABCde')\n"]}, "pep-3116-new-i-o-library": {"text": "PEP 3116: New I/O Library\n\nPython’s built-in file objects support a number of methods, but\nfile-like objects don’t necessarily support all of them.  Objects that\nimitate files usually support read() and write(), but they\nmay not support readline(), for example.  Python 3.0 introduces\na layered I/O library in the io module that separates buffering\nand text-handling features from the fundamental read and write\noperations.\nThere are three levels of abstract base classes provided by\nthe io module:\n\nRawIOBase defines raw I/O operations: read(),\nreadinto(),\nwrite(), seek(), tell(), truncate(),\nand close().\nMost of the methods of this class will often map to a single system call.\nThere are also readable(), writable(), and seekable()\nmethods for determining what operations a given object will allow.\nPython 3.0 has concrete implementations of this class for files and\nsockets, but Python 2.6 hasn’t restructured its file and socket objects\nin this way.\n\nBufferedIOBase is an abstract base class that\nbuffers data in memory to reduce the number of\nsystem calls used, making I/O processing more efficient.\nIt supports all of the methods of RawIOBase,\nand adds a raw attribute holding the underlying raw object.\nThere are five concrete classes implementing this ABC.\nBufferedWriter and BufferedReader are for objects\nthat support write-only or read-only usage that have a seek()\nmethod for random access.  BufferedRandom objects support\nread and write access upon the same underlying stream, and\nBufferedRWPair is for objects such as TTYs that have both\nread and write operations acting upon unconnected streams of data.\nThe BytesIO class supports reading, writing, and seeking\nover an in-memory buffer.\n\nTextIOBase: Provides functions for reading and writing\nstrings (remember, strings will be Unicode in Python 3.0),\nand supporting universal newlines.  TextIOBase defines\nthe readline() method and supports iteration upon\nobjects.\nThere are two concrete implementations.  TextIOWrapper\nwraps a buffered I/O object, supporting all of the methods for\ntext I/O and adding a buffer attribute for access\nto the underlying object.  StringIO simply buffers\neverything in memory without ever writing anything to disk.\n(In Python 2.6, io.StringIO is implemented in\npure Python, so it’s pretty slow.   You should therefore stick with the\nexisting StringIO module or cStringIO for now.  At some\npoint Python 3.0’s io module will be rewritten into C for speed,\nand perhaps the C implementation will be  backported to the 2.x releases.)\n\n\nIn Python 2.6, the underlying implementations haven’t been\nrestructured to build on top of the io module’s classes.  The\nmodule is being provided to make it easier to write code that’s\nforward-compatible with 3.0, and to save developers the effort of writing\ntheir own implementations of buffering and text I/O.\n\nSee also\n\nPEP 3116 - New I/O\nPEP written by Daniel Stutzbach, Mike Verdone, and Guido van Rossum.\nCode by Guido van Rossum, Georg Brandl, Walter Doerwald,\nJeremy Hylton, Martin von Loewis, Tony Lownds, and others.", "code_blocks": []}, "pep-3118-revised-buffer-protocol": {"text": "PEP 3118: Revised Buffer Protocol\n\nThe buffer protocol is a C-level API that lets Python types\nexchange pointers into their internal representations.  A\nmemory-mapped file can be viewed as a buffer of characters, for\nexample, and this lets another module such as re\ntreat memory-mapped files as a string of characters to be searched.\nThe primary users of the buffer protocol are numeric-processing\npackages such as NumPy, which expose the internal representation\nof arrays so that callers can write data directly into an array instead\nof going through a slower API.  This PEP updates the buffer protocol in light of experience\nfrom NumPy development, adding a number of new features\nsuch as indicating the shape of an array or locking a memory region.\nThe most important new C API function is\nPyObject_GetBuffer(PyObject *obj, Py_buffer *view, int flags), which\ntakes an object and a set of flags, and fills in the\nPy_buffer structure with information\nabout the object’s memory representation.  Objects\ncan use this operation to lock memory in place\nwhile an external caller could be modifying the contents,\nso there’s a corresponding PyBuffer_Release(Py_buffer *view) to\nindicate that the external caller is done.\nThe flags argument to PyObject_GetBuffer() specifies\nconstraints upon the memory returned.  Some examples are:\n\n\nPyBUF_WRITABLE indicates that the memory must be writable.\nPyBUF_LOCK requests a read-only or exclusive lock on the memory.\nPyBUF_C_CONTIGUOUS and PyBUF_F_CONTIGUOUS\nrequests a C-contiguous (last dimension varies the fastest) or\nFortran-contiguous (first dimension varies the fastest) array layout.\n\n\nTwo new argument codes for PyArg_ParseTuple(),\ns* and z*, return locked buffer objects for a parameter.\n\nSee also\n\nPEP 3118 - Revising the buffer protocol\nPEP written by Travis Oliphant and Carl Banks; implemented by\nTravis Oliphant.", "code_blocks": []}, "pep-3119-abstract-base-classes": {"text": "PEP 3119: Abstract Base Classes\n\nSome object-oriented languages such as Java support interfaces,\ndeclaring that a class has a given set of methods or supports a given\naccess protocol.  Abstract Base Classes (or ABCs) are an equivalent\nfeature for Python. The ABC support consists of an abc module\ncontaining a metaclass called ABCMeta, special handling of\nthis metaclass by the isinstance() and issubclass()\nbuiltins, and a collection of basic ABCs that the Python developers\nthink will be widely useful.  Future versions of Python will probably\nadd more ABCs.\nLet’s say you have a particular class and wish to know whether it supports\ndictionary-style access.  The phrase “dictionary-style” is vague, however.\nIt probably means that accessing items with obj[1] works.\nDoes it imply that setting items with obj[2] = value works?\nOr that the object will have keys(), values(), and items()\nmethods?  What about the iterative variants  such as iterkeys()?  copy()\nand update()?  Iterating over the object with iter()?\nThe Python 2.6 collections module includes a number of\ndifferent ABCs that represent these distinctions.  Iterable\nindicates that a class defines __iter__(), and\nContainer means the class defines a __contains__()\nmethod and therefore supports x in y expressions.  The basic\ndictionary interface of getting items, setting items, and\nkeys(), values(), and items(), is defined by the\nMutableMapping ABC.\nYou can derive your own classes from a particular ABC\nto indicate they support that ABC’s interface:\nimport collections\n\nclass Storage(collections.MutableMapping):\n    ...\n\n\nAlternatively, you could write the class without deriving from\nthe desired ABC and instead register the class by\ncalling the ABC’s register() method:\nimport collections\n\nclass Storage:\n    ...\n\ncollections.MutableMapping.register(Storage)\n\n\nFor classes that you write, deriving from the ABC is probably clearer.\nThe register()  method is useful when you’ve written a new\nABC that can describe an existing type or class, or if you want\nto declare that some third-party class implements an ABC.\nFor example, if you defined a PrintableType ABC,\nit’s legal to do:\n# Register Python's types\nPrintableType.register(int)\nPrintableType.register(float)\nPrintableType.register(str)\n\n\nClasses should obey the semantics specified by an ABC, but\nPython can’t check this; it’s up to the class author to\nunderstand the ABC’s requirements and to implement the code accordingly.\nTo check whether an object supports a particular interface, you can\nnow write:\ndef func(d):\n    if not isinstance(d, collections.MutableMapping):\n        raise ValueError(\"Mapping object expected, not %r\" % d)\n\n\nDon’t feel that you must now begin writing lots of checks as in the\nabove example.  Python has a strong tradition of duck-typing, where\nexplicit type-checking is never done and code simply calls methods on\nan object, trusting that those methods will be there and raising an\nexception if they aren’t.  Be judicious in checking for ABCs and only\ndo it where it’s absolutely necessary.\nYou can write your own ABCs by using abc.ABCMeta as the\nmetaclass in a class definition:\nfrom abc import ABCMeta, abstractmethod\n\nclass Drawable():\n    __metaclass__ = ABCMeta\n\n    @abstractmethod\n    def draw(self, x, y, scale=1.0):\n        pass\n\n    def draw_doubled(self, x, y):\n        self.draw(x, y, scale=2.0)\n\n\nclass Square(Drawable):\n    def draw(self, x, y, scale):\n        ...\n\n\nIn the Drawable ABC above, the draw_doubled() method\nrenders the object at twice its size and can be implemented in terms\nof other methods described in Drawable.  Classes implementing\nthis ABC therefore don’t need to provide their own implementation\nof draw_doubled(), though they can do so.  An implementation\nof draw() is necessary, though; the ABC can’t provide\na useful generic implementation.\nYou can apply the @abstractmethod decorator to methods such as\ndraw() that must be implemented; Python will then raise an\nexception for classes that don’t define the method.\nNote that the exception is only raised when you actually\ntry to create an instance of a subclass lacking the method:\n>>> class Circle(Drawable):\n...     pass\n...\n>>> c = Circle()\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: Can't instantiate abstract class Circle with abstract methods draw\n>>>\n\n\nAbstract data attributes can be declared using the\n@abstractproperty decorator:\nfrom abc import abstractproperty\n...\n\n@abstractproperty\ndef readonly(self):\n   return self._x\n\n\nSubclasses must then define a readonly() property.\n\nSee also\n\nPEP 3119 - Introducing Abstract Base Classes\nPEP written by Guido van Rossum and Talin.\nImplemented by Guido van Rossum.\nBackported to 2.6 by Benjamin Aranguren, with Alex Martelli.", "code_blocks": ["import collections\n\nclass Storage(collections.MutableMapping):\n    ...\n", "import collections\n\nclass Storage:\n    ...\n\ncollections.MutableMapping.register(Storage)\n", "# Register Python's types\nPrintableType.register(int)\nPrintableType.register(float)\nPrintableType.register(str)\n", "def func(d):\n    if not isinstance(d, collections.MutableMapping):\n        raise ValueError(\"Mapping object expected, not %r\" % d)\n", "from abc import ABCMeta, abstractmethod\n\nclass Drawable():\n    __metaclass__ = ABCMeta\n\n    @abstractmethod\n    def draw(self, x, y, scale=1.0):\n        pass\n\n    def draw_doubled(self, x, y):\n        self.draw(x, y, scale=2.0)\n\n\nclass Square(Drawable):\n    def draw(self, x, y, scale):\n        ...\n", ">>> class Circle(Drawable):\n...     pass\n...\n>>> c = Circle()\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: Can't instantiate abstract class Circle with abstract methods draw\n>>>\n", "from abc import abstractproperty\n...\n\n@abstractproperty\ndef readonly(self):\n   return self._x\n"]}, "pep-3127-integer-literal-support-and-syntax": {"text": "PEP 3127: Integer Literal Support and Syntax\n\nPython 3.0 changes the syntax for octal (base-8) integer literals,\nprefixing them with “0o” or “0O” instead of a leading zero, and adds\nsupport for binary (base-2) integer literals, signalled by a “0b” or\n“0B” prefix.\nPython 2.6 doesn’t drop support for a leading 0 signalling\nan octal number, but it does add support for “0o” and “0b”:\n>>> 0o21, 2*8 + 1\n(17, 17)\n>>> 0b101111\n47\n\n\nThe oct() builtin still returns numbers\nprefixed with a leading zero, and a new bin()\nbuiltin returns the binary representation for a number:\n>>> oct(42)\n'052'\n>>> future_builtins.oct(42)\n'0o52'\n>>> bin(173)\n'0b10101101'\n\n\nThe int() and long() builtins will now accept the “0o”\nand “0b” prefixes when base-8 or base-2 are requested, or when the\nbase argument is zero (signalling that the base used should be\ndetermined from the string):\n>>> int ('0o52', 0)\n42\n>>> int('1101', 2)\n13\n>>> int('0b1101', 2)\n13\n>>> int('0b1101', 0)\n13\n\n\n\nSee also\n\nPEP 3127 - Integer Literal Support and Syntax\nPEP written by Patrick Maupin; backported to 2.6 by\nEric Smith.", "code_blocks": [">>> 0o21, 2*8 + 1\n(17, 17)\n>>> 0b101111\n47\n", ">>> oct(42)\n'052'\n>>> future_builtins.oct(42)\n'0o52'\n>>> bin(173)\n'0b10101101'\n", ">>> int ('0o52', 0)\n42\n>>> int('1101', 2)\n13\n>>> int('0b1101', 2)\n13\n>>> int('0b1101', 0)\n13\n"]}, "pep-3129-class-decorators": {"text": "PEP 3129: Class Decorators\n\nDecorators have been extended from functions to classes.  It’s now legal to\nwrite:\n@foo\n@bar\nclass A:\n  pass\n\n\nThis is equivalent to:\nclass A:\n  pass\n\nA = foo(bar(A))\n\n\n\nSee also\n\nPEP 3129 - Class Decorators\nPEP written by Collin Winter.", "code_blocks": ["@foo\n@bar\nclass A:\n  pass\n", "class A:\n  pass\n\nA = foo(bar(A))\n"]}, "pep-3141-a-type-hierarchy-for-numbers - the-fractions-module": {"text": "The fractions Module\n\nTo fill out the hierarchy of numeric types, the fractions\nmodule provides a rational-number class.  Rational numbers store their\nvalues as a numerator and denominator forming a fraction, and can\nexactly represent numbers such as 2/3 that floating-point numbers\ncan only approximate.\nThe Fraction constructor takes two Integral values\nthat will be the numerator and denominator of the resulting fraction.\n>>> from fractions import Fraction\n>>> a = Fraction(2, 3)\n>>> b = Fraction(2, 5)\n>>> float(a), float(b)\n(0.66666666666666663, 0.40000000000000002)\n>>> a+b\nFraction(16, 15)\n>>> a/b\nFraction(5, 3)\n\n\nFor converting floating-point numbers to rationals,\nthe float type now has an as_integer_ratio() method that returns\nthe numerator and denominator for a fraction that evaluates to the same\nfloating-point value:\n>>> (2.5) .as_integer_ratio()\n(5, 2)\n>>> (3.1415) .as_integer_ratio()\n(7074029114692207L, 2251799813685248L)\n>>> (1./3) .as_integer_ratio()\n(6004799503160661L, 18014398509481984L)\n\n\nNote that values that can only be approximated by floating-point\nnumbers, such as 1./3, are not simplified to the number being\napproximated; the fraction attempts to match the floating-point value\nexactly.\nThe fractions module is based upon an implementation by Sjoerd\nMullender that was in Python’s Demo/classes/ directory for a\nlong time.  This implementation was significantly updated by Jeffrey\nYasskin.", "code_blocks": [">>> from fractions import Fraction\n>>> a = Fraction(2, 3)\n>>> b = Fraction(2, 5)\n>>> float(a), float(b)\n(0.66666666666666663, 0.40000000000000002)\n>>> a+b\nFraction(16, 15)\n>>> a/b\nFraction(5, 3)\n", ">>> (2.5) .as_integer_ratio()\n(5, 2)\n>>> (3.1415) .as_integer_ratio()\n(7074029114692207L, 2251799813685248L)\n>>> (1./3) .as_integer_ratio()\n(6004799503160661L, 18014398509481984L)\n"]}, "other-language-changes - optimizations": {"text": "Optimizations\n\n\nThe warnings module has been rewritten in C.  This makes\nit possible to invoke warnings from the parser, and may also\nmake the interpreter’s startup faster.\n(Contributed by Neal Norwitz and Brett Cannon; issue 1631171.)\n\nType objects now have a cache of methods that can reduce\nthe work required to find the correct method implementation\nfor a particular class; once cached, the interpreter doesn’t need to\ntraverse base classes to figure out the right method to call.\nThe cache is cleared if a base class or the class itself is modified,\nso the cache should remain correct even in the face of Python’s dynamic\nnature.\n(Original optimization implemented by Armin Rigo, updated for\nPython 2.6 by Kevin Jacobs; issue 1700288.)\nBy default, this change is only applied to types that are included with\nthe Python core.  Extension modules may not necessarily be compatible with\nthis cache,\nso they must explicitly add Py_TPFLAGS_HAVE_VERSION_TAG\nto the module’s tp_flags field to enable the method cache.\n(To be compatible with the method cache, the extension module’s code\nmust not directly access and modify the tp_dict member of\nany of the types it implements.  Most modules don’t do this,\nbut it’s impossible for the Python interpreter to determine that.\nSee issue 1878 for some discussion.)\n\nFunction calls that use keyword arguments are significantly faster\nby doing a quick pointer comparison, usually saving the time of a\nfull string comparison.  (Contributed by Raymond Hettinger, after an\ninitial implementation by Antoine Pitrou; issue 1819.)\n\nAll of the functions in the struct module have been rewritten in\nC, thanks to work at the Need For Speed sprint.\n(Contributed by Raymond Hettinger.)\n\nSome of the standard built-in types now set a bit in their type\nobjects.  This speeds up checking whether an object is a subclass of\none of these types.  (Contributed by Neal Norwitz.)\n\nUnicode strings now use faster code for detecting\nwhitespace and line breaks; this speeds up the split() method\nby about 25% and splitlines() by 35%.\n(Contributed by Antoine Pitrou.)  Memory usage is reduced\nby using pymalloc for the Unicode string’s data.\n\nThe with statement now stores the __exit__() method on the stack,\nproducing a small speedup.  (Implemented by Jeffrey Yasskin.)\n\nTo reduce memory usage, the garbage collector will now clear internal\nfree lists when garbage-collecting the highest generation of objects.\nThis may return memory to the operating system sooner.", "code_blocks": []}, "other-language-changes - interpreter-changes": {"text": "Interpreter Changes\n\nTwo command-line options have been reserved for use by other Python\nimplementations.  The -J switch has been reserved for use by\nJython for Jython-specific options, such as switches that are passed to\nthe underlying JVM.  -X has been reserved for options\nspecific to a particular implementation of Python such as CPython,\nJython, or IronPython.  If either option is used with Python 2.6, the\ninterpreter will report that the option isn’t currently used.\nPython can now be prevented from writing .pyc or .pyo\nfiles by supplying the -B switch to the Python interpreter,\nor by setting the PYTHONDONTWRITEBYTECODE environment\nvariable before running the interpreter.  This setting is available to\nPython programs as the sys.dont_write_bytecode variable, and\nPython code can change the value to modify the interpreter’s\nbehaviour.  (Contributed by Neal Norwitz and Georg Brandl.)\nThe encoding used for standard input, output, and standard error can\nbe specified by setting the PYTHONIOENCODING environment\nvariable before running the interpreter.  The value should be a string\nin the form <encoding> or <encoding>:<errorhandler>.\nThe encoding part specifies the encoding’s name, e.g. utf-8 or\nlatin-1; the optional errorhandler part specifies\nwhat to do with characters that can’t be handled by the encoding,\nand  should be one of “error”, “ignore”, or “replace”.   (Contributed\nby Martin von Loewis.)", "code_blocks": []}, "new-and-improved-modules - the-ast-module": {"text": "The ast module\n\nThe ast module provides an Abstract Syntax Tree\nrepresentation of Python code, and Armin Ronacher\ncontributed a set of helper functions that perform a variety of\ncommon tasks.  These will be useful for HTML templating\npackages, code analyzers, and similar tools that process\nPython code.\nThe parse() function takes an expression and returns an AST.\nThe dump() function outputs a representation of a tree, suitable\nfor debugging:\nimport ast\n\nt = ast.parse(\"\"\"\nd = {}\nfor i in 'abcdefghijklm':\n    d[i + i] = ord(i) - ord('a') + 1\nprint d\n\"\"\")\nprint ast.dump(t)\n\n\nThis outputs a deeply nested tree:\nModule(body=[\n  Assign(targets=[\n    Name(id='d', ctx=Store())\n   ], value=Dict(keys=[], values=[]))\n  For(target=Name(id='i', ctx=Store()),\n      iter=Str(s='abcdefghijklm'), body=[\n    Assign(targets=[\n      Subscript(value=\n        Name(id='d', ctx=Load()),\n          slice=\n          Index(value=\n            BinOp(left=Name(id='i', ctx=Load()), op=Add(),\n             right=Name(id='i', ctx=Load()))), ctx=Store())\n     ], value=\n     BinOp(left=\n      BinOp(left=\n       Call(func=\n        Name(id='ord', ctx=Load()), args=[\n          Name(id='i', ctx=Load())\n         ], keywords=[], starargs=None, kwargs=None),\n       op=Sub(), right=Call(func=\n        Name(id='ord', ctx=Load()), args=[\n          Str(s='a')\n         ], keywords=[], starargs=None, kwargs=None)),\n       op=Add(), right=Num(n=1)))\n    ], orelse=[])\n   Print(dest=None, values=[\n     Name(id='d', ctx=Load())\n   ], nl=True)\n ])\n\nThe literal_eval() method takes a string or an AST\nrepresenting a literal expression, parses and evaluates it, and\nreturns the resulting value.  A literal expression is a Python\nexpression containing only strings, numbers, dictionaries,\netc. but no statements or function calls.  If you need to\nevaluate an expression but cannot accept the security risk of using an\neval() call, literal_eval() will handle it safely:\n>>> literal = '(\"a\", \"b\", {2:4, 3:8, 1:2})'\n>>> print ast.literal_eval(literal)\n('a', 'b', {1: 2, 2: 4, 3: 8})\n>>> print ast.literal_eval('\"a\" + \"b\"')\nTraceback (most recent call last):\n  ...\nValueError: malformed string\n\n\nThe module also includes NodeVisitor and\nNodeTransformer classes for traversing and modifying an AST,\nand functions for common transformations such as changing line\nnumbers.", "code_blocks": ["import ast\n\nt = ast.parse(\"\"\"\nd = {}\nfor i in 'abcdefghijklm':\n    d[i + i] = ord(i) - ord('a') + 1\nprint d\n\"\"\")\nprint ast.dump(t)\n", ">>> literal = '(\"a\", \"b\", {2:4, 3:8, 1:2})'\n>>> print ast.literal_eval(literal)\n('a', 'b', {1: 2, 2: 4, 3: 8})\n>>> print ast.literal_eval('\"a\" + \"b\"')\nTraceback (most recent call last):\n  ...\nValueError: malformed string\n"]}, "new-and-improved-modules - the-future-builtins-module": {"text": "The future_builtins module\n\nPython 3.0 makes many changes to the repertoire of built-in\nfunctions, and most of the changes can’t be introduced in the Python\n2.x series because they would break compatibility.\nThe future_builtins module provides versions\nof these built-in functions that can be imported when writing\n3.0-compatible code.\nThe functions in this module currently include:\n\nascii(obj): equivalent to repr().  In Python 3.0,\nrepr() will return a Unicode string, while ascii() will\nreturn a pure ASCII bytestring.\nfilter(predicate, iterable),\nmap(func, iterable1, ...): the 3.0 versions\nreturn iterators, unlike the 2.x builtins which return lists.\nhex(value), oct(value): instead of calling the\n__hex__() or __oct__() methods, these versions will\ncall the __index__() method and convert the result to hexadecimal\nor octal.  oct() will use the new 0o notation for its\nresult.", "code_blocks": []}, "new-and-improved-modules - the-json-module-javascript-object-notation": {"text": "The json module: JavaScript Object Notation\n\nThe new json module supports the encoding and decoding of Python types in\nJSON (Javascript Object Notation). JSON is a lightweight interchange format\noften used in web applications. For more information about JSON, see\nhttp://www.json.org.\njson comes with support for decoding and encoding most built-in Python\ntypes. The following example encodes and decodes a dictionary:\n>>> import json\n>>> data = {\"spam\" : \"foo\", \"parrot\" : 42}\n>>> in_json = json.dumps(data) # Encode the data\n>>> in_json\n'{\"parrot\": 42, \"spam\": \"foo\"}'\n>>> json.loads(in_json) # Decode into a Python object\n{\"spam\" : \"foo\", \"parrot\" : 42}\n\n\nIt’s also possible to write your own decoders and encoders to support\nmore types. Pretty-printing of the JSON strings is also supported.\njson (originally called simplejson) was written by Bob\nIppolito.", "code_blocks": [">>> import json\n>>> data = {\"spam\" : \"foo\", \"parrot\" : 42}\n>>> in_json = json.dumps(data) # Encode the data\n>>> in_json\n'{\"parrot\": 42, \"spam\": \"foo\"}'\n>>> json.loads(in_json) # Decode into a Python object\n{\"spam\" : \"foo\", \"parrot\" : 42}\n"]}, "new-and-improved-modules - the-plistlib-module-a-property-list-parser": {"text": "The plistlib module: A Property-List Parser\n\nThe .plist format is commonly used on Mac OS X to\nstore basic data types (numbers, strings, lists,\nand dictionaries) by serializing them into an XML-based format.\nIt resembles the XML-RPC serialization of data types.\nDespite being primarily used on Mac OS X, the format\nhas nothing Mac-specific about it and the Python implementation works\non any platform that Python supports, so the plistlib module\nhas been promoted to the standard library.\nUsing the module is simple:\nimport sys\nimport plistlib\nimport datetime\n\n# Create data structure\ndata_struct = dict(lastAccessed=datetime.datetime.now(),\n                   version=1,\n                   categories=('Personal','Shared','Private'))\n\n# Create string containing XML.\nplist_str = plistlib.writePlistToString(data_struct)\nnew_struct = plistlib.readPlistFromString(plist_str)\nprint data_struct\nprint new_struct\n\n# Write data structure to a file and read it back.\nplistlib.writePlist(data_struct, '/tmp/customizations.plist')\nnew_struct = plistlib.readPlist('/tmp/customizations.plist')\n\n# read/writePlist accepts file-like objects as well as paths.\nplistlib.writePlist(data_struct, sys.stdout)", "code_blocks": ["import sys\nimport plistlib\nimport datetime\n\n# Create data structure\ndata_struct = dict(lastAccessed=datetime.datetime.now(),\n                   version=1,\n                   categories=('Personal','Shared','Private'))\n\n# Create string containing XML.\nplist_str = plistlib.writePlistToString(data_struct)\nnew_struct = plistlib.readPlistFromString(plist_str)\nprint data_struct\nprint new_struct\n\n# Write data structure to a file and read it back.\nplistlib.writePlist(data_struct, '/tmp/customizations.plist')\nnew_struct = plistlib.readPlist('/tmp/customizations.plist')\n\n# read/writePlist accepts file-like objects as well as paths.\nplistlib.writePlist(data_struct, sys.stdout)\n"]}, "new-and-improved-modules - ctypes-enhancements": {"text": "ctypes Enhancements\n\nThomas Heller continued to maintain and enhance the\nctypes module.\nctypes now supports a c_bool datatype\nthat represents the C99 bool type.  (Contributed by David Remahl;\nissue 1649190.)\nThe ctypes string, buffer and array types have improved\nsupport for extended slicing syntax,\nwhere various combinations of (start, stop, step) are supplied.\n(Implemented by Thomas Wouters.)\nAll ctypes data types now support\nfrom_buffer() and from_buffer_copy()\nmethods that create a ctypes instance based on a\nprovided buffer object.  from_buffer_copy() copies\nthe contents of the object,\nwhile from_buffer() will share the same memory area.\nA new calling convention tells ctypes to clear the errno or\nWin32 LastError variables at the outset of each wrapped call.\n(Implemented by Thomas Heller; issue 1798.)\nYou can now retrieve the Unix errno variable after a function\ncall.  When creating a wrapped function, you can supply\nuse_errno=True as a keyword parameter to the DLL() function\nand then call the module-level methods set_errno() and\nget_errno() to set and retrieve the error value.\nThe Win32 LastError variable is similarly supported by\nthe DLL(), OleDLL(), and WinDLL() functions.\nYou supply use_last_error=True as a keyword parameter\nand then call the module-level methods set_last_error()\nand get_last_error().\nThe byref() function, used to retrieve a pointer to a ctypes\ninstance, now has an optional offset parameter that is a byte\ncount that will be added to the returned pointer.", "code_blocks": []}, "new-and-improved-modules - improved-ssl-support": {"text": "Improved SSL Support\n\nBill Janssen made extensive improvements to Python 2.6’s support for\nthe Secure Sockets Layer by adding a new module, ssl, that’s\nbuilt atop the OpenSSL library.\nThis new module provides more control over the protocol negotiated,\nthe X.509 certificates used, and has better support for writing SSL\nservers (as opposed to clients) in Python.  The existing SSL support\nin the socket module hasn’t been removed and continues to work,\nthough it will be removed in Python 3.0.\nTo use the new module, you must first create a TCP connection in the\nusual way and then pass it to the ssl.wrap_socket() function.\nIt’s possible to specify whether a certificate is required, and to\nobtain certificate info by calling the getpeercert() method.\n\nSee also\nThe documentation for the ssl module.", "code_blocks": []}, "deprecations-and-removals": {"text": "Deprecations and Removals\n\n\nString exceptions have been removed.  Attempting to use them raises a\nTypeError.\n\nChanges to the Exception interface\nas dictated by PEP 352 continue to be made.  For 2.6,\nthe message attribute is being deprecated in favor of the\nargs attribute.\n\n(3.0-warning mode) Python 3.0 will feature a reorganized standard\nlibrary that will drop many outdated modules and rename others.\nPython 2.6 running in 3.0-warning mode will warn about these modules\nwhen they are imported.\nThe list of deprecated modules is:\naudiodev,\nbgenlocations,\nbuildtools,\nbundlebuilder,\nCanvas,\ncompiler,\ndircache,\ndl,\nfpformat,\ngensuitemodule,\nihooks,\nimageop,\nimgfile,\nlinuxaudiodev,\nmhlib,\nmimetools,\nmultifile,\nnew,\npure,\nstatvfs,\nsunaudiodev,\ntest.testall, and\ntoaiff.\n\nThe gopherlib module has been removed.\n\nThe MimeWriter module and mimify module\nhave been deprecated; use the email\npackage instead.\n\nThe md5 module has been deprecated; use the hashlib module\ninstead.\n\nThe posixfile module has been deprecated; fcntl.lockf()\nprovides better locking.\n\nThe popen2 module has been deprecated; use the subprocess\nmodule.\n\nThe rgbimg module has been removed.\n\nThe sets module has been deprecated; it’s better to\nuse the built-in set and frozenset types.\n\nThe sha module has been deprecated; use the hashlib module\ninstead.", "code_blocks": []}, "build-and-c-api-changes - port-specific-changes-windows": {"text": "Port-Specific Changes: Windows\n\n\nThe support for Windows 95, 98, ME and NT4 has been dropped.\nPython 2.6 requires at least Windows 2000 SP4.\n\nThe new default compiler on Windows is Visual Studio 2008 (version\n9.0). The build directories for Visual Studio 2003 (version 7.1) and\n2005 (version 8.0) were moved into the PC/ directory. The new\nPCbuild directory supports cross compilation for X64, debug\nbuilds and Profile Guided Optimization (PGO). PGO builds are roughly\n10% faster than normal builds.  (Contributed by Christian Heimes\nwith help from Amaury Forgeot d’Arc and Martin von Loewis.)\n\nThe msvcrt module now supports\nboth the normal and wide char variants of the console I/O\nAPI.  The getwch() function reads a keypress and returns a Unicode\nvalue, as does the getwche() function.  The putwch() function\ntakes a Unicode character and writes it to the console.\n(Contributed by Christian Heimes.)\n\nos.path.expandvars() will now expand environment variables in\nthe form “%var%”, and “~user” will be expanded into the user’s home\ndirectory path.  (Contributed by Josiah Carlson; issue 957650.)\n\nThe socket module’s socket objects now have an\nioctl() method that provides a limited interface to the\nWSAIoctl() system interface.\n\nThe _winreg module now has a function,\nExpandEnvironmentStrings(),\nthat expands environment variable references such as %NAME%\nin an input string.  The handle objects provided by this\nmodule now support the context protocol, so they can be used\nin with statements. (Contributed by Christian Heimes.)\n_winreg also has better support for x64 systems,\nexposing the DisableReflectionKey(), EnableReflectionKey(),\nand QueryReflectionKey() functions, which enable and disable\nregistry reflection for 32-bit processes running on 64-bit systems.\n(issue 1753245)\n\nThe msilib module’s Record object\ngained GetInteger() and GetString() methods that\nreturn field values as an integer or a string.\n(Contributed by Floris Bruynooghe; issue 2125.)", "code_blocks": []}, "build-and-c-api-changes - port-specific-changes-mac-os-x": {"text": "Port-Specific Changes: Mac OS X\n\n\nWhen compiling a framework build of Python, you can now specify the\nframework name to be used by providing the\n--with-framework-name= option to the\nconfigure script.\nThe macfs module has been removed.  This in turn required the\nmacostools.touched() function to be removed because it depended on the\nmacfs module.  (issue 1490190)\nMany other Mac OS modules have been deprecated and will removed in\nPython 3.0:\n_builtinSuites,\naepack,\naetools,\naetypes,\napplesingle,\nappletrawmain,\nappletrunner,\nargvemulator,\nAudio_mac,\nautoGIL,\nCarbon,\ncfmfile,\nCodeWarrior,\nColorPicker,\nEasyDialogs,\nExplorer,\nFinder,\nFrameWork,\nfindertools,\nic,\nicglue,\nicopen,\nmacerrors,\nMacOS,\nmacfs,\nmacostools,\nmacresource,\nMiniAEFrame,\nNav,\nNetscape,\nOSATerminology,\npimp,\nPixMapWrapper,\nStdSuites,\nSystemEvents,\nTerminal, and\nterminalcommand.", "code_blocks": []}, "build-and-c-api-changes - port-specific-changes-irix": {"text": "Port-Specific Changes: IRIX\n\nA number of old IRIX-specific modules were deprecated and will\nbe removed in Python 3.0:\nal and AL,\ncd,\ncddb,\ncdplayer,\nCL and cl,\nDEVICE,\nERRNO,\nFILE,\nFL and fl,\nflp,\nfm,\nGET,\nGLWS,\nGL and gl,\nIN,\nIOCTL,\njpeg,\npanelparser,\nreadcd,\nSV and sv,\ntorgb,\nvideoreader, and\nWAIT.", "code_blocks": []}, "porting-to-python-2-6": {"text": "Porting to Python 2.6\n\nThis section lists previously described changes and other bugfixes\nthat may require changes to your code:\n\nClasses that aren’t supposed to be hashable should\nset __hash__ = None in their definitions to indicate\nthe fact.\n\nString exceptions have been removed.  Attempting to use them raises a\nTypeError.\n\nThe __init__() method of collections.deque\nnow clears any existing contents of the deque\nbefore adding elements from the iterable.  This change makes the\nbehavior match list.__init__().\n\nobject.__init__() previously accepted arbitrary arguments and\nkeyword arguments, ignoring them.  In Python 2.6, this is no longer\nallowed and will result in a TypeError.  This will affect\n__init__() methods that end up calling the corresponding\nmethod on object (perhaps through using super()).\nSee issue 1683368 for discussion.\n\nThe Decimal constructor now accepts leading and trailing\nwhitespace when passed a string.  Previously it would raise an\nInvalidOperation exception.  On the other hand, the\ncreate_decimal() method of Context objects now\nexplicitly disallows extra whitespace, raising a\nConversionSyntax exception.\n\nDue to an implementation accident, if you passed a file path to\nthe built-in  __import__() function, it would actually import\nthe specified file.  This was never intended to work, however, and\nthe implementation now explicitly checks for this case and raises\nan ImportError.\n\nC API: the PyImport_Import() and PyImport_ImportModule()\nfunctions now default to absolute imports, not relative imports.\nThis will affect C extensions that import other modules.\n\nC API: extension data types that shouldn’t be hashable\nshould define their tp_hash slot to\nPyObject_HashNotImplemented().\n\nThe socket module exception socket.error now inherits\nfrom IOError.  Previously it wasn’t a subclass of\nStandardError but now it is, through IOError.\n(Implemented by Gregory P. Smith; issue 1706815.)\n\nThe xmlrpclib module no longer automatically converts\ndatetime.date and datetime.time to the\nxmlrpclib.DateTime type; the conversion semantics were\nnot necessarily correct for all applications.  Code using\nxmlrpclib should convert date and time\ninstances. (issue 1330538)\n\n(3.0-warning mode) The Exception class now warns\nwhen accessed using slicing or index access; having\nException behave like a tuple is being phased out.\n\n(3.0-warning mode) inequality comparisons between two dictionaries\nor two objects that don’t implement comparison methods are reported\nas warnings.  dict1 == dict2 still works, but dict1 < dict2\nis being phased out.\nComparisons between cells, which are an implementation detail of Python’s\nscoping rules, also cause warnings because such comparisons are forbidden\nentirely in 3.0.\n\n\nFor applications that embed Python:\n\nThe PySys_SetArgvEx() function was added in Python 2.6.6,\nletting applications close a security hole when the existing\nPySys_SetArgv() function was used.  Check whether you’re\ncalling PySys_SetArgv() and carefully consider whether the\napplication should be using PySys_SetArgvEx() with\nupdatepath set to false.", "code_blocks": []}, "acknowledgements": {"text": "Acknowledgements\n\nThe author would like to thank the following people for offering\nsuggestions, corrections and assistance with various drafts of this\narticle: Georg Brandl, Steve Brown, Nick Coghlan, Ralph Corderoy,\nJim Jewett, Kent Johnson, Chris Lambacher,  Martin Michlmayr,\nAntoine Pitrou, Brian Warner.", "code_blocks": []}}}
{"index": 1, "python_version": "2.7", "url": "https://docs.python.org/2.7/whatsnew/2.7.html", "sections": {"the-future-for-python-2-x": {"text": "The Future for Python 2.x\n\nPython 2.7 is the last major release in the 2.x series, as the Python\nmaintainers have shifted the focus of their new feature development efforts\nto the Python 3.x series. This means that while Python 2 continues to\nreceive bug fixes, and to be updated to build correctly on new hardware and\nversions of supported operated systems, there will be no new full feature\nreleases for the language or standard library.\nHowever, while there is a large common subset between Python 2.7 and Python\n3, and many of the changes involved in migrating to that common subset, or\ndirectly to Python 3, can be safely automated, some other changes (notably\nthose associated with Unicode handling) may require careful consideration,\nand preferably robust automated regression test suites, to migrate\neffectively.\nThis means that Python 2.7 will remain in place for a long time, providing a\nstable and supported base platform for production systems that have not yet\nbeen ported to Python 3. The full expected lifecycle of the Python 2.7\nseries is detailed in PEP 373.\nSome key consequences of the long-term significance of 2.7 are:\n\nAs noted above, the 2.7 release has a much longer period of maintenance\nwhen compared to earlier 2.x versions. Python 2.7 is currently expected to\nremain supported by the core development team (receiving security updates\nand other bug fixes) until at least 2020 (10 years after its initial\nrelease, compared to the more typical support period of 18–24 months).\nAs the Python 2.7 standard library ages, making effective use of the\nPython Package Index (either directly or via a redistributor) becomes\nmore important for Python 2 users. In addition to a wide variety of third\nparty packages for various tasks, the available packages include backports\nof new modules and features from the Python 3 standard library that are\ncompatible with Python 2, as well as various tools and libraries that can\nmake it easier to migrate to Python 3. The Python Packaging User Guide provides guidance on downloading and\ninstalling software from the Python Package Index.\nWhile the preferred approach to enhancing Python 2 is now the publication\nof new packages on the Python Package Index, this approach doesn’t\nnecessarily work in all cases, especially those related to network\nsecurity. In exceptional cases that cannot be handled adequately by\npublishing new or updated packages on PyPI, the Python Enhancement\nProposal process may be used to make the case for adding new features\ndirectly to the Python 2 standard library. Any such additions, and the\nmaintenance releases where they were added, will be noted in the\nNew Features Added to Python 2.7 Maintenance Releases section below.\n\nFor projects wishing to migrate from Python 2 to Python 3, or for library\nand framework developers wishing to support users on both Python 2 and\nPython 3, there are a variety of tools and guides available to help decide\non a suitable approach and manage some of the technical details involved.\nThe recommended starting point is the Porting Python 2 Code to Python 3 HOWTO guide.", "code_blocks": []}, "changes-to-the-handling-of-deprecation-warnings": {"text": "Changes to the Handling of Deprecation Warnings\n\nFor Python 2.7, a policy decision was made to silence warnings only of\ninterest to developers by default.  DeprecationWarning and its\ndescendants are now ignored unless otherwise requested, preventing\nusers from seeing warnings triggered by an application.  This change\nwas also made in the branch that became Python 3.2. (Discussed\non stdlib-sig and carried out in bpo-7319.)\nIn previous releases, DeprecationWarning messages were\nenabled by default, providing Python developers with a clear\nindication of where their code may break in a future major version\nof Python.\nHowever, there are increasingly many users of Python-based\napplications who are not directly involved in the development of\nthose applications.  DeprecationWarning messages are\nirrelevant to such users, making them worry about an application\nthat’s actually working correctly and burdening application developers\nwith responding to these concerns.\nYou can re-enable display of DeprecationWarning messages by\nrunning Python with the -Wdefault (short form:\n-Wd) switch, or by setting the PYTHONWARNINGS\nenvironment variable to \"default\" (or \"d\") before running\nPython.  Python code can also re-enable them\nby calling warnings.simplefilter('default').\nThe unittest module also automatically reenables deprecation warnings\nwhen running tests.", "code_blocks": []}, "python-3-1-features": {"text": "Python 3.1 Features\n\nMuch as Python 2.6 incorporated features from Python 3.0,\nversion 2.7 incorporates some of the new features\nin Python 3.1.  The 2.x series continues to provide tools\nfor migrating to the 3.x series.\nA partial list of 3.1 features that were backported to 2.7:\n\nThe syntax for set literals ({1,2,3} is a mutable set).\nDictionary and set comprehensions ({i: i*2 for i in range(3)}).\nMultiple context managers in a single with statement.\nA new version of the io library, rewritten in C for performance.\nThe ordered-dictionary type described in PEP 372: Adding an Ordered Dictionary to collections.\nThe new \",\" format specifier described in PEP 378: Format Specifier for Thousands Separator.\nThe memoryview object.\nA small subset of the importlib module,\ndescribed below.\nThe repr() of a float x is shorter in many cases: it’s now\nbased on the shortest decimal string that’s guaranteed to round back\nto x.  As in previous versions of Python, it’s guaranteed that\nfloat(repr(x)) recovers x.\nFloat-to-string and string-to-float conversions are correctly rounded.\nThe round() function is also now correctly rounded.\nThe PyCapsule type, used to provide a C API for extension modules.\nThe PyLong_AsLongAndOverflow() C API function.\n\nOther new Python3-mode warnings include:\n\noperator.isCallable() and operator.sequenceIncludes(),\nwhich are not supported in 3.x, now trigger warnings.\nThe -3 switch now automatically\nenables the -Qwarn switch that causes warnings\nabout using classic division with integers and long integers.", "code_blocks": []}, "pep-372-adding-an-ordered-dictionary-to-collections": {"text": "PEP 372: Adding an Ordered Dictionary to collections\n\nRegular Python dictionaries iterate over key/value pairs in arbitrary order.\nOver the years, a number of authors have written alternative implementations\nthat remember the order that the keys were originally inserted.  Based on\nthe experiences from those implementations, 2.7 introduces a new\nOrderedDict class in the collections module.\nThe OrderedDict API provides the same interface as regular\ndictionaries but iterates over keys and values in a guaranteed order\ndepending on when a key was first inserted:\n>>> from collections import OrderedDict\n>>> d = OrderedDict([('first', 1),\n...                  ('second', 2),\n...                  ('third', 3)])\n>>> d.items()\n[('first', 1), ('second', 2), ('third', 3)]\n\n\nIf a new entry overwrites an existing entry, the original insertion\nposition is left unchanged:\n>>> d['second'] = 4\n>>> d.items()\n[('first', 1), ('second', 4), ('third', 3)]\n\n\nDeleting an entry and reinserting it will move it to the end:\n>>> del d['second']\n>>> d['second'] = 5\n>>> d.items()\n[('first', 1), ('third', 3), ('second', 5)]\n\n\nThe popitem() method has an optional last\nargument that defaults to True.  If last is true, the most recently\nadded key is returned and removed; if it’s false, the\noldest key is selected:\n>>> od = OrderedDict([(x,0) for x in range(20)])\n>>> od.popitem()\n(19, 0)\n>>> od.popitem()\n(18, 0)\n>>> od.popitem(last=False)\n(0, 0)\n>>> od.popitem(last=False)\n(1, 0)\n\n\nComparing two ordered dictionaries checks both the keys and values,\nand requires that the insertion order was the same:\n>>> od1 = OrderedDict([('first', 1),\n...                    ('second', 2),\n...                    ('third', 3)])\n>>> od2 = OrderedDict([('third', 3),\n...                    ('first', 1),\n...                    ('second', 2)])\n>>> od1 == od2\nFalse\n>>> # Move 'third' key to the end\n>>> del od2['third']; od2['third'] = 3\n>>> od1 == od2\nTrue\n\n\nComparing an OrderedDict with a regular dictionary\nignores the insertion order and just compares the keys and values.\nHow does the OrderedDict work?  It maintains a\ndoubly-linked list of keys, appending new keys to the list as they’re inserted.\nA secondary dictionary maps keys to their corresponding list node, so\ndeletion doesn’t have to traverse the entire linked list and therefore\nremains O(1).\nThe standard library now supports use of ordered dictionaries in several\nmodules.\n\nThe ConfigParser module uses them by default, meaning that\nconfiguration files can now be read, modified, and then written back\nin their original order.\nThe _asdict() method for\ncollections.namedtuple() now returns an ordered dictionary with the\nvalues appearing in the same order as the underlying tuple indices.\nThe json module’s JSONDecoder class\nconstructor was extended with an object_pairs_hook parameter to\nallow OrderedDict instances to be built by the decoder.\nSupport was also added for third-party tools like\nPyYAML.\n\n\nSee also\n\nPEP 372 - Adding an ordered dictionary to collectionsPEP written by Armin Ronacher and Raymond Hettinger;\nimplemented by Raymond Hettinger.", "code_blocks": [">>> from collections import OrderedDict\n>>> d = OrderedDict([('first', 1),\n...                  ('second', 2),\n...                  ('third', 3)])\n>>> d.items()\n[('first', 1), ('second', 2), ('third', 3)]\n", ">>> d['second'] = 4\n>>> d.items()\n[('first', 1), ('second', 4), ('third', 3)]\n", ">>> del d['second']\n>>> d['second'] = 5\n>>> d.items()\n[('first', 1), ('third', 3), ('second', 5)]\n", ">>> od = OrderedDict([(x,0) for x in range(20)])\n>>> od.popitem()\n(19, 0)\n>>> od.popitem()\n(18, 0)\n>>> od.popitem(last=False)\n(0, 0)\n>>> od.popitem(last=False)\n(1, 0)\n", ">>> od1 = OrderedDict([('first', 1),\n...                    ('second', 2),\n...                    ('third', 3)])\n>>> od2 = OrderedDict([('third', 3),\n...                    ('first', 1),\n...                    ('second', 2)])\n>>> od1 == od2\nFalse\n>>> # Move 'third' key to the end\n>>> del od2['third']; od2['third'] = 3\n>>> od1 == od2\nTrue\n"]}, "pep-378-format-specifier-for-thousands-separator": {"text": "PEP 378: Format Specifier for Thousands Separator\n\nTo make program output more readable, it can be useful to add\nseparators to large numbers, rendering them as\n18,446,744,073,709,551,616 instead of 18446744073709551616.\nThe fully general solution for doing this is the locale module,\nwhich can use different separators (“,” in North America, “.” in\nEurope) and different grouping sizes, but locale is complicated\nto use and unsuitable for multi-threaded applications where different\nthreads are producing output for different locales.\nTherefore, a simple comma-grouping mechanism has been added to the\nmini-language used by the str.format() method.  When\nformatting a floating-point number, simply include a comma between the\nwidth and the precision:\n>>> '{:20,.2f}'.format(18446744073709551616.0)\n'18,446,744,073,709,551,616.00'\n\n\nWhen formatting an integer, include the comma after the width:\n>>> '{:20,d}'.format(18446744073709551616)\n'18,446,744,073,709,551,616'\n\n\nThis mechanism is not adaptable at all; commas are always used as the\nseparator and the grouping is always into three-digit groups.  The\ncomma-formatting mechanism isn’t as general as the locale\nmodule, but it’s easier to use.\n\nSee also\n\nPEP 378 - Format Specifier for Thousands SeparatorPEP written by Raymond Hettinger; implemented by Eric Smith.", "code_blocks": [">>> '{:20,.2f}'.format(18446744073709551616.0)\n'18,446,744,073,709,551,616.00'\n", ">>> '{:20,d}'.format(18446744073709551616)\n'18,446,744,073,709,551,616'\n"]}, "pep-389-the-argparse-module-for-parsing-command-lines": {"text": "PEP 389: The argparse Module for Parsing Command Lines\n\nThe argparse module for parsing command-line arguments was\nadded as a more powerful replacement for the\noptparse module.\nThis means Python now supports three different modules for parsing\ncommand-line arguments: getopt, optparse, and\nargparse.  The getopt module closely resembles the C\nlibrary’s getopt() function, so it remains useful if you’re writing a\nPython prototype that will eventually be rewritten in C.\noptparse becomes redundant, but there are no plans to remove it\nbecause there are many scripts still using it, and there’s no\nautomated way to update these scripts.  (Making the argparse\nAPI consistent with optparse’s interface was discussed but\nrejected as too messy and difficult.)\nIn short, if you’re writing a new script and don’t need to worry\nabout compatibility with earlier versions of Python, use\nargparse instead of optparse.\nHere’s an example:\nimport argparse\n\nparser = argparse.ArgumentParser(description='Command-line example.')\n\n# Add optional switches\nparser.add_argument('-v', action='store_true', dest='is_verbose',\n                    help='produce verbose output')\nparser.add_argument('-o', action='store', dest='output',\n                    metavar='FILE',\n                    help='direct output to FILE instead of stdout')\nparser.add_argument('-C', action='store', type=int, dest='context',\n                    metavar='NUM', default=0,\n                    help='display NUM lines of added context')\n\n# Allow any number of additional arguments.\nparser.add_argument(nargs='*', action='store', dest='inputs',\n                    help='input filenames (default is stdin)')\n\nargs = parser.parse_args()\nprint args.__dict__\n\n\nUnless you override it, -h and --help switches\nare automatically added, and produce neatly formatted output:\n-> ./python.exe argparse-example.py --help\nusage: argparse-example.py [-h] [-v] [-o FILE] [-C NUM] [inputs [inputs ...]]\n\nCommand-line example.\n\npositional arguments:\n  inputs      input filenames (default is stdin)\n\noptional arguments:\n  -h, --help  show this help message and exit\n  -v          produce verbose output\n  -o FILE     direct output to FILE instead of stdout\n  -C NUM      display NUM lines of added context\n\n\nAs with optparse, the command-line switches and arguments\nare returned as an object with attributes named by the dest parameters:\n-> ./python.exe argparse-example.py -v\n{'output': None,\n 'is_verbose': True,\n 'context': 0,\n 'inputs': []}\n\n-> ./python.exe argparse-example.py -v -o /tmp/output -C 4 file1 file2\n{'output': '/tmp/output',\n 'is_verbose': True,\n 'context': 4,\n 'inputs': ['file1', 'file2']}\n\n\nargparse has much fancier validation than optparse; you\ncan specify an exact number of arguments as an integer, 0 or more\narguments by passing '*', 1 or more by passing '+', or an\noptional argument with '?'.  A top-level parser can contain\nsub-parsers to define subcommands that have different sets of\nswitches, as in svn commit, svn checkout, etc.  You can\nspecify an argument’s type as FileType, which will\nautomatically open files for you and understands that '-' means\nstandard input or output.\n\nSee also\n\nargparse documentationThe documentation page of the argparse module.\n\nUpgrading optparse codePart of the Python documentation, describing how to convert\ncode that uses optparse.\n\nPEP 389 - argparse - New Command Line Parsing ModulePEP written and implemented by Steven Bethard.", "code_blocks": ["import argparse\n\nparser = argparse.ArgumentParser(description='Command-line example.')\n\n# Add optional switches\nparser.add_argument('-v', action='store_true', dest='is_verbose',\n                    help='produce verbose output')\nparser.add_argument('-o', action='store', dest='output',\n                    metavar='FILE',\n                    help='direct output to FILE instead of stdout')\nparser.add_argument('-C', action='store', type=int, dest='context',\n                    metavar='NUM', default=0,\n                    help='display NUM lines of added context')\n\n# Allow any number of additional arguments.\nparser.add_argument(nargs='*', action='store', dest='inputs',\n                    help='input filenames (default is stdin)')\n\nargs = parser.parse_args()\nprint args.__dict__\n", "-> ./python.exe argparse-example.py --help\nusage: argparse-example.py [-h] [-v] [-o FILE] [-C NUM] [inputs [inputs ...]]\n\nCommand-line example.\n\npositional arguments:\n  inputs      input filenames (default is stdin)\n\noptional arguments:\n  -h, --help  show this help message and exit\n  -v          produce verbose output\n  -o FILE     direct output to FILE instead of stdout\n  -C NUM      display NUM lines of added context\n", "-> ./python.exe argparse-example.py -v\n{'output': None,\n 'is_verbose': True,\n 'context': 0,\n 'inputs': []}\n\n-> ./python.exe argparse-example.py -v -o /tmp/output -C 4 file1 file2\n{'output': '/tmp/output',\n 'is_verbose': True,\n 'context': 4,\n 'inputs': ['file1', 'file2']}\n"]}, "pep-391-dictionary-based-configuration-for-logging": {"text": "PEP 391: Dictionary-Based Configuration For Logging\n\nThe logging module is very flexible; applications can define\na tree of logging subsystems, and each logger in this tree can filter\nout certain messages, format them differently, and direct messages to\na varying number of handlers.\nAll this flexibility can require a lot of configuration.  You can\nwrite Python statements to create objects and set their properties,\nbut a complex set-up requires verbose but boring code.\nlogging also supports a fileConfig()\nfunction that parses a file, but the file format doesn’t support\nconfiguring filters, and it’s messier to generate programmatically.\nPython 2.7 adds a dictConfig() function that\nuses a dictionary to configure logging.  There are many ways to\nproduce a dictionary from different sources: construct one with code;\nparse a file containing JSON; or use a YAML parsing library if one is\ninstalled.  For more information see Configuration functions.\nThe following example configures two loggers, the root logger and a\nlogger named “network”.  Messages sent to the root logger will be\nsent to the system log using the syslog protocol, and messages\nto the “network” logger will be written to a network.log file\nthat will be rotated once the log reaches 1MB.\nimport logging\nimport logging.config\n\nconfigdict = {\n 'version': 1,    # Configuration schema in use; must be 1 for now\n 'formatters': {\n     'standard': {\n         'format': ('%(asctime)s %(name)-15s '\n                    '%(levelname)-8s %(message)s')}},\n\n 'handlers': {'netlog': {'backupCount': 10,\n                     'class': 'logging.handlers.RotatingFileHandler',\n                     'filename': '/logs/network.log',\n                     'formatter': 'standard',\n                     'level': 'INFO',\n                     'maxBytes': 1000000},\n              'syslog': {'class': 'logging.handlers.SysLogHandler',\n                         'formatter': 'standard',\n                         'level': 'ERROR'}},\n\n # Specify all the subordinate loggers\n 'loggers': {\n             'network': {\n                         'handlers': ['netlog']\n             }\n },\n # Specify properties of the root logger\n 'root': {\n          'handlers': ['syslog']\n },\n}\n\n# Set up configuration\nlogging.config.dictConfig(configdict)\n\n# As an example, log two error messages\nlogger = logging.getLogger('/')\nlogger.error('Database not found')\n\nnetlogger = logging.getLogger('network')\nnetlogger.error('Connection failed')\n\n\nThree smaller enhancements to the logging module, all\nimplemented by Vinay Sajip, are:\n\nThe SysLogHandler class now supports\nsyslogging over TCP.  The constructor has a socktype parameter\ngiving the type of socket to use, either socket.SOCK_DGRAM\nfor UDP or socket.SOCK_STREAM for TCP.  The default\nprotocol remains UDP.\nLogger instances gained a getChild()\nmethod that retrieves a descendant logger using a relative path.\nFor example, once you retrieve a logger by doing log = getLogger('app'),\ncalling log.getChild('network.listen') is equivalent to\ngetLogger('app.network.listen').\nThe LoggerAdapter class gained an\nisEnabledFor() method that takes a\nlevel and returns whether the underlying logger would\nprocess a message of that level of importance.\n\n\nSee also\n\nPEP 391 - Dictionary-Based Configuration For LoggingPEP written and implemented by Vinay Sajip.", "code_blocks": ["import logging\nimport logging.config\n\nconfigdict = {\n 'version': 1,    # Configuration schema in use; must be 1 for now\n 'formatters': {\n     'standard': {\n         'format': ('%(asctime)s %(name)-15s '\n                    '%(levelname)-8s %(message)s')}},\n\n 'handlers': {'netlog': {'backupCount': 10,\n                     'class': 'logging.handlers.RotatingFileHandler',\n                     'filename': '/logs/network.log',\n                     'formatter': 'standard',\n                     'level': 'INFO',\n                     'maxBytes': 1000000},\n              'syslog': {'class': 'logging.handlers.SysLogHandler',\n                         'formatter': 'standard',\n                         'level': 'ERROR'}},\n\n # Specify all the subordinate loggers\n 'loggers': {\n             'network': {\n                         'handlers': ['netlog']\n             }\n },\n # Specify properties of the root logger\n 'root': {\n          'handlers': ['syslog']\n },\n}\n\n# Set up configuration\nlogging.config.dictConfig(configdict)\n\n# As an example, log two error messages\nlogger = logging.getLogger('/')\nlogger.error('Database not found')\n\nnetlogger = logging.getLogger('network')\nnetlogger.error('Connection failed')\n"]}, "pep-3106-dictionary-views": {"text": "PEP 3106: Dictionary Views\n\nThe dictionary methods keys(), values(), and\nitems() are different in Python 3.x.  They return an object\ncalled a view instead of a fully materialized list.\nIt’s not possible to change the return values of keys(),\nvalues(), and items() in Python 2.7 because\ntoo much code would break.  Instead the 3.x versions were added\nunder the new names viewkeys(), viewvalues(),\nand viewitems().\n>>> d = dict((i*10, chr(65+i)) for i in range(26))\n>>> d\n{0: 'A', 130: 'N', 10: 'B', 140: 'O', 20: ..., 250: 'Z'}\n>>> d.viewkeys()\ndict_keys([0, 130, 10, 140, 20, 150, 30, ..., 250])\n\n\nViews can be iterated over, but the key and item views also behave\nlike sets.  The & operator performs intersection, and |\nperforms a union:\n>>> d1 = dict((i*10, chr(65+i)) for i in range(26))\n>>> d2 = dict((i**.5, i) for i in range(1000))\n>>> d1.viewkeys() & d2.viewkeys()\nset([0.0, 10.0, 20.0, 30.0])\n>>> d1.viewkeys() | range(0, 30)\nset([0, 1, 130, 3, 4, 5, 6, ..., 120, 250])\n\n\nThe view keeps track of the dictionary and its contents change as the\ndictionary is modified:\n>>> vk = d.viewkeys()\n>>> vk\ndict_keys([0, 130, 10, ..., 250])\n>>> d[260] = '&'\n>>> vk\ndict_keys([0, 130, 260, 10, ..., 250])\n\n\nHowever, note that you can’t add or remove keys while you’re iterating\nover the view:\n>>> for k in vk:\n...     d[k*2] = k\n...\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nRuntimeError: dictionary changed size during iteration\n\n\nYou can use the view methods in Python 2.x code, and the 2to3\nconverter will change them to the standard keys(),\nvalues(), and items() methods.\n\nSee also\n\nPEP 3106 - Revamping dict.keys(), .values() and .items()PEP written by Guido van Rossum.\nBackported to 2.7 by Alexandre Vassalotti; bpo-1967.", "code_blocks": [">>> d = dict((i*10, chr(65+i)) for i in range(26))\n>>> d\n{0: 'A', 130: 'N', 10: 'B', 140: 'O', 20: ..., 250: 'Z'}\n>>> d.viewkeys()\ndict_keys([0, 130, 10, 140, 20, 150, 30, ..., 250])\n", ">>> d1 = dict((i*10, chr(65+i)) for i in range(26))\n>>> d2 = dict((i**.5, i) for i in range(1000))\n>>> d1.viewkeys() & d2.viewkeys()\nset([0.0, 10.0, 20.0, 30.0])\n>>> d1.viewkeys() | range(0, 30)\nset([0, 1, 130, 3, 4, 5, 6, ..., 120, 250])\n", ">>> vk = d.viewkeys()\n>>> vk\ndict_keys([0, 130, 10, ..., 250])\n>>> d[260] = '&'\n>>> vk\ndict_keys([0, 130, 260, 10, ..., 250])\n", ">>> for k in vk:\n...     d[k*2] = k\n...\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nRuntimeError: dictionary changed size during iteration\n"]}, "pep-3137-the-memoryview-object": {"text": "PEP 3137: The memoryview Object\n\nThe memoryview object provides a view of another object’s\nmemory content that matches the bytes type’s interface.\n>>> import string\n>>> m = memoryview(string.letters)\n>>> m\n<memory at 0x37f850>\n>>> len(m)           # Returns length of underlying object\n52\n>>> m[0], m[25], m[26]   # Indexing returns one byte\n('a', 'z', 'A')\n>>> m2 = m[0:26]         # Slicing returns another memoryview\n>>> m2\n<memory at 0x37f080>\n\n\nThe content of the view can be converted to a string of bytes or\na list of integers:\n>>> m2.tobytes()\n'abcdefghijklmnopqrstuvwxyz'\n>>> m2.tolist()\n[97, 98, 99, 100, 101, 102, 103, ... 121, 122]\n>>>\n\n\nmemoryview objects allow modifying the underlying object if\nit’s a mutable object.\n>>> m2[0] = 75\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: cannot modify read-only memory\n>>> b = bytearray(string.letters)  # Creating a mutable object\n>>> b\nbytearray(b'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ')\n>>> mb = memoryview(b)\n>>> mb[0] = '*'         # Assign to view, changing the bytearray.\n>>> b[0:5]              # The bytearray has been changed.\nbytearray(b'*bcde')\n>>>\n\n\n\nSee also\n\nPEP 3137 - Immutable Bytes and Mutable BufferPEP written by Guido van Rossum.\nImplemented by Travis Oliphant, Antoine Pitrou and others.\nBackported to 2.7 by Antoine Pitrou; bpo-2396.", "code_blocks": [">>> import string\n>>> m = memoryview(string.letters)\n>>> m\n<memory at 0x37f850>\n>>> len(m)           # Returns length of underlying object\n52\n>>> m[0], m[25], m[26]   # Indexing returns one byte\n('a', 'z', 'A')\n>>> m2 = m[0:26]         # Slicing returns another memoryview\n>>> m2\n<memory at 0x37f080>\n", ">>> m2.tobytes()\n'abcdefghijklmnopqrstuvwxyz'\n>>> m2.tolist()\n[97, 98, 99, 100, 101, 102, 103, ... 121, 122]\n>>>\n", ">>> m2[0] = 75\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: cannot modify read-only memory\n>>> b = bytearray(string.letters)  # Creating a mutable object\n>>> b\nbytearray(b'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ')\n>>> mb = memoryview(b)\n>>> mb[0] = '*'         # Assign to view, changing the bytearray.\n>>> b[0:5]              # The bytearray has been changed.\nbytearray(b'*bcde')\n>>>\n"]}, "other-language-changes - interpreter-changes": {"text": "Interpreter Changes\n\nA new environment variable, PYTHONWARNINGS,\nallows controlling warnings.  It should be set to a string\ncontaining warning settings, equivalent to those\nused with the -W switch, separated by commas.\n(Contributed by Brian Curtin; bpo-7301.)\nFor example, the following setting will print warnings every time\nthey occur, but turn warnings from the Cookie module into an\nerror.  (The exact syntax for setting an environment variable varies\nacross operating systems and shells.)\nexport PYTHONWARNINGS=all,error:::Cookie:0", "code_blocks": ["export PYTHONWARNINGS=all,error:::Cookie:0\n"]}, "other-language-changes - optimizations": {"text": "Optimizations\n\nSeveral performance enhancements have been added:\n\nA new opcode was added to perform the initial setup for\nwith statements, looking up the __enter__() and\n__exit__() methods.  (Contributed by Benjamin Peterson.)\nThe garbage collector now performs better for one common usage\npattern: when many objects are being allocated without deallocating\nany of them.  This would previously take quadratic\ntime for garbage collection, but now the number of full garbage collections\nis reduced as the number of objects on the heap grows.\nThe new logic only performs a full garbage collection pass when\nthe middle generation has been collected 10 times and when the\nnumber of survivor objects from the middle generation exceeds 10% of\nthe number of objects in the oldest generation.  (Suggested by Martin\nvon Löwis and implemented by Antoine Pitrou; bpo-4074.)\nThe garbage collector tries to avoid tracking simple containers\nwhich can’t be part of a cycle. In Python 2.7, this is now true for\ntuples and dicts containing atomic types (such as ints, strings,\netc.). Transitively, a dict containing tuples of atomic types won’t\nbe tracked either. This helps reduce the cost of each\ngarbage collection by decreasing the number of objects to be\nconsidered and traversed by the collector.\n(Contributed by Antoine Pitrou; bpo-4688.)\nLong integers are now stored internally either in base 2**15 or in base\n2**30, the base being determined at build time.  Previously, they\nwere always stored in base 2**15.  Using base 2**30 gives\nsignificant performance improvements on 64-bit machines, but\nbenchmark results on 32-bit machines have been mixed.  Therefore,\nthe default is to use base 2**30 on 64-bit machines and base 2**15\non 32-bit machines; on Unix, there’s a new configure option\n--enable-big-digits that can be used to override this default.\nApart from the performance improvements this change should be\ninvisible to end users, with one exception: for testing and\ndebugging purposes there’s a new structseq sys.long_info that\nprovides information about the internal format, giving the number of\nbits per digit and the size in bytes of the C type used to store\neach digit:\n>>> import sys\n>>> sys.long_info\nsys.long_info(bits_per_digit=30, sizeof_digit=4)\n\n\n(Contributed by Mark Dickinson; bpo-4258.)\nAnother set of changes made long objects a few bytes smaller: 2 bytes\nsmaller on 32-bit systems and 6 bytes on 64-bit.\n(Contributed by Mark Dickinson; bpo-5260.)\n\nThe division algorithm for long integers has been made faster\nby tightening the inner loop, doing shifts instead of multiplications,\nand fixing an unnecessary extra iteration.\nVarious benchmarks show speedups of between 50% and 150% for long\ninteger divisions and modulo operations.\n(Contributed by Mark Dickinson; bpo-5512.)\nBitwise operations are also significantly faster (initial patch by\nGregory Smith; bpo-1087418).\nThe implementation of % checks for the left-side operand being\na Python string and special-cases it; this results in a 1–3%\nperformance increase for applications that frequently use %\nwith strings, such as templating libraries.\n(Implemented by Collin Winter; bpo-5176.)\nList comprehensions with an if condition are compiled into\nfaster bytecode.  (Patch by Antoine Pitrou, back-ported to 2.7\nby Jeffrey Yasskin; bpo-4715.)\nConverting an integer or long integer to a decimal string was made\nfaster by special-casing base 10 instead of using a generalized\nconversion function that supports arbitrary bases.\n(Patch by Gawain Bolton; bpo-6713.)\nThe split(), replace(), rindex(),\nrpartition(), and rsplit() methods of string-like types\n(strings, Unicode strings, and bytearray objects) now use a\nfast reverse-search algorithm instead of a character-by-character\nscan.  This is sometimes faster by a factor of 10.  (Added by\nFlorent Xicluna; bpo-7462 and bpo-7622.)\nThe pickle and cPickle modules now automatically\nintern the strings used for attribute names, reducing memory usage\nof the objects resulting from unpickling.  (Contributed by Jake\nMcGuire; bpo-5084.)\nThe cPickle module now special-cases dictionaries,\nnearly halving the time required to pickle them.\n(Contributed by Collin Winter; bpo-5670.)", "code_blocks": [">>> import sys\n>>> sys.long_info\nsys.long_info(bits_per_digit=30, sizeof_digit=4)\n"]}, "new-and-improved-modules - new-module-importlib": {"text": "New module: importlib\n\nPython 3.1 includes the importlib package, a re-implementation\nof the logic underlying Python’s import statement.\nimportlib is useful for implementors of Python interpreters and\nto users who wish to write new importers that can participate in the\nimport process.  Python 2.7 doesn’t contain the complete\nimportlib package, but instead has a tiny subset that contains\na single function, import_module().\nimport_module(name, package=None) imports a module.  name is\na string containing the module or package’s name.  It’s possible to do\nrelative imports by providing a string that begins with a .\ncharacter, such as ..utils.errors.  For relative imports, the\npackage argument must be provided and is the name of the package that\nwill be used as the anchor for\nthe relative import.  import_module() both inserts the imported\nmodule into sys.modules and returns the module object.\nHere are some examples:\n>>> from importlib import import_module\n>>> anydbm = import_module('anydbm')  # Standard absolute import\n>>> anydbm\n<module 'anydbm' from '/p/python/Lib/anydbm.py'>\n>>> # Relative import\n>>> file_util = import_module('..file_util', 'distutils.command')\n>>> file_util\n<module 'distutils.file_util' from '/python/Lib/distutils/file_util.pyc'>\n\n\nimportlib was implemented by Brett Cannon and introduced in\nPython 3.1.", "code_blocks": [">>> from importlib import import_module\n>>> anydbm = import_module('anydbm')  # Standard absolute import\n>>> anydbm\n<module 'anydbm' from '/p/python/Lib/anydbm.py'>\n>>> # Relative import\n>>> file_util = import_module('..file_util', 'distutils.command')\n>>> file_util\n<module 'distutils.file_util' from '/python/Lib/distutils/file_util.pyc'>\n"]}, "new-and-improved-modules - new-module-sysconfig": {"text": "New module: sysconfig\n\nThe sysconfig module has been pulled out of the Distutils\npackage, becoming a new top-level module in its own right.\nsysconfig provides functions for getting information about\nPython’s build process: compiler switches, installation paths, the\nplatform name, and whether Python is running from its source\ndirectory.\nSome of the functions in the module are:\n\nget_config_var() returns variables from Python’s\nMakefile and the pyconfig.h file.\nget_config_vars() returns a dictionary containing\nall of the configuration variables.\nget_path() returns the configured path for\na particular type of module: the standard library,\nsite-specific modules, platform-specific modules, etc.\nis_python_build() returns true if you’re running a\nbinary from a Python source tree, and false otherwise.\n\nConsult the sysconfig documentation for more details and for\na complete list of functions.\nThe Distutils package and sysconfig are now maintained by Tarek\nZiadé, who has also started a Distutils2 package (source repository at\nhttps://hg.python.org/distutils2/) for developing a next-generation\nversion of Distutils.", "code_blocks": []}, "new-and-improved-modules - ttk-themed-widgets-for-tk": {"text": "ttk: Themed Widgets for Tk\n\nTcl/Tk 8.5 includes a set of themed widgets that re-implement basic Tk\nwidgets but have a more customizable appearance and can therefore more\nclosely resemble the native platform’s widgets.  This widget\nset was originally called Tile, but was renamed to Ttk (for “themed Tk”)\non being added to Tcl/Tck release 8.5.\nTo learn more, read the ttk module documentation.  You may also\nwish to read the Tcl/Tk manual page describing the\nTtk theme engine, available at\nhttps://www.tcl.tk/man/tcl8.5/TkCmd/ttk_intro.htm. Some\nscreenshots of the Python/Ttk code in use are at\nhttps://code.google.com/archive/p/python-ttk/wikis/Screenshots.wiki.\nThe ttk module was written by Guilherme Polo and added in\nbpo-2983.  An alternate version called Tile.py, written by\nMartin Franklin and maintained by Kevin Walzer, was proposed for\ninclusion in bpo-2618, but the authors argued that Guilherme\nPolo’s work was more comprehensive.", "code_blocks": []}, "new-and-improved-modules - updated-module-unittest": {"text": "Updated module: unittest\n\nThe unittest module was greatly enhanced; many\nnew features were added.  Most of these features were implemented\nby Michael Foord, unless otherwise noted.  The enhanced version of\nthe module is downloadable separately for use with Python versions 2.4 to 2.6,\npackaged as the unittest2 package, from\nhttps://pypi.org/project/unittest2.\nWhen used from the command line, the module can automatically discover\ntests.  It’s not as fancy as py.test or\nnose, but provides a\nsimple way to run tests kept within a set of package directories.  For example,\nthe following command will search the test/ subdirectory for\nany importable test files named test*.py:\npython -m unittest discover -s test\n\n\nConsult the unittest module documentation for more details.\n(Developed in bpo-6001.)\nThe main() function supports some other new options:\n\n-b or --buffer will buffer the standard output\nand standard error streams during each test.  If the test passes,\nany resulting output will be discarded; on failure, the buffered\noutput will be displayed.\n-c or --catch will cause the control-C interrupt\nto be handled more gracefully.  Instead of interrupting the test\nprocess immediately, the currently running test will be completed\nand then the partial results up to the interruption will be reported.\nIf you’re impatient, a second press of control-C will cause an immediate\ninterruption.\nThis control-C handler tries to avoid causing problems when the code\nbeing tested or the tests being run have defined a signal handler of\ntheir own, by noticing that a signal handler was already set and\ncalling it.  If this doesn’t work for you, there’s a\nremoveHandler() decorator that can be used to mark tests that\nshould have the control-C handling disabled.\n\n-f or --failfast makes\ntest execution stop immediately when a test fails instead of\ncontinuing to execute further tests.  (Suggested by Cliff Dyer and\nimplemented by Michael Foord; bpo-8074.)\n\nThe progress messages now show ‘x’ for expected failures\nand ‘u’ for unexpected successes when run in verbose mode.\n(Contributed by Benjamin Peterson.)\nTest cases can raise the SkipTest exception to skip a\ntest (bpo-1034053).\nThe error messages for assertEqual(),\nassertTrue(), and assertFalse()\nfailures now provide more information.  If you set the\nlongMessage attribute of your TestCase classes to\ntrue, both the standard error message and any additional message you\nprovide will be printed for failures.  (Added by Michael Foord; bpo-5663.)\nThe assertRaises() method now\nreturns a context handler when called without providing a callable\nobject to run.  For example, you can write this:\nwith self.assertRaises(KeyError):\n    {}['foo']\n\n\n(Implemented by Antoine Pitrou; bpo-4444.)\nModule- and class-level setup and teardown fixtures are now supported.\nModules can contain setUpModule() and tearDownModule()\nfunctions.  Classes can have setUpClass() and\ntearDownClass() methods that must be defined as class methods\n(using @classmethod or equivalent).  These functions and\nmethods are invoked when the test runner switches to a test case in a\ndifferent module or class.\nThe methods addCleanup() and\ndoCleanups() were added.\naddCleanup() lets you add cleanup functions that\nwill be called unconditionally (after setUp() if\nsetUp() fails, otherwise after tearDown()). This allows\nfor much simpler resource allocation and deallocation during tests\n(bpo-5679).\nA number of new methods were added that provide more specialized\ntests.  Many of these methods were written by Google engineers\nfor use in their test suites; Gregory P. Smith, Michael Foord, and\nGvR worked on merging them into Python’s version of unittest.\n\nassertIsNone() and assertIsNotNone() take one\nexpression and verify that the result is or is not None.\nassertIs() and assertIsNot()\ntake two values and check whether the two values evaluate to the same object or not.\n(Added by Michael Foord; bpo-2578.)\nassertIsInstance() and\nassertNotIsInstance() check whether\nthe resulting object is an instance of a particular class, or of\none of a tuple of classes.  (Added by Georg Brandl; bpo-7031.)\nassertGreater(), assertGreaterEqual(),\nassertLess(), and assertLessEqual() compare\ntwo quantities.\nassertMultiLineEqual() compares two strings, and if they’re\nnot equal, displays a helpful comparison that highlights the\ndifferences in the two strings.  This comparison is now used by\ndefault when Unicode strings are compared with assertEqual().\nassertRegexpMatches() and\nassertNotRegexpMatches() checks whether the\nfirst argument is a string matching or not matching the regular\nexpression provided as the second argument (bpo-8038).\nassertRaisesRegexp() checks whether a particular exception\nis raised, and then also checks that the string representation of\nthe exception matches the provided regular expression.\nassertIn() and assertNotIn()\ntests whether first is or is not in  second.\nassertItemsEqual() tests whether two provided sequences\ncontain the same elements.\nassertSetEqual() compares whether two sets are equal, and\nonly reports the differences between the sets in case of error.\nSimilarly, assertListEqual() and assertTupleEqual()\ncompare the specified types and explain any differences without necessarily\nprinting their full values; these methods are now used by default\nwhen comparing lists and tuples using assertEqual().\nMore generally, assertSequenceEqual() compares two sequences\nand can optionally check whether both sequences are of a\nparticular type.\nassertDictEqual() compares two dictionaries and reports the\ndifferences; it’s now used by default when you compare two dictionaries\nusing assertEqual().  assertDictContainsSubset() checks whether\nall of the key/value pairs in first are found in second.\nassertAlmostEqual() and assertNotAlmostEqual() test\nwhether first and second are approximately equal.  This method\ncan either round their difference to an optionally-specified number\nof places (the default is 7) and compare it to zero, or require\nthe difference to be smaller than a supplied delta value.\nloadTestsFromName() properly honors the\nsuiteClass attribute of\nthe TestLoader. (Fixed by Mark Roddy; bpo-6866.)\nA new hook lets you extend the assertEqual() method to handle\nnew data types.  The addTypeEqualityFunc() method takes a type\nobject and a function. The function will be used when both of the\nobjects being compared are of the specified type.  This function\nshould compare the two objects and raise an exception if they don’t\nmatch; it’s a good idea for the function to provide additional\ninformation about why the two objects aren’t matching, much as the new\nsequence comparison methods do.\n\nunittest.main() now takes an optional exit argument.  If\nfalse, main() doesn’t call sys.exit(), allowing\nmain() to be used from the interactive interpreter.\n(Contributed by J. Pablo Fernández; bpo-3379.)\nTestResult has new startTestRun() and\nstopTestRun() methods that are called immediately before\nand after a test run.  (Contributed by Robert Collins; bpo-5728.)\nWith all these changes, the unittest.py was becoming awkwardly\nlarge, so the module was turned into a package and the code split into\nseveral files (by Benjamin Peterson).  This doesn’t affect how the\nmodule is imported or used.\n\nSee also\n\nhttp://www.voidspace.org.uk/python/articles/unittest2.shtmlDescribes the new features, how to use them, and the\nrationale for various design decisions.  (By Michael Foord.)", "code_blocks": ["python -m unittest discover -s test\n", "with self.assertRaises(KeyError):\n    {}['foo']\n"]}, "new-and-improved-modules - updated-module-elementtree-1-3": {"text": "Updated module: ElementTree 1.3\n\nThe version of the ElementTree library included with Python was updated to\nversion 1.3.  Some of the new features are:\n\nThe various parsing functions now take a parser keyword argument\ngiving an XMLParser instance that will\nbe used.  This makes it possible to override the file’s internal encoding:\np = ET.XMLParser(encoding='utf-8')\nt = ET.XML(\"\"\"<root/>\"\"\", parser=p)\n\n\nErrors in parsing XML now raise a ParseError exception, whose\ninstances have a position attribute\ncontaining a (line, column) tuple giving the location of the problem.\n\nElementTree’s code for converting trees to a string has been\nsignificantly reworked, making it roughly twice as fast in many\ncases.  The ElementTree.write()\nand Element.write() methods now have a method parameter that can be\n“xml” (the default), “html”, or “text”.  HTML mode will output empty\nelements as <empty></empty> instead of <empty/>, and text\nmode will skip over elements and only output the text chunks.  If\nyou set the tag attribute of an element to None but\nleave its children in place, the element will be omitted when the\ntree is written out, so you don’t need to do more extensive rearrangement\nto remove a single element.\nNamespace handling has also been improved.  All xmlns:<whatever>\ndeclarations are now output on the root element, not scattered throughout\nthe resulting XML.  You can set the default namespace for a tree\nby setting the default_namespace attribute and can\nregister new prefixes with register_namespace().  In XML mode,\nyou can use the true/false xml_declaration parameter to suppress the\nXML declaration.\n\nNew Element method:\nextend() appends the items from a\nsequence to the element’s children.  Elements themselves behave like\nsequences, so it’s easy to move children from one element to\nanother:\nfrom xml.etree import ElementTree as ET\n\nt = ET.XML(\"\"\"<list>\n  <item>1</item> <item>2</item>  <item>3</item>\n</list>\"\"\")\nnew = ET.XML('<root/>')\nnew.extend(t)\n\n# Outputs <root><item>1</item>...</root>\nprint ET.tostring(new)\n\n\n\nNew Element method:\niter() yields the children of the\nelement as a generator.  It’s also possible to write for child in\nelem: to loop over an element’s children.  The existing method\ngetiterator() is now deprecated, as is getchildren()\nwhich constructs and returns a list of children.\nNew Element method:\nitertext() yields all chunks of\ntext that are descendants of the element.  For example:\nt = ET.XML(\"\"\"<list>\n  <item>1</item> <item>2</item>  <item>3</item>\n</list>\"\"\")\n\n# Outputs ['\\n  ', '1', ' ', '2', '  ', '3', '\\n']\nprint list(t.itertext())\n\n\n\nDeprecated: using an element as a Boolean (i.e., if elem:) would\nreturn true if the element had any children, or false if there were\nno children.  This behaviour is confusing – None is false, but\nso is a childless element? – so it will now trigger a\nFutureWarning.  In your code, you should be explicit: write\nlen(elem) != 0 if you’re interested in the number of children,\nor elem is not None.\n\nFredrik Lundh develops ElementTree and produced the 1.3 version;\nyou can read his article describing 1.3 at\nhttp://effbot.org/zone/elementtree-13-intro.htm.\nFlorent Xicluna updated the version included with\nPython, after discussions on python-dev and in bpo-6472.)", "code_blocks": ["p = ET.XMLParser(encoding='utf-8')\nt = ET.XML(\"\"\"<root/>\"\"\", parser=p)\n", "from xml.etree import ElementTree as ET\n\nt = ET.XML(\"\"\"<list>\n  <item>1</item> <item>2</item>  <item>3</item>\n</list>\"\"\")\nnew = ET.XML('<root/>')\nnew.extend(t)\n\n# Outputs <root><item>1</item>...</root>\nprint ET.tostring(new)\n", "t = ET.XML(\"\"\"<list>\n  <item>1</item> <item>2</item>  <item>3</item>\n</list>\"\"\")\n\n# Outputs ['\\n  ', '1', ' ', '2', '  ', '3', '\\n']\nprint list(t.itertext())\n"]}, "build-and-c-api-changes - capsules": {"text": "Capsules\n\nPython 3.1 adds a new C datatype, PyCapsule, for providing a\nC API to an extension module.  A capsule is essentially the holder of\na C void * pointer, and is made available as a module attribute; for\nexample, the socket module’s API is exposed as socket.CAPI,\nand unicodedata exposes ucnhash_CAPI.  Other extensions\ncan import the module, access its dictionary to get the capsule\nobject, and then get the void * pointer, which will usually point\nto an array of pointers to the module’s various API functions.\nThere is an existing data type already used for this,\nPyCObject, but it doesn’t provide type safety.  Evil code\nwritten in pure Python could cause a segmentation fault by taking a\nPyCObject from module A and somehow substituting it for the\nPyCObject in module B.   Capsules know their own name,\nand getting the pointer requires providing the name:\nvoid *vtable;\n\nif (!PyCapsule_IsValid(capsule, \"mymodule.CAPI\") {\n        PyErr_SetString(PyExc_ValueError, \"argument type invalid\");\n        return NULL;\n}\n\nvtable = PyCapsule_GetPointer(capsule, \"mymodule.CAPI\");\n\n\nYou are assured that vtable points to whatever you’re expecting.\nIf a different capsule was passed in, PyCapsule_IsValid() would\ndetect the mismatched name and return false.  Refer to\nProviding a C API for an Extension Module for more information on using these objects.\nPython 2.7 now uses capsules internally to provide various\nextension-module APIs, but the PyCObject_AsVoidPtr() was\nmodified to handle capsules, preserving compile-time compatibility\nwith the CObject interface.  Use of\nPyCObject_AsVoidPtr() will signal a\nPendingDeprecationWarning, which is silent by default.\nImplemented in Python 3.1 and backported to 2.7 by Larry Hastings;\ndiscussed in bpo-5630.", "code_blocks": ["void *vtable;\n\nif (!PyCapsule_IsValid(capsule, \"mymodule.CAPI\") {\n        PyErr_SetString(PyExc_ValueError, \"argument type invalid\");\n        return NULL;\n}\n\nvtable = PyCapsule_GetPointer(capsule, \"mymodule.CAPI\");\n"]}, "build-and-c-api-changes - port-specific-changes-windows": {"text": "Port-Specific Changes: Windows\n\n\nThe msvcrt module now contains some constants from\nthe crtassem.h header file:\nCRT_ASSEMBLY_VERSION,\nVC_ASSEMBLY_PUBLICKEYTOKEN,\nand LIBRARIES_ASSEMBLY_NAME_PREFIX.\n(Contributed by David Cournapeau; bpo-4365.)\nThe _winreg module for accessing the registry now implements\nthe CreateKeyEx() and DeleteKeyEx()\nfunctions, extended versions of previously-supported functions that\ntake several extra arguments.  The DisableReflectionKey(),\nEnableReflectionKey(), and QueryReflectionKey()\nwere also tested and documented.\n(Implemented by Brian Curtin: bpo-7347.)\nThe new _beginthreadex() API is used to start threads, and\nthe native thread-local storage functions are now used.\n(Contributed by Kristján Valur Jónsson; bpo-3582.)\nThe os.kill() function now works on Windows.  The signal value\ncan be the constants CTRL_C_EVENT,\nCTRL_BREAK_EVENT, or any integer.  The first two constants\nwill send Control-C and Control-Break keystroke events to\nsubprocesses; any other value will use the TerminateProcess()\nAPI.  (Contributed by Miki Tebeka; bpo-1220212.)\nThe os.listdir() function now correctly fails\nfor an empty path.  (Fixed by Hirokazu Yamamoto; bpo-5913.)\nThe mimelib module will now read the MIME database from\nthe Windows registry when initializing.\n(Patch by Gabriel Genellina; bpo-4969.)", "code_blocks": []}, "build-and-c-api-changes - port-specific-changes-mac-os-x": {"text": "Port-Specific Changes: Mac OS X\n\n\nThe path /Library/Python/2.7/site-packages is now appended to\nsys.path, in order to share added packages between the system\ninstallation and a user-installed copy of the same version.\n(Changed by Ronald Oussoren; bpo-4865.)\n\n\nChanged in version 2.7.13: As of 2.7.13, this change was removed.\n/Library/Python/2.7/site-packages, the site-packages directory\nused by the Apple-supplied system Python 2.7 is no longer appended to\nsys.path for user-installed Pythons such as from the python.org\ninstallers.  As of macOS 10.12, Apple changed how the system\nsite-packages directory is configured, which could cause installation\nof pip components, like setuptools, to fail.  Packages installed for\nthe system Python will no longer be shared with user-installed\nPythons. (bpo-28440)", "code_blocks": []}, "build-and-c-api-changes - port-specific-changes-freebsd": {"text": "Port-Specific Changes: FreeBSD\n\n\nFreeBSD 7.1’s SO_SETFIB constant, used with\ngetsockopt()/setsockopt() to select an\nalternate routing table, is now available in the socket\nmodule.  (Added by Kyle VanderBeek; bpo-8235.)", "code_blocks": []}, "other-changes-and-fixes": {"text": "Other Changes and Fixes\n\n\nTwo benchmark scripts, iobench and ccbench, were\nadded to the Tools directory.  iobench measures the\nspeed of the built-in file I/O objects returned by open()\nwhile performing various operations, and ccbench is a\nconcurrency benchmark that tries to measure computing throughput,\nthread switching latency, and IO processing bandwidth when\nperforming several tasks using a varying number of threads.\nThe Tools/i18n/msgfmt.py script now understands plural\nforms in .po files.  (Fixed by Martin von Löwis;\nbpo-5464.)\nWhen importing a module from a .pyc or .pyo file\nwith an existing .py counterpart, the co_filename\nattributes of the resulting code objects are overwritten when the\noriginal filename is obsolete.  This can happen if the file has been\nrenamed, moved, or is accessed through different paths.  (Patch by\nZiga Seilnacht and Jean-Paul Calderone; bpo-1180193.)\nThe regrtest.py script now takes a --randseed=\nswitch that takes an integer that will be used as the random seed\nfor the -r option that executes tests in random order.\nThe -r option also reports the seed that was used\n(Added by Collin Winter.)\nAnother regrtest.py switch is -j, which\ntakes an integer specifying how many tests run in parallel. This\nallows reducing the total runtime on multi-core machines.\nThis option is compatible with several other options, including the\n-R switch which is known to produce long runtimes.\n(Added by Antoine Pitrou, bpo-6152.)  This can also be used\nwith a new -F switch that runs selected tests in a loop\nuntil they fail.  (Added by Antoine Pitrou; bpo-7312.)\nWhen executed as a script, the py_compile.py module now\naccepts '-' as an argument, which will read standard input for\nthe list of filenames to be compiled.  (Contributed by Piotr\nOżarowski; bpo-8233.)", "code_blocks": []}, "porting-to-python-2-7": {"text": "Porting to Python 2.7\n\nThis section lists previously described changes and other bugfixes\nthat may require changes to your code:\n\nThe range() function processes its arguments more\nconsistently; it will now call __int__() on non-float,\nnon-integer arguments that are supplied to it.  (Fixed by Alexander\nBelopolsky; bpo-1533.)\nThe string format() method changed the default precision used\nfor floating-point and complex numbers from 6 decimal\nplaces to 12, which matches the precision used by str().\n(Changed by Eric Smith; bpo-5920.)\nBecause of an optimization for the with statement, the special\nmethods __enter__() and __exit__() must belong to the object’s\ntype, and cannot be directly attached to the object’s instance.  This\naffects new-style classes (derived from object) and C extension\ntypes.  (bpo-6101.)\nDue to a bug in Python 2.6, the exc_value parameter to\n__exit__() methods was often the string representation of the\nexception, not an instance.  This was fixed in 2.7, so exc_value\nwill be an instance as expected.  (Fixed by Florent Xicluna;\nbpo-7853.)\nWhen a restricted set of attributes were set using __slots__,\ndeleting an unset attribute would not raise AttributeError\nas you would expect.  Fixed by Benjamin Peterson; bpo-7604.)\n\nIn the standard library:\n\nOperations with datetime instances that resulted in a year\nfalling outside the supported range didn’t always raise\nOverflowError.  Such errors are now checked more carefully\nand will now raise the exception. (Reported by Mark Leander, patch\nby Anand B. Pillai and Alexander Belopolsky; bpo-7150.)\nWhen using Decimal instances with a string’s\nformat() method, the default alignment was previously\nleft-alignment.  This has been changed to right-alignment, which might\nchange the output of your programs.\n(Changed by Mark Dickinson; bpo-6857.)\nComparisons involving a signaling NaN value (or sNAN) now signal\nInvalidOperation instead of silently returning a true or\nfalse value depending on the comparison operator.  Quiet NaN values\n(or NaN) are now hashable.  (Fixed by Mark Dickinson;\nbpo-7279.)\n\nThe ElementTree library, xml.etree, no longer escapes\nampersands and angle brackets when outputting an XML processing\ninstruction (which looks like <?xml-stylesheet href=”#style1”?>)\nor comment (which looks like <!– comment –>).\n(Patch by Neil Muller; bpo-2746.)\nThe readline() method of StringIO objects now does\nnothing when a negative length is requested, as other file-like\nobjects do.  (bpo-7348).\nThe syslog module will now use the value of sys.argv[0] as the\nidentifier instead of the previous default value of 'python'.\n(Changed by Sean Reifschneider; bpo-8451.)\nThe tarfile module’s default error handling has changed, to\nno longer suppress fatal errors.  The default error level was previously 0,\nwhich meant that errors would only result in a message being written to the\ndebug log, but because the debug log is not activated by default,\nthese errors go unnoticed.  The default error level is now 1,\nwhich raises an exception if there’s an error.\n(Changed by Lars Gustäbel; bpo-7357.)\nThe urlparse module’s urlsplit() now handles\nunknown URL schemes in a fashion compliant with RFC 3986: if the\nURL is of the form \"<something>://...\", the text before the\n:// is treated as the scheme, even if it’s a made-up scheme that\nthe module doesn’t know about.  This change may break code that\nworked around the old behaviour.  For example, Python 2.6.4 or 2.5\nwill return the following:\n>>> import urlparse\n>>> urlparse.urlsplit('invented://host/filename?query')\n('invented', '', '//host/filename?query', '', '')\n\n\nPython 2.7 (and Python 2.6.5) will return:\n>>> import urlparse\n>>> urlparse.urlsplit('invented://host/filename?query')\n('invented', 'host', '/filename?query', '', '')\n\n\n(Python 2.7 actually produces slightly different output, since it\nreturns a named tuple instead of a standard tuple.)\n\n\nFor C extensions:\n\nC extensions that use integer format codes with the PyArg_Parse*\nfamily of functions will now raise a TypeError exception\ninstead of triggering a DeprecationWarning (bpo-5080).\nUse the new PyOS_string_to_double() function instead of the old\nPyOS_ascii_strtod() and PyOS_ascii_atof() functions,\nwhich are now deprecated.\n\nFor applications that embed Python:\n\nThe PySys_SetArgvEx() function was added, letting\napplications close a security hole when the existing\nPySys_SetArgv() function was used.  Check whether you’re\ncalling PySys_SetArgv() and carefully consider whether the\napplication should be using PySys_SetArgvEx() with\nupdatepath set to false.", "code_blocks": [">>> import urlparse\n>>> urlparse.urlsplit('invented://host/filename?query')\n('invented', '', '//host/filename?query', '', '')\n", ">>> import urlparse\n>>> urlparse.urlsplit('invented://host/filename?query')\n('invented', 'host', '/filename?query', '', '')\n"]}, "new-features-added-to-python-2-7-maintenance-releases - two-new-environment-variables-for-debug-mode": {"text": "Two new environment variables for debug mode\n\nIn debug mode, the [xxx refs] statistic is not written by default, the\nPYTHONSHOWREFCOUNT environment variable now must also be set.\n(Contributed by Victor Stinner; bpo-31733.)\nWhen Python is compiled with COUNT_ALLOC defined, allocation counts are no\nlonger dumped by default anymore: the PYTHONSHOWALLOCCOUNT environment\nvariable must now also be set. Moreover, allocation counts are now dumped into\nstderr, rather than stdout. (Contributed by Victor Stinner; bpo-31692.)\n\nNew in version 2.7.15.", "code_blocks": []}, "new-features-added-to-python-2-7-maintenance-releases - pep-434-idle-enhancement-exception-for-all-branches": {"text": "PEP 434: IDLE Enhancement Exception for All Branches\n\nPEP 434 describes a general exemption for changes made to the IDLE\ndevelopment environment shipped along with Python. This exemption makes it\npossible for the IDLE developers to provide a more consistent user\nexperience across all supported versions of Python 2 and 3.\nFor details of any IDLE changes, refer to the NEWS file for the specific\nrelease.", "code_blocks": []}, "new-features-added-to-python-2-7-maintenance-releases - pep-466-network-security-enhancements-for-python-2-7": {"text": "PEP 466: Network Security Enhancements for Python 2.7\n\nPEP 466 describes a number of network security enhancement proposals\nthat have been approved for inclusion in Python 2.7 maintenance releases,\nwith the first of those changes appearing in the Python 2.7.7 release.\nPEP 466 related features added in Python 2.7.7:\n\nhmac.compare_digest() was backported from Python 3 to make a timing\nattack resistant comparison operation available to Python 2 applications.\n(Contributed by Alex Gaynor; bpo-21306.)\nOpenSSL 1.0.1g was upgraded in the official Windows installers published on\npython.org. (Contributed by Zachary Ware; bpo-21462.)\n\nPEP 466 related features added in Python 2.7.8:\n\nhashlib.pbkdf2_hmac() was backported from Python 3 to make a hashing\nalgorithm suitable for secure password storage broadly available to Python\n2 applications. (Contributed by Alex Gaynor; bpo-21304.)\nOpenSSL 1.0.1h was upgraded for the official Windows installers published on\npython.org. (contributed by Zachary Ware in bpo-21671 for CVE-2014-0224)\n\nPEP 466 related features added in Python 2.7.9:\n\nMost of Python 3.4’s ssl module was backported. This means ssl\nnow supports Server Name Indication, TLS1.x settings, access to the platform\ncertificate store, the SSLContext class, and other\nfeatures. (Contributed by Alex Gaynor and David Reid; bpo-21308.)\nRefer to the “Version added: 2.7.9” notes in the module documentation for\nspecific details.\n\nos.urandom() was changed to cache a file descriptor to /dev/urandom\ninstead of reopening /dev/urandom on every call. (Contributed by Alex\nGaynor; bpo-21305.)\nhashlib.algorithms_guaranteed and\nhashlib.algorithms_available were backported from Python 3 to make\nit easier for Python 2 applications to select the strongest available hash\nalgorithm. (Contributed by Alex Gaynor in bpo-21307)", "code_blocks": []}, "new-features-added-to-python-2-7-maintenance-releases - pep-477-backport-ensurepip-pep-453-to-python-2-7": {"text": "PEP 477: Backport ensurepip (PEP 453) to Python 2.7\n\nPEP 477 approves the inclusion of the PEP 453 ensurepip module and the\nimproved documentation that was enabled by it in the Python 2.7 maintenance\nreleases, appearing first in the Python 2.7.9 release.\n\nBootstrapping pip By Default\n\nThe new ensurepip module (defined in PEP 453) provides a standard\ncross-platform mechanism to bootstrap the pip installer into Python\ninstallations. The version of pip included with Python 2.7.9 is pip\n1.5.6, and future 2.7.x maintenance releases will update the bundled version to\nthe latest version of pip that is available at the time of creating the\nrelease candidate.\nBy default, the commands pip, pipX and pipX.Y will be installed on\nall platforms (where X.Y stands for the version of the Python installation),\nalong with the pip Python package and its dependencies.\nFor CPython source builds on POSIX systems,\nthe make install and make altinstall commands do not bootstrap pip\nby default.  This behaviour can be controlled through configure options, and\noverridden through Makefile options.\nOn Windows and Mac OS X, the CPython installers now default to installing\npip along with CPython itself (users may opt out of installing it\nduring the installation process). Window users will need to opt in to the\nautomatic PATH modifications to have pip available from the command\nline by default, otherwise it can still be accessed through the Python\nlauncher for Windows as py -m pip.\nAs discussed in the PEP, platform packagers may choose not to install\nthese commands by default, as long as, when invoked, they provide clear and\nsimple directions on how to install them on that platform (usually using\nthe system package manager).\n\n\nDocumentation Changes\n\nAs part of this change, the Installing Python Modules and\nDistributing Python Modules sections of the documentation have been\ncompletely redesigned as short getting started and FAQ documents. Most\npackaging documentation has now been moved out to the Python Packaging\nAuthority maintained Python Packaging User Guide and the documentation of the individual\nprojects.\nHowever, as this migration is currently still incomplete, the legacy\nversions of those guides remaining available as Installing Python Modules (Legacy version)\nand Distributing Python Modules (Legacy version).\n\nSee also\n\nPEP 453 – Explicit bootstrapping of pip in Python installationsPEP written by Donald Stufft and Nick Coghlan, implemented by\nDonald Stufft, Nick Coghlan, Martin von Löwis and Ned Deily.", "code_blocks": []}, "new-features-added-to-python-2-7-maintenance-releases - pep-476-enabling-certificate-verification-by-default-for-stdlib-http-clients": {"text": "PEP 476: Enabling certificate verification by default for stdlib http clients\n\nPEP 476 updated httplib and modules which use it, such as\nurllib2 and xmlrpclib, to now verify that the server\npresents a certificate which is signed by a Certificate Authority in the\nplatform trust store and whose hostname matches the hostname being requested\nby default, significantly improving security for many applications. This\nchange was made in the Python 2.7.9 release.\nFor applications which require the old previous behavior, they can pass an\nalternate context:\nimport urllib2\nimport ssl\n\n# This disables all verification\ncontext = ssl._create_unverified_context()\n\n# This allows using a specific certificate for the host, which doesn't need\n# to be in the trust store\ncontext = ssl.create_default_context(cafile=\"/path/to/file.crt\")\n\nurllib2.urlopen(\"https://invalid-cert\", context=context)", "code_blocks": ["import urllib2\nimport ssl\n\n# This disables all verification\ncontext = ssl._create_unverified_context()\n\n# This allows using a specific certificate for the host, which doesn't need\n# to be in the trust store\ncontext = ssl.create_default_context(cafile=\"/path/to/file.crt\")\n\nurllib2.urlopen(\"https://invalid-cert\", context=context)\n"]}, "new-features-added-to-python-2-7-maintenance-releases - pep-493-https-verification-migration-tools-for-python-2-7": {"text": "PEP 493: HTTPS verification migration tools for Python 2.7\n\nPEP 493 provides additional migration tools to support a more incremental\ninfrastructure upgrade process for environments containing applications and\nservices relying on the historically permissive processing of server\ncertificates when establishing client HTTPS connections.  These additions were\nmade in the Python 2.7.12 release.\nThese tools are intended for use in cases where affected applications and\nservices can’t be modified to explicitly pass a more permissive SSL context\nwhen establishing the connection.\nFor applications and services which can’t be modified at all, the new\nPYTHONHTTPSVERIFY environment variable may be set to 0 to revert an\nentire Python process back to the default permissive behaviour of Python 2.7.8\nand earlier.\nFor cases where the connection establishment code can’t be modified, but the\noverall application can be, the new ssl._https_verify_certificates()\nfunction can be used to adjust the default behaviour at runtime.", "code_blocks": []}, "new-features-added-to-python-2-7-maintenance-releases - new-make-regen-all-build-target": {"text": "New make regen-all build target\n\nTo simplify cross-compilation, and to ensure that CPython can reliably be\ncompiled without requiring an existing version of Python to already be\navailable, the autotools-based build system no longer attempts to implicitly\nrecompile generated files based on file modification times.\nInstead, a new make regen-all command has been added to force regeneration\nof these files when desired (e.g. after an initial version of Python has\nalready been built based on the pregenerated versions).\nMore selective regeneration targets are also defined - see\nMakefile.pre.in for details.\n(Contributed by Victor Stinner in bpo-23404.)\n\nNew in version 2.7.14.", "code_blocks": []}, "new-features-added-to-python-2-7-maintenance-releases - removal-of-make-touch-build-target": {"text": "Removal of make touch build target\n\nThe make touch build target previously used to request implicit regeneration\nof generated files by updating their modification times has been removed.\nIt has been replaced by the new make regen-all target.\n(Contributed by Victor Stinner in bpo-23404.)\n\nChanged in version 2.7.14.", "code_blocks": []}, "acknowledgements": {"text": "Acknowledgements\n\nThe author would like to thank the following people for offering\nsuggestions, corrections and assistance with various drafts of this\narticle: Nick Coghlan, Philip Jenvey, Ryan Lovett, R. David Murray,\nHugh Secker-Walker.", "code_blocks": []}}}
{"index": 2, "python_version": "3.0", "url": "https://docs.python.org/3.0/whatsnew/3.0.html", "sections": {"common-stumbling-blocks - print-is-a-function": {"text": "Print Is A Function\n\nThe print statement has been replaced with a print()\nfunction, with keyword arguments to replace most of the special syntax\nof the old print statement (PEP 3105).  Examples:\nOld: print \"The answer is\", 2*2\nNew: print(\"The answer is\", 2*2)\n\nOld: print x,           # Trailing comma suppresses newline\nNew: print(x, end=\" \")  # Appends a space instead of a newline\n\nOld: print              # Prints a newline\nNew: print()            # You must call the function!\n\nOld: print >>sys.stderr, \"fatal error\"\nNew: print(\"fatal error\", file=sys.stderr)\n\nOld: print (x, y)       # prints repr((x, y))\nNew: print((x, y))      # Not the same as print(x, y)!\n\n\nYou can also customize the separator between items, e.g.:\nprint(\"There are <\", 2**32, \"> possibilities!\", sep=\"\")\n\n\nwhich produces:\nThere are <4294967296> possibilities!\n\nNote:\n\nThe print() function doesn’t support the “softspace” feature of\nthe old print statement.  For example, in Python 2.x,\nprint \"A\\n\", \"B\" would write \"A\\nB\\n\"; but in Python 3.0,\nprint(\"A\\n\", \"B\") writes \"A\\n B\\n\".\nInitially, you’ll be finding yourself typing the old print x\na lot in interactive mode.  Time to retrain your fingers to type\nprint(x) instead!\nWhen using the 2to3 source-to-source conversion tool, all\nprint statements are automatically converted to\nprint() function calls, so this is mostly a non-issue for\nlarger projects.", "code_blocks": ["Old: print \"The answer is\", 2*2\nNew: print(\"The answer is\", 2*2)\n\nOld: print x,           # Trailing comma suppresses newline\nNew: print(x, end=\" \")  # Appends a space instead of a newline\n\nOld: print              # Prints a newline\nNew: print()            # You must call the function!\n\nOld: print >>sys.stderr, \"fatal error\"\nNew: print(\"fatal error\", file=sys.stderr)\n\nOld: print (x, y)       # prints repr((x, y))\nNew: print((x, y))      # Not the same as print(x, y)!\n", "print(\"There are <\", 2**32, \"> possibilities!\", sep=\"\")\n"]}, "common-stumbling-blocks - views-and-iterators-instead-of-lists": {"text": "Views And Iterators Instead Of Lists\n\nSome well-known APIs no longer return lists:\n\ndict methods dict.keys(), dict.items() and\ndict.values() return “views” instead of lists.  For example,\nthis no longer works: k = d.keys(); k.sort().  Use k =\nsorted(d) instead (this works in Python 2.5 too and is just\nas efficient).\nAlso, the dict.iterkeys(), dict.iteritems() and\ndict.itervalues() methods are no longer supported.\nmap() and filter() return iterators.  If you really need\na list, a quick fix is e.g.  list(map(...)), but a better fix is\noften to use a list comprehension (especially when the original code\nuses lambda), or rewriting the code so it doesn’t need a\nlist at all.  Particularly tricky is map() invoked for the\nside effects of the function; the correct transformation is to use a\nregular for loop (since creating a list would just be\nwasteful).\nrange() now behaves like xrange() used to behave, except\nit works with values of arbitrary size.  The latter no longer\nexists.\nzip() now returns an iterator.", "code_blocks": []}, "common-stumbling-blocks - ordering-comparisons": {"text": "Ordering Comparisons\n\nPython 3.0 has simplified the rules for ordering comparisons:\n\nThe ordering comparison operators (<, <=, >=, >)\nraise a TypeError exception when the operands don’t have a\nmeaningful natural ordering.  Thus, expressions like 1 < '', 0\n> None or len <= len are no longer valid, and e.g. None <\nNone raises TypeError instead of returning\nFalse.  A corollary is that sorting a heterogeneous list\nno longer makes sense – all the elements must be comparable to each\nother.  Note that this does not apply to the == and !=\noperators: objects of different incomparable types always compare\nunequal to each other.\nbuiltin.sorted() and list.sort() no longer accept the\ncmp argument providing a comparison function.  Use the key\nargument instead. N.B. the key and reverse arguments are now\n“keyword-only”.\nThe cmp() function should be treated as gone, and the __cmp__()\nspecial method is no longer supported.  Use __lt__() for sorting,\n__eq__() with __hash__(), and other rich comparisons as needed.\n(If you really need the cmp() functionality, you could use the\nexpression (a > b) - (a < b) as the equivalent for cmp(a, b).)", "code_blocks": []}, "common-stumbling-blocks - integers": {"text": "Integers\n\n\nPEP 0237: Essentially, long renamed to int.\nThat is, there is only one built-in integral type, named\nint; but it behaves mostly like the old long type.\nPEP 0238: An expression like 1/2 returns a float.  Use\n1//2 to get the truncating behavior.  (The latter syntax has\nexisted for years, at least since Python 2.2.)\nThe sys.maxint constant was removed, since there is no\nlonger a limit to the value of integers.  However, sys.maxsize\ncan be used as an integer larger than any practical list or string\nindex.  It conforms to the implementation’s “natural” integer size\nand is typically the same as sys.maxint in previous releases\non the same platform (assuming the same build options).\nThe repr() of a long integer doesn’t include the trailing L\nanymore, so code that unconditionally strips that character will\nchop off the last digit instead.  (Use str() instead.)\nOctal literals are no longer of the form 0720; use 0o720\ninstead.", "code_blocks": []}, "common-stumbling-blocks - text-vs-data-instead-of-unicode-vs-8-bit": {"text": "Text Vs. Data Instead Of Unicode Vs. 8-bit\n\nEverything you thought you knew about binary data and Unicode has\nchanged.\n\nPython 3.0 uses the concepts of text and (binary) data instead\nof Unicode strings and 8-bit strings.  All text is Unicode; however\nencoded Unicode is represented as binary data.  The type used to\nhold text is str, the type used to hold data is\nbytes.  The biggest difference with the 2.x situation is\nthat any attempt to mix text and data in Python 3.0 raises\nTypeError, whereas if you were to mix Unicode and 8-bit\nstrings in Python 2.x, it would work if the 8-bit string happened to\ncontain only 7-bit (ASCII) bytes, but you would get\nUnicodeDecodeError if it contained non-ASCII values.  This\nvalue-specific behavior has caused numerous sad faces over the\nyears.\nAs a consequence of this change in philosophy, pretty much all code\nthat uses Unicode, encodings or binary data most likely has to\nchange.  The change is for the better, as in the 2.x world there\nwere numerous bugs having to do with mixing encoded and unencoded\ntext.  To be prepared in Python 2.x, start using unicode\nfor all unencoded text, and str for binary or encoded data\nonly.  Then the 2to3 tool will do most of the work for you.\nYou can no longer use u\"...\" literals for Unicode text.\nHowever, you must use b\"...\" literals for binary data.\nAs the str and bytes types cannot be mixed, you\nmust always explicitly convert between them.  Use str.encode()\nto go from str to bytes, and bytes.decode()\nto go from bytes to str.  You can also use\nbytes(s, encoding=...) and str(b, encoding=...),\nrespectively.\nLike str, the bytes type is immutable.  There is a\nseparate mutable type to hold buffered binary data,\nbytearray.  Nearly all APIs that accept bytes also\naccept bytearray.  The mutable API is based on\ncollections.MutableSequence.\nAll backslashes in raw string literals are interpreted literally.\nThis means that '\\U' and '\\u' escapes in raw strings are not\ntreated specially.  For example, r'\\u20ac' is a string of 6\ncharacters in Python 3.0, whereas in 2.6, ur'\\u20ac' was the\nsingle “euro” character.  (Of course, this change only affects raw\nstring literals; the euro character is '\\u20ac' in Python 3.0.)\nThe builtin basestring abstract type was removed.  Use\nstr instead.  The str and bytes types\ndon’t have functionality enough in common to warrant a shared base\nclass.  The 2to3 tool (see below) replaces every occurrence of\nbasestring with str.\nFiles opened as text files (still the default mode for open())\nalways use an encoding to map between strings (in memory) and bytes\n(on disk).  Binary files (opened with a b in the mode argument)\nalways use bytes in memory.  This means that if a file is opened\nusing an incorrect mode or encoding, I/O will likely fail loudly,\ninstead of silently producing incorrect data.  It also means that\neven Unix users will have to specify the correct mode (text or\nbinary) when opening a file.  There is a platform-dependent default\nencoding, which on Unixy platforms can be set with the LANG\nenvironment variable (and sometimes also with some other\nplatform-specific locale-related environment variables).  In many\ncases, but not all, the system default is UTF-8; you should never\ncount on this default.  Any application reading or writing more than\npure ASCII text should probably have a way to override the encoding.\nThere is no longer any need for using the encoding-aware streams\nin the codecs module.\nFilenames are passed to and returned from APIs as (Unicode) strings.\nThis can present platform-specific problems because on some\nplatforms filenames are arbitrary byte strings.  (On the other hand,\non Windows filenames are natively stored as Unicode.)  As a\nwork-around, most APIs (e.g. open() and many functions in the\nos module) that take filenames accept bytes objects\nas well as strings, and a few APIs have a way to ask for a\nbytes return value.  Thus, os.listdir() returns a\nlist of bytes instances if the argument is a bytes\ninstance, and os.getcwdb() returns the current working\ndirectory as a bytes instance.  Note that when\nos.listdir() returns a list of strings, filenames that\ncannot be decoded properly are omitted rather than raising\nUnicodeError.\nSome system APIs like os.environ and sys.argv can\nalso present problems when the bytes made available by the system is\nnot interpretable using the default encoding.  Setting the LANG\nvariable and rerunning the program is probably the best approach.\nPEP 3138: The repr() of a string no longer escapes\nnon-ASCII characters.  It still escapes control characters and code\npoints with non-printable status in the Unicode standard, however.\nPEP 3120: The default source encoding is now UTF-8.\nPEP 3131: Non-ASCII letters are now allowed in identifiers.\n(However, the standard library remains ASCII-only with the exception\nof contributor names in comments.)\nThe StringIO and cStringIO modules are gone.  Instead,\nimport the io module and use io.StringIO or\nio.BytesIO for text and data respectively.\nSee also the Unicode HOWTO, which was updated for Python 3.0.", "code_blocks": []}, "overview-of-syntax-changes - new-syntax": {"text": "New Syntax\n\n\nPEP 3107: Function argument and return value annotations.  This\nprovides a standardized way of annotating a function’s parameters\nand return value.  There are no semantics attached to such\nannotations except that they can be introspected at runtime using\nthe __annotations__ attribute.  The intent is to encourage\nexperimentation through metaclasses, decorators or frameworks.\n\nPEP 3102: Keyword-only arguments.  Named parameters occurring\nafter *args in the parameter list must be specified using\nkeyword syntax in the call.  You can also use a bare * in the\nparameter list to indicate that you don’t accept a variable-length\nargument list, but you do have keyword-only arguments.\n\nKeyword arguments are allowed after the list of base classes in a\nclass definition.  This is used by the new convention for specifying\na metaclass (see next section), but can be used for other purposes\nas well, as long as the metaclass supports it.\n\nPEP 3104: nonlocal statement.  Using nonlocal x\nyou can now assign directly to a variable in an outer (but\nnon-global) scope.  nonlocal is a new reserved word.\n\nPEP 3132: Extended Iterable Unpacking.  You can now write things\nlike a, b, *rest = some_sequence.  And even *rest, a =\nstuff.  The rest object is always a (possibly empty) list; the\nright-hand side may be any iterable.  Example:\n(a, *rest, b) = range(5)\n\n\nThis sets a to 0, b to 4, and rest to [1, 2, 3].\n\nDictionary comprehensions: {k: v for k, v in stuff} means the\nsame thing as dict(stuff) but is more flexible.  (This is\nPEP 0274 vindicated. :-)\n\nSet literals, e.g. {1, 2}.  Note that {} is an empty\ndictionary; use set() for an empty set.  Set comprehensions are\nalso supported; e.g., {x for x in stuff} means the same thing as\nset(stuff) but is more flexible.\n\nNew octal literals, e.g. 0o720 (already in 2.6).  The old octal\nliterals (0720) are gone.\n\nNew binary literals, e.g. 0b1010 (already in 2.6), and\nthere is a new corresponding builtin function, bin().\n\nBytes literals are introduced with a leading b or B, and\nthere is a new corresponding builtin function, bytes().", "code_blocks": ["(a, *rest, b) = range(5)\n"]}, "overview-of-syntax-changes - changed-syntax": {"text": "Changed Syntax\n\n\nPEP 3109 and PEP 3134: new raise statement syntax:\nraise [expr [from expr]].  See below.\n\nas and with are now reserved words.  (Since\n2.6, actually.)\n\nTrue, False, and None are reserved\nwords.  (2.6 partially enforced the restrictions on None\nalready.)\n\nChange from except exc, var to\nexcept exc as var.  See PEP 3110.\n\nPEP 3115: New Metaclass Syntax.  Instead of:\nclass C:\n    __metaclass__ = M\n    ...\n\nyou must now use:\nclass C(metaclass=M):\n    ...\n\n\nThe module-global __metaclass__ variable is no longer\nsupported.  (It was a crutch to make it easier to default to\nnew-style classes without deriving every class from\nobject.)\n\nList comprehensions no longer support the syntactic form\n[... for var in item1, item2, ...].  Use\n[... for var in (item1, item2, ...)] instead.\nAlso note that list comprehensions have different semantics: they\nare closer to syntactic sugar for a generator expression inside a\nlist() constructor, and in particular the loop control\nvariables are no longer leaked into the surrounding scope.\n\nThe ellipsis (...) can be used as an atomic expression\nanywhere.  (Previously it was only allowed in slices.)  Also, it\nmust now be spelled as ....  (Previously it could also be\nspelled as . . ., by a mere accident of the grammar.)", "code_blocks": ["class C(metaclass=M):\n    ...\n"]}, "overview-of-syntax-changes - removed-syntax": {"text": "Removed Syntax\n\n\nPEP 3113: Tuple parameter unpacking removed.  You can no longer\nwrite def foo(a, (b, c)): ....\nUse def foo(a, b_c): b, c = b_c instead.\nRemoved backticks (use repr() instead).\nRemoved <> (use != instead).\nRemoved keyword: exec() is no longer a keyword; it remains as\na function.  (Fortunately the function syntax was also accepted in\n2.x.)  Also note that exec() no longer takes a stream argument;\ninstead of exec(f) you can use exec(f.read()).\nInteger literals no longer support a trailing l or L.\nString literals no longer support a leading u or U.\nThe from module import * syntax is only\nallowed at the module level, no longer inside functions.\nThe only acceptable syntax for relative imports is from .[module]\nimport name.  All import forms not starting with . are\ninterpreted as absolute imports.  (PEP 0328)\nClassic classes are gone.", "code_blocks": []}, "changes-already-present-in-python-2-6": {"text": "Changes Already Present In Python 2.6\n\nSince many users presumably make the jump straight from Python 2.5 to\nPython 3.0, this section reminds the reader of new features that were\noriginally designed for Python 3.0 but that were back-ported to Python\n2.6.  The corresponding sections in What’s New in Python 2.6 should be\nconsulted for longer descriptions.\n\nPEP 343: The ‘with’ statement.  The with statement is now a standard\nfeature and no longer needs to be imported from the __future__.\nAlso check out Writing Context Managers and\nThe contextlib module.\nPEP 366: Explicit Relative Imports From a Main Module.  This enhances the usefulness of the -m\noption when the referenced module lives in a package.\nPEP 370: Per-user site-packages Directory.\nPEP 371: The multiprocessing Package.\nPEP 3101: Advanced String Formatting.  Note: the 2.6 description mentions the\nformat() method for both 8-bit and Unicode strings.  In 3.0,\nonly the str type (text strings with Unicode support)\nsupports this method; the bytes type does not.  The plan is\nto eventually make this the only API for string formatting, and to\nstart deprecating the % operator in Python 3.1.\nPEP 3105: print As a Function.  This is now a standard feature and no longer needs\nto be imported from __future__.  More details were given above.\nPEP 3110: Exception-Handling Changes.  The except exc as var\nsyntax is now standard and except exc, var is no\nlonger supported.  (Of course, the as var part is still\noptional.)\nPEP 3112: Byte Literals.  The b\"...\" string literal notation (and its\nvariants like b'...', b\"\"\"...\"\"\", and br\"...\") now\nproduces a literal of type bytes.\nPEP 3116: New I/O Library.  The io module is now the standard way of\ndoing file I/O, and the initial values of sys.stdin,\nsys.stdout and sys.stderr are now instances of\nio.TextIOBase.  The builtin open() function is now an\nalias for io.open() and has additional keyword arguments\nencoding, errors, newline and closefd.  Also note that an\ninvalid mode argument now raises ValueError, not\nIOError.  The binary file object underlying a text file\nobject can be accessed as f.buffer (but beware that the\ntext object maintains a buffer of itself in order to speed up\nthe encoding and decoding operations).\nPEP 3118: Revised Buffer Protocol.  The old builtin buffer() is now really gone;\nthe new builtin memoryview() provides (mostly) similar\nfunctionality.\nPEP 3119: Abstract Base Classes.  The abc module and the ABCs defined in the\ncollections module plays a somewhat more prominent role in\nthe language now, and builtin collection types like dict\nand list conform to the collections.MutableMapping\nand collections.MutableSequence ABCs, respectively.\nPEP 3127: Integer Literal Support and Syntax.  As mentioned above, the new octal literal\nnotation is the only one supported, and binary literals have been\nadded.\nPEP 3129: Class Decorators.\nPEP 3141: A Type Hierarchy for Numbers.  The numbers module is another new use of\nABCs, defining Python’s “numeric tower”.  Also note the new\nfractions module which implements numbers.Rational.", "code_blocks": []}, "library-changes": {"text": "Library Changes\n\nDue to time constraints, this document does not exhaustively cover the\nvery extensive changes to the standard library.  PEP 3108 is the\nreference for the major changes to the library.  Here’s a capsule\nreview:\n\nMany old modules were removed.  Some, like gopherlib (no\nlonger used) and md5 (replaced by hashlib), were\nalready deprecated by PEP 0004.  Others were removed as a result\nof the removal of support for various platforms such as Irix, BeOS\nand Mac OS 9 (see PEP 0011).  Some modules were also selected for\nremoval in Python 3.0 due to lack of use or because a better\nreplacement exists.  See PEP 3108 for an exhaustive list.\n\nThe bsddb3 package was removed because its presence in the\ncore standard library has proved over time to be a particular burden\nfor the core developers due to testing instability and Berkeley DB’s\nrelease schedule.  However, the package is alive and well,\nexternally maintained at http://www.jcea.es/programacion/pybsddb.htm.\n\nSome modules were renamed because their old name disobeyed\nPEP 0008, or for various other reasons.  Here’s the list:\n\n\n\n\n\n\nOld Name\n\nNew Name\n\n\n\n\n_winreg\n\nwinreg\n\n\nConfigParser\n\nconfigparser\n\n\ncopy_reg\n\ncopyreg\n\n\nQueue\n\nqueue\n\n\nSocketServer\n\nsocketserver\n\n\nmarkupbase\n\n_markupbase\n\n\nrepr\n\nreprlib\n\n\ntest.test_support\n\ntest.support\n\n\n\n\n\nA common pattern in Python 2.x is to have one version of a module\nimplemented in pure Python, with an optional accelerated version\nimplemented as a C extension; for example, pickle and\ncPickle.  This places the burden of importing the accelerated\nversion and falling back on the pure Python version on each user of\nthese modules.  In Python 3.0, the accelerated versions are\nconsidered implementation details of the pure Python versions.\nUsers should always import the standard version, which attempts to\nimport the accelerated version and falls back to the pure Python\nversion.  The pickle / cPickle pair received this\ntreatment.  The profile module is on the list for 3.1.  The\nStringIO module has been turned into a class in the io\nmodule.\n\nSome related modules have been grouped into packages, and usually\nthe submodule names have been simplified.  The resulting new\npackages are:\n\ndbm (anydbm, dbhash, dbm,\ndumbdbm, gdbm, whichdb).\nhtml (HTMLParser, htmlentitydefs).\nhttp (httplib, BaseHTTPServer,\nCGIHTTPServer, SimpleHTTPServer, Cookie,\ncookielib).\ntkinter (all Tkinter-related modules except\nturtle).  The target audience of turtle doesn’t\nreally care about tkinter.  Also note that as of Python\n2.6, the functionality of turtle has been greatly enhanced.\nurllib (urllib, urllib2, urlparse,\nrobotparse).\nxmlrpc (xmlrpclib, DocXMLRPCServer,\nSimpleXMLRPCServer).\n\n\n\nSome other changes to standard library modules, not covered by\nPEP 3108:\n\nKilled sets.  Use the builtin set() function.\nCleanup of the sys module: removed sys.exitfunc(),\nsys.exc_clear(), sys.exc_type, sys.exc_value,\nsys.exc_traceback.  (Note that sys.last_type\netc. remain.)\nCleanup of the array.array type: the read() and\nwrite() methods are gone; use fromfile() and\ntofile() instead.  Also, the 'c' typecode for array is\ngone – use either 'b' for bytes or 'u' for Unicode\ncharacters.\nCleanup of the operator module: removed\nsequenceIncludes() and isCallable().\nCleanup of the thread module: acquire_lock() and\nrelease_lock() are gone; use acquire() and\nrelease() instead.\nCleanup of the random module: removed the jumpahead() API.\nThe new module is gone.\nThe functions os.tmpnam(), os.tempnam() and\nos.tmpfile() have been removed in favor of the tempfile\nmodule.\nThe tokenize module has been changed to work with bytes.  The\nmain entry point is now tokenize.tokenize(), instead of\ngenerate_tokens.\nstring.letters and its friends (string.lowercase and\nstring.uppercase) are gone.  Use\nstring.ascii_letters etc. instead.  (The reason for the\nremoval is that string.letters and friends had\nlocale-specific behavior, which is a bad idea for such\nattractively-named global “constants”.)\nRenamed module __builtin__ to builtins (removing the\nunderscores, adding an ‘s’).  The __builtins__ variable\nfound in most global namespaces is unchanged.  To modify a builtin,\nyou should use builtins, not __builtins__!", "code_blocks": []}, "pep-3101-a-new-approach-to-string-formatting": {"text": "PEP 3101: A New Approach To String Formatting\n\n\nA new system for  built-in string formatting operations replaces the\n% string  formatting operator.   (However, the %  operator is\nstill supported;  it will  be deprecated in  Python 3.1  and removed\nfrom the language at some later time.)  Read PEP 3101 for the full\nscoop.", "code_blocks": []}, "changes-to-exceptions": {"text": "Changes To Exceptions\n\nThe APIs for raising and catching exception have been cleaned up and\nnew powerful features added:\n\nPEP 0352: All exceptions must be derived (directly or indirectly)\nfrom BaseException.  This is the root of the exception\nhierarchy.  This is not new as a recommendation, but the\nrequirement to inherit from BaseException is new.  (Python\n2.6 still allowed classic classes to be raised, and placed no\nrestriction on what you can catch.)  As a consequence, string\nexceptions are finally truly and utterly dead.\n\nAlmost all exceptions should actually derive from Exception;\nBaseException should only be used as a base class for\nexceptions that should only be handled at the top level, such as\nSystemExit or KeyboardInterrupt.  The recommended\nidiom for handling all exceptions except for this latter category is\nto use except Exception.\n\nStandardError was removed (in 2.6 already).\n\nExceptions no longer behave as sequences.  Use the args\nattribute instead.\n\nPEP 3109: Raising exceptions.  You must now use raise\nException(args) instead of raise Exception, args.\nAdditionally, you can no longer explicitly specify a traceback;\ninstead, if you have to do this, you can assign directly to the\n__traceback__ attribute (see below).\n\nPEP 3110: Catching exceptions.  You must now use\nexcept SomeException as variable instead\nof except SomeException, variable.  Moreover, the\nvariable is explicitly deleted when the except block\nis left.\n\nPEP 3134: Exception chaining.  There are two cases: implicit\nchaining and explicit chaining.  Implicit chaining happens when an\nexception is raised in an except or finally\nhandler block.  This usually happens due to a bug in the handler\nblock; we call this a secondary exception.  In this case, the\noriginal exception (that was being handled) is saved as the\n__context__ attribute of the secondary exception.\nExplicit chaining is invoked with this syntax:\nraise SecondaryException() from primary_exception\n\n\n(where primary_exception is any expression that produces an\nexception object, probably an exception that was previously caught).\nIn this case, the primary exception is stored on the\n__cause__ attribute of the secondary exception.  The\ntraceback printed when an unhandled exception occurs walks the chain\nof __cause__ and __context__ attributes and prints a\nseparate traceback for each component of the chain, with the primary\nexception at the top.  (Java users may recognize this behavior.)\n\nPEP 3134: Exception objects now store their traceback as the\n__traceback__ attribute.  This means that an exception\nobject now contains all the information pertaining to an exception,\nand there are fewer reasons to use sys.exc_info() (though the\nlatter is not removed).\n\nA few exception messages are improved when Windows fails to load an\nextension module.  For example, error code 193 is now %1 is\nnot a valid Win32 application.  Strings now deal with non-English\nlocales.", "code_blocks": ["raise SecondaryException() from primary_exception\n"]}, "miscellaneous-other-changes - operators-and-special-methods": {"text": "Operators And Special Methods\n\n\n!= now returns the opposite of ==, unless == returns\nNotImplemented.\nThe concept of “unbound methods” has been removed from the language.\nWhen referencing a method as a class attribute, you now get a plain\nfunction object.\n__getslice__(), __setslice__() and __delslice__()\nwere killed.  The syntax a[i:j] now translates to\na.__getitem__(slice(i, j)) (or __setitem__() or\n__delitem__(), when used as an assignment or deletion target,\nrespectively).\nPEP 3114: the standard next() method has been renamed to\n__next__().\nThe __oct__() and __hex__() special methods are removed\n– oct() and hex() use __index__() now to convert\nthe argument to an integer.\nRemoved support for __members__ and __methods__.\nThe function attributes named func_X have been renamed to\nuse the __X__ form, freeing up these names in the function\nattribute namespace for user-defined attributes.  To wit,\nfunc_closure, func_code, func_defaults,\nfunc_dict, func_doc, func_globals,\nfunc_name were renamed to __closure__,\n__code__, __defaults__, __dict__,\n__doc__, __globals__, __name__,\nrespectively.\n__nonzero__() is now __bool__().", "code_blocks": []}, "miscellaneous-other-changes - builtins": {"text": "Builtins\n\n\nPEP 3135: New super().  You can now invoke super()\nwithout arguments and (assuming this is in a regular instance method\ndefined inside a class statement) the right class and\ninstance will automatically be chosen.  With arguments, the behavior\nof super() is unchanged.\nPEP 3111: raw_input() was renamed to input().  That\nis, the new input() function reads a line from\nsys.stdin and returns it with the trailing newline stripped.\nIt raises EOFError if the input is terminated prematurely.\nTo get the old behavior of input(), use eval(input()).\nA new builtin next() was added to call the __next__()\nmethod on an object.\nMoved intern() to sys.intern().\nRemoved: apply().  Instead of apply(f, args) use\nf(*args).\nRemoved callable().  Instead of callable(f) you can use\nhasattr(f, '__call__').  The operator.isCallable() function\nis also gone.\nRemoved coerce().  This function no longer serves a purpose\nnow that classic classes are gone.\nRemoved execfile().  Instead of execfile(fn) use\nexec(open(fn).read()).\nRemoved file.  Use open().\nRemoved reduce().  Use functools.reduce() if you really\nneed it; however, 99 percent of the time an explicit for\nloop is more readable.\nRemoved reload().  Use imp.reload().\nRemoved. dict.has_key() – use the in operator\ninstead.", "code_blocks": []}, "build-and-c-api-changes": {"text": "Build and C API Changes\n\nDue to time constraints, here is a very incomplete list of changes\nto the C API.\n\nSupport for several platforms was dropped, including but not limited\nto Mac OS 9, BeOS, RISCOS, Irix, and Tru64.\nPEP 3118: New Buffer API.\nPEP 3121: Extension Module Initialization & Finalization.\nPEP 3123: Making PyObject_HEAD conform to standard C.\nNo more C API support for restricted execution.\nPyNumber_Coerce, PyNumber_CoerceEx,\nPyMember_Get, and PyMember_Set C APIs are removed.\nNew C API PyImport_ImportModuleNoBlock, works like\nPyImport_ImportModule but won’t block on the import lock\n(returning an error instead).\nRenamed the boolean conversion C-level slot and method:\nnb_nonzero is now nb_bool.\nRemoved METH_OLDARGS and WITH_CYCLE_GC from the C API.", "code_blocks": []}, "performance": {"text": "Performance\n\nThe net result of the 3.0 generalizations is that Python 3.0 runs the\npystone benchmark around 10% slower than Python 2.5.  Most likely the\nbiggest cause is the removal of special-casing for small integers.\nThere’s room for improvement, but it will happen after 3.0 is\nreleased!", "code_blocks": []}, "porting-to-python-3-0": {"text": "Porting To Python 3.0\n\nFor porting existing Python 2.5 or 2.6 source code to Python 3.0, the\nbest strategy is the following:\n\n(Prerequisite:) Start with excellent test coverage.\nPort to Python 2.6.  This should be no more work than the average\nport from Python 2.x to Python 2.(x+1).  Make sure all your tests\npass.\n(Still using 2.6:) Turn on the -3 command line switch.\nThis enables warnings about features that will be removed (or\nchange) in 3.0.  Run your test suite again, and fix code that you\nget warnings about until there are no warnings left, and all your\ntests still pass.\nRun the 2to3 source-to-source translator over your source code\ntree.  (See 2to3 - Automated Python 2 to 3 code translation for more on this tool.)  Run the\nresult of the translation under Python 3.0.  Manually fix up any\nremaining issues, fixing problems until all tests pass again.\n\nIt is not recommended to try to write source code that runs unchanged\nunder both Python 2.6 and 3.0; you’d have to use a very contorted\ncoding style, e.g. avoiding print statements, metaclasses,\nand much more.  If you are maintaining a library that needs to support\nboth Python 2.6 and Python 3.0, the best approach is to modify step 3\nabove by editing the 2.6 version of the source code and running the\n2to3 translator again, rather than editing the 3.0 version of the\nsource code.\nFor porting C extensions to Python 3.0, please see Porting Extension Modules to 3.0.", "code_blocks": []}}}
{"index": 3, "python_version": "3.1", "url": "https://docs.python.org/3.1/whatsnew/3.1.html", "sections": {"pep-372-ordered-dictionaries": {"text": "PEP 372: Ordered Dictionaries\n\nRegular Python dictionaries iterate over key/value pairs in arbitrary order.\nOver the years, a number of authors have written alternative implementations\nthat remember the order that the keys were originally inserted.  Based on\nthe experiences from those implementations, a new\ncollections.OrderedDict class has been introduced.\nThe OrderedDict API is substantially the same as regular dictionaries\nbut will iterate over keys and values in a guaranteed order depending on\nwhen a key was first inserted.  If a new entry overwrites an existing entry,\nthe original insertion position is left unchanged.  Deleting an entry and\nreinserting it will move it to the end.\nThe standard library now supports use of ordered dictionaries in several\nmodules.  The configparser module uses them by default.  This lets\nconfiguration files be read, modified, and then written back in their original\norder.  The _asdict() method for collections.namedtuple() now\nreturns an ordered dictionary with the values appearing in the same order as\nthe underlying tuple indicies.  The json module is being built-out with\nan object_pairs_hook to allow OrderedDicts to be built by the decoder.\nSupport was also added for third-party tools like PyYAML.\n\nSee also\n\nPEP 372 - Ordered Dictionaries\nPEP written by Armin Ronacher and Raymond Hettinger.  Implementation\nwritten by Raymond Hettinger.\n\n\nSince an ordered dictionary remembers its insertion order, it can be used\nin conjuction with sorting to make a sorted dictionary:\n>>> # regular unsorted dictionary\n>>> d = {'banana': 3, 'apple':4, 'pear': 1, 'orange': 2}\n\n>>> # dictionary sorted by key\n>>> OrderedDict(sorted(d.items(), key=lambda t: t[0]))\nOrderedDict([('apple', 4), ('banana', 3), ('orange', 2), ('pear', 1)])\n\n>>> # dictionary sorted by value\n>>> OrderedDict(sorted(d.items(), key=lambda t: t[1]))\nOrderedDict([('pear', 1), ('orange', 2), ('banana', 3), ('apple', 4)])\n\n>>> # dictionary sorted by length of the key string\n>>> OrderedDict(sorted(d.items(), key=lambda t: len(t[0])))\nOrderedDict([('pear', 1), ('apple', 4), ('orange', 2), ('banana', 3)])\n\n\nThe new sorted dictionaries maintain their sort order when entries\nare deleted.  But when new keys are added, the keys are appended\nto the end and the sort is not maintained.", "code_blocks": [">>> # regular unsorted dictionary\n>>> d = {'banana': 3, 'apple':4, 'pear': 1, 'orange': 2}\n\n>>> # dictionary sorted by key\n>>> OrderedDict(sorted(d.items(), key=lambda t: t[0]))\nOrderedDict([('apple', 4), ('banana', 3), ('orange', 2), ('pear', 1)])\n\n>>> # dictionary sorted by value\n>>> OrderedDict(sorted(d.items(), key=lambda t: t[1]))\nOrderedDict([('pear', 1), ('orange', 2), ('banana', 3), ('apple', 4)])\n\n>>> # dictionary sorted by length of the key string\n>>> OrderedDict(sorted(d.items(), key=lambda t: len(t[0])))\nOrderedDict([('pear', 1), ('apple', 4), ('orange', 2), ('banana', 3)])\n"]}, "pep-378-format-specifier-for-thousands-separator": {"text": "PEP 378: Format Specifier for Thousands Separator\n\nThe builtin format() function and the str.format() method use\na mini-language that now includes a simple, non-locale aware way to format\na number with a thousands separator.  That provides a way to humanize a\nprogram’s output, improving its professional appearance and readability:\n>>> format(1234567, ',d')\n'1,234,567'\n>>> format(1234567.89, ',.2f')\n'1,234,567.89'\n>>> format(12345.6 + 8901234.12j, ',f')\n'12,345.600000+8,901,234.120000j'\n>>> format(Decimal('1234567.89'), ',f')\n'1,234,567.89'\n\n\nThe supported types are int, float, complex\nand decimal.Decimal.\nDiscussions are underway about how to specify alternative separators\nlike dots, spaces, apostrophes, or underscores.  Locale-aware applications\nshould use the existing n format specifier which already has some support\nfor thousands separators.\n\nSee also\n\nPEP 378 - Format Specifier for Thousands Separator\nPEP written by Raymond Hettinger and implemented by Eric Smith and\nMark Dickinson.", "code_blocks": [">>> format(1234567, ',d')\n'1,234,567'\n>>> format(1234567.89, ',.2f')\n'1,234,567.89'\n>>> format(12345.6 + 8901234.12j, ',f')\n'12,345.600000+8,901,234.120000j'\n>>> format(Decimal('1234567.89'), ',f')\n'1,234,567.89'\n"]}, "other-language-changes": {"text": "Other Language Changes\n\nSome smaller changes made to the core Python language are:\n\nDirectories and zip archives containing a __main__.py\nfile can now be executed directly by passing their name to the\ninterpreter. The directory/zipfile is automatically inserted as the\nfirst entry in sys.path.  (Suggestion and initial patch by Andy Chu;\nrevised patch by Phillip J. Eby and Nick Coghlan; issue 1739468.)\n\nThe int() type gained a bit_length method that returns the\nnumber of bits necessary to represent its argument in binary:\n>>> n = 37\n>>> bin(37)\n'0b100101'\n>>> n.bit_length()\n6\n>>> n = 2**123-1\n>>> n.bit_length()\n123\n>>> (n+1).bit_length()\n124\n\n\n(Contributed by Fredrik Johansson, Victor Stinner, Raymond Hettinger,\nand Mark Dickinson; issue 3439.)\n\nThe fields in format() strings can now be automatically\nnumbered:\n>>> 'Sir {} of {}'.format('Gallahad', 'Camelot')\n'Sir Gallahad of Camelot'\n\n\nFormerly, the string would have required numbered fields such as:\n'Sir {0} of {1}'.\n(Contributed by Eric Smith; issue 5237.)\n\nThe string.maketrans() function is deprecated and is replaced by new\nstatic methods, bytes.maketrans() and bytearray.maketrans().\nThis change solves the confusion around which types were supported by the\nstring module. Now, str, bytes, and\nbytearray each have their own maketrans and translate\nmethods with intermediate translation tables of the appropriate type.\n(Contributed by Georg Brandl; issue 5675.)\n\nThe syntax of the with statement now allows multiple context\nmanagers in a single statement:\n>>> with open('mylog.txt') as infile, open('a.out', 'w') as outfile:\n...     for line in infile:\n...         if '<critical>' in line:\n...             outfile.write(line)\n\n\nWith the new syntax, the contextlib.nested() function is no longer\nneeded and is now deprecated.\n(Contributed by Georg Brandl and Mattias Brändström;\nappspot issue 53094.)\n\nround(x, n) now returns an integer if x is an integer.\nPreviously it returned a float:\n>>> round(1123, -2)\n1100\n\n\n(Contributed by Mark Dickinson; issue 4707.)\n\nPython now uses David Gay’s algorithm for finding the shortest floating\npoint representation that doesn’t change its value.  This should help\nmitigate some of the confusion surrounding binary floating point\nnumbers.\nThe significance is easily seen with a number like 1.1 which does not\nhave an exact equivalent in binary floating point.  Since there is no exact\nequivalent, an expression like float('1.1') evaluates to the nearest\nrepresentable value which is 0x1.199999999999ap+0 in hex or\n1.100000000000000088817841970012523233890533447265625 in decimal. That\nnearest value was and still is used in subsequent floating point\ncalculations.\nWhat is new is how the number gets displayed.  Formerly, Python used a\nsimple approach.  The value of repr(1.1) was computed as format(1.1,\n'.17g') which evaluated to '1.1000000000000001'. The advantage of\nusing 17 digits was that it relied on IEEE-754 guarantees to assure that\neval(repr(1.1)) would round-trip exactly to its original value.  The\ndisadvantage is that many people found the output to be confusing (mistaking\nintrinsic limitations of binary floating point representation as being a\nproblem with Python itself).\nThe new algorithm for repr(1.1) is smarter and returns '1.1'.\nEffectively, it searches all equivalent string representations (ones that\nget stored with the same underlying float value) and returns the shortest\nrepresentation.\nThe new algorithm tends to emit cleaner representations when possible, but\nit does not change the underlying values.  So, it is still the case that\n1.1 + 2.2 != 3.3 even though the representations may suggest otherwise.\nThe new algorithm depends on certain features in the underlying floating\npoint implementation.  If the required features are not found, the old\nalgorithm will continue to be used.  Also, the text pickle protocols\nassure cross-platform portability by using the old algorithm.\n(Contributed by Eric Smith and Mark Dickinson; issue 1580)", "code_blocks": [">>> n = 37\n>>> bin(37)\n'0b100101'\n>>> n.bit_length()\n6\n>>> n = 2**123-1\n>>> n.bit_length()\n123\n>>> (n+1).bit_length()\n124\n", ">>> 'Sir {} of {}'.format('Gallahad', 'Camelot')\n'Sir Gallahad of Camelot'\n", ">>> with open('mylog.txt') as infile, open('a.out', 'w') as outfile:\n...     for line in infile:\n...         if '<critical>' in line:\n...             outfile.write(line)\n", ">>> round(1123, -2)\n1100\n"]}, "new-improved-and-deprecated-modules": {"text": "New, Improved, and Deprecated Modules\n\n\nAdded a collections.Counter class to support convenient\ncounting of unique items in a sequence or iterable:\n>>> Counter(['red', 'blue', 'red', 'green', 'blue', 'blue'])\nCounter({'blue': 3, 'red': 2, 'green': 1})\n\n\n(Contributed by Raymond Hettinger; issue 1696199.)\n\nAdded a new module, tkinter.ttk for access to the Tk themed widget set.\nThe basic idea of ttk is to separate, to the extent possible, the code\nimplementing a widget’s behavior from the code implementing its appearance.\n(Contributed by Guilherme Polo; issue 2983.)\n\nThe gzip.GzipFile and bz2.BZ2File classes now support\nthe context manager protocol:\n>>> # Automatically close file after writing\n>>> with gzip.GzipFile(filename, \"wb\") as f:\n...     f.write(b\"xxx\")\n\n\n(Contributed by Antoine Pitrou.)\n\nThe decimal module now supports methods for creating a\ndecimal object from a binary float.  The conversion is\nexact but can sometimes be surprising:\n>>> Decimal.from_float(1.1)\nDecimal('1.100000000000000088817841970012523233890533447265625')\n\n\nThe long decimal result shows the actual binary fraction being\nstored for 1.1.  The fraction has many digits because 1.1 cannot\nbe exactly represented in binary.\n(Contributed by Raymond Hettinger and Mark Dickinson.)\n\nThe itertools module grew two new functions.  The\nitertools.combinations_with_replacement() function is one of\nfour for generating combinatorics including permutations and Cartesian\nproducts.  The itertools.compress() function mimics its namesake\nfrom APL.  Also, the existing itertools.count() function now has\nan optional step argument and can accept any type of counting\nsequence including fractions.Fraction and\ndecimal.Decimal:\n>>> [p+q for p,q in combinations_with_replacement('LOVE', 2)]\n['LL', 'LO', 'LV', 'LE', 'OO', 'OV', 'OE', 'VV', 'VE', 'EE']\n\n>>> list(compress(data=range(10), selectors=[0,0,1,1,0,1,0,1,0,0]))\n[2, 3, 5, 7]\n\n>>> c = count(start=Fraction(1,2), step=Fraction(1,6))\n>>> [next(c), next(c), next(c), next(c)]\n[Fraction(1, 2), Fraction(2, 3), Fraction(5, 6), Fraction(1, 1)]\n\n\n(Contributed by Raymond Hettinger.)\n\ncollections.namedtuple() now supports a keyword argument\nrename which lets invalid fieldnames be automatically converted to\npositional names in the form _0, _1, etc.  This is useful when\nthe field names are being created by an external source such as a\nCSV header, SQL field list, or user input:\n>>> query = input()\nSELECT region, dept, count(*) FROM main GROUPBY region, dept\n\n>>> cursor.execute(query)\n>>> query_fields = [desc[0] for desc in cursor.description]\n>>> UserQuery = namedtuple('UserQuery', query_fields, rename=True)\n>>> pprint.pprint([UserQuery(*row) for row in cursor])\n[UserQuery(region='South', dept='Shipping', _2=185),\n UserQuery(region='North', dept='Accounting', _2=37),\n UserQuery(region='West', dept='Sales', _2=419)]\n\n\n(Contributed by Raymond Hettinger; issue 1818.)\n\nThe re.sub(), re.subn() and re.split() functions now\naccept a flags parameter.\n(Contributed by Gregory Smith.)\n\nThe logging module now implements a simple logging.NullHandler\nclass for applications that are not using logging but are calling\nlibrary code that does.  Setting-up a null handler will suppress\nspurious warnings such as “No handlers could be found for logger foo”:\n>>> h = logging.NullHandler()\n>>> logging.getLogger(\"foo\").addHandler(h)\n\n\n(Contributed by Vinay Sajip; issue 4384).\n\nThe runpy module which supports the -m command line switch\nnow supports the execution of packages by looking for and executing\na __main__ submodule when a package name is supplied.\n(Contributed by Andi Vajda; issue 4195.)\n\nThe pdb module can now access and display source code loaded via\nzipimport (or any other conformant PEP 302 loader).\n(Contributed by Alexander Belopolsky; issue 4201.)\n\nfunctools.partial objects can now be pickled.\n\n\n\n(Suggested by Antoine Pitrou and Jesse Noller.  Implemented by\nJack Diederich; issue 5228.)\n\nAdd pydoc help topics for symbols so that help('@')\nworks as expected in the interactive environment.\n(Contributed by David Laban; issue 4739.)\n\nThe unittest module now supports skipping individual tests or classes\nof tests. And it supports marking a test as a expected failure, a test that\nis known to be broken, but shouldn’t be counted as a failure on a\nTestResult:\nclass TestGizmo(unittest.TestCase):\n\n    @unittest.skipUnless(sys.platform.startswith(\"win\"), \"requires Windows\")\n    def test_gizmo_on_windows(self):\n        ...\n\n    @unittest.expectedFailure\n    def test_gimzo_without_required_library(self):\n        ...\n\n\nAlso, tests for exceptions have been builtout to work with context managers\nusing the with statement:\ndef test_division_by_zero(self):\n    with self.assertRaises(ZeroDivisionError):\n        x / 0\n\n\nIn addition, several new assertion methods were added including\nassertSetEqual(), assertDictEqual(),\nassertDictContainsSubset(), assertListEqual(),\nassertTupleEqual(), assertSequenceEqual(),\nassertRaisesRegexp(), assertIsNone(),\nand assertIsNotNone().\n(Contributed by Benjamin Peterson and Antoine Pitrou.)\n\nThe io module has three new constants for the seek()\nmethod SEEK_SET, SEEK_CUR, and SEEK_END.\n\nThe sys.version_info tuple is now a named tuple:\n>>> sys.version_info\nsys.version_info(major=3, minor=1, micro=0, releaselevel='alpha', serial=2)\n\n\n(Contributed by Ross Light; issue 4285.)\n\nThe nntplib and imaplib modules now support IPv6.\n(Contributed by Derek Morr; issue 1655 and issue 1664.)\n\nThe pickle module has been adapted for better interoperability with\nPython 2.x when used with protocol 2 or lower.  The reorganization of the\nstandard library changed the formal reference for many objects.  For\nexample, __builtin__.set in Python 2 is called builtins.set in Python\n3. This change confounded efforts to share data between different versions of\nPython.  But now when protocol 2 or lower is selected, the pickler will\nautomatically use the old Python 2 names for both loading and dumping. This\nremapping is turned-on by default but can be disabled with the fix_imports\noption:\n>>> s = {1, 2, 3}\n>>> pickle.dumps(s, protocol=0)\nb'c__builtin__\\nset\\np0\\n((lp1\\nL1L\\naL2L\\naL3L\\natp2\\nRp3\\n.'\n>>> pickle.dumps(s, protocol=0, fix_imports=False)\nb'cbuiltins\\nset\\np0\\n((lp1\\nL1L\\naL2L\\naL3L\\natp2\\nRp3\\n.'\n\n\nAn unfortunate but unavoidable side-effect of this change is that protocol 2\npickles produced by Python 3.1 won’t be readable with Python 3.0. The latest\npickle protocol, protocol 3, should be used when migrating data between\nPython 3.x implementations, as it doesn’t attempt to remain compatible with\nPython 2.x.\n(Contributed by Alexandre Vassalotti and Antoine Pitrou, issue 6137.)\n\nA new module, importlib was added.  It provides a complete, portable,\npure Python reference implementation of the import statement and its\ncounterpart, the __import__() function.  It represents a substantial\nstep forward in documenting and defining the actions that take place during\nimports.\n(Contributed by Brett Cannon.)", "code_blocks": [">>> Counter(['red', 'blue', 'red', 'green', 'blue', 'blue'])\nCounter({'blue': 3, 'red': 2, 'green': 1})\n", ">>> # Automatically close file after writing\n>>> with gzip.GzipFile(filename, \"wb\") as f:\n...     f.write(b\"xxx\")\n", ">>> Decimal.from_float(1.1)\nDecimal('1.100000000000000088817841970012523233890533447265625')\n", ">>> [p+q for p,q in combinations_with_replacement('LOVE', 2)]\n['LL', 'LO', 'LV', 'LE', 'OO', 'OV', 'OE', 'VV', 'VE', 'EE']\n\n>>> list(compress(data=range(10), selectors=[0,0,1,1,0,1,0,1,0,0]))\n[2, 3, 5, 7]\n\n>>> c = count(start=Fraction(1,2), step=Fraction(1,6))\n>>> [next(c), next(c), next(c), next(c)]\n[Fraction(1, 2), Fraction(2, 3), Fraction(5, 6), Fraction(1, 1)]\n", ">>> query = input()\nSELECT region, dept, count(*) FROM main GROUPBY region, dept\n\n>>> cursor.execute(query)\n>>> query_fields = [desc[0] for desc in cursor.description]\n>>> UserQuery = namedtuple('UserQuery', query_fields, rename=True)\n>>> pprint.pprint([UserQuery(*row) for row in cursor])\n[UserQuery(region='South', dept='Shipping', _2=185),\n UserQuery(region='North', dept='Accounting', _2=37),\n UserQuery(region='West', dept='Sales', _2=419)]\n", ">>> h = logging.NullHandler()\n>>> logging.getLogger(\"foo\").addHandler(h)\n", "class TestGizmo(unittest.TestCase):\n\n    @unittest.skipUnless(sys.platform.startswith(\"win\"), \"requires Windows\")\n    def test_gizmo_on_windows(self):\n        ...\n\n    @unittest.expectedFailure\n    def test_gimzo_without_required_library(self):\n        ...\n", "def test_division_by_zero(self):\n    with self.assertRaises(ZeroDivisionError):\n        x / 0\n", ">>> sys.version_info\nsys.version_info(major=3, minor=1, micro=0, releaselevel='alpha', serial=2)\n", ">>> s = {1, 2, 3}\n>>> pickle.dumps(s, protocol=0)\nb'c__builtin__\\nset\\np0\\n((lp1\\nL1L\\naL2L\\naL3L\\natp2\\nRp3\\n.'\n>>> pickle.dumps(s, protocol=0, fix_imports=False)\nb'cbuiltins\\nset\\np0\\n((lp1\\nL1L\\naL2L\\naL3L\\natp2\\nRp3\\n.'\n"]}, "optimizations": {"text": "Optimizations\n\nMajor performance enhancements have been added:\n\nThe new I/O library (as defined in PEP 3116) was mostly written in\nPython and quickly proved to be a problematic bottleneck in Python 3.0.\nIn Python 3.1, the I/O library has been entirely rewritten in C and is\n2 to 20 times faster depending on the task at hand. The pure Python\nversion is still available for experimentation purposes through\nthe _pyio module.\n(Contributed by Amaury Forgeot d’Arc and Antoine Pitrou.)\n\nAdded a heuristic so that tuples and dicts containing only untrackable objects\nare not tracked by the garbage collector. This can reduce the size of\ncollections and therefore the garbage collection overhead on long-running\nprograms, depending on their particular use of datatypes.\n(Contributed by Antoine Pitrou, issue 4688.)\n\nEnabling a configure option named --with-computed-gotos\non compilers that support it (notably: gcc, SunPro, icc), the bytecode\nevaluation loop is compiled with a new dispatch mechanism which gives\nspeedups of up to 20%, depending on the system, the compiler, and\nthe benchmark.\n(Contributed by Antoine Pitrou along with a number of other participants,\nissue 4753).\n\nThe decoding of UTF-8, UTF-16 and LATIN-1 is now two to four times\nfaster.\n(Contributed by Antoine Pitrou and Amaury Forgeot d’Arc, issue 4868.)\n\nThe json module now has a C extension to substantially improve\nits performance.  In addition, the API was modified so that json works\nonly with str, not with bytes.  That change makes the\nmodule closely match the JSON specification\nwhich is defined in terms of Unicode.\n(Contributed by Bob Ippolito and converted to Py3.1 by Antoine Pitrou\nand Benjamin Peterson; issue 4136.)\n\nUnpickling now interns the attribute names of pickled objects.  This saves\nmemory and allows pickles to be smaller.\n(Contributed by Jake McGuire and Antoine Pitrou; issue 5084.)", "code_blocks": []}, "idle": {"text": "IDLE\n\n\nIDLE’s format menu now provides an option to strip trailing whitespace\nfrom a source file.\n(Contributed by Roger D. Serwy; issue 5150.)", "code_blocks": []}, "build-and-c-api-changes": {"text": "Build and C API Changes\n\nChanges to Python’s build process and to the C API include:\n\nIntegers are now stored internally either in base 2**15 or in base\n2**30, the base being determined at build time.  Previously, they\nwere always stored in base 2**15.  Using base 2**30 gives\nsignificant performance improvements on 64-bit machines, but\nbenchmark results on 32-bit machines have been mixed.  Therefore,\nthe default is to use base 2**30 on 64-bit machines and base 2**15\non 32-bit machines; on Unix, there’s a new configure option\n--enable-big-digits that can be used to override this default.\nApart from the performance improvements this change should be invisible to\nend users, with one exception: for testing and debugging purposes there’s a\nnew sys.int_info that provides information about the\ninternal format, giving the number of bits per digit and the size in bytes\nof the C type used to store each digit:\n>>> import sys\n>>> sys.int_info\nsys.int_info(bits_per_digit=30, sizeof_digit=4)\n\n\n(Contributed by Mark Dickinson; issue 4258.)\n\nThe PyLong_AsUnsignedLongLong() function now handles a negative\npylong by raising OverflowError instead of TypeError.\n(Contributed by Mark Dickinson and Lisandro Dalcrin; issue 5175.)\n\nDeprecated PyNumber_Int().  Use PyNumber_Long() instead.\n(Contributed by Mark Dickinson; issue 4910.)\n\nAdded a new PyOS_string_to_double() function to replace the\ndeprecated functions PyOS_ascii_strtod() and PyOS_ascii_atof().\n(Contributed by Mark Dickinson; issue 5914.)\n\nAdded PyCapsule as a replacement for the PyCObject API.\nThe principal difference is that the new type has a well defined interface\nfor passing typing safety information and a less complicated signature\nfor calling a destructor.  The old type had a problematic API and is now\ndeprecated.\n(Contributed by Larry Hastings; issue 5630.)", "code_blocks": [">>> import sys\n>>> sys.int_info\nsys.int_info(bits_per_digit=30, sizeof_digit=4)\n"]}, "porting-to-python-3-1": {"text": "Porting to Python 3.1\n\nThis section lists previously described changes and other bugfixes\nthat may require changes to your code:\n\nThe new floating point string representations can break existing doctests.\nFor example:\ndef e():\n    '''Compute the base of natural logarithms.\n\n    >>> e()\n    2.7182818284590451\n\n    '''\n    return sum(1/math.factorial(x) for x in reversed(range(30)))\n\ndoctest.testmod()\n\n**********************************************************************\nFailed example:\n    e()\nExpected:\n    2.7182818284590451\nGot:\n    2.718281828459045\n**********************************************************************\n\n\n\nThe automatic name remapping in the pickle module for protocol 2 or lower can\nmake Python 3.1 pickles unreadable in Python 3.0.  One solution is to use\nprotocol 3.  Another solution is to set the fix_imports option to False.\nSee the discussion above for more details.", "code_blocks": ["def e():\n    '''Compute the base of natural logarithms.\n\n    >>> e()\n    2.7182818284590451\n\n    '''\n    return sum(1/math.factorial(x) for x in reversed(range(30)))\n\ndoctest.testmod()\n\n**********************************************************************\nFailed example:\n    e()\nExpected:\n    2.7182818284590451\nGot:\n    2.718281828459045\n**********************************************************************\n"]}}}
{"index": 4, "python_version": "3.2", "url": "https://docs.python.org/3.2/whatsnew/3.2.html", "sections": {"pep-384-defining-a-stable-abi": {"text": "PEP 384: Defining a Stable ABI\n\nIn the past, extension modules built for one Python version were often\nnot usable with other Python versions. Particularly on Windows, every\nfeature release of Python required rebuilding all extension modules that\none wanted to use. This requirement was the result of the free access to\nPython interpreter internals that extension modules could use.\nWith Python 3.2, an alternative approach becomes available: extension\nmodules which restrict themselves to a limited API (by defining\nPy_LIMITED_API) cannot use many of the internals, but are constrained\nto a set of API functions that are promised to be stable for several\nreleases. As a consequence, extension modules built for 3.2 in that\nmode will also work with 3.3, 3.4, and so on. Extension modules that\nmake use of details of memory structures can still be built, but will\nneed to be recompiled for every feature release.\n\nSee also\n\nPEP 384 - Defining a Stable ABI\nPEP written by Martin von Löwis.", "code_blocks": []}, "pep-389-argparse-command-line-parsing-module": {"text": "PEP 389: Argparse Command Line Parsing Module\n\nA new module for command line parsing, argparse, was introduced to\novercome the limitations of optparse which did not provide support for\npositional arguments (not just options), subcommands, required options and other\ncommon patterns of specifying and validating options.\nThis module has already had widespread success in the community as a\nthird-party module.  Being more fully featured than its predecessor, the\nargparse module is now the preferred module for command-line processing.\nThe older module is still being kept available because of the substantial amount\nof legacy code that depends on it.\nHere’s an annotated example parser showing features like limiting results to a\nset of choices, specifying a metavar in the help screen, validating that one\nor more positional arguments is present, and making a required option:\nimport argparse\nparser = argparse.ArgumentParser(\n            description = 'Manage servers',         # main description for help\n            epilog = 'Tested on Solaris and Linux') # displayed after help\nparser.add_argument('action',                       # argument name\n            choices = ['deploy', 'start', 'stop'],  # three allowed values\n            help = 'action on each target')         # help msg\nparser.add_argument('targets',\n            metavar = 'HOSTNAME',                   # var name used in help msg\n            nargs = '+',                            # require one or more targets\n            help = 'url for target machines')       # help msg explanation\nparser.add_argument('-u', '--user',                 # -u or --user option\n            required = True,                        # make it a required argument\n            help = 'login as user')\n\n\nExample of calling the parser on a command string:\n>>> cmd  = 'deploy sneezy.example.com sleepy.example.com -u skycaptain'\n>>> result = parser.parse_args(cmd.split())\n>>> result.action\n'deploy'\n>>> result.targets\n['sneezy.example.com', 'sleepy.example.com']\n>>> result.user\n'skycaptain'\n\n\nExample of the parser’s automatically generated help:\n>>> parser.parse_args('-h'.split())\n\nusage: manage_cloud.py [-h] -u USER\n                       {deploy,start,stop} HOSTNAME [HOSTNAME ...]\n\nManage servers\n\npositional arguments:\n  {deploy,start,stop}   action on each target\n  HOSTNAME              url for target machines\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -u USER, --user USER  login as user\n\nTested on Solaris and Linux\n\n\nAn especially nice argparse feature is the ability to define subparsers,\neach with their own argument patterns and help displays:\nimport argparse\nparser = argparse.ArgumentParser(prog='HELM')\nsubparsers = parser.add_subparsers()\n\nparser_l = subparsers.add_parser('launch', help='Launch Control')   # first subgroup\nparser_l.add_argument('-m', '--missiles', action='store_true')\nparser_l.add_argument('-t', '--torpedos', action='store_true')\n\nparser_m = subparsers.add_parser('move', help='Move Vessel',        # second subgroup\n                                 aliases=('steer', 'turn'))         # equivalent names\nparser_m.add_argument('-c', '--course', type=int, required=True)\nparser_m.add_argument('-s', '--speed', type=int, default=0)\n\n$ ./helm.py --help                         # top level help (launch and move)\n$ ./helm.py launch --help                  # help for launch options\n$ ./helm.py launch --missiles              # set missiles=True and torpedos=False\n$ ./helm.py steer --course 180 --speed 5   # set movement parameters\n\n\nSee also\n\nPEP 389 - New Command Line Parsing Module\nPEP written by Steven Bethard.\n\nUpgrading optparse code for details on the differences from optparse.", "code_blocks": ["import argparse\nparser = argparse.ArgumentParser(\n            description = 'Manage servers',         # main description for help\n            epilog = 'Tested on Solaris and Linux') # displayed after help\nparser.add_argument('action',                       # argument name\n            choices = ['deploy', 'start', 'stop'],  # three allowed values\n            help = 'action on each target')         # help msg\nparser.add_argument('targets',\n            metavar = 'HOSTNAME',                   # var name used in help msg\n            nargs = '+',                            # require one or more targets\n            help = 'url for target machines')       # help msg explanation\nparser.add_argument('-u', '--user',                 # -u or --user option\n            required = True,                        # make it a required argument\n            help = 'login as user')\n", ">>> cmd  = 'deploy sneezy.example.com sleepy.example.com -u skycaptain'\n>>> result = parser.parse_args(cmd.split())\n>>> result.action\n'deploy'\n>>> result.targets\n['sneezy.example.com', 'sleepy.example.com']\n>>> result.user\n'skycaptain'\n", ">>> parser.parse_args('-h'.split())\n\nusage: manage_cloud.py [-h] -u USER\n                       {deploy,start,stop} HOSTNAME [HOSTNAME ...]\n\nManage servers\n\npositional arguments:\n  {deploy,start,stop}   action on each target\n  HOSTNAME              url for target machines\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -u USER, --user USER  login as user\n\nTested on Solaris and Linux\n"]}, "pep-391-dictionary-based-configuration-for-logging": {"text": "PEP 391:  Dictionary Based Configuration for Logging\n\nThe logging module provided two kinds of configuration, one style with\nfunction calls for each option or another style driven by an external file saved\nin a ConfigParser format.  Those options did not provide the flexibility\nto create configurations from JSON or YAML files, nor did they support\nincremental configuration, which is needed for specifying logger options from a\ncommand line.\nTo support a more flexible style, the module now offers\nlogging.config.dictConfig() for specifying logging configuration with\nplain Python dictionaries.  The configuration options include formatters,\nhandlers, filters, and loggers.  Here’s a working example of a configuration\ndictionary:\n{\"version\": 1,\n \"formatters\": {\"brief\": {\"format\": \"%(levelname)-8s: %(name)-15s: %(message)s\"},\n                \"full\": {\"format\": \"%(asctime)s %(name)-15s %(levelname)-8s %(message)s\"}\n                },\n \"handlers\": {\"console\": {\n                   \"class\": \"logging.StreamHandler\",\n                   \"formatter\": \"brief\",\n                   \"level\": \"INFO\",\n                   \"stream\": \"ext://sys.stdout\"},\n              \"console_priority\": {\n                   \"class\": \"logging.StreamHandler\",\n                   \"formatter\": \"full\",\n                   \"level\": \"ERROR\",\n                   \"stream\": \"ext://sys.stderr\"}\n              },\n \"root\": {\"level\": \"DEBUG\", \"handlers\": [\"console\", \"console_priority\"]}}\n\n\nIf that dictionary is stored in a file called conf.json, it can be\nloaded and called with code like this:\n>>> import json, logging.config\n>>> with open('conf.json') as f:\n        conf = json.load(f)\n>>> logging.config.dictConfig(conf)\n>>> logging.info(\"Transaction completed normally\")\nINFO    : root           : Transaction completed normally\n>>> logging.critical(\"Abnormal termination\")\n2011-02-17 11:14:36,694 root            CRITICAL Abnormal termination\n\n\n\nSee also\n\nPEP 391 - Dictionary Based Configuration for Logging\nPEP written by Vinay Sajip.", "code_blocks": ["{\"version\": 1,\n \"formatters\": {\"brief\": {\"format\": \"%(levelname)-8s: %(name)-15s: %(message)s\"},\n                \"full\": {\"format\": \"%(asctime)s %(name)-15s %(levelname)-8s %(message)s\"}\n                },\n \"handlers\": {\"console\": {\n                   \"class\": \"logging.StreamHandler\",\n                   \"formatter\": \"brief\",\n                   \"level\": \"INFO\",\n                   \"stream\": \"ext://sys.stdout\"},\n              \"console_priority\": {\n                   \"class\": \"logging.StreamHandler\",\n                   \"formatter\": \"full\",\n                   \"level\": \"ERROR\",\n                   \"stream\": \"ext://sys.stderr\"}\n              },\n \"root\": {\"level\": \"DEBUG\", \"handlers\": [\"console\", \"console_priority\"]}}\n", ">>> import json, logging.config\n>>> with open('conf.json') as f:\n        conf = json.load(f)\n>>> logging.config.dictConfig(conf)\n>>> logging.info(\"Transaction completed normally\")\nINFO    : root           : Transaction completed normally\n>>> logging.critical(\"Abnormal termination\")\n2011-02-17 11:14:36,694 root            CRITICAL Abnormal termination\n"]}, "pep-3148-the-concurrent-futures-module": {"text": "PEP 3148:  The concurrent.futures module\n\nCode for creating and managing concurrency is being collected in a new top-level\nnamespace, concurrent.  Its first member is a futures package which provides\na uniform high-level interface for managing threads and processes.\nThe design for concurrent.futures was inspired by the\njava.util.concurrent package.  In that model, a running call and its result\nare represented by a Future object that abstracts\nfeatures common to threads, processes, and remote procedure calls.  That object\nsupports status checks (running or done), timeouts, cancellations, adding\ncallbacks, and access to results or exceptions.\nThe primary offering of the new module is a pair of executor classes for\nlaunching and managing calls.  The goal of the executors is to make it easier to\nuse existing tools for making parallel calls. They save the effort needed to\nsetup a pool of resources, launch the calls, create a results queue, add\ntime-out handling, and limit the total number of threads, processes, or remote\nprocedure calls.\nIdeally, each application should share a single executor across multiple\ncomponents so that process and thread limits can be centrally managed.  This\nsolves the design challenge that arises when each component has its own\ncompeting strategy for resource management.\nBoth classes share a common interface with three methods:\nsubmit() for scheduling a callable and\nreturning a Future object;\nmap() for scheduling many asynchronous calls\nat a time, and shutdown() for freeing\nresources.  The class is a context manager and can be used in a\nwith statement to assure that resources are automatically released\nwhen currently pending futures are done executing.\nA simple of example of ThreadPoolExecutor is a\nlaunch of four parallel threads for copying files:\nimport concurrent.futures, shutil\nwith concurrent.futures.ThreadPoolExecutor(max_workers=4) as e:\n    e.submit(shutil.copy, 'src1.txt', 'dest1.txt')\n    e.submit(shutil.copy, 'src2.txt', 'dest2.txt')\n    e.submit(shutil.copy, 'src3.txt', 'dest3.txt')\n    e.submit(shutil.copy, 'src4.txt', 'dest4.txt')\n\n\n\nSee also\n\nPEP 3148 - Futures – Execute Computations Asynchronously\nPEP written by Brian Quinlan.\n\nCode for Threaded Parallel URL reads, an\nexample using threads to fetch multiple web pages in parallel.\nCode for computing prime numbers in\nparallel, an example demonstrating\nProcessPoolExecutor.", "code_blocks": ["import concurrent.futures, shutil\nwith concurrent.futures.ThreadPoolExecutor(max_workers=4) as e:\n    e.submit(shutil.copy, 'src1.txt', 'dest1.txt')\n    e.submit(shutil.copy, 'src2.txt', 'dest2.txt')\n    e.submit(shutil.copy, 'src3.txt', 'dest3.txt')\n    e.submit(shutil.copy, 'src4.txt', 'dest4.txt')\n"]}, "pep-3147-pyc-repository-directories": {"text": "PEP 3147:  PYC Repository Directories\n\nPython’s scheme for caching bytecode in .pyc files did not work well in\nenvironments with multiple Python interpreters.  If one interpreter encountered\na cached file created by another interpreter, it would recompile the source and\noverwrite the cached file, thus losing the benefits of caching.\nThe issue of “pyc fights” has become more pronounced as it has become\ncommonplace for Linux distributions to ship with multiple versions of Python.\nThese conflicts also arise with CPython alternatives such as Unladen Swallow.\nTo solve this problem, Python’s import machinery has been extended to use\ndistinct filenames for each interpreter.  Instead of Python 3.2 and Python 3.3 and\nUnladen Swallow each competing for a file called “mymodule.pyc”, they will now\nlook for “mymodule.cpython-32.pyc”, “mymodule.cpython-33.pyc”, and\n“mymodule.unladen10.pyc”.  And to prevent all of these new files from\ncluttering source directories, the pyc files are now collected in a\n“__pycache__” directory stored under the package directory.\nAside from the filenames and target directories, the new scheme has a few\naspects that are visible to the programmer:\n\nImported modules now have a __cached__ attribute which stores the name\nof the actual file that was imported:\n>>> import collections\n>>> collections.__cached__\n'c:/py32/lib/__pycache__/collections.cpython-32.pyc'\n\n\n\nThe tag that is unique to each interpreter is accessible from the imp\nmodule:\n>>> import imp\n>>> imp.get_tag()\n'cpython-32'\n\n\n\nScripts that try to deduce source filename from the imported file now need to\nbe smarter.  It is no longer sufficient to simply strip the “c” from a ”.pyc”\nfilename.  Instead, use the new functions in the imp module:\n>>> imp.source_from_cache('c:/py32/lib/__pycache__/collections.cpython-32.pyc')\n'c:/py32/lib/collections.py'\n>>> imp.cache_from_source('c:/py32/lib/collections.py')\n'c:/py32/lib/__pycache__/collections.cpython-32.pyc'\n\n\n\nThe py_compile and compileall modules have been updated to\nreflect the new naming convention and target directory.  The command-line\ninvocation of compileall has new options: -i for\nspecifying a list of files and directories to compile and -b which causes\nbytecode files to be written to their legacy location rather than\n__pycache__.\n\nThe importlib.abc module has been updated with new abstract base\nclasses for loading bytecode files.  The obsolete\nABCs, PyLoader and\nPyPycLoader, have been deprecated (instructions on how\nto stay Python 3.1 compatible are included with the documentation).\n\n\n\nSee also\n\nPEP 3147 - PYC Repository Directories\nPEP written by Barry Warsaw.", "code_blocks": [">>> import collections\n>>> collections.__cached__\n'c:/py32/lib/__pycache__/collections.cpython-32.pyc'\n", ">>> import imp\n>>> imp.get_tag()\n'cpython-32'\n", ">>> imp.source_from_cache('c:/py32/lib/__pycache__/collections.cpython-32.pyc')\n'c:/py32/lib/collections.py'\n>>> imp.cache_from_source('c:/py32/lib/collections.py')\n'c:/py32/lib/__pycache__/collections.cpython-32.pyc'\n"]}, "pep-3149-abi-version-tagged-so-files": {"text": "PEP 3149: ABI Version Tagged .so Files\n\nThe PYC repository directory allows multiple bytecode cache files to be\nco-located.  This PEP implements a similar mechanism for shared object files by\ngiving them a common directory and distinct names for each version.\nThe common directory is “pyshared” and the file names are made distinct by\nidentifying the Python implementation (such as CPython, PyPy, Jython, etc.), the\nmajor and minor version numbers, and optional build flags (such as “d” for\ndebug, “m” for pymalloc, “u” for wide-unicode).  For an arbitrary package “foo”,\nyou may see these files when the distribution package is installed:\n/usr/share/pyshared/foo.cpython-32m.so\n/usr/share/pyshared/foo.cpython-33md.so\n\n\nIn Python itself, the tags are accessible from functions in the sysconfig\nmodule:\n>>> import sysconfig\n>>> sysconfig.get_config_var('SOABI')       # find the version tag\n'cpython-32mu'\n>>> sysconfig.get_config_var('EXT_SUFFIX')  # find the full filename extension\n'.cpython-32mu.so'\n\n\n\nSee also\n\nPEP 3149 - ABI Version Tagged .so Files\nPEP written by Barry Warsaw.", "code_blocks": ["/usr/share/pyshared/foo.cpython-32m.so\n/usr/share/pyshared/foo.cpython-33md.so\n", ">>> import sysconfig\n>>> sysconfig.get_config_var('SOABI')       # find the version tag\n'cpython-32mu'\n>>> sysconfig.get_config_var('EXT_SUFFIX')  # find the full filename extension\n'.cpython-32mu.so'\n"]}, "pep-3333-python-web-server-gateway-interface-v1-0-1": {"text": "PEP 3333: Python Web Server Gateway Interface v1.0.1\n\nThis informational PEP clarifies how bytes/text issues are to be handled by the\nWSGI protocol.  The challenge is that string handling in Python 3 is most\nconveniently handled with the str type even though the HTTP protocol\nis itself bytes oriented.\nThe PEP differentiates so-called native strings that are used for\nrequest/response headers and metadata versus byte strings which are used for\nthe bodies of requests and responses.\nThe native strings are always of type str but are restricted to code\npoints between U+0000 through U+00FF which are translatable to bytes using\nLatin-1 encoding.  These strings are used for the keys and values in the\nenvironment dictionary and for response headers and statuses in the\nstart_response() function.  They must follow RFC 2616 with respect to\nencoding. That is, they must either be ISO-8859-1 characters or use\nRFC 2047 MIME encoding.\nFor developers porting WSGI applications from Python 2, here are the salient\npoints:\n\nIf the app already used strings for headers in Python 2, no change is needed.\nIf instead, the app encoded output headers or decoded input headers, then the\nheaders will need to be re-encoded to Latin-1.  For example, an output header\nencoded in utf-8 was using h.encode('utf-8') now needs to convert from\nbytes to native strings using h.encode('utf-8').decode('latin-1').\nValues yielded by an application or sent using the write() method\nmust be byte strings.  The start_response() function and environ\nmust use native strings.  The two cannot be mixed.\n\nFor server implementers writing CGI-to-WSGI pathways or other CGI-style\nprotocols, the users must to be able access the environment using native strings\neven though the underlying platform may have a different convention.  To bridge\nthis gap, the wsgiref module has a new function,\nwsgiref.handlers.read_environ() for transcoding CGI variables from\nos.environ into native strings and returning a new dictionary.\n\nSee also\n\nPEP 3333 - Python Web Server Gateway Interface v1.0.1\nPEP written by Phillip Eby.", "code_blocks": []}, "other-language-changes": {"text": "Other Language Changes\n\nSome smaller changes made to the core Python language are:\n\nString formatting for format() and str.format() gained new\ncapabilities for the format character #.  Previously, for integers in\nbinary, octal, or hexadecimal, it caused the output to be prefixed with ‘0b’,\n‘0o’, or ‘0x’ respectively.  Now it can also handle floats, complex, and\nDecimal, causing the output to always have a decimal point even when no digits\nfollow it.\n>>> format(20, '#o')\n'0o24'\n>>> format(12.34, '#5.0f')\n'  12.'\n\n\n(Suggested by Mark Dickinson and implemented by Eric Smith in issue 7094.)\n\nThere is also a new str.format_map() method that extends the\ncapabilities of the existing str.format() method by accepting arbitrary\nmapping objects.  This new method makes it possible to use string\nformatting with any of Python’s many dictionary-like objects such as\ndefaultdict, Shelf,\nConfigParser, or dbm.  It is also useful with\ncustom dict subclasses that normalize keys before look-up or that\nsupply a __missing__() method for unknown keys:\n>>> import shelve\n>>> d = shelve.open('tmp.shl')\n>>> 'The {project_name} status is {status} as of {date}'.format_map(d)\n'The testing project status is green as of February 15, 2011'\n\n>>> class LowerCasedDict(dict):\n        def __getitem__(self, key):\n            return dict.__getitem__(self, key.lower())\n>>> lcd = LowerCasedDict(part='widgets', quantity=10)\n>>> 'There are {QUANTITY} {Part} in stock'.format_map(lcd)\n'There are 10 widgets in stock'\n\n>>> class PlaceholderDict(dict):\n        def __missing__(self, key):\n            return '<{}>'.format(key)\n>>> 'Hello {name}, welcome to {location}'.format_map(PlaceholderDict())\n'Hello <name>, welcome to <location>'\n\n\n\n\n\n(Suggested by Raymond Hettinger and implemented by Eric Smith in\nissue 6081.)\n\nThe interpreter can now be started with a quiet option, -q, to prevent\nthe copyright and version information from being displayed in the interactive\nmode.  The option can be introspected using the sys.flags attribute:\n$ python -q\n>>> sys.flags\nsys.flags(debug=0, division_warning=0, inspect=0, interactive=0,\noptimize=0, dont_write_bytecode=0, no_user_site=0, no_site=0,\nignore_environment=0, verbose=0, bytes_warning=0, quiet=1)\n\n(Contributed by Marcin Wojdyr in issue 1772833).\n\nThe hasattr() function works by calling getattr() and detecting\nwhether an exception is raised.  This technique allows it to detect methods\ncreated dynamically by __getattr__() or __getattribute__() which\nwould otherwise be absent from the class dictionary.  Formerly, hasattr\nwould catch any exception, possibly masking genuine errors.  Now, hasattr\nhas been tightened to only catch AttributeError and let other\nexceptions pass through:\n>>> class A:\n        @property\n        def f(self):\n            return 1 // 0\n\n>>> a = A()\n>>> hasattr(a, 'f')\nTraceback (most recent call last):\n  ...\nZeroDivisionError: integer division or modulo by zero\n\n\n(Discovered by Yury Selivanov and fixed by Benjamin Peterson; issue 9666.)\n\nThe str() of a float or complex number is now the same as its\nrepr(). Previously, the str() form was shorter but that just\ncaused confusion and is no longer needed now that the shortest possible\nrepr() is displayed by default:\n>>> import math\n>>> repr(math.pi)\n'3.141592653589793'\n>>> str(math.pi)\n'3.141592653589793'\n\n\n(Proposed and implemented by Mark Dickinson; issue 9337.)\n\nmemoryview objects now have a release() method\nand they also now support the context manager protocol.  This allows timely\nrelease of any resources that were acquired when requesting a buffer from the\noriginal object.\n>>> with memoryview(b'abcdefgh') as v:\n        print(v.tolist())\n[97, 98, 99, 100, 101, 102, 103, 104]\n\n\n(Added by Antoine Pitrou; issue 9757.)\n\nPreviously it was illegal to delete a name from the local namespace if it\noccurs as a free variable in a nested block:\ndef outer(x):\n    def inner():\n       return x\n    inner()\n    del x\n\n\nThis is now allowed.  Remember that the target of an except clause\nis cleared, so this code which used to work with Python 2.6, raised a\nSyntaxError with Python 3.1 and now works again:\ndef f():\n    def print_error():\n       print(e)\n    try:\n       something\n    except Exception as e:\n       print_error()\n       # implicit \"del e\" here\n\n\n(See issue 4617.)\n\nThe internal structsequence tool now creates subclasses of tuple.\nThis means that C structures like those returned by os.stat(),\ntime.gmtime(), and sys.version_info now work like a\nnamed tuple and now work with functions and methods that\nexpect a tuple as an argument.  This is a big step forward in making the C\nstructures as flexible as their pure Python counterparts:\n>>> isinstance(sys.version_info, tuple)\nTrue\n>>> 'Version %d.%d.%d %s(%d)' % sys.version_info\n'Version 3.2.0 final(0)'\n\n\n(Suggested by Arfrever Frehtes Taifersar Arahesis and implemented\nby Benjamin Peterson in issue 8413.)\n\nWarnings are now easier to control using the PYTHONWARNINGS\nenvironment variable as an alternative to using -W at the command line:\n$ export PYTHONWARNINGS='ignore::RuntimeWarning::,once::UnicodeWarning::'\n\n(Suggested by Barry Warsaw and implemented by Philip Jenvey in issue 7301.)\n\nA new warning category, ResourceWarning, has been added.  It is\nemitted when potential issues with resource consumption or cleanup\nare detected.  It is silenced by default in normal release builds but\ncan be enabled through the means provided by the warnings\nmodule, or on the command line.\nA ResourceWarning is issued at interpreter shutdown if the\ngc.garbage list isn’t empty, and if gc.DEBUG_UNCOLLECTABLE is\nset, all uncollectable objects are printed.  This is meant to make the\nprogrammer aware that their code contains object finalization issues.\nA ResourceWarning is also issued when a file object is destroyed\nwithout having been explicitly closed.  While the deallocator for such\nobject ensures it closes the underlying operating system resource\n(usually, a file descriptor), the delay in deallocating the object could\nproduce various issues, especially under Windows.  Here is an example\nof enabling the warning from the command line:\n$ python -q -Wdefault\n>>> f = open(\"foo\", \"wb\")\n>>> del f\n__main__:1: ResourceWarning: unclosed file <_io.BufferedWriter name='foo'>\n\n(Added by Antoine Pitrou and Georg Brandl in issue 10093 and issue 477863.)\n\nrange objects now support index and count methods. This is part\nof an effort to make more objects fully implement the\ncollections.Sequence abstract base class.  As a result, the\nlanguage will have a more uniform API.  In addition, range objects\nnow support slicing and negative indices, even with values larger than\nsys.maxsize.  This makes range more interoperable with lists:\n>>> range(0, 100, 2).count(10)\n1\n>>> range(0, 100, 2).index(10)\n5\n>>> range(0, 100, 2)[5]\n10\n>>> range(0, 100, 2)[0:5]\nrange(0, 10, 2)\n\n\n(Contributed by Daniel Stutzbach in issue 9213, by Alexander Belopolsky\nin issue 2690, and by Nick Coghlan in issue 10889.)\n\nThe callable() builtin function from Py2.x was resurrected.  It provides\na concise, readable alternative to using an abstract base class in an\nexpression like isinstance(x, collections.Callable):\n>>> callable(max)\nTrue\n>>> callable(20)\nFalse\n\n\n(See issue 10518.)\n\nPython’s import mechanism can now load modules installed in directories with\nnon-ASCII characters in the path name.  This solved an aggravating problem\nwith home directories for users with non-ASCII characters in their usernames.\n\n\n\n(Required extensive work by Victor Stinner in issue 9425.)", "code_blocks": [">>> format(20, '#o')\n'0o24'\n>>> format(12.34, '#5.0f')\n'  12.'\n", ">>> import shelve\n>>> d = shelve.open('tmp.shl')\n>>> 'The {project_name} status is {status} as of {date}'.format_map(d)\n'The testing project status is green as of February 15, 2011'\n\n>>> class LowerCasedDict(dict):\n        def __getitem__(self, key):\n            return dict.__getitem__(self, key.lower())\n>>> lcd = LowerCasedDict(part='widgets', quantity=10)\n>>> 'There are {QUANTITY} {Part} in stock'.format_map(lcd)\n'There are 10 widgets in stock'\n\n>>> class PlaceholderDict(dict):\n        def __missing__(self, key):\n            return '<{}>'.format(key)\n>>> 'Hello {name}, welcome to {location}'.format_map(PlaceholderDict())\n'Hello <name>, welcome to <location>'\n", ">>> class A:\n        @property\n        def f(self):\n            return 1 // 0\n\n>>> a = A()\n>>> hasattr(a, 'f')\nTraceback (most recent call last):\n  ...\nZeroDivisionError: integer division or modulo by zero\n", ">>> import math\n>>> repr(math.pi)\n'3.141592653589793'\n>>> str(math.pi)\n'3.141592653589793'\n", ">>> with memoryview(b'abcdefgh') as v:\n        print(v.tolist())\n[97, 98, 99, 100, 101, 102, 103, 104]\n", "def outer(x):\n    def inner():\n       return x\n    inner()\n    del x\n", "def f():\n    def print_error():\n       print(e)\n    try:\n       something\n    except Exception as e:\n       print_error()\n       # implicit \"del e\" here\n", ">>> isinstance(sys.version_info, tuple)\nTrue\n>>> 'Version %d.%d.%d %s(%d)' % sys.version_info\n'Version 3.2.0 final(0)'\n", ">>> range(0, 100, 2).count(10)\n1\n>>> range(0, 100, 2).index(10)\n5\n>>> range(0, 100, 2)[5]\n10\n>>> range(0, 100, 2)[0:5]\nrange(0, 10, 2)\n", ">>> callable(max)\nTrue\n>>> callable(20)\nFalse\n"]}, "new-improved-and-deprecated-modules - email": {"text": "email\n\nThe usability of the email package in Python 3 has been mostly fixed by\nthe extensive efforts of R. David Murray.  The problem was that emails are\ntypically read and stored in the form of bytes rather than str\ntext, and they may contain multiple encodings within a single email.  So, the\nemail package had to be extended to parse and generate email messages in bytes\nformat.\n\nNew functions message_from_bytes() and\nmessage_from_binary_file(), and new classes\nBytesFeedParser and BytesParser\nallow binary message data to be parsed into model objects.\n\nGiven bytes input to the model, get_payload()\nwill by default decode a message body that has a\nContent-Transfer-Encoding of 8bit using the charset\nspecified in the MIME headers and return the resulting string.\n\nGiven bytes input to the model, Generator will\nconvert message bodies that have a Content-Transfer-Encoding of\n8bit to instead have a 7bit Content-Transfer-Encoding.\nHeaders with unencoded non-ASCII bytes are deemed to be RFC 2047-encoded\nusing the unknown-8bit character set.\n\nA new class BytesGenerator produces bytes as output,\npreserving any unchanged non-ASCII data that was present in the input used to\nbuild the model, including message bodies with a\nContent-Transfer-Encoding of 8bit.\n\nThe smtplib SMTP class now accepts a byte string\nfor the msg argument to the sendmail() method,\nand a new method, send_message() accepts a\nMessage object and can optionally obtain the\nfrom_addr and to_addrs addresses directly from the object.\n\n\n(Proposed and implemented by R. David Murray, issue 4661 and issue 10321.)", "code_blocks": []}, "new-improved-and-deprecated-modules - elementtree": {"text": "elementtree\n\nThe xml.etree.ElementTree package and its xml.etree.cElementTree\ncounterpart have been updated to version 1.3.\nSeveral new and useful functions and methods have been added:\n\nxml.etree.ElementTree.fromstringlist() which builds an XML document\nfrom a sequence of fragments\nxml.etree.ElementTree.register_namespace() for registering a global\nnamespace prefix\nxml.etree.ElementTree.tostringlist() for string representation\nincluding all sublists\nxml.etree.ElementTree.Element.extend() for appending a sequence of zero\nor more elements\nxml.etree.ElementTree.Element.iterfind() searches an element and\nsubelements\nxml.etree.ElementTree.Element.itertext() creates a text iterator over\nan element and its subelements\nxml.etree.ElementTree.TreeBuilder.end() closes the current element\nxml.etree.ElementTree.TreeBuilder.doctype() handles a doctype\ndeclaration\n\nTwo methods have been deprecated:\n\nxml.etree.ElementTree.getchildren() use list(elem) instead.\nxml.etree.ElementTree.getiterator() use Element.iter instead.\n\nFor details of the update, see Introducing ElementTree on Fredrik Lundh’s website.\n(Contributed by Florent Xicluna and Fredrik Lundh, issue 6472.)", "code_blocks": []}, "new-improved-and-deprecated-modules - functools": {"text": "functools\n\n\nThe functools module includes a new decorator for caching function\ncalls.  functools.lru_cache() can save repeated queries to an external\nresource whenever the results are expected to be the same.\nFor example, adding a caching decorator to a database query function can save\ndatabase accesses for popular searches:\n>>> import functools\n>>> @functools.lru_cache(maxsize=300)\n>>> def get_phone_number(name):\n        c = conn.cursor()\n        c.execute('SELECT phonenumber FROM phonelist WHERE name=?', (name,))\n        return c.fetchone()[0]\n\n\n>>> for name in user_requests:\n        get_phone_number(name)        # cached lookup\n\n\nTo help with choosing an effective cache size, the wrapped function is\ninstrumented for tracking cache statistics:\n>>> get_phone_number.cache_info()\nCacheInfo(hits=4805, misses=980, maxsize=300, currsize=300)\n\n\nIf the phonelist table gets updated, the outdated contents of the cache can be\ncleared with:\n>>> get_phone_number.cache_clear()\n\n\n(Contributed by Raymond Hettinger and incorporating design ideas from Jim\nBaker, Miki Tebeka, and Nick Coghlan; see recipe 498245, recipe 577479, issue 10586, and\nissue 10593.)\n\nThe functools.wraps() decorator now adds a __wrapped__ attribute\npointing to the original callable function.  This allows wrapped functions to\nbe introspected.  It also copies __annotations__ if defined.  And now\nit also gracefully skips over missing attributes such as __doc__ which\nmight not be defined for the wrapped callable.\nIn the above example, the cache can be removed by recovering the original\nfunction:\n>>> get_phone_number = get_phone_number.__wrapped__    # uncached function\n\n\n(By Nick Coghlan and Terrence Cole; issue 9567, issue 3445, and\nissue 8814.)\n\nTo help write classes with rich comparison methods, a new decorator\nfunctools.total_ordering() will use a existing equality and inequality\nmethods to fill in the remaining methods.\nFor example, supplying __eq__ and __lt__ will enable\ntotal_ordering() to fill-in __le__, __gt__ and __ge__:\n@total_ordering\nclass Student:\n    def __eq__(self, other):\n        return ((self.lastname.lower(), self.firstname.lower()) ==\n                (other.lastname.lower(), other.firstname.lower()))\n    def __lt__(self, other):\n        return ((self.lastname.lower(), self.firstname.lower()) <\n                (other.lastname.lower(), other.firstname.lower()))\n\n\nWith the total_ordering decorator, the remaining comparison methods\nare filled in automatically.\n(Contributed by Raymond Hettinger.)\n\nTo aid in porting programs from Python 2, the functools.cmp_to_key()\nfunction converts an old-style comparison function to\nmodern key function:\n>>> # locale-aware sort order\n>>> sorted(iterable, key=cmp_to_key(locale.strcoll))\n\n\nFor sorting examples and a brief sorting tutorial, see the Sorting HowTo tutorial.\n(Contributed by Raymond Hettinger.)", "code_blocks": [">>> import functools\n>>> @functools.lru_cache(maxsize=300)\n>>> def get_phone_number(name):\n        c = conn.cursor()\n        c.execute('SELECT phonenumber FROM phonelist WHERE name=?', (name,))\n        return c.fetchone()[0]\n", ">>> for name in user_requests:\n        get_phone_number(name)        # cached lookup\n", ">>> get_phone_number.cache_info()\nCacheInfo(hits=4805, misses=980, maxsize=300, currsize=300)\n", ">>> get_phone_number.cache_clear()\n", ">>> get_phone_number = get_phone_number.__wrapped__    # uncached function\n", "@total_ordering\nclass Student:\n    def __eq__(self, other):\n        return ((self.lastname.lower(), self.firstname.lower()) ==\n                (other.lastname.lower(), other.firstname.lower()))\n    def __lt__(self, other):\n        return ((self.lastname.lower(), self.firstname.lower()) <\n                (other.lastname.lower(), other.firstname.lower()))\n", ">>> # locale-aware sort order\n>>> sorted(iterable, key=cmp_to_key(locale.strcoll))\n"]}, "new-improved-and-deprecated-modules - itertools": {"text": "itertools\n\n\nThe itertools module has a new accumulate() function\nmodeled on APL’s scan operator and Numpy’s accumulate function:\n>>> from itertools import accumulate\n>>> list(accumulate([8, 2, 50]))\n[8, 10, 60]\n\n\n>>> prob_dist = [0.1, 0.4, 0.2, 0.3]\n>>> list(accumulate(prob_dist))      # cumulative probability distribution\n[0.1, 0.5, 0.7, 1.0]\n\n\nFor an example using accumulate(), see the examples for\nthe random module.\n(Contributed by Raymond Hettinger and incorporating design suggestions\nfrom Mark Dickinson.)", "code_blocks": [">>> from itertools import accumulate\n>>> list(accumulate([8, 2, 50]))\n[8, 10, 60]\n", ">>> prob_dist = [0.1, 0.4, 0.2, 0.3]\n>>> list(accumulate(prob_dist))      # cumulative probability distribution\n[0.1, 0.5, 0.7, 1.0]\n"]}, "new-improved-and-deprecated-modules - collections": {"text": "collections\n\n\nThe collections.Counter class now has two forms of in-place\nsubtraction, the existing -= operator for saturating subtraction and the new\nsubtract() method for regular subtraction.  The\nformer is suitable for multisets\nwhich only have positive counts, and the latter is more suitable for use cases\nthat allow negative counts:\n>>> tally = Counter(dogs=5, cat=3)\n>>> tally -= Counter(dogs=2, cats=8)    # saturating subtraction\n>>> tally\nCounter({'dogs': 3})\n\n\n>>> tally = Counter(dogs=5, cats=3)\n>>> tally.subtract(dogs=2, cats=8)      # regular subtraction\n>>> tally\nCounter({'dogs': 3, 'cats': -5})\n\n\n(Contributed by Raymond Hettinger.)\n\nThe collections.OrderedDict class has a new method\nmove_to_end() which takes an existing key and\nmoves it to either the first or last position in the ordered sequence.\nThe default is to move an item to the last position.  This is equivalent of\nrenewing an entry with od[k] = od.pop(k).\nA fast move-to-end operation is useful for resequencing entries.  For example,\nan ordered dictionary can be used to track order of access by aging entries\nfrom the oldest to the most recently accessed.\n>>> d = OrderedDict.fromkeys(['a', 'b', 'X', 'd', 'e'])\n>>> list(d)\n['a', 'b', 'X', 'd', 'e']\n>>> d.move_to_end('X')\n>>> list(d)\n['a', 'b', 'd', 'e', 'X']\n\n\n(Contributed by Raymond Hettinger.)\n\nThe collections.deque class grew two new methods\ncount() and reverse() that\nmake them more substitutable for list objects:\n>>> d = deque('simsalabim')\n>>> d.count('s')\n2\n>>> d.reverse()\n>>> d\ndeque(['m', 'i', 'b', 'a', 'l', 'a', 's', 'm', 'i', 's'])\n\n\n(Contributed by Raymond Hettinger.)", "code_blocks": [">>> tally = Counter(dogs=5, cat=3)\n>>> tally -= Counter(dogs=2, cats=8)    # saturating subtraction\n>>> tally\nCounter({'dogs': 3})\n", ">>> tally = Counter(dogs=5, cats=3)\n>>> tally.subtract(dogs=2, cats=8)      # regular subtraction\n>>> tally\nCounter({'dogs': 3, 'cats': -5})\n", ">>> d = OrderedDict.fromkeys(['a', 'b', 'X', 'd', 'e'])\n>>> list(d)\n['a', 'b', 'X', 'd', 'e']\n>>> d.move_to_end('X')\n>>> list(d)\n['a', 'b', 'd', 'e', 'X']\n", ">>> d = deque('simsalabim')\n>>> d.count('s')\n2\n>>> d.reverse()\n>>> d\ndeque(['m', 'i', 'b', 'a', 'l', 'a', 's', 'm', 'i', 's'])\n"]}, "new-improved-and-deprecated-modules - threading": {"text": "threading\n\nThe threading module has a new Barrier\nsynchronization class for making multiple threads wait until all of them have\nreached a common barrier point.  Barriers are useful for making sure that a task\nwith multiple preconditions does not run until all of the predecessor tasks are\ncomplete.\nBarriers can work with an arbitrary number of threads.  This is a generalization\nof a Rendezvous which\nis defined for only two threads.\nImplemented as a two-phase cyclic barrier, Barrier objects\nare suitable for use in loops.  The separate filling and draining phases\nassure that all threads get released (drained) before any one of them can loop\nback and re-enter the barrier.  The barrier fully resets after each cycle.\nExample of using barriers:\nfrom threading import Barrier, Thread\n\ndef get_votes(site):\n    ballots = conduct_election(site)\n    all_polls_closed.wait()        # do not count until all polls are closed\n    totals = summarize(ballots)\n    publish(site, totals)\n\nall_polls_closed = Barrier(len(sites))\nfor site in sites:\n    Thread(target=get_votes, args=(site,)).start()\n\n\nIn this example, the barrier enforces a rule that votes cannot be counted at any\npolling site until all polls are closed.  Notice how a solution with a barrier\nis similar to one with threading.Thread.join(), but the threads stay alive\nand continue to do work (summarizing ballots) after the barrier point is\ncrossed.\nIf any of the predecessor tasks can hang or be delayed, a barrier can be created\nwith an optional timeout parameter.  Then if the timeout period elapses before\nall the predecessor tasks reach the barrier point, all waiting threads are\nreleased and a BrokenBarrierError exception is raised:\ndef get_votes(site):\n    ballots = conduct_election(site)\n    try:\n        all_polls_closed.wait(timeout = midnight - time.now())\n    except BrokenBarrierError:\n        lockbox = seal_ballots(ballots)\n        queue.put(lockbox)\n    else:\n        totals = summarize(ballots)\n        publish(site, totals)\n\n\nIn this example, the barrier enforces a more robust rule.  If some election\nsites do not finish before midnight, the barrier times-out and the ballots are\nsealed and deposited in a queue for later handling.\nSee Barrier Synchronization Patterns for\nmore examples of how barriers can be used in parallel computing.  Also, there is\na simple but thorough explanation of barriers in The Little Book of Semaphores, section 3.6.\n(Contributed by Kristján Valur Jónsson with an API review by Jeffrey Yasskin in\nissue 8777.)", "code_blocks": ["from threading import Barrier, Thread\n\ndef get_votes(site):\n    ballots = conduct_election(site)\n    all_polls_closed.wait()        # do not count until all polls are closed\n    totals = summarize(ballots)\n    publish(site, totals)\n\nall_polls_closed = Barrier(len(sites))\nfor site in sites:\n    Thread(target=get_votes, args=(site,)).start()\n", "def get_votes(site):\n    ballots = conduct_election(site)\n    try:\n        all_polls_closed.wait(timeout = midnight - time.now())\n    except BrokenBarrierError:\n        lockbox = seal_ballots(ballots)\n        queue.put(lockbox)\n    else:\n        totals = summarize(ballots)\n        publish(site, totals)\n"]}, "new-improved-and-deprecated-modules - datetime-and-time": {"text": "datetime and time\n\n\nThe datetime module has a new type timezone that\nimplements the tzinfo interface by returning a fixed UTC\noffset and timezone name. This makes it easier to create timezone-aware\ndatetime objects:\n>>> from datetime import datetime, timezone\n\n>>> datetime.now(timezone.utc)\ndatetime.datetime(2010, 12, 8, 21, 4, 2, 923754, tzinfo=datetime.timezone.utc)\n\n>>> datetime.strptime(\"01/01/2000 12:00 +0000\", \"%m/%d/%Y %H:%M %z\")\ndatetime.datetime(2000, 1, 1, 12, 0, tzinfo=datetime.timezone.utc)\n\n\n\nAlso, timedelta objects can now be multiplied by\nfloat and divided by float and int objects.\nAnd timedelta objects can now divide one another.\n\nThe datetime.date.strftime() method is no longer restricted to years\nafter 1900.  The new supported year range is from 1000 to 9999 inclusive.\n\nWhenever a two-digit year is used in a time tuple, the interpretation has been\ngoverned by time.accept2dyear.  The default is True which means that\nfor a two-digit year, the century is guessed according to the POSIX rules\ngoverning the %y strptime format.\nStarting with Py3.2, use of the century guessing heuristic will emit a\nDeprecationWarning.  Instead, it is recommended that\ntime.accept2dyear be set to False so that large date ranges\ncan be used without guesswork:\n>>> import time, warnings\n>>> warnings.resetwarnings()      # remove the default warning filters\n\n>>> time.accept2dyear = True      # guess whether 11 means 11 or 2011\n>>> time.asctime((11, 1, 1, 12, 34, 56, 4, 1, 0))\nWarning (from warnings module):\n  ...\nDeprecationWarning: Century info guessed for a 2-digit year.\n'Fri Jan  1 12:34:56 2011'\n\n>>> time.accept2dyear = False     # use the full range of allowable dates\n>>> time.asctime((11, 1, 1, 12, 34, 56, 4, 1, 0))\n'Fri Jan  1 12:34:56 11'\n\n\nSeveral functions now have significantly expanded date ranges.  When\ntime.accept2dyear is false, the time.asctime() function will\naccept any year that fits in a C int, while the time.mktime() and\ntime.strftime() functions will accept the full range supported by the\ncorresponding operating system functions.\n\n\n(Contributed by Alexander Belopolsky and Victor Stinner in issue 1289118,\nissue 5094, issue 6641, issue 2706, issue 1777412, issue 8013,\nand issue 10827.)", "code_blocks": [">>> from datetime import datetime, timezone\n\n>>> datetime.now(timezone.utc)\ndatetime.datetime(2010, 12, 8, 21, 4, 2, 923754, tzinfo=datetime.timezone.utc)\n\n>>> datetime.strptime(\"01/01/2000 12:00 +0000\", \"%m/%d/%Y %H:%M %z\")\ndatetime.datetime(2000, 1, 1, 12, 0, tzinfo=datetime.timezone.utc)\n", ">>> import time, warnings\n>>> warnings.resetwarnings()      # remove the default warning filters\n\n>>> time.accept2dyear = True      # guess whether 11 means 11 or 2011\n>>> time.asctime((11, 1, 1, 12, 34, 56, 4, 1, 0))\nWarning (from warnings module):\n  ...\nDeprecationWarning: Century info guessed for a 2-digit year.\n'Fri Jan  1 12:34:56 2011'\n\n>>> time.accept2dyear = False     # use the full range of allowable dates\n>>> time.asctime((11, 1, 1, 12, 34, 56, 4, 1, 0))\n'Fri Jan  1 12:34:56 11'\n"]}, "new-improved-and-deprecated-modules - math": {"text": "math\n\nThe math module has been updated with six new functions inspired by the\nC99 standard.\nThe isfinite() function provides a reliable and fast way to detect\nspecial values.  It returns True for regular numbers and False for Nan or\nInfinity:\n>>> [isfinite(x) for x in (123, 4.56, float('Nan'), float('Inf'))]\n[True, True, False, False]\n\n\nThe expm1() function computes e**x-1 for small values of x\nwithout incurring the loss of precision that usually accompanies the subtraction\nof nearly equal quantities:\n>>> expm1(0.013671875)   # more accurate way to compute e**x-1 for a small x\n0.013765762467652909\n\n\nThe erf() function computes a probability integral or Gaussian\nerror function.  The\ncomplementary error function, erfc(), is 1 - erf(x):\n>>> erf(1.0/sqrt(2.0))   # portion of normal distribution within 1 standard deviation\n0.682689492137086\n>>> erfc(1.0/sqrt(2.0))  # portion of normal distribution outside 1 standard deviation\n0.31731050786291404\n>>> erf(1.0/sqrt(2.0)) + erfc(1.0/sqrt(2.0))\n1.0\n\n\nThe gamma() function is a continuous extension of the factorial\nfunction.  See http://en.wikipedia.org/wiki/Gamma_function for details.  Because\nthe function is related to factorials, it grows large even for small values of\nx, so there is also a lgamma() function for computing the natural\nlogarithm of the gamma function:\n>>> gamma(7.0)           # six factorial\n720.0\n>>> lgamma(801.0)        # log(800 factorial)\n4551.950730698041\n\n\n(Contributed by Mark Dickinson.)", "code_blocks": [">>> [isfinite(x) for x in (123, 4.56, float('Nan'), float('Inf'))]\n[True, True, False, False]\n", ">>> expm1(0.013671875)   # more accurate way to compute e**x-1 for a small x\n0.013765762467652909\n", ">>> erf(1.0/sqrt(2.0))   # portion of normal distribution within 1 standard deviation\n0.682689492137086\n>>> erfc(1.0/sqrt(2.0))  # portion of normal distribution outside 1 standard deviation\n0.31731050786291404\n>>> erf(1.0/sqrt(2.0)) + erfc(1.0/sqrt(2.0))\n1.0\n", ">>> gamma(7.0)           # six factorial\n720.0\n>>> lgamma(801.0)        # log(800 factorial)\n4551.950730698041\n"]}, "new-improved-and-deprecated-modules - abc": {"text": "abc\n\nThe abc module now supports abstractclassmethod() and\nabstractstaticmethod().\nThese tools make it possible to define an abstract base class that\nrequires a particular classmethod() or staticmethod() to be\nimplemented:\nclass Temperature(metaclass=abc.ABCMeta):\n    @abc.abstractclassmethod\n    def from_fahrenheit(cls, t):\n        ...\n    @abc.abstractclassmethod\n    def from_celsius(cls, t):\n        ...\n\n\n(Patch submitted by Daniel Urban; issue 5867.)", "code_blocks": ["class Temperature(metaclass=abc.ABCMeta):\n    @abc.abstractclassmethod\n    def from_fahrenheit(cls, t):\n        ...\n    @abc.abstractclassmethod\n    def from_celsius(cls, t):\n        ...\n"]}, "new-improved-and-deprecated-modules - io": {"text": "io\n\nThe io.BytesIO has a new method, getbuffer(), which\nprovides functionality similar to memoryview().  It creates an editable\nview of the data without making a copy.  The buffer’s random access and support\nfor slice notation are well-suited to in-place editing:\n>>> REC_LEN, LOC_START, LOC_LEN = 34, 7, 11\n\n>>> def change_location(buffer, record_number, location):\n        start = record_number * REC_LEN + LOC_START\n        buffer[start: start+LOC_LEN] = location\n\n>>> import io\n\n>>> byte_stream = io.BytesIO(\n    b'G3805  storeroom  Main chassis    '\n    b'X7899  shipping   Reserve cog     '\n    b'L6988  receiving  Primary sprocket'\n)\n>>> buffer = byte_stream.getbuffer()\n>>> change_location(buffer, 1, b'warehouse  ')\n>>> change_location(buffer, 0, b'showroom   ')\n>>> print(byte_stream.getvalue())\nb'G3805  showroom   Main chassis    '\nb'X7899  warehouse  Reserve cog     '\nb'L6988  receiving  Primary sprocket'\n\n\n(Contributed by Antoine Pitrou in issue 5506.)", "code_blocks": [">>> REC_LEN, LOC_START, LOC_LEN = 34, 7, 11\n\n>>> def change_location(buffer, record_number, location):\n        start = record_number * REC_LEN + LOC_START\n        buffer[start: start+LOC_LEN] = location\n\n>>> import io\n\n>>> byte_stream = io.BytesIO(\n    b'G3805  storeroom  Main chassis    '\n    b'X7899  shipping   Reserve cog     '\n    b'L6988  receiving  Primary sprocket'\n)\n>>> buffer = byte_stream.getbuffer()\n>>> change_location(buffer, 1, b'warehouse  ')\n>>> change_location(buffer, 0, b'showroom   ')\n>>> print(byte_stream.getvalue())\nb'G3805  showroom   Main chassis    '\nb'X7899  warehouse  Reserve cog     '\nb'L6988  receiving  Primary sprocket'\n"]}, "new-improved-and-deprecated-modules - reprlib": {"text": "reprlib\n\nWhen writing a __repr__() method for a custom container, it is easy to\nforget to handle the case where a member refers back to the container itself.\nPython’s builtin objects such as list and set handle\nself-reference by displaying ”...” in the recursive part of the representation\nstring.\nTo help write such __repr__() methods, the reprlib module has a new\ndecorator, recursive_repr(), for detecting recursive calls to\n__repr__() and substituting a placeholder string instead:\n>>> class MyList(list):\n        @recursive_repr()\n        def __repr__(self):\n            return '<' + '|'.join(map(repr, self)) + '>'\n\n>>> m = MyList('abc')\n>>> m.append(m)\n>>> m.append('x')\n>>> print(m)\n<'a'|'b'|'c'|...|'x'>\n\n\n(Contributed by Raymond Hettinger in issue 9826 and issue 9840.)", "code_blocks": [">>> class MyList(list):\n        @recursive_repr()\n        def __repr__(self):\n            return '<' + '|'.join(map(repr, self)) + '>'\n\n>>> m = MyList('abc')\n>>> m.append(m)\n>>> m.append('x')\n>>> print(m)\n<'a'|'b'|'c'|...|'x'>\n"]}, "new-improved-and-deprecated-modules - logging": {"text": "logging\n\nIn addition to dictionary-based configuration described above, the\nlogging package has many other improvements.\nThe logging documentation has been augmented by a basic tutorial, an advanced tutorial, and a cookbook of\nlogging recipes.  These documents are the fastest way to learn about logging.\nThe logging.basicConfig() set-up function gained a style argument to\nsupport three different types of string formatting.  It defaults to “%” for\ntraditional %-formatting, can be set to “{” for the new str.format() style, or\ncan be set to “$” for the shell-style formatting provided by\nstring.Template.  The following three configurations are equivalent:\n>>> from logging import basicConfig\n>>> basicConfig(style='%', format=\"%(name)s -> %(levelname)s: %(message)s\")\n>>> basicConfig(style='{', format=\"{name} -> {levelname} {message}\")\n>>> basicConfig(style='$', format=\"$name -> $levelname: $message\")\n\n\nIf no configuration is set-up before a logging event occurs, there is now a\ndefault configuration using a StreamHandler directed to\nsys.stderr for events of WARNING level or higher.  Formerly, an\nevent occurring before a configuration was set-up would either raise an\nexception or silently drop the event depending on the value of\nlogging.raiseExceptions.  The new default handler is stored in\nlogging.lastResort.\nThe use of filters has been simplified.  Instead of creating a\nFilter object, the predicate can be any Python callable that\nreturns True or False.\nThere were a number of other improvements that add flexibility and simplify\nconfiguration.  See the module documentation for a full listing of changes in\nPython 3.2.", "code_blocks": [">>> from logging import basicConfig\n>>> basicConfig(style='%', format=\"%(name)s -> %(levelname)s: %(message)s\")\n>>> basicConfig(style='{', format=\"{name} -> {levelname} {message}\")\n>>> basicConfig(style='$', format=\"$name -> $levelname: $message\")\n"]}, "new-improved-and-deprecated-modules - csv": {"text": "csv\n\nThe csv module now supports a new dialect, unix_dialect,\nwhich applies quoting for all fields and a traditional Unix style with '\\n' as\nthe line terminator.  The registered dialect name is unix.\nThe csv.DictWriter has a new method,\nwriteheader() for writing-out an initial row to document\nthe field names:\n>>> import csv, sys\n>>> w = csv.DictWriter(sys.stdout, ['name', 'dept'], dialect='unix')\n>>> w.writeheader()\n\"name\",\"dept\"\n>>> w.writerows([\n        {'name': 'tom', 'dept': 'accounting'},\n        {'name': 'susan', 'dept': 'Salesl'}])\n\"tom\",\"accounting\"\n\"susan\",\"sales\"\n\n\n(New dialect suggested by Jay Talbot in issue 5975, and the new method\nsuggested by Ed Abraham in issue 1537721.)", "code_blocks": [">>> import csv, sys\n>>> w = csv.DictWriter(sys.stdout, ['name', 'dept'], dialect='unix')\n>>> w.writeheader()\n\"name\",\"dept\"\n>>> w.writerows([\n        {'name': 'tom', 'dept': 'accounting'},\n        {'name': 'susan', 'dept': 'Salesl'}])\n\"tom\",\"accounting\"\n\"susan\",\"sales\"\n"]}, "new-improved-and-deprecated-modules - contextlib": {"text": "contextlib\n\nThere is a new and slightly mind-blowing tool\nContextDecorator that is helpful for creating a\ncontext manager that does double duty as a function decorator.\nAs a convenience, this new functionality is used by\ncontextmanager() so that no extra effort is needed to support\nboth roles.\nThe basic idea is that both context managers and function decorators can be used\nfor pre-action and post-action wrappers.  Context managers wrap a group of\nstatements using a with statement, and function decorators wrap a\ngroup of statements enclosed in a function.  So, occasionally there is a need to\nwrite a pre-action or post-action wrapper that can be used in either role.\nFor example, it is sometimes useful to wrap functions or groups of statements\nwith a logger that can track the time of entry and time of exit.  Rather than\nwriting both a function decorator and a context manager for the task, the\ncontextmanager() provides both capabilities in a single\ndefinition:\nfrom contextlib import contextmanager\nimport logging\n\nlogging.basicConfig(level=logging.INFO)\n\n@contextmanager\ndef track_entry_and_exit(name):\n    logging.info('Entering: {}'.format(name))\n    yield\n    logging.info('Exiting: {}'.format(name))\n\n\nFormerly, this would have only been usable as a context manager:\nwith track_entry_and_exit('widget loader'):\n    print('Some time consuming activity goes here')\n    load_widget()\n\n\nNow, it can be used as a decorator as well:\n@track_entry_and_exit('widget loader')\ndef activity():\n    print('Some time consuming activity goes here')\n    load_widget()\n\n\nTrying to fulfill two roles at once places some limitations on the technique.\nContext managers normally have the flexibility to return an argument usable by\na with statement, but there is no parallel for function decorators.\nIn the above example, there is not a clean way for the track_entry_and_exit\ncontext manager to return a logging instance for use in the body of enclosed\nstatements.\n(Contributed by Michael Foord in issue 9110.)", "code_blocks": ["from contextlib import contextmanager\nimport logging\n\nlogging.basicConfig(level=logging.INFO)\n\n@contextmanager\ndef track_entry_and_exit(name):\n    logging.info('Entering: {}'.format(name))\n    yield\n    logging.info('Exiting: {}'.format(name))\n", "with track_entry_and_exit('widget loader'):\n    print('Some time consuming activity goes here')\n    load_widget()\n", "@track_entry_and_exit('widget loader')\ndef activity():\n    print('Some time consuming activity goes here')\n    load_widget()\n"]}, "new-improved-and-deprecated-modules - decimal-and-fractions": {"text": "decimal and fractions\n\nMark Dickinson crafted an elegant and efficient scheme for assuring that\ndifferent numeric datatypes will have the same hash value whenever their actual\nvalues are equal (issue 8188):\nassert hash(Fraction(3, 2)) == hash(1.5) == \\\n       hash(Decimal(\"1.5\")) == hash(complex(1.5, 0))\n\n\nSome of the hashing details are exposed through a new attribute,\nsys.hash_info, which describes the bit width of the hash value, the\nprime modulus, the hash values for infinity and nan, and the multiplier\nused for the imaginary part of a number:\n>>> sys.hash_info\nsys.hash_info(width=64, modulus=2305843009213693951, inf=314159, nan=0, imag=1000003)\n\n\nAn early decision to limit the inter-operability of various numeric types has\nbeen relaxed.  It is still unsupported (and ill-advised) to have implicit\nmixing in arithmetic expressions such as Decimal('1.1') + float('1.1')\nbecause the latter loses information in the process of constructing the binary\nfloat.  However, since existing floating point value can be converted losslessly\nto either a decimal or rational representation, it makes sense to add them to\nthe constructor and to support mixed-type comparisons.\n\nThe decimal.Decimal constructor now accepts float objects\ndirectly so there in no longer a need to use the from_float()\nmethod (issue 8257).\nMixed type comparisons are now fully supported so that\nDecimal objects can be directly compared with float\nand fractions.Fraction (issue 2531 and issue 8188).\n\nSimilar changes were made to fractions.Fraction so that the\nfrom_float() and from_decimal()\nmethods are no longer needed (issue 8294):\n>>> Decimal(1.1)\nDecimal('1.100000000000000088817841970012523233890533447265625')\n>>> Fraction(1.1)\nFraction(2476979795053773, 2251799813685248)\n\n\nAnother useful change for the decimal module is that the\nContext.clamp attribute is now public.  This is useful in creating\ncontexts that correspond to the decimal interchange formats specified in IEEE\n754 (see issue 8540).\n(Contributed by Mark Dickinson and Raymond Hettinger.)", "code_blocks": ["assert hash(Fraction(3, 2)) == hash(1.5) == \\\n       hash(Decimal(\"1.5\")) == hash(complex(1.5, 0))\n", ">>> sys.hash_info\nsys.hash_info(width=64, modulus=2305843009213693951, inf=314159, nan=0, imag=1000003)\n", ">>> Decimal(1.1)\nDecimal('1.100000000000000088817841970012523233890533447265625')\n>>> Fraction(1.1)\nFraction(2476979795053773, 2251799813685248)\n"]}, "new-improved-and-deprecated-modules - ftp": {"text": "ftp\n\nThe ftplib.FTP class now supports the context manager protocol to\nunconditionally consume socket.error exceptions and to close the FTP\nconnection when done:\n>>> from ftplib import FTP\n>>> with FTP(\"ftp1.at.proftpd.org\") as ftp:\n        ftp.login()\n        ftp.dir()\n\n'230 Anonymous login ok, restrictions apply.'\ndr-xr-xr-x   9 ftp      ftp           154 May  6 10:43 .\ndr-xr-xr-x   9 ftp      ftp           154 May  6 10:43 ..\ndr-xr-xr-x   5 ftp      ftp          4096 May  6 10:43 CentOS\ndr-xr-xr-x   3 ftp      ftp            18 Jul 10  2008 Fedora\n\n\nOther file-like objects such as mmap.mmap and fileinput.input()\nalso grew auto-closing context managers:\nwith fileinput.input(files=('log1.txt', 'log2.txt')) as f:\n    for line in f:\n        process(line)\n\n\n(Contributed by Tarek Ziadé and Giampaolo Rodolà in issue 4972, and\nby Georg Brandl in issue 8046 and issue 1286.)\nThe FTP_TLS class now accepts a context parameter, which is a\nssl.SSLContext object allowing bundling SSL configuration options,\ncertificates and private keys into a single (potentially long-lived) structure.\n(Contributed by Giampaolo Rodolà; issue 8806.)", "code_blocks": [">>> from ftplib import FTP\n>>> with FTP(\"ftp1.at.proftpd.org\") as ftp:\n        ftp.login()\n        ftp.dir()\n\n'230 Anonymous login ok, restrictions apply.'\ndr-xr-xr-x   9 ftp      ftp           154 May  6 10:43 .\ndr-xr-xr-x   9 ftp      ftp           154 May  6 10:43 ..\ndr-xr-xr-x   5 ftp      ftp          4096 May  6 10:43 CentOS\ndr-xr-xr-x   3 ftp      ftp            18 Jul 10  2008 Fedora\n", "with fileinput.input(files=('log1.txt', 'log2.txt')) as f:\n    for line in f:\n        process(line)\n"]}, "new-improved-and-deprecated-modules - popen": {"text": "popen\n\nThe os.popen() and subprocess.Popen() functions now support\nwith statements for auto-closing of the file descriptors.\n(Contributed by Antoine Pitrou and Brian Curtin in issue 7461 and\nissue 10554.)", "code_blocks": []}, "new-improved-and-deprecated-modules - select": {"text": "select\n\nThe select module now exposes a new, constant attribute,\nPIPE_BUF, which gives the minimum number of bytes which are\nguaranteed not to block when select.select() says a pipe is ready\nfor writing.\n>>> import select\n>>> select.PIPE_BUF\n512\n\n\n(Available on Unix systems. Patch by Sébastien Sablé in issue 9862)", "code_blocks": [">>> import select\n>>> select.PIPE_BUF\n512\n"]}, "new-improved-and-deprecated-modules - gzip-and-zipfile": {"text": "gzip and zipfile\n\ngzip.GzipFile now implements the io.BufferedIOBase\nabstract base class (except for truncate()).  It also has a\npeek() method and supports unseekable as well as\nzero-padded file objects.\nThe gzip module also gains the compress() and\ndecompress() functions for easier in-memory compression and\ndecompression.  Keep in mind that text needs to be encoded as bytes\nbefore compressing and decompressing:\n>>> s = 'Three shall be the number thou shalt count, '\n>>> s += 'and the number of the counting shall be three'\n>>> b = s.encode()                        # convert to utf-8\n>>> len(b)\n89\n>>> c = gzip.compress(b)\n>>> len(c)\n77\n>>> gzip.decompress(c).decode()[:42]      # decompress and convert to text\n'Three shall be the number thou shalt count,'\n\n\n(Contributed by Anand B. Pillai in issue 3488; and by Antoine Pitrou, Nir\nAides and Brian Curtin in issue 9962, issue 1675951, issue 7471 and\nissue 2846.)\nAlso, the zipfile.ZipExtFile class was reworked internally to represent\nfiles stored inside an archive.  The new implementation is significantly faster\nand can be wrapped in a io.BufferedReader object for more speedups.  It\nalso solves an issue where interleaved calls to read and readline gave the\nwrong results.\n(Patch submitted by Nir Aides in issue 7610.)", "code_blocks": [">>> s = 'Three shall be the number thou shalt count, '\n>>> s += 'and the number of the counting shall be three'\n>>> b = s.encode()                        # convert to utf-8\n>>> len(b)\n89\n>>> c = gzip.compress(b)\n>>> len(c)\n77\n>>> gzip.decompress(c).decode()[:42]      # decompress and convert to text\n'Three shall be the number thou shalt count,'\n"]}, "new-improved-and-deprecated-modules - tarfile": {"text": "tarfile\n\nThe TarFile class can now be used as a context manager.  In\naddition, its add() method has a new option, filter,\nthat controls which files are added to the archive and allows the file metadata\nto be edited.\nThe new filter option replaces the older, less flexible exclude parameter\nwhich is now deprecated.  If specified, the optional filter parameter needs to\nbe a keyword argument.  The user-supplied filter function accepts a\nTarInfo object and returns an updated\nTarInfo object, or if it wants the file to be excluded, the\nfunction can return None:\n>>> import tarfile, glob\n\n>>> def myfilter(tarinfo):\n       if tarinfo.isfile():             # only save real files\n            tarinfo.uname = 'monty'     # redact the user name\n            return tarinfo\n\n>>> with tarfile.open(name='myarchive.tar.gz', mode='w:gz') as tf:\n        for filename in glob.glob('*.txt'):\n            tf.add(filename, filter=myfilter)\n        tf.list()\n-rw-r--r-- monty/501        902 2011-01-26 17:59:11 annotations.txt\n-rw-r--r-- monty/501        123 2011-01-26 17:59:11 general_questions.txt\n-rw-r--r-- monty/501       3514 2011-01-26 17:59:11 prion.txt\n-rw-r--r-- monty/501        124 2011-01-26 17:59:11 py_todo.txt\n-rw-r--r-- monty/501       1399 2011-01-26 17:59:11 semaphore_notes.txt\n\n\n(Proposed by Tarek Ziadé and implemented by Lars Gustäbel in issue 6856.)", "code_blocks": [">>> import tarfile, glob\n\n>>> def myfilter(tarinfo):\n       if tarinfo.isfile():             # only save real files\n            tarinfo.uname = 'monty'     # redact the user name\n            return tarinfo\n\n>>> with tarfile.open(name='myarchive.tar.gz', mode='w:gz') as tf:\n        for filename in glob.glob('*.txt'):\n            tf.add(filename, filter=myfilter)\n        tf.list()\n-rw-r--r-- monty/501        902 2011-01-26 17:59:11 annotations.txt\n-rw-r--r-- monty/501        123 2011-01-26 17:59:11 general_questions.txt\n-rw-r--r-- monty/501       3514 2011-01-26 17:59:11 prion.txt\n-rw-r--r-- monty/501        124 2011-01-26 17:59:11 py_todo.txt\n-rw-r--r-- monty/501       1399 2011-01-26 17:59:11 semaphore_notes.txt\n"]}, "new-improved-and-deprecated-modules - hashlib": {"text": "hashlib\n\nThe hashlib module has two new constant attributes listing the hashing\nalgorithms guaranteed to be present in all implementations and those available\non the current implementation:\n>>> import hashlib\n\n>>> hashlib.algorithms_guaranteed\n{'sha1', 'sha224', 'sha384', 'sha256', 'sha512', 'md5'}\n\n>>> hashlib.algorithms_available\n{'md2', 'SHA256', 'SHA512', 'dsaWithSHA', 'mdc2', 'SHA224', 'MD4', 'sha256',\n'sha512', 'ripemd160', 'SHA1', 'MDC2', 'SHA', 'SHA384', 'MD2',\n'ecdsa-with-SHA1','md4', 'md5', 'sha1', 'DSA-SHA', 'sha224',\n'dsaEncryption', 'DSA', 'RIPEMD160', 'sha', 'MD5', 'sha384'}\n\n\n(Suggested by Carl Chenet in issue 7418.)", "code_blocks": [">>> import hashlib\n\n>>> hashlib.algorithms_guaranteed\n{'sha1', 'sha224', 'sha384', 'sha256', 'sha512', 'md5'}\n\n>>> hashlib.algorithms_available\n{'md2', 'SHA256', 'SHA512', 'dsaWithSHA', 'mdc2', 'SHA224', 'MD4', 'sha256',\n'sha512', 'ripemd160', 'SHA1', 'MDC2', 'SHA', 'SHA384', 'MD2',\n'ecdsa-with-SHA1','md4', 'md5', 'sha1', 'DSA-SHA', 'sha224',\n'dsaEncryption', 'DSA', 'RIPEMD160', 'sha', 'MD5', 'sha384'}\n"]}, "new-improved-and-deprecated-modules - ast": {"text": "ast\n\nThe ast module has a wonderful a general-purpose tool for safely\nevaluating expression strings using the Python literal\nsyntax.  The ast.literal_eval() function serves as a secure alternative to\nthe builtin eval() function which is easily abused.  Python 3.2 adds\nbytes and set literals to the list of supported types:\nstrings, bytes, numbers, tuples, lists, dicts, sets, booleans, and None.\n>>> from ast import literal_eval\n\n>>> request = \"{'req': 3, 'func': 'pow', 'args': (2, 0.5)}\"\n>>> literal_eval(request)\n{'args': (2, 0.5), 'req': 3, 'func': 'pow'}\n\n>>> request = \"os.system('do something harmful')\"\n>>> literal_eval(request)\nTraceback (most recent call last):\n  ...\nValueError: malformed node or string: <_ast.Call object at 0x101739a10>\n\n\n(Implemented by Benjamin Peterson and Georg Brandl.)", "code_blocks": [">>> from ast import literal_eval\n\n>>> request = \"{'req': 3, 'func': 'pow', 'args': (2, 0.5)}\"\n>>> literal_eval(request)\n{'args': (2, 0.5), 'req': 3, 'func': 'pow'}\n\n>>> request = \"os.system('do something harmful')\"\n>>> literal_eval(request)\nTraceback (most recent call last):\n  ...\nValueError: malformed node or string: <_ast.Call object at 0x101739a10>\n"]}, "new-improved-and-deprecated-modules - os": {"text": "os\n\nDifferent operating systems use various encodings for filenames and environment\nvariables.  The os module provides two new functions,\nfsencode() and fsdecode(), for encoding and decoding\nfilenames:\n>>> filename = 'Sehenswürdigkeiten'\n>>> os.fsencode(filename)\nb'Sehensw\\xc3\\xbcrdigkeiten'\n\n\nSome operating systems allow direct access to encoded bytes in the\nenvironment.  If so, the os.supports_bytes_environ constant will be\ntrue.\nFor direct access to encoded environment variables (if available),\nuse the new os.getenvb() function or use os.environb\nwhich is a bytes version of os.environ.\n(Contributed by Victor Stinner.)", "code_blocks": [">>> filename = 'Sehenswürdigkeiten'\n>>> os.fsencode(filename)\nb'Sehensw\\xc3\\xbcrdigkeiten'\n"]}, "new-improved-and-deprecated-modules - shutil": {"text": "shutil\n\nThe shutil.copytree() function has two new options:\n\nignore_dangling_symlinks: when symlinks=False so that the function\ncopies a file pointed to by a symlink, not the symlink itself. This option\nwill silence the error raised if the file doesn’t exist.\ncopy_function: is a callable that will be used to copy files.\nshutil.copy2() is used by default.\n\n(Contributed by Tarek Ziadé.)\nIn addition, the shutil module now supports archiving operations for zipfiles, uncompressed tarfiles, gzipped tarfiles,\nand bzipped tarfiles.  And there are functions for registering additional\narchiving file formats (such as xz compressed tarfiles or custom formats).\nThe principal functions are make_archive() and\nunpack_archive().  By default, both operate on the current\ndirectory (which can be set by os.chdir()) and on any sub-directories.\nThe archive filename needs to be specified with a full pathname.  The archiving\nstep is non-destructive (the original files are left unchanged).\n>>> import shutil, pprint\n\n>>> os.chdir('mydata')                               # change to the source directory\n>>> f = shutil.make_archive('/var/backup/mydata',\n                            'zip')                   # archive the current directory\n>>> f                                                # show the name of archive\n'/var/backup/mydata.zip'\n>>> os.chdir('tmp')                                  # change to an unpacking\n>>> shutil.unpack_archive('/var/backup/mydata.zip')  # recover the data\n\n>>> pprint.pprint(shutil.get_archive_formats())      # display known formats\n[('bztar', \"bzip2'ed tar-file\"),\n ('gztar', \"gzip'ed tar-file\"),\n ('tar', 'uncompressed tar file'),\n ('zip', 'ZIP file')]\n\n>>> shutil.register_archive_format(                  # register a new archive format\n        name = 'xz',\n        function = xz.compress,                      # callable archiving function\n        extra_args = [('level', 8)],                 # arguments to the function\n        description = 'xz compression'\n)\n\n\n(Contributed by Tarek Ziadé.)", "code_blocks": [">>> import shutil, pprint\n\n>>> os.chdir('mydata')                               # change to the source directory\n>>> f = shutil.make_archive('/var/backup/mydata',\n                            'zip')                   # archive the current directory\n>>> f                                                # show the name of archive\n'/var/backup/mydata.zip'\n>>> os.chdir('tmp')                                  # change to an unpacking\n>>> shutil.unpack_archive('/var/backup/mydata.zip')  # recover the data\n\n>>> pprint.pprint(shutil.get_archive_formats())      # display known formats\n[('bztar', \"bzip2'ed tar-file\"),\n ('gztar', \"gzip'ed tar-file\"),\n ('tar', 'uncompressed tar file'),\n ('zip', 'ZIP file')]\n\n>>> shutil.register_archive_format(                  # register a new archive format\n        name = 'xz',\n        function = xz.compress,                      # callable archiving function\n        extra_args = [('level', 8)],                 # arguments to the function\n        description = 'xz compression'\n)\n"]}, "new-improved-and-deprecated-modules - sqlite3": {"text": "sqlite3\n\nThe sqlite3 module was updated to pysqlite version 2.6.0.  It has two new capabilities.\n\nThe sqlite3.Connection.in_transit attribute is true if there is an\nactive transaction for uncommitted changes.\nThe sqlite3.Connection.enable_load_extension() and\nsqlite3.Connection.load_extension() methods allows you to load SQLite\nextensions from ”.so” files.  One well-known extension is the fulltext-search\nextension distributed with SQLite.\n\n(Contributed by R. David Murray and Shashwat Anand; issue 8845.)", "code_blocks": []}, "new-improved-and-deprecated-modules - html": {"text": "html\n\nA new html module was introduced with only a single function,\nescape(), which is used for escaping reserved characters from HTML\nmarkup:\n>>> import html\n>>> html.escape('x > 2 && x < 7')\n'x &gt; 2 &amp;&amp; x &lt; 7'", "code_blocks": [">>> import html\n>>> html.escape('x > 2 && x < 7')\n'x &gt; 2 &amp;&amp; x &lt; 7'\n"]}, "new-improved-and-deprecated-modules - socket": {"text": "socket\n\nThe socket module has two new improvements.\n\nSocket objects now have a detach() method which puts\nthe socket into closed state without actually closing the underlying file\ndescriptor.  The latter can then be reused for other purposes.\n(Added by Antoine Pitrou; issue 8524.)\nsocket.create_connection() now supports the context manager protocol\nto unconditionally consume socket.error exceptions and to close the\nsocket when done.\n(Contributed by Giampaolo Rodolà; issue 9794.)", "code_blocks": []}, "new-improved-and-deprecated-modules - ssl": {"text": "ssl\n\nThe ssl module added a number of features to satisfy common requirements\nfor secure (encrypted, authenticated) internet connections:\n\nA new class, SSLContext, serves as a container for persistent\nSSL data, such as protocol settings, certificates, private keys, and various\nother options. It includes a wrap_socket() for creating\nan SSL socket from an SSL context.\nA new function, ssl.match_hostname(), supports server identity\nverification for higher-level protocols by implementing the rules of HTTPS\n(from RFC 2818) which are also suitable for other protocols.\nThe ssl.wrap_socket() constructor function now takes a ciphers\nargument.  The ciphers string lists the allowed encryption algorithms using\nthe format described in the OpenSSL documentation.\nWhen linked against recent versions of OpenSSL, the ssl module now\nsupports the Server Name Indication extension to the TLS protocol, allowing\nmultiple “virtual hosts” using different certificates on a single IP port.\nThis extension is only supported in client mode, and is activated by passing\nthe server_hostname argument to ssl.SSLContext.wrap_socket().\nVarious options have been added to the ssl module, such as\nOP_NO_SSLv2 which disables the insecure and obsolete SSLv2\nprotocol.\nThe extension now loads all the OpenSSL ciphers and digest algorithms.  If\nsome SSL certificates cannot be verified, they are reported as an “unknown\nalgorithm” error.\nThe version of OpenSSL being used is now accessible using the module\nattributes ssl.OPENSSL_VERSION (a string),\nssl.OPENSSL_VERSION_INFO (a 5-tuple), and\nssl.OPENSSL_VERSION_NUMBER (an integer).\n\n(Contributed by Antoine Pitrou in issue 8850, issue 1589, issue 8322,\nissue 5639, issue 4870, issue 8484, and issue 8321.)", "code_blocks": []}, "new-improved-and-deprecated-modules - nntp": {"text": "nntp\n\nThe nntplib module has a revamped implementation with better bytes and\ntext semantics as well as more practical APIs.  These improvements break\ncompatibility with the nntplib version in Python 3.1, which was partly\ndysfunctional in itself.\nSupport for secure connections through both implicit (using\nnntplib.NNTP_SSL) and explicit (using nntplib.NNTP.starttls())\nTLS has also been added.\n(Contributed by Antoine Pitrou in issue 9360 and Andrew Vant in issue 1926.)", "code_blocks": []}, "new-improved-and-deprecated-modules - certificates": {"text": "certificates\n\nhttp.client.HTTPSConnection, urllib.request.HTTPSHandler\nand urllib.request.urlopen() now take optional arguments to allow for\nserver certificate checking against a set of Certificate Authorities,\nas recommended in public uses of HTTPS.\n(Added by Antoine Pitrou, issue 9003.)", "code_blocks": []}, "new-improved-and-deprecated-modules - imaplib": {"text": "imaplib\n\nSupport for explicit TLS on standard IMAP4 connections has been added through\nthe new imaplib.IMAP4.starttls method.\n(Contributed by Lorenzo M. Catucci and Antoine Pitrou, issue 4471.)", "code_blocks": []}, "new-improved-and-deprecated-modules - http-client": {"text": "http.client\n\nThere were a number of small API improvements in the http.client module.\nThe old-style HTTP 0.9 simple responses are no longer supported and the strict\nparameter is deprecated in all classes.\nThe HTTPConnection and\nHTTPSConnection classes now have a source_address\nparameter for a (host, port) tuple indicating where the HTTP connection is made\nfrom.\nSupport for certificate checking and HTTPS virtual hosts were added to\nHTTPSConnection.\nThe request() method on connection objects\nallowed an optional body argument so that a file object could be used\nto supply the content of the request.  Conveniently, the body argument now\nalso accepts an iterable object so long as it includes an explicit\nContent-Length header.  This extended interface is much more flexible than\nbefore.\nTo establish an HTTPS connection through a proxy server, there is a new\nset_tunnel() method that sets the host and\nport for HTTP Connect tunneling.\nTo match the behavior of http.server, the HTTP client library now also\nencodes headers with ISO-8859-1 (Latin-1) encoding.  It was already doing that\nfor incoming headers, so now the behavior is consistent for both incoming and\noutgoing traffic. (See work by Armin Ronacher in issue 10980.)", "code_blocks": []}, "new-improved-and-deprecated-modules - unittest": {"text": "unittest\n\nThe unittest module has a number of improvements supporting test discovery for\npackages, easier experimentation at the interactive prompt, new testcase\nmethods, improved diagnostic messages for test failures, and better method\nnames.\n\nThe command-line call python -m unittest can now accept file paths\ninstead of module names for running specific tests (issue 10620).  The new\ntest discovery can find tests within packages, locating any test importable\nfrom the top-level directory.  The top-level directory can be specified with\nthe -t option, a pattern for matching files with -p, and a directory to\nstart discovery with -s:\n$ python -m unittest discover -s my_proj_dir -p _test.py\n\n(Contributed by Michael Foord.)\n\nExperimentation at the interactive prompt is now easier because the\nunittest.case.TestCase class can now be instantiated without\narguments:\n>>> TestCase().assertEqual(pow(2, 3), 8)\n\n\n(Contributed by Michael Foord.)\n\nThe unittest module has two new methods,\nassertWarns() and\nassertWarnsRegex() to verify that a given warning type\nis triggered by the code under test:\nwith self.assertWarns(DeprecationWarning):\n    legacy_function('XYZ')\n\n\n(Contributed by Antoine Pitrou, issue 9754.)\nAnother new method, assertCountEqual() is used to\ncompare two iterables to determine if their element counts are equal (whether\nthe same elements are present with the same number of occurrences regardless\nof order):\ndef test_anagram(self):\n    self.assertCountEqual('algorithm', 'logarithm')\n\n\n(Contributed by Raymond Hettinger.)\n\nA principal feature of the unittest module is an effort to produce meaningful\ndiagnostics when a test fails.  When possible, the failure is recorded along\nwith a diff of the output.  This is especially helpful for analyzing log files\nof failed test runs. However, since diffs can sometime be voluminous, there is\na new maxDiff attribute that sets maximum length of\ndiffs displayed.\n\nIn addition, the method names in the module have undergone a number of clean-ups.\nFor example, assertRegex() is the new name for\nassertRegexpMatches() which was misnamed because the\ntest uses re.search(), not re.match().  Other methods using\nregular expressions are now named using short form “Regex” in preference to\n“Regexp” – this matches the names used in other unittest implementations,\nmatches Python’s old name for the re module, and it has unambiguous\ncamel-casing.\n(Contributed by Raymond Hettinger and implemented by Ezio Melotti.)\n\nTo improve consistency, some long-standing method aliases are being\ndeprecated in favor of the preferred names:\n\n\n\n\n\n\n\nOld Name\n\nPreferred Name\n\n\n\n\nassert_()\n\nassertTrue()\n\n\nassertEquals()\n\nassertEqual()\n\n\nassertNotEquals()\n\nassertNotEqual()\n\n\nassertAlmostEquals()\n\nassertAlmostEqual()\n\n\nassertNotAlmostEquals()\n\nassertNotAlmostEqual()\n\n\n\n\n\nLikewise, the TestCase.fail* methods deprecated in Python 3.1 are expected\nto be removed in Python 3.3.  Also see the Deprecated aliases section in\nthe unittest documentation.\n(Contributed by Ezio Melotti; issue 9424.)\n\nThe assertDictContainsSubset() method was deprecated\nbecause it was misimplemented with the arguments in the wrong order.  This\ncreated hard-to-debug optical illusions where tests like\nTestCase().assertDictContainsSubset({'a':1, 'b':2}, {'a':1}) would fail.\n(Contributed by Raymond Hettinger.)", "code_blocks": [">>> TestCase().assertEqual(pow(2, 3), 8)\n", "with self.assertWarns(DeprecationWarning):\n    legacy_function('XYZ')\n", "def test_anagram(self):\n    self.assertCountEqual('algorithm', 'logarithm')\n"]}, "new-improved-and-deprecated-modules - random": {"text": "random\n\nThe integer methods in the random module now do a better job of producing\nuniform distributions.  Previously, they computed selections with\nint(n*random()) which had a slight bias whenever n was not a power of two.\nNow, multiple selections are made from a range up to the next power of two and a\nselection is kept only when it falls within the range 0 <= x < n.  The\nfunctions and methods affected are randrange(),\nrandint(), choice(), shuffle() and\nsample().\n(Contributed by Raymond Hettinger; issue 9025.)", "code_blocks": []}, "new-improved-and-deprecated-modules - poplib": {"text": "poplib\n\nPOP3_SSL class now accepts a context parameter, which is a\nssl.SSLContext object allowing bundling SSL configuration options,\ncertificates and private keys into a single (potentially long-lived)\nstructure.\n(Contributed by Giampaolo Rodolà; issue 8807.)", "code_blocks": []}, "new-improved-and-deprecated-modules - asyncore": {"text": "asyncore\n\nasyncore.dispatcher now provides a\nhandle_accepted() method\nreturning a (sock, addr) pair which is called when a connection has actually\nbeen established with a new remote endpoint. This is supposed to be used as a\nreplacement for old handle_accept() and avoids\nthe user  to call accept() directly.\n(Contributed by Giampaolo Rodolà; issue 6706.)", "code_blocks": []}, "new-improved-and-deprecated-modules - tempfile": {"text": "tempfile\n\nThe tempfile module has a new context manager,\nTemporaryDirectory which provides easy deterministic\ncleanup of temporary directories:\nwith tempfile.TemporaryDirectory() as tmpdirname:\n    print('created temporary dir:', tmpdirname)\n\n\n(Contributed by Neil Schemenauer and Nick Coghlan; issue 5178.)", "code_blocks": ["with tempfile.TemporaryDirectory() as tmpdirname:\n    print('created temporary dir:', tmpdirname)\n"]}, "new-improved-and-deprecated-modules - inspect": {"text": "inspect\n\n\nThe inspect module has a new function\ngetgeneratorstate() to easily identify the current state of a\ngenerator-iterator:\n>>> from inspect import getgeneratorstate\n>>> def gen():\n        yield 'demo'\n>>> g = gen()\n>>> getgeneratorstate(g)\n'GEN_CREATED'\n>>> next(g)\n'demo'\n>>> getgeneratorstate(g)\n'GEN_SUSPENDED'\n>>> next(g, None)\n>>> getgeneratorstate(g)\n'GEN_CLOSED'\n\n\n(Contributed by Rodolpho Eckhardt and Nick Coghlan, issue 10220.)\n\nTo support lookups without the possibility of activating a dynamic attribute,\nthe inspect module has a new function, getattr_static().\nUnlike hasattr(), this is a true read-only search, guaranteed not to\nchange state while it is searching:\n>>> class A:\n        @property\n        def f(self):\n            print('Running')\n            return 10\n\n>>> a = A()\n>>> getattr(a, 'f')\nRunning\n10\n>>> inspect.getattr_static(a, 'f')\n<property object at 0x1022bd788>\n\n\n\n\n\n(Contributed by Michael Foord.)", "code_blocks": [">>> from inspect import getgeneratorstate\n>>> def gen():\n        yield 'demo'\n>>> g = gen()\n>>> getgeneratorstate(g)\n'GEN_CREATED'\n>>> next(g)\n'demo'\n>>> getgeneratorstate(g)\n'GEN_SUSPENDED'\n>>> next(g, None)\n>>> getgeneratorstate(g)\n'GEN_CLOSED'\n", ">>> class A:\n        @property\n        def f(self):\n            print('Running')\n            return 10\n\n>>> a = A()\n>>> getattr(a, 'f')\nRunning\n10\n>>> inspect.getattr_static(a, 'f')\n<property object at 0x1022bd788>\n"]}, "new-improved-and-deprecated-modules - pydoc": {"text": "pydoc\n\nThe pydoc module now provides a much-improved Web server interface, as\nwell as a new command-line option -b to automatically open a browser window\nto display that server:\n$ pydoc3.2 -b\n\n(Contributed by Ron Adam; issue 2001.)", "code_blocks": []}, "new-improved-and-deprecated-modules - dis": {"text": "dis\n\nThe dis module gained two new functions for inspecting code,\ncode_info() and show_code().  Both provide detailed code\nobject information for the supplied function, method, source code string or code\nobject.  The former returns a string and the latter prints it:\n>>> import dis, random\n>>> dis.show_code(random.choice)\nName:              choice\nFilename:          /Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/random.py\nArgument count:    2\nKw-only arguments: 0\nNumber of locals:  3\nStack size:        11\nFlags:             OPTIMIZED, NEWLOCALS, NOFREE\nConstants:\n   0: 'Choose a random element from a non-empty sequence.'\n   1: 'Cannot choose from an empty sequence'\nNames:\n   0: _randbelow\n   1: len\n   2: ValueError\n   3: IndexError\nVariable names:\n   0: self\n   1: seq\n   2: i\n\n\nIn addition, the dis() function now accepts string arguments\nso that the common idiom dis(compile(s, '', 'eval')) can be shortened\nto dis(s):\n>>> dis('3*x+1 if x%2==1 else x//2')\n  1           0 LOAD_NAME                0 (x)\n              3 LOAD_CONST               0 (2)\n              6 BINARY_MODULO\n              7 LOAD_CONST               1 (1)\n             10 COMPARE_OP               2 (==)\n             13 POP_JUMP_IF_FALSE       28\n             16 LOAD_CONST               2 (3)\n             19 LOAD_NAME                0 (x)\n             22 BINARY_MULTIPLY\n             23 LOAD_CONST               1 (1)\n             26 BINARY_ADD\n             27 RETURN_VALUE\n        >>   28 LOAD_NAME                0 (x)\n             31 LOAD_CONST               0 (2)\n             34 BINARY_FLOOR_DIVIDE\n             35 RETURN_VALUE\n\n\nTaken together, these improvements make it easier to explore how CPython is\nimplemented and to see for yourself what the language syntax does\nunder-the-hood.\n(Contributed by Nick Coghlan in issue 9147.)", "code_blocks": [">>> import dis, random\n>>> dis.show_code(random.choice)\nName:              choice\nFilename:          /Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/random.py\nArgument count:    2\nKw-only arguments: 0\nNumber of locals:  3\nStack size:        11\nFlags:             OPTIMIZED, NEWLOCALS, NOFREE\nConstants:\n   0: 'Choose a random element from a non-empty sequence.'\n   1: 'Cannot choose from an empty sequence'\nNames:\n   0: _randbelow\n   1: len\n   2: ValueError\n   3: IndexError\nVariable names:\n   0: self\n   1: seq\n   2: i\n", ">>> dis('3*x+1 if x%2==1 else x//2')\n  1           0 LOAD_NAME                0 (x)\n              3 LOAD_CONST               0 (2)\n              6 BINARY_MODULO\n              7 LOAD_CONST               1 (1)\n             10 COMPARE_OP               2 (==)\n             13 POP_JUMP_IF_FALSE       28\n             16 LOAD_CONST               2 (3)\n             19 LOAD_NAME                0 (x)\n             22 BINARY_MULTIPLY\n             23 LOAD_CONST               1 (1)\n             26 BINARY_ADD\n             27 RETURN_VALUE\n        >>   28 LOAD_NAME                0 (x)\n             31 LOAD_CONST               0 (2)\n             34 BINARY_FLOOR_DIVIDE\n             35 RETURN_VALUE\n"]}, "new-improved-and-deprecated-modules - dbm": {"text": "dbm\n\nAll database modules now support the get() and setdefault() methods.\n(Suggested by Ray Allen in issue 9523.)", "code_blocks": []}, "new-improved-and-deprecated-modules - ctypes": {"text": "ctypes\n\nA new type, ctypes.c_ssize_t represents the C ssize_t datatype.", "code_blocks": []}, "new-improved-and-deprecated-modules - site": {"text": "site\n\nThe site module has three new functions useful for reporting on the\ndetails of a given Python installation.\n\ngetsitepackages() lists all global site-packages directories.\ngetuserbase() reports on the user’s base directory where data can\nbe stored.\ngetusersitepackages() reveals the user-specific site-packages\ndirectory path.\n\n>>> import site\n>>> site.getsitepackages()\n['/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/site-packages',\n '/Library/Frameworks/Python.framework/Versions/3.2/lib/site-python',\n '/Library/Python/3.2/site-packages']\n>>> site.getuserbase()\n'/Users/raymondhettinger/Library/Python/3.2'\n>>> site.getusersitepackages()\n'/Users/raymondhettinger/Library/Python/3.2/lib/python/site-packages'\n\n\nConveniently, some of site’s functionality is accessible directly from the\ncommand-line:\n$ python -m site --user-base\n/Users/raymondhettinger/.local\n$ python -m site --user-site\n/Users/raymondhettinger/.local/lib/python3.2/site-packages\n\n(Contributed by Tarek Ziadé in issue 6693.)", "code_blocks": [">>> import site\n>>> site.getsitepackages()\n['/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/site-packages',\n '/Library/Frameworks/Python.framework/Versions/3.2/lib/site-python',\n '/Library/Python/3.2/site-packages']\n>>> site.getuserbase()\n'/Users/raymondhettinger/Library/Python/3.2'\n>>> site.getusersitepackages()\n'/Users/raymondhettinger/Library/Python/3.2/lib/python/site-packages'\n"]}, "new-improved-and-deprecated-modules - sysconfig": {"text": "sysconfig\n\nThe new sysconfig module makes it straightforward to discover\ninstallation paths and configuration variables that vary across platforms and\ninstallations.\nThe module offers access simple access functions for platform and version\ninformation:\n\nget_platform() returning values like linux-i586 or\nmacosx-10.6-ppc.\nget_python_version() returns a Python version string\nsuch as “3.2”.\n\nIt also provides access to the paths and variables corresponding to one of\nseven named schemes used by distutils.  Those include posix_prefix,\nposix_home, posix_user, nt, nt_user, os2, os2_home:\n\nget_paths() makes a dictionary containing installation paths\nfor the current installation scheme.\nget_config_vars() returns a dictionary of platform specific\nvariables.\n\nThere is also a convenient command-line interface:\nC:\\Python32>python -m sysconfig\nPlatform: \"win32\"\nPython version: \"3.2\"\nCurrent installation scheme: \"nt\"\n\nPaths:\n        data = \"C:\\Python32\"\n        include = \"C:\\Python32\\Include\"\n        platinclude = \"C:\\Python32\\Include\"\n        platlib = \"C:\\Python32\\Lib\\site-packages\"\n        platstdlib = \"C:\\Python32\\Lib\"\n        purelib = \"C:\\Python32\\Lib\\site-packages\"\n        scripts = \"C:\\Python32\\Scripts\"\n        stdlib = \"C:\\Python32\\Lib\"\n\nVariables:\n        BINDIR = \"C:\\Python32\"\n        BINLIBDEST = \"C:\\Python32\\Lib\"\n        EXE = \".exe\"\n        INCLUDEPY = \"C:\\Python32\\Include\"\n        LIBDEST = \"C:\\Python32\\Lib\"\n        SO = \".pyd\"\n        VERSION = \"32\"\n        abiflags = \"\"\n        base = \"C:\\Python32\"\n        exec_prefix = \"C:\\Python32\"\n        platbase = \"C:\\Python32\"\n        prefix = \"C:\\Python32\"\n        projectbase = \"C:\\Python32\"\n        py_version = \"3.2\"\n        py_version_nodot = \"32\"\n        py_version_short = \"3.2\"\n        srcdir = \"C:\\Python32\"\n        userbase = \"C:\\Documents and Settings\\Raymond\\Application Data\\Python\"\n\n\n(Moved out of Distutils by Tarek Ziadé.)", "code_blocks": ["C:\\Python32>python -m sysconfig\nPlatform: \"win32\"\nPython version: \"3.2\"\nCurrent installation scheme: \"nt\"\n\nPaths:\n        data = \"C:\\Python32\"\n        include = \"C:\\Python32\\Include\"\n        platinclude = \"C:\\Python32\\Include\"\n        platlib = \"C:\\Python32\\Lib\\site-packages\"\n        platstdlib = \"C:\\Python32\\Lib\"\n        purelib = \"C:\\Python32\\Lib\\site-packages\"\n        scripts = \"C:\\Python32\\Scripts\"\n        stdlib = \"C:\\Python32\\Lib\"\n\nVariables:\n        BINDIR = \"C:\\Python32\"\n        BINLIBDEST = \"C:\\Python32\\Lib\"\n        EXE = \".exe\"\n        INCLUDEPY = \"C:\\Python32\\Include\"\n        LIBDEST = \"C:\\Python32\\Lib\"\n        SO = \".pyd\"\n        VERSION = \"32\"\n        abiflags = \"\"\n        base = \"C:\\Python32\"\n        exec_prefix = \"C:\\Python32\"\n        platbase = \"C:\\Python32\"\n        prefix = \"C:\\Python32\"\n        projectbase = \"C:\\Python32\"\n        py_version = \"3.2\"\n        py_version_nodot = \"32\"\n        py_version_short = \"3.2\"\n        srcdir = \"C:\\Python32\"\n        userbase = \"C:\\Documents and Settings\\Raymond\\Application Data\\Python\"\n"]}, "new-improved-and-deprecated-modules - pdb": {"text": "pdb\n\nThe pdb debugger module gained a number of usability improvements:\n\npdb.py now has a -c option that executes commands as given in a\n.pdbrc script file.\nA .pdbrc script file can contain continue and next commands\nthat continue debugging.\nThe Pdb class constructor now accepts a nosigint argument.\nNew commands: l(list), ll(long list) and source for\nlisting source code.\nNew commands: display and undisplay for showing or hiding\nthe value of an expression if it has changed.\nNew command: interact for starting an interactive interpreter containing\nthe global and local  names found in the current scope.\nBreakpoints can be cleared by breakpoint number.\n\n(Contributed by Georg Brandl, Antonio Cuni and Ilya Sandler.)", "code_blocks": []}, "new-improved-and-deprecated-modules - configparser": {"text": "configparser\n\nThe configparser module was modified to improve usability and\npredictability of the default parser and its supported INI syntax.  The old\nConfigParser class was removed in favor of SafeConfigParser\nwhich has in turn been renamed to ConfigParser. Support\nfor inline comments is now turned off by default and section or option\nduplicates are not allowed in a single configuration source.\nConfig parsers gained a new API based on the mapping protocol:\n>>> parser = ConfigParser()\n>>> parser.read_string(\"\"\"\n[DEFAULT]\nlocation = upper left\nvisible = yes\neditable = no\ncolor = blue\n\n[main]\ntitle = Main Menu\ncolor = green\n\n[options]\ntitle = Options\n\"\"\")\n>>> parser['main']['color']\n'green'\n>>> parser['main']['editable']\n'no'\n>>> section = parser['options']\n>>> section['title']\n'Options'\n>>> section['title'] = 'Options (editable: %(editable)s)'\n>>> section['title']\n'Options (editable: no)'\n\n\nThe new API is implemented on top of the classical API, so custom parser\nsubclasses should be able to use it without modifications.\nThe INI file structure accepted by config parsers can now be customized. Users\ncan specify alternative option/value delimiters and comment prefixes, change the\nname of the DEFAULT section or switch the interpolation syntax.\nThere is support for pluggable interpolation including an additional interpolation\nhandler ExtendedInterpolation:\n>>> parser = ConfigParser(interpolation=ExtendedInterpolation())\n>>> parser.read_dict({'buildout': {'directory': '/home/ambv/zope9'},\n                      'custom': {'prefix': '/usr/local'}})\n>>> parser.read_string(\"\"\"\n    [buildout]\n    parts =\n      zope9\n      instance\n    find-links =\n      ${buildout:directory}/downloads/dist\n\n    [zope9]\n    recipe = plone.recipe.zope9install\n    location = /opt/zope\n\n    [instance]\n    recipe = plone.recipe.zope9instance\n    zope9-location = ${zope9:location}\n    zope-conf = ${custom:prefix}/etc/zope.conf\n    \"\"\")\n>>> parser['buildout']['find-links']\n'\\n/home/ambv/zope9/downloads/dist'\n>>> parser['instance']['zope-conf']\n'/usr/local/etc/zope.conf'\n>>> instance = parser['instance']\n>>> instance['zope-conf']\n'/usr/local/etc/zope.conf'\n>>> instance['zope9-location']\n'/opt/zope'\n\n\nA number of smaller features were also introduced, like support for specifying\nencoding in read operations, specifying fallback values for get-functions, or\nreading directly from dictionaries and strings.\n(All changes contributed by Łukasz Langa.)", "code_blocks": [">>> parser = ConfigParser()\n>>> parser.read_string(\"\"\"\n[DEFAULT]\nlocation = upper left\nvisible = yes\neditable = no\ncolor = blue\n\n[main]\ntitle = Main Menu\ncolor = green\n\n[options]\ntitle = Options\n\"\"\")\n>>> parser['main']['color']\n'green'\n>>> parser['main']['editable']\n'no'\n>>> section = parser['options']\n>>> section['title']\n'Options'\n>>> section['title'] = 'Options (editable: %(editable)s)'\n>>> section['title']\n'Options (editable: no)'\n", ">>> parser = ConfigParser(interpolation=ExtendedInterpolation())\n>>> parser.read_dict({'buildout': {'directory': '/home/ambv/zope9'},\n                      'custom': {'prefix': '/usr/local'}})\n>>> parser.read_string(\"\"\"\n    [buildout]\n    parts =\n      zope9\n      instance\n    find-links =\n      ${buildout:directory}/downloads/dist\n\n    [zope9]\n    recipe = plone.recipe.zope9install\n    location = /opt/zope\n\n    [instance]\n    recipe = plone.recipe.zope9instance\n    zope9-location = ${zope9:location}\n    zope-conf = ${custom:prefix}/etc/zope.conf\n    \"\"\")\n>>> parser['buildout']['find-links']\n'\\n/home/ambv/zope9/downloads/dist'\n>>> parser['instance']['zope-conf']\n'/usr/local/etc/zope.conf'\n>>> instance = parser['instance']\n>>> instance['zope-conf']\n'/usr/local/etc/zope.conf'\n>>> instance['zope9-location']\n'/opt/zope'\n"]}, "new-improved-and-deprecated-modules - urllib-parse": {"text": "urllib.parse\n\nA number of usability improvements were made for the urllib.parse module.\nThe urlparse() function now supports IPv6 addresses as described in RFC 2732:\n>>> import urllib.parse\n>>> urllib.parse.urlparse('http://[dead:beef:cafe:5417:affe:8FA3:deaf:feed]/foo/')\nParseResult(scheme='http',\n            netloc='[dead:beef:cafe:5417:affe:8FA3:deaf:feed]',\n            path='/foo/',\n            params='',\n            query='',\n            fragment='')\n\n\nThe urldefrag() function now returns a named tuple:\n>>> r = urllib.parse.urldefrag('http://python.org/about/#target')\n>>> r\nDefragResult(url='http://python.org/about/', fragment='target')\n>>> r[0]\n'http://python.org/about/'\n>>> r.fragment\n'target'\n\n\nAnd, the urlencode() function is now much more flexible,\naccepting either a string or bytes type for the query argument.  If it is a\nstring, then the safe, encoding, and error parameters are sent to\nquote_plus() for encoding:\n>>> urllib.parse.urlencode([\n         ('type', 'telenovela'),\n         ('name', '¿Dónde Está Elisa?')],\n         encoding='latin-1')\n'type=telenovela&name=%BFD%F3nde+Est%E1+Elisa%3F'\n\n\nAs detailed in Parsing ASCII Encoded Bytes, all the urllib.parse\nfunctions now accept ASCII-encoded byte strings as input, so long as they are\nnot mixed with regular strings.  If ASCII-encoded byte strings are given as\nparameters, the return types will also be an ASCII-encoded byte strings:\n>>> urllib.parse.urlparse(b'http://www.python.org:80/about/')\nParseResultBytes(scheme=b'http', netloc=b'www.python.org:80',\n                 path=b'/about/', params=b'', query=b'', fragment=b'')\n\n\n(Work by Nick Coghlan, Dan Mahn, and Senthil Kumaran in issue 2987,\nissue 5468, and issue 9873.)", "code_blocks": [">>> import urllib.parse\n>>> urllib.parse.urlparse('http://[dead:beef:cafe:5417:affe:8FA3:deaf:feed]/foo/')\nParseResult(scheme='http',\n            netloc='[dead:beef:cafe:5417:affe:8FA3:deaf:feed]',\n            path='/foo/',\n            params='',\n            query='',\n            fragment='')\n", ">>> r = urllib.parse.urldefrag('http://python.org/about/#target')\n>>> r\nDefragResult(url='http://python.org/about/', fragment='target')\n>>> r[0]\n'http://python.org/about/'\n>>> r.fragment\n'target'\n", ">>> urllib.parse.urlencode([\n         ('type', 'telenovela'),\n         ('name', '¿Dónde Está Elisa?')],\n         encoding='latin-1')\n'type=telenovela&name=%BFD%F3nde+Est%E1+Elisa%3F'\n", ">>> urllib.parse.urlparse(b'http://www.python.org:80/about/')\nParseResultBytes(scheme=b'http', netloc=b'www.python.org:80',\n                 path=b'/about/', params=b'', query=b'', fragment=b'')\n"]}, "new-improved-and-deprecated-modules - mailbox": {"text": "mailbox\n\nThanks to a concerted effort by R. David Murray, the mailbox module has\nbeen fixed for Python 3.2.  The challenge was that mailbox had been originally\ndesigned with a text interface, but email messages are best represented with\nbytes because various parts of a message may have different encodings.\nThe solution harnessed the email package’s binary support for parsing\narbitrary email messages.  In addition, the solution required a number of API\nchanges.\nAs expected, the add() method for\nmailbox.Mailbox objects now accepts binary input.\nStringIO and text file input are deprecated.  Also, string input\nwill fail early if non-ASCII characters are used.  Previously it would fail when\nthe email was processed in a later step.\nThere is also support for binary output.  The get_file()\nmethod now returns a file in the binary mode (where it used to incorrectly set\nthe file to text-mode).  There is also a new get_bytes()\nmethod that returns a bytes representation of a message corresponding\nto a given key.\nIt is still possible to get non-binary output using the old API’s\nget_string() method, but that approach\nis not very useful.  Instead, it is best to extract messages from\na Message object or to load them from binary input.\n(Contributed by R. David Murray, with efforts from Steffen Daode Nurpmeso and an\ninitial patch by Victor Stinner in issue 9124.)", "code_blocks": []}, "new-improved-and-deprecated-modules - turtledemo": {"text": "turtledemo\n\nThe demonstration code for the turtle module was moved from the Demo\ndirectory to main library.  It includes over a dozen sample scripts with\nlively displays.  Being on sys.path, it can now be run directly\nfrom the command-line:\n$ python -m turtledemo\n\n(Moved from the Demo directory by Alexander Belopolsky in issue 10199.)", "code_blocks": []}, "multi-threading": {"text": "Multi-threading\n\n\nThe mechanism for serializing execution of concurrently running Python threads\n(generally known as the GIL or Global Interpreter Lock) has\nbeen rewritten.  Among the objectives were more predictable switching\nintervals and reduced overhead due to lock contention and the number of\nensuing system calls.  The notion of a “check interval” to allow thread\nswitches has been abandoned and replaced by an absolute duration expressed in\nseconds.  This parameter is tunable through sys.setswitchinterval().\nIt currently defaults to 5 milliseconds.\nAdditional details about the implementation can be read from a python-dev\nmailing-list message\n(however, “priority requests” as exposed in this message have not been kept\nfor inclusion).\n(Contributed by Antoine Pitrou.)\n\nRegular and recursive locks now accept an optional timeout argument to their\nacquire() method.  (Contributed by Antoine Pitrou;\nissue 7316.)\n\nSimilarly, threading.Semaphore.acquire() also gained a timeout\nargument.  (Contributed by Torsten Landschoff; issue 850728.)\n\nRegular and recursive lock acquisitions can now be interrupted by signals on\nplatforms using Pthreads.  This means that Python programs that deadlock while\nacquiring locks can be successfully killed by repeatedly sending SIGINT to the\nprocess (by pressing Ctrl+C in most shells).\n(Contributed by Reid Kleckner; issue 8844.)", "code_blocks": []}, "optimizations": {"text": "Optimizations\n\nA number of small performance enhancements have been added:\n\nPython’s peephole optimizer now recognizes patterns such x in {1, 2, 3} as\nbeing a test for membership in a set of constants.  The optimizer recasts the\nset as a frozenset and stores the pre-built constant.\nNow that the speed penalty is gone, it is practical to start writing\nmembership tests using set-notation.  This style is both semantically clear\nand operationally fast:\nextension = name.rpartition('.')[2]\nif extension in {'xml', 'html', 'xhtml', 'css'}:\n    handle(name)\n\n\n(Patch and additional tests contributed by Dave Malcolm; issue 6690).\n\nSerializing and unserializing data using the pickle module is now\nseveral times faster.\n(Contributed by Alexandre Vassalotti, Antoine Pitrou\nand the Unladen Swallow team in issue 9410 and issue 3873.)\n\nThe Timsort algorithm used in\nlist.sort() and sorted() now runs faster and uses less memory\nwhen called with a key function.  Previously, every element of\na list was wrapped with a temporary object that remembered the key value\nassociated with each element.  Now, two arrays of keys and values are\nsorted in parallel.  This saves the memory consumed by the sort wrappers,\nand it saves time lost to delegating comparisons.\n(Patch by Daniel Stutzbach in issue 9915.)\n\nJSON decoding performance is improved and memory consumption is reduced\nwhenever the same string is repeated for multiple keys.  Also, JSON encoding\nnow uses the C speedups when the sort_keys argument is true.\n(Contributed by Antoine Pitrou in issue 7451 and by Raymond Hettinger and\nAntoine Pitrou in issue 10314.)\n\nRecursive locks (created with the threading.RLock() API) now benefit\nfrom a C implementation which makes them as fast as regular locks, and between\n10x and 15x faster than their previous pure Python implementation.\n(Contributed by Antoine Pitrou; issue 3001.)\n\nThe fast-search algorithm in stringlib is now used by the split(),\nsplitlines() and replace() methods on\nbytes, bytearray and str objects. Likewise, the\nalgorithm is also used by rfind(), rindex(), rsplit() and\nrpartition().\n(Patch by Florent Xicluna in issue 7622 and issue 7462.)\n\nInteger to string conversions now work two “digits” at a time, reducing the\nnumber of division and modulo operations.\n(issue 6713 by Gawain Bolton, Mark Dickinson, and Victor Stinner.)\n\n\nThere were several other minor optimizations. Set differencing now runs faster\nwhen one operand is much larger than the other (patch by Andress Bennetts in\nissue 8685).  The array.repeat() method has a faster implementation\n(issue 1569291 by Alexander Belopolsky). The BaseHTTPRequestHandler\nhas more efficient buffering (issue 3709 by Andrew Schaaf).  The\noperator.attrgetter() function has been sped-up (issue 10160 by\nChristos Georgiou).  And ConfigParser loads multi-line arguments a bit\nfaster (issue 7113 by Łukasz Langa).", "code_blocks": ["extension = name.rpartition('.')[2]\nif extension in {'xml', 'html', 'xhtml', 'css'}:\n    handle(name)\n"]}, "unicode": {"text": "Unicode\n\nPython has been updated to Unicode 6.0.0.  The update to the standard adds\nover 2,000 new characters including emoji\nsymbols which are important for mobile phones.\nIn addition, the updated standard has altered the character properties for two\nKannada characters (U+0CF1, U+0CF2) and one New Tai Lue numeric character\n(U+19DA), making the former eligible for use in identifiers while disqualifying\nthe latter.  For more information, see Unicode Character Database Changes.", "code_blocks": []}, "codecs": {"text": "Codecs\n\nSupport was added for cp720 Arabic DOS encoding (issue 1616979).\nMBCS encoding no longer ignores the error handler argument. In the default\nstrict mode, it raises an UnicodeDecodeError when it encounters an\nundecodable byte sequence and an UnicodeEncodeError for an unencodable\ncharacter.\nThe MBCS codec supports 'strict' and 'ignore' error handlers for\ndecoding, and 'strict' and 'replace' for encoding.\nTo emulate Python3.1 MBCS encoding, select the 'ignore' handler for decoding\nand the 'replace' handler for encoding.\nOn Mac OS X, Python decodes command line arguments with 'utf-8' rather than\nthe locale encoding.\nBy default, tarfile uses 'utf-8' encoding on Windows (instead of\n'mbcs') and the 'surrogateescape' error handler on all operating\nsystems.", "code_blocks": []}, "documentation": {"text": "Documentation\n\nThe documentation continues to be improved.\n\nA table of quick links has been added to the top of lengthy sections such as\nBuilt-in Functions.  In the case of itertools, the links are\naccompanied by tables of cheatsheet-style summaries to provide an overview and\nmemory jog without having to read all of the docs.\n\nIn some cases, the pure Python source code can be a helpful adjunct to the\ndocumentation, so now many modules now feature quick links to the latest\nversion of the source code.  For example, the functools module\ndocumentation has a quick link at the top labeled:\n\nSource code Lib/functools.py.\n\n(Contributed by Raymond Hettinger; see\nrationale.)\n\nThe docs now contain more examples and recipes.  In particular, re\nmodule has an extensive section, Regular Expression Examples.  Likewise, the\nitertools module continues to be updated with new\nItertools Recipes.\n\nThe datetime module now has an auxiliary implementation in pure Python.\nNo functionality was changed.  This just provides an easier-to-read alternate\nimplementation.\n(Contributed by Alexander Belopolsky in issue 9528.)\n\nThe unmaintained Demo directory has been removed.  Some demos were\nintegrated into the documentation, some were moved to the Tools/demo\ndirectory, and others were removed altogether.\n(Contributed by Georg Brandl in issue 7962.)", "code_blocks": []}, "idle": {"text": "IDLE\n\n\nThe format menu now has an option to clean source files by stripping\ntrailing whitespace.\n(Contributed by Raymond Hettinger; issue 5150.)\n\nIDLE on Mac OS X now works with both Carbon AquaTk and Cocoa AquaTk.\n(Contributed by Kevin Walzer, Ned Deily, and Ronald Oussoren; issue 6075.)", "code_blocks": []}, "code-repository": {"text": "Code Repository\n\nIn addition to the existing Subversion code repository at http://svn.python.org\nthere is now a Mercurial repository at\nhttp://hg.python.org/.\nAfter the 3.2 release, there are plans to switch to Mercurial as the primary\nrepository.  This distributed version control system should make it easier for\nmembers of the community to create and share external changesets.  See\nPEP 385 for details.\nTo learn the new version control system, see the tutorial by Joel\nSpolsky or the Guide to Mercurial Workflows.", "code_blocks": []}, "build-and-c-api-changes": {"text": "Build and C API Changes\n\nChanges to Python’s build process and to the C API include:\n\nThe idle, pydoc and 2to3 scripts are now installed with a\nversion-specific suffix on make altinstall (issue 10679).\n\nThe C functions that access the Unicode Database now accept and return\ncharacters from the full Unicode range, even on narrow unicode builds\n(Py_UNICODE_TOLOWER, Py_UNICODE_ISDECIMAL, and others).  A visible difference\nin Python is that unicodedata.numeric() now returns the correct value\nfor large code points, and repr() may consider more characters as\nprintable.\n(Reported by Bupjoe Lee and fixed by Amaury Forgeot D’Arc; issue 5127.)\n\nComputed gotos are now enabled by default on supported compilers (which are\ndetected by the configure script).  They can still be disabled selectively by\nspecifying --without-computed-gotos.\n(Contributed by Antoine Pitrou; issue 9203.)\n\nThe option --with-wctype-functions was removed.  The built-in unicode\ndatabase is now used for all functions.\n(Contributed by Amaury Forgeot D’Arc; issue 9210.)\n\nHash values are now values of a new type, Py_hash_t, which is\ndefined to be the same size as a pointer.  Previously they were of type long,\nwhich on some 64-bit operating systems is still only 32 bits long.  As a\nresult of this fix, set and dict can now hold more than\n2**32 entries on builds with 64-bit pointers (previously, they could grow\nto that size but their performance degraded catastrophically).\n(Suggested by Raymond Hettinger and implemented by Benjamin Peterson;\nissue 9778.)\n\nA new macro Py_VA_COPY copies the state of the variable argument\nlist.  It is equivalent to C99 va_copy but available on all Python platforms\n(issue 2443).\n\nA new C API function PySys_SetArgvEx() allows an embedded interpreter\nto set sys.argv without also modifying sys.path\n(issue 5753).\n\nPyEval_CallObject is now only available in macro form.  The\nfunction declaration, which was kept for backwards compatibility reasons, is\nnow removed – the macro was introduced in 1997 (issue 8276).\n\nThere is a new function PyLong_AsLongLongAndOverflow() which\nis analogous to PyLong_AsLongAndOverflow().  They both serve to\nconvert Python int into a native fixed-width type while providing\ndetection of cases where the conversion won’t fit (issue 7767).\n\nThe PyUnicode_CompareWithASCIIString() function now returns not\nequal if the Python string is NUL terminated.\n\nThere is a new function PyErr_NewExceptionWithDoc() that is\nlike PyErr_NewException() but allows a docstring to be specified.\nThis lets C exceptions have the same self-documenting capabilities as\ntheir pure Python counterparts (issue 7033).\n\nWhen compiled with the --with-valgrind option, the pymalloc\nallocator will be automatically disabled when running under Valgrind.  This\ngives improved memory leak detection when running under Valgrind, while taking\nadvantage of pymalloc at other times (issue 2422).\n\nRemoved the O? format from the PyArg_Parse functions.  The format is no\nlonger used and it had never been documented (issue 8837).\n\n\nThere were a number of other small changes to the C-API.  See the\nMisc/NEWS file for a complete list.\nAlso, there were a number of updates to the Mac OS X build, see\nMac/BuildScript/README.txt for details.  For users running a 32/64-bit\nbuild, there is a known problem with the default Tcl/Tk on Mac OS X 10.6.\nAccordingly, we recommend installing an updated alternative such as\nActiveState Tcl/Tk 8.5.9.\nSee http://www.python.org/download/mac/tcltk/ for additional details.", "code_blocks": []}, "porting-to-python-3-2": {"text": "Porting to Python 3.2\n\nThis section lists previously described changes and other bugfixes that may\nrequire changes to your code:\n\nThe configparser module has a number of clean-ups.  The major change is\nto replace the old ConfigParser class with long-standing preferred\nalternative SafeConfigParser.  In addition there are a number of\nsmaller incompatibilities:\n\nThe interpolation syntax is now validated on\nget() and\nset() operations. In the default\ninterpolation scheme, only two tokens with percent signs are valid: %(name)s\nand %%, the latter being an escaped percent sign.\nThe set() and\nadd_section() methods now verify that\nvalues are actual strings.  Formerly, unsupported types could be introduced\nunintentionally.\nDuplicate sections or options from a single source now raise either\nDuplicateSectionError or\nDuplicateOptionError.  Formerly, duplicates would\nsilently overwrite a previous entry.\nInline comments are now disabled by default so now the ; character\ncan be safely used in values.\nComments now can be indented.  Consequently, for ; or # to appear at\nthe start of a line in multiline values, it has to be interpolated.  This\nkeeps comment prefix characters in values from being mistaken as comments.\n\"\" is now a valid value and is no longer automatically converted to an\nempty string. For empty strings, use \"option =\" in a line.\n\n\nThe nntplib module was reworked extensively, meaning that its APIs\nare often incompatible with the 3.1 APIs.\n\nbytearray objects can no longer be used as filenames; instead,\nthey should be converted to bytes.\n\nThe array.tostring() and array.fromstring() have been renamed to\narray.tobytes() and array.frombytes() for clarity.  The old names\nhave been deprecated. (See issue 8990.)\n\nPyArg_Parse*() functions:\n\n“t#” format has been removed: use “s#” or “s*” instead\n“w” and “w#” formats has been removed: use “w*” instead\n\n\nThe PyCObject type, deprecated in 3.1, has been removed.  To wrap\nopaque C pointers in Python objects, the PyCapsule API should be used\ninstead; the new type has a well-defined interface for passing typing safety\ninformation and a less complicated signature for calling a destructor.\n\nThe sys.setfilesystemencoding() function was removed because\nit had a flawed design.\n\nThe random.seed() function and method now salt string seeds with an\nsha512 hash function.  To access the previous version of seed in order to\nreproduce Python 3.1 sequences, set the version argument to 1,\nrandom.seed(s, version=1).\n\nThe previously deprecated string.maketrans() function has been removed\nin favor of the static methods bytes.maketrans() and\nbytearray.maketrans().  This change solves the confusion around which\ntypes were supported by the string module.  Now, str,\nbytes, and bytearray each have their own maketrans and\ntranslate methods with intermediate translation tables of the appropriate\ntype.\n(Contributed by Georg Brandl; issue 5675.)\n\nThe previously deprecated contextlib.nested() function has been removed\nin favor of a plain with statement which can accept multiple\ncontext managers.  The latter technique is faster (because it is built-in),\nand it does a better job finalizing multiple context managers when one of them\nraises an exception:\nwith open('mylog.txt') as infile, open('a.out', 'w') as outfile:\n    for line in infile:\n        if '<critical>' in line:\n            outfile.write(line)\n\n\n(Contributed by Georg Brandl and Mattias Brändström;\nappspot issue 53094.)\n\nstruct.pack() now only allows bytes for the s string pack code.\nFormerly, it would accept text arguments and implicitly encode them to bytes\nusing UTF-8.  This was problematic because it made assumptions about the\ncorrect encoding and because a variable-length encoding can fail when writing\nto fixed length segment of a structure.\nCode such as struct.pack('<6sHHBBB', 'GIF87a', x, y) should be rewritten\nwith to use bytes instead of text, struct.pack('<6sHHBBB', b'GIF87a', x, y).\n(Discovered by David Beazley and fixed by Victor Stinner; issue 10783.)\n\nThe xml.etree.ElementTree class now raises an\nxml.etree.ElementTree.ParseError when a parse fails. Previously it\nraised a xml.parsers.expat.ExpatError.\n\nThe new, longer str() value on floats may break doctests which rely on\nthe old output format.\n\nIn subprocess.Popen, the default value for close_fds is now\nTrue under Unix; under Windows, it is True if the three standard\nstreams are set to None, False otherwise.  Previously, close_fds\nwas always False by default, which produced difficult to solve bugs\nor race conditions when open file descriptors would leak into the child\nprocess.\n\nSupport for legacy HTTP 0.9 has been removed from urllib.request\nand http.client.  Such support is still present on the server side\n(in http.server).\n(Contributed by Antoine Pitrou, issue 10711.)\n\nSSL sockets in timeout mode now raise socket.timeout when a timeout\noccurs, rather than a generic SSLError.\n(Contributed by Antoine Pitrou, issue 10272.)\n\nThe misleading functions PyEval_AcquireLock() and\nPyEval_ReleaseLock() have been officially deprecated.  The\nthread-state aware APIs (such as PyEval_SaveThread()\nand PyEval_RestoreThread()) should be used instead.\n\nDue to security risks, asyncore.handle_accept() has been deprecated, and\na new function, asyncore.handle_accepted(), was added to replace it.\n(Contributed by Giampaolo Rodola in issue 6706.)\n\nDue to the new GIL implementation, PyEval_InitThreads()\ncannot be called before Py_Initialize() anymore.", "code_blocks": ["with open('mylog.txt') as infile, open('a.out', 'w') as outfile:\n    for line in infile:\n        if '<critical>' in line:\n            outfile.write(line)\n"]}}}
{"index": 5, "python_version": "3.3", "url": "https://docs.python.org/3.3/whatsnew/3.3.html", "sections": {"summary-release-highlights": {"text": "Summary – Release highlights\n\nNew syntax features:\n\nNew yield from expression for generator delegation.\nThe u'unicode' syntax is accepted again for str objects.\n\nNew library modules:\n\nfaulthandler (helps debugging low-level crashes)\nipaddress (high-level objects representing IP addresses and masks)\nlzma (compress data using the XZ / LZMA algorithm)\nunittest.mock (replace parts of your system under test with mock objects)\nvenv (Python virtual environments, as in the\npopular virtualenv package)\n\nNew built-in features:\n\nReworked I/O exception hierarchy.\n\nImplementation improvements:\n\nRewritten import machinery based on importlib.\nMore compact unicode strings.\nMore compact attribute dictionaries.\n\nSignificantly Improved Library Modules:\n\nC Accelerator for the decimal module.\nBetter unicode handling in the email module\n(provisional).\n\nSecurity improvements:\n\nHash randomization is switched on by default.\n\nPlease read on for a comprehensive list of user-facing changes.", "code_blocks": []}, "pep-405-virtual-environments": {"text": "PEP 405: Virtual Environments\n\nVirtual environments help create separate Python setups while sharing a\nsystem-wide base install, for ease of maintenance.  Virtual environments\nhave their own set of private site packages (i.e. locally-installed\nlibraries), and are optionally segregated from the system-wide site\npackages.  Their concept and implementation are inspired by the popular\nvirtualenv third-party package, but benefit from tighter integration\nwith the interpreter core.\nThis PEP adds the venv module for programmatic access, and the\npyvenv script for command-line access and\nadministration.  The Python interpreter checks for a pyvenv.cfg,\nfile whose existence signals the base of a virtual environment’s directory\ntree.\n\nSee also\n\nPEP 405 - Python Virtual Environments\nPEP written by Carl Meyer; implementation by Carl Meyer and Vinay Sajip", "code_blocks": []}, "pep-420-implicit-namespace-packages": {"text": "PEP 420: Implicit Namespace Packages\n\nNative support for package directories that don’t require __init__.py\nmarker files and can automatically span multiple path segments (inspired by\nvarious third party approaches to namespace packages, as described in\nPEP 420)\n\nSee also\n\nPEP 420 - Implicit Namespace Packages\nPEP written by Eric V. Smith; implementation by Eric V. Smith\nand Barry Warsaw", "code_blocks": []}, "pep-3118-new-memoryview-implementation-and-buffer-protocol-documentation - features": {"text": "Features\n\n\nAll native single character format specifiers in struct module syntax\n(optionally prefixed with ‘@’) are now supported.\nWith some restrictions, the cast() method allows changing of format and\nshape of C-contiguous arrays.\nMulti-dimensional list representations are supported for any array type.\nMulti-dimensional comparisons are supported for any array type.\nOne-dimensional memoryviews of hashable (read-only) types with formats B,\nb or c are now hashable. (Contributed by Antoine Pitrou in issue 13411)\nArbitrary slicing of any 1-D arrays type is supported. For example, it\nis now possible to reverse a memoryview in O(1) by using a negative step.", "code_blocks": []}, "pep-3118-new-memoryview-implementation-and-buffer-protocol-documentation - api-changes": {"text": "API changes\n\n\nThe maximum number of dimensions is officially limited to 64.\nThe representation of empty shape, strides and suboffsets is now\nan empty tuple instead of None.\nAccessing a memoryview element with format ‘B’ (unsigned bytes)\nnow returns an integer (in accordance with the struct module syntax).\nFor returning a bytes object the view must be cast to ‘c’ first.\nmemoryview comparisons now use the logical structure of the operands\nand compare all array elements by value. All format strings in struct\nmodule syntax are supported. Views with unrecognised format strings\nare still permitted, but will always compare as unequal, regardless\nof view contents.\nFor further changes see Build and C API Changes and Porting C code.\n\n(Contributed by Stefan Krah in issue 10181)\n\nSee also\nPEP 3118 - Revising the Buffer Protocol", "code_blocks": []}, "pep-393-flexible-string-representation - functionality": {"text": "Functionality\n\nChanges introduced by PEP 393 are the following:\n\nPython now always supports the full range of Unicode codepoints, including\nnon-BMP ones (i.e. from U+0000 to U+10FFFF).  The distinction between\nnarrow and wide builds no longer exists and Python now behaves like a wide\nbuild, even under Windows.\nWith the death of narrow builds, the problems specific to narrow builds have\nalso been fixed, for example:\nlen() now always returns 1 for non-BMP characters,\nso len('\\U0010FFFF') == 1;\nsurrogate pairs are not recombined in string literals,\nso '\\uDBFF\\uDFFF' != '\\U0010FFFF';\nindexing or slicing non-BMP characters returns the expected value,\nso '\\U0010FFFF'[0] now returns '\\U0010FFFF' and not '\\uDBFF';\nall other functions in the standard library now correctly handle\nnon-BMP codepoints.\n\n\nThe value of sys.maxunicode is now always 1114111 (0x10FFFF\nin hexadecimal).  The PyUnicode_GetMax() function still returns\neither 0xFFFF or 0x10FFFF for backward compatibility, and it should\nnot be used with the new Unicode API (see issue 13054).\nThe ./configure flag --with-wide-unicode has been removed.", "code_blocks": []}, "pep-393-flexible-string-representation - performance-and-resource-usage": {"text": "Performance and resource usage\n\nThe storage of Unicode strings now depends on the highest codepoint in the string:\n\npure ASCII and Latin1 strings (U+0000-U+00FF) use 1 byte per codepoint;\nBMP strings (U+0000-U+FFFF) use 2 bytes per codepoint;\nnon-BMP strings (U+10000-U+10FFFF) use 4 bytes per codepoint.\n\nThe net effect is that for most applications, memory usage of string\nstorage should decrease significantly - especially compared to former\nwide unicode builds - as, in many cases, strings will be pure ASCII\neven in international contexts (because many strings store non-human\nlanguage data, such as XML fragments, HTTP headers, JSON-encoded data,\netc.).  We also hope that it will, for the same reasons, increase CPU\ncache efficiency on non-trivial applications. The memory usage of\nPython 3.3 is two to three times smaller than Python 3.2, and a little\nbit better than Python 2.7, on a Django benchmark (see the PEP for\ndetails).\n\nSee also\n\nPEP 393 - Flexible String Representation\nPEP written by Martin von Löwis; implementation by Torsten Becker\nand Martin von Löwis.", "code_blocks": []}, "pep-397-python-launcher-for-windows": {"text": "PEP 397: Python Launcher for Windows\n\nThe Python 3.3 Windows installer now includes a py launcher application\nthat can be used to launch Python applications in a version independent\nfashion.\nThis launcher is invoked implicitly when double-clicking *.py files.\nIf only a single Python version is installed on the system, that version\nwill be used to run the file. If multiple versions are installed, the most\nrecent version is used by default, but this can be overridden by including\na Unix-style “shebang line” in the Python script.\nThe launcher can also be used explicitly from the command line as the py\napplication. Running py follows the same version selection rules as\nimplicitly launching scripts, but a more specific version can be selected\nby passing appropriate arguments (such as -3 to request Python 3 when\nPython 2 is also installed, or -2.6 to specifclly request an earlier\nPython version when a more recent version is installed).\nIn addition to the launcher, the Windows installer now includes an\noption to add the newly installed Python to the system PATH (contributed\nby Brian Curtin in issue 3561).\n\nSee also\n\nPEP 397 - Python Launcher for Windows\nPEP written by Mark Hammond and Martin v. Löwis; implementation by\nVinay Sajip.\n\nLauncher documentation: Python Launcher for Windows\nInstaller PATH modification: Finding the Python executable", "code_blocks": []}, "pep-3151-reworking-the-os-and-io-exception-hierarchy": {"text": "PEP 3151: Reworking the OS and IO exception hierarchy\n\nThe hierarchy of exceptions raised by operating system errors is now both\nsimplified and finer-grained.\nYou don’t have to worry anymore about choosing the appropriate exception\ntype between OSError, IOError, EnvironmentError,\nWindowsError, mmap.error, socket.error or\nselect.error.  All these exception types are now only one:\nOSError.  The other names are kept as aliases for compatibility\nreasons.\nAlso, it is now easier to catch a specific error condition.  Instead of\ninspecting the errno attribute (or args[0]) for a particular\nconstant from the errno module, you can catch the adequate\nOSError subclass.  The available subclasses are the following:\n\nBlockingIOError\nChildProcessError\nConnectionError\nFileExistsError\nFileNotFoundError\nInterruptedError\nIsADirectoryError\nNotADirectoryError\nPermissionError\nProcessLookupError\nTimeoutError\n\nAnd the ConnectionError itself has finer-grained subclasses:\n\nBrokenPipeError\nConnectionAbortedError\nConnectionRefusedError\nConnectionResetError\n\nThanks to the new exceptions, common usages of the errno can now be\navoided.  For example, the following code written for Python 3.2:\nfrom errno import ENOENT, EACCES, EPERM\n\ntry:\n    with open(\"document.txt\") as f:\n        content = f.read()\nexcept IOError as err:\n    if err.errno == ENOENT:\n        print(\"document.txt file is missing\")\n    elif err.errno in (EACCES, EPERM):\n        print(\"You are not allowed to read document.txt\")\n    else:\n        raise\n\n\ncan now be written without the errno import and without manual\ninspection of exception attributes:\ntry:\n    with open(\"document.txt\") as f:\n        content = f.read()\nexcept FileNotFoundError:\n    print(\"document.txt file is missing\")\nexcept PermissionError:\n    print(\"You are not allowed to read document.txt\")\n\n\n\nSee also\n\nPEP 3151 - Reworking the OS and IO Exception Hierarchy\nPEP written and implemented by Antoine Pitrou", "code_blocks": ["from errno import ENOENT, EACCES, EPERM\n\ntry:\n    with open(\"document.txt\") as f:\n        content = f.read()\nexcept IOError as err:\n    if err.errno == ENOENT:\n        print(\"document.txt file is missing\")\n    elif err.errno in (EACCES, EPERM):\n        print(\"You are not allowed to read document.txt\")\n    else:\n        raise\n", "try:\n    with open(\"document.txt\") as f:\n        content = f.read()\nexcept FileNotFoundError:\n    print(\"document.txt file is missing\")\nexcept PermissionError:\n    print(\"You are not allowed to read document.txt\")\n"]}, "pep-380-syntax-for-delegating-to-a-subgenerator": {"text": "PEP 380: Syntax for Delegating to a Subgenerator\n\nPEP 380 adds the yield from expression, allowing a generator to\ndelegate\npart of its operations to another generator. This allows a section of code\ncontaining yield to be factored out and placed in another generator.\nAdditionally, the subgenerator is allowed to return with a value, and the\nvalue is made available to the delegating generator.\nWhile designed primarily for use in delegating to a subgenerator, the yield\nfrom expression actually allows delegation to arbitrary subiterators.\nFor simple iterators, yield from iterable is essentially just a shortened\nform of for item in iterable: yield item:\n>>> def g(x):\n...     yield from range(x, 0, -1)\n...     yield from range(x)\n...\n>>> list(g(5))\n[5, 4, 3, 2, 1, 0, 1, 2, 3, 4]\n\n\nHowever, unlike an ordinary loop, yield from allows subgenerators to\nreceive sent and thrown values directly from the calling scope, and\nreturn a final value to the outer generator:\n>>> def accumulate():\n...     tally = 0\n...     while 1:\n...         next = yield\n...         if next is None:\n...             return tally\n...         tally += next\n...\n>>> def gather_tallies(tallies):\n...     while 1:\n...         tally = yield from accumulate()\n...         tallies.append(tally)\n...\n>>> tallies = []\n>>> acc = gather_tallies(tallies)\n>>> next(acc) # Ensure the accumulator is ready to accept values\n>>> for i in range(4):\n...     acc.send(i)\n...\n>>> acc.send(None) # Finish the first tally\n>>> for i in range(5):\n...     acc.send(i)\n...\n>>> acc.send(None) # Finish the second tally\n>>> tallies\n[6, 10]\n\n\nThe main principle driving this change is to allow even generators that are\ndesigned to be used with the send and throw methods to be split into\nmultiple subgenerators as easily as a single large function can be split into\nmultiple subfunctions.\n\nSee also\n\nPEP 380 - Syntax for Delegating to a Subgenerator\nPEP written by Greg Ewing; implementation by Greg Ewing, integrated into\n3.3 by Renaud Blanch, Ryan Kelly and Nick Coghlan; documentation by\nZbigniew Jędrzejewski-Szmek and Nick Coghlan", "code_blocks": [">>> def g(x):\n...     yield from range(x, 0, -1)\n...     yield from range(x)\n...\n>>> list(g(5))\n[5, 4, 3, 2, 1, 0, 1, 2, 3, 4]\n", ">>> def accumulate():\n...     tally = 0\n...     while 1:\n...         next = yield\n...         if next is None:\n...             return tally\n...         tally += next\n...\n>>> def gather_tallies(tallies):\n...     while 1:\n...         tally = yield from accumulate()\n...         tallies.append(tally)\n...\n>>> tallies = []\n>>> acc = gather_tallies(tallies)\n>>> next(acc) # Ensure the accumulator is ready to accept values\n>>> for i in range(4):\n...     acc.send(i)\n...\n>>> acc.send(None) # Finish the first tally\n>>> for i in range(5):\n...     acc.send(i)\n...\n>>> acc.send(None) # Finish the second tally\n>>> tallies\n[6, 10]\n"]}, "pep-409-suppressing-exception-context": {"text": "PEP 409: Suppressing exception context\n\nPEP 409 introduces new syntax that allows the display of the chained\nexception context to be disabled. This allows cleaner error messages in\napplications that convert between exception types:\n>>> class D:\n...     def __init__(self, extra):\n...         self._extra_attributes = extra\n...     def __getattr__(self, attr):\n...         try:\n...             return self._extra_attributes[attr]\n...         except KeyError:\n...             raise AttributeError(attr) from None\n...\n>>> D({}).x\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"<stdin>\", line 8, in __getattr__\nAttributeError: x\n\n\nWithout the from None suffix to suppress the cause, the original\nexception would be displayed by default:\n>>> class C:\n...     def __init__(self, extra):\n...         self._extra_attributes = extra\n...     def __getattr__(self, attr):\n...         try:\n...             return self._extra_attributes[attr]\n...         except KeyError:\n...             raise AttributeError(attr)\n...\n>>> C({}).x\nTraceback (most recent call last):\n  File \"<stdin>\", line 6, in __getattr__\nKeyError: 'x'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"<stdin>\", line 8, in __getattr__\nAttributeError: x\n\n\nNo debugging capability is lost, as the original exception context remains\navailable if needed (for example, if an intervening library has incorrectly\nsuppressed valuable underlying details):\n>>> try:\n...     D({}).x\n... except AttributeError as exc:\n...     print(repr(exc.__context__))\n...\nKeyError('x',)\n\n\n\nSee also\n\nPEP 409 - Suppressing exception context\nPEP written by Ethan Furman; implemented by Ethan Furman and Nick\nCoghlan.", "code_blocks": [">>> class D:\n...     def __init__(self, extra):\n...         self._extra_attributes = extra\n...     def __getattr__(self, attr):\n...         try:\n...             return self._extra_attributes[attr]\n...         except KeyError:\n...             raise AttributeError(attr) from None\n...\n>>> D({}).x\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"<stdin>\", line 8, in __getattr__\nAttributeError: x\n", ">>> class C:\n...     def __init__(self, extra):\n...         self._extra_attributes = extra\n...     def __getattr__(self, attr):\n...         try:\n...             return self._extra_attributes[attr]\n...         except KeyError:\n...             raise AttributeError(attr)\n...\n>>> C({}).x\nTraceback (most recent call last):\n  File \"<stdin>\", line 6, in __getattr__\nKeyError: 'x'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"<stdin>\", line 8, in __getattr__\nAttributeError: x\n", ">>> try:\n...     D({}).x\n... except AttributeError as exc:\n...     print(repr(exc.__context__))\n...\nKeyError('x',)\n"]}, "pep-414-explicit-unicode-literals": {"text": "PEP 414: Explicit Unicode literals\n\nTo ease the transition from Python 2 for Unicode aware Python applications\nthat make heavy use of Unicode literals, Python 3.3 once again supports the\n“u” prefix for string literals. This prefix has no semantic significance\nin Python 3, it is provided solely to reduce the number of purely mechanical\nchanges in migrating to Python 3, making it easier for developers to focus on\nthe more significant semantic changes (such as the stricter default\nseparation of binary and text data).\n\nSee also\n\nPEP 414 - Explicit Unicode literals\nPEP written by Armin Ronacher.", "code_blocks": []}, "pep-3155-qualified-name-for-classes-and-functions": {"text": "PEP 3155: Qualified name for classes and functions\n\nFunctions and class objects have a new __qualname__ attribute representing\nthe “path” from the module top-level to their definition.  For global functions\nand classes, this is the same as __name__.  For other functions and classes,\nit provides better information about where they were actually defined, and\nhow they might be accessible from the global scope.\nExample with (non-bound) methods:\n>>> class C:\n...     def meth(self):\n...         pass\n>>> C.meth.__name__\n'meth'\n>>> C.meth.__qualname__\n'C.meth'\n\n\nExample with nested classes:\n>>> class C:\n...     class D:\n...         def meth(self):\n...             pass\n...\n>>> C.D.__name__\n'D'\n>>> C.D.__qualname__\n'C.D'\n>>> C.D.meth.__name__\n'meth'\n>>> C.D.meth.__qualname__\n'C.D.meth'\n\n\nExample with nested functions:\n>>> def outer():\n...     def inner():\n...         pass\n...     return inner\n...\n>>> outer().__name__\n'inner'\n>>> outer().__qualname__\n'outer.<locals>.inner'\n\n\nThe string representation of those objects is also changed to include the\nnew, more precise information:\n>>> str(C.D)\n\"<class '__main__.C.D'>\"\n>>> str(C.D.meth)\n'<function C.D.meth at 0x7f46b9fe31e0>'\n\n\n\nSee also\n\nPEP 3155 - Qualified name for classes and functions\nPEP written and implemented by Antoine Pitrou.", "code_blocks": [">>> class C:\n...     def meth(self):\n...         pass\n>>> C.meth.__name__\n'meth'\n>>> C.meth.__qualname__\n'C.meth'\n", ">>> class C:\n...     class D:\n...         def meth(self):\n...             pass\n...\n>>> C.D.__name__\n'D'\n>>> C.D.__qualname__\n'C.D'\n>>> C.D.meth.__name__\n'meth'\n>>> C.D.meth.__qualname__\n'C.D.meth'\n", ">>> def outer():\n...     def inner():\n...         pass\n...     return inner\n...\n>>> outer().__name__\n'inner'\n>>> outer().__qualname__\n'outer.<locals>.inner'\n", ">>> str(C.D)\n\"<class '__main__.C.D'>\"\n>>> str(C.D.meth)\n'<function C.D.meth at 0x7f46b9fe31e0>'\n"]}, "pep-412-key-sharing-dictionary": {"text": "PEP 412: Key-Sharing Dictionary\n\nDictionaries used for the storage of objects’ attributes are now able to\nshare part of their internal storage between each other (namely, the part\nwhich stores the keys and their respective hashes).  This reduces the memory\nconsumption of programs creating many instances of non-builtin types.\n\nSee also\n\nPEP 412 - Key-Sharing Dictionary\nPEP written and implemented by Mark Shannon.", "code_blocks": []}, "pep-362-function-signature-object": {"text": "PEP 362: Function Signature Object\n\nA new function inspect.signature() makes introspection of python\ncallables easy and straightforward.  A broad range of callables is supported:\npython functions, decorated or not, classes, and functools.partial()\nobjects.  New classes inspect.Signature, inspect.Parameter\nand inspect.BoundArguments hold information about the call signatures,\nsuch as, annotations, default values, parameters kinds, and bound arguments,\nwhich considerably simplifies writing decorators and any code that validates\nor amends calling signatures or arguments.\n\nSee also\n\nPEP 362: -  Function Signature Object\nPEP written by Brett Cannon, Yury Selivanov, Larry Hastings, Jiwon Seo;\nimplemented by Yury Selivanov.", "code_blocks": []}, "pep-421-adding-sys-implementation - simplenamespace": {"text": "SimpleNamespace\n\nThe implementation of sys.implementation also introduces a new type to\nPython: types.SimpleNamespace.  In contrast to a mapping-based\nnamespace, like dict, SimpleNamespace is attribute-based, like\nobject.  However, unlike object, SimpleNamespace instances\nare writable.  This means that you can add, remove, and modify the namespace\nthrough normal attribute access.\n\nSee also\n\nPEP 421 - Adding sys.implementation\nPEP written and implemented by Eric Snow.", "code_blocks": []}, "using-importlib-as-the-implementation-of-import - new-apis": {"text": "New APIs\n\nOne of the large benefits of this work is the exposure of what goes into\nmaking the import statement work. That means the various importers that were\nonce implicit are now fully exposed as part of the importlib package.\nThe abstract base classes defined in importlib.abc have been expanded\nto properly delineate between meta path finders\nand path entry finders by introducing\nimportlib.abc.MetaPathFinder and\nimportlib.abc.PathEntryFinder, respectively. The old ABC of\nimportlib.abc.Finder is now only provided for backwards-compatibility\nand does not enforce any method requirements.\nIn terms of finders, importlib.machinery.FileFinder exposes the\nmechanism used to search for source and bytecode files of a module. Previously\nthis class was an implicit member of sys.path_hooks.\nFor loaders, the new abstract base class importlib.abc.FileLoader helps\nwrite a loader that uses the file system as the storage mechanism for a module’s\ncode. The loader for source files\n(importlib.machinery.SourceFileLoader), sourceless bytecode files\n(importlib.machinery.SourcelessFileLoader), and extension modules\n(importlib.machinery.ExtensionFileLoader) are now available for\ndirect use.\nImportError now has name and path attributes which are set when\nthere is relevant data to provide. The message for failed imports will also\nprovide the full name of the module now instead of just the tail end of the\nmodule’s name.\nThe importlib.invalidate_caches() function will now call the method with\nthe same name on all finders cached in sys.path_importer_cache to help\nclean up any stored state as necessary.", "code_blocks": []}, "using-importlib-as-the-implementation-of-import - visible-changes": {"text": "Visible Changes\n\nFor potential required changes to code, see the Porting Python code\nsection.\nBeyond the expanse of what importlib now exposes, there are other\nvisible changes to import. The biggest is that sys.meta_path and\nsys.path_hooks now store all of the meta path finders and path entry\nhooks used by import.  Previously the finders were implicit and hidden within\nthe C code of import instead of being directly exposed. This means that one can\nnow easily remove or change the order of the various finders to fit one’s needs.\nAnother change is that all modules have a __loader__ attribute, storing the\nloader used to create the module. PEP 302 has been updated to make this\nattribute mandatory for loaders to implement, so in the future once 3rd-party\nloaders have been updated people will be able to rely on the existence of the\nattribute. Until such time, though, import is setting the module post-load.\nLoaders are also now expected to set the __package__ attribute from\nPEP 366. Once again, import itself is already setting this on all loaders\nfrom importlib and import itself is setting the attribute post-load.\nNone is now inserted into sys.path_importer_cache when no finder\ncan be found on sys.path_hooks. Since imp.NullImporter is not\ndirectly exposed on sys.path_hooks it could no longer be relied upon to\nalways be available to use as a value representing no finder found.\nAll other changes relate to semantic changes which should be taken into\nconsideration when updating code for Python 3.3, and thus should be read about\nin the Porting Python code section of this document.\n(Implementation by Brett Cannon)", "code_blocks": []}, "other-language-changes": {"text": "Other Language Changes\n\nSome smaller changes made to the core Python language are:\n\nAdded support for Unicode name aliases and named sequences.\nBoth unicodedata.lookup() and '\\N{...}' now resolve name aliases,\nand unicodedata.lookup() resolves named sequences too.\n(Contributed by Ezio Melotti in issue 12753)\n\nUnicode database updated to UCD version 6.1.0\n\nEquality comparisons on range() objects now return a result reflecting\nthe equality of the underlying sequences generated by those range objects.\n(issue 13201)\n\nThe count(), find(), rfind(), index() and rindex()\nmethods of bytes and bytearray objects now accept an\ninteger between 0 and 255 as their first argument.\n(Contributed by Petri Lehtinen in issue 12170)\n\nThe rjust(), ljust(), and center() methods of bytes\nand bytearray now accept a bytearray for the fill\nargument.  (Contributed by Petri Lehtinen in issue 12380.)\n\nNew methods have been added to list and bytearray:\ncopy() and clear() (issue 10516).  Consequently,\nMutableSequence now also defines a\nclear() method (issue 11388).\n\nRaw bytes literals can now be written rb\"...\" as well as br\"...\".\n(Contributed by Antoine Pitrou in issue 13748.)\n\ndict.setdefault() now does only one lookup for the given key, making\nit atomic when used with built-in types.\n(Contributed by Filip Gruszczyński in issue 13521.)\n\nThe error messages produced when a function call does not match the function\nsignature have been significantly improved.\n(Contributed by Benjamin Peterson.)", "code_blocks": []}, "a-finer-grained-import-lock": {"text": "A Finer-Grained Import Lock\n\nPrevious versions of CPython have always relied on a global import lock.\nThis led to unexpected annoyances, such as deadlocks when importing a module\nwould trigger code execution in a different thread as a side-effect.\nClumsy workarounds were sometimes employed, such as the\nPyImport_ImportModuleNoBlock() C API function.\nIn Python 3.3, importing a module takes a per-module lock.  This correctly\nserializes importation of a given module from multiple threads (preventing\nthe exposure of incompletely initialized modules), while eliminating the\naforementioned annoyances.\n(Contributed by Antoine Pitrou in issue 9260.)", "code_blocks": []}, "builtin-functions-and-types": {"text": "Builtin functions and types\n\n\nopen() gets a new opener parameter: the underlying file descriptor\nfor the file object is then obtained by calling opener with (file,\nflags). It can be used to use custom flags like os.O_CLOEXEC for\nexample. The 'x' mode was added: open for exclusive creation, failing if\nthe file already exists.\nprint(): added the flush keyword argument. If the flush keyword\nargument is true, the stream is forcibly flushed.\nhash(): hash randomization is enabled by default, see\nobject.__hash__() and PYTHONHASHSEED.\nThe str type gets a new casefold() method: return a\ncasefolded copy of the string, casefolded strings may be used for caseless\nmatching. For example, 'ß'.casefold() returns 'ss'.\nThe sequence documentation has been substantially rewritten to better\nexplain the binary/text sequence distinction and to provide specific\ndocumentation sections for the individual builtin sequence types\n(issue 4966)", "code_blocks": []}, "new-modules - faulthandler": {"text": "faulthandler\n\nThis new debug module faulthandler contains functions to dump Python tracebacks explicitly,\non a fault (a crash like a segmentation fault), after a timeout, or on a user\nsignal. Call faulthandler.enable() to install fault handlers for the\nSIGSEGV, SIGFPE, SIGABRT, SIGBUS, and\nSIGILL signals. You can also enable them at startup by setting the\nPYTHONFAULTHANDLER environment variable or by using -X\nfaulthandler command line option.\nExample of a segmentation fault on Linux:\n$ python -q -X faulthandler\n>>> import ctypes\n>>> ctypes.string_at(0)\nFatal Python error: Segmentation fault\n\nCurrent thread 0x00007fb899f39700:\n  File \"/home/python/cpython/Lib/ctypes/__init__.py\", line 486 in string_at\n  File \"<stdin>\", line 1 in <module>\nSegmentation fault", "code_blocks": []}, "new-modules - ipaddress": {"text": "ipaddress\n\nThe new ipaddress module provides tools for creating and manipulating\nobjects representing IPv4 and IPv6 addresses, networks and interfaces (i.e.\nan IP address associated with a specific IP subnet).\n(Contributed by Google and Peter Moody in PEP 3144)", "code_blocks": []}, "new-modules - lzma": {"text": "lzma\n\nThe newly-added lzma module provides data compression and decompression\nusing the LZMA algorithm, including support for the .xz and .lzma\nfile formats.\n(Contributed by Nadeem Vawda and Per Øyvind Karlsen in issue 6715)", "code_blocks": []}, "improved-modules - abc": {"text": "abc\n\nImproved support for abstract base classes containing descriptors composed with\nabstract methods. The recommended approach to declaring abstract descriptors is\nnow to provide __isabstractmethod__ as a dynamically updated\nproperty. The built-in descriptors have been updated accordingly.\n\n\nabc.abstractproperty has been deprecated, use property\nwith abc.abstractmethod() instead.\nabc.abstractclassmethod has been deprecated, use\nclassmethod with abc.abstractmethod() instead.\nabc.abstractstaticmethod has been deprecated, use\nstaticmethod with abc.abstractmethod() instead.\n\n\n(Contributed by Darren Dale in issue 11610)\nabc.ABCMeta.register() now returns the registered subclass, which means\nit can now be used as a class decorator (issue 10868).", "code_blocks": []}, "improved-modules - array": {"text": "array\n\nThe array module supports the long long type using q and\nQ type codes.\n(Contributed by Oren Tirosh and Hirokazu Yamamoto in issue 1172711)", "code_blocks": []}, "improved-modules - base64": {"text": "base64\n\nASCII-only Unicode strings are now accepted by the decoding functions of the\nbase64 modern interface. For example, base64.b64decode('YWJj')\nreturns b'abc'.  (Contributed by Catalin Iacob in issue 13641.)", "code_blocks": []}, "improved-modules - binascii": {"text": "binascii\n\nIn addition to the binary objects they normally accept, the a2b_ functions\nnow all also accept ASCII-only strings as input.  (Contributed by Antoine\nPitrou in issue 13637.)", "code_blocks": []}, "improved-modules - bz2": {"text": "bz2\n\nThe bz2 module has been rewritten from scratch. In the process, several\nnew features have been added:\n\nNew bz2.open() function: open a bzip2-compressed file in binary or\ntext mode.\n\nbz2.BZ2File can now read from and write to arbitrary file-like\nobjects, by means of its constructor’s fileobj argument.\n(Contributed by Nadeem Vawda in issue 5863)\n\nbz2.BZ2File and bz2.decompress() can now decompress\nmulti-stream inputs (such as those produced by the pbzip2 tool).\nbz2.BZ2File can now also be used to create this type of file, using\nthe 'a' (append) mode.\n(Contributed by Nir Aides in issue 1625)\n\nbz2.BZ2File now implements all of the io.BufferedIOBase API,\nexcept for the detach() and truncate() methods.", "code_blocks": []}, "improved-modules - codecs": {"text": "codecs\n\nThe mbcs codec has been rewritten to handle correctly\nreplace and ignore error handlers on all Windows versions.  The\nmbcs codec now supports all error handlers, instead of only\nreplace to encode and ignore to decode.\nA new Windows-only codec has been added: cp65001 (issue 13216). It is the\nWindows code page 65001 (Windows UTF-8, CP_UTF8).  For example, it is used\nby sys.stdout if the console output code page is set to cp65001 (e.g., using\nchcp 65001 command).\nMultibyte CJK decoders now resynchronize faster.  They only ignore the first\nbyte of an invalid byte sequence. For example, b'\\xff\\n'.decode('gb2312',\n'replace') now returns a \\n after the replacement character.\n(issue 12016)\nIncremental CJK codec encoders are no longer reset at each call to their\nencode() methods. For example:\n$ ./python -q\n>>> import codecs\n>>> encoder = codecs.getincrementalencoder('hz')('strict')\n>>> b''.join(encoder.encode(x) for x in '\\u52ff\\u65bd\\u65bc\\u4eba\\u3002 Bye.')\nb'~{NpJ)l6HK!#~} Bye.'\n\nThis example gives b'~{Np~}~{J)~}~{l6~}~{HK~}~{!#~} Bye.' with older Python\nversions.\n(issue 12100)\nThe unicode_internal codec has been deprecated.", "code_blocks": []}, "improved-modules - collections": {"text": "collections\n\nAddition of a new ChainMap class to allow treating a\nnumber of mappings as a single unit.  (Written by Raymond Hettinger for\nissue 11089, made public in issue 11297)\nThe abstract base classes have been moved in a new collections.abc\nmodule, to better differentiate between the abstract and the concrete\ncollections classes.  Aliases for ABCs are still present in the\ncollections module to preserve existing imports.  (issue 11085)\nThe Counter class now supports the unary + and -\noperators, as well as the in-place operators +=, -=, |=, and\n&=.  (Contributed by Raymond Hettinger in issue 13121.)", "code_blocks": []}, "improved-modules - contextlib": {"text": "contextlib\n\nExitStack now provides a solid foundation for\nprogrammatic manipulation of context managers and similar cleanup\nfunctionality. Unlike the previous contextlib.nested API (which was\ndeprecated and removed), the new API is designed to work correctly\nregardless of whether context managers acquire their resources in\ntheir __init__ method (for example, file objects) or in their\n__enter__ method (for example, synchronisation objects from the\nthreading module).\n(issue 13585)", "code_blocks": []}, "improved-modules - crypt": {"text": "crypt\n\nAddition of salt and modular crypt format (hashing method) and the mksalt()\nfunction to the crypt module.\n(issue 10924)", "code_blocks": []}, "improved-modules - curses": {"text": "curses\n\n\n\nIf the curses module is linked to the ncursesw library, use Unicode\nfunctions when Unicode strings or characters are passed (e.g.\nwaddwstr()), and bytes functions otherwise (e.g. waddstr()).\nUse the locale encoding instead of utf-8 to encode Unicode strings.\ncurses.window has a new curses.window.encoding attribute.\nThe curses.window class has a new get_wch()\nmethod to get a wide character\nThe curses module has a new unget_wch() function to\npush a wide character so the next get_wch() will return\nit\n\n\n(Contributed by Iñigo Serna in issue 6755)", "code_blocks": []}, "improved-modules - datetime": {"text": "datetime\n\n\n\nEquality comparisons between naive and aware datetime\ninstances now return False instead of raising TypeError\n(issue 15006).\nNew datetime.datetime.timestamp() method: Return POSIX timestamp\ncorresponding to the datetime instance.\nThe datetime.datetime.strftime() method supports formatting years\nolder than 1000.\nThe datetime.datetime.astimezone() method can now be\ncalled without arguments to convert datetime instance to the system\ntimezone.", "code_blocks": []}, "improved-modules - decimal": {"text": "decimal\n\n\nissue 7652 - integrate fast native decimal arithmetic.\nC-module and libmpdec written by Stefan Krah.\n\nThe new C version of the decimal module integrates the high speed libmpdec\nlibrary for arbitrary precision correctly-rounded decimal floating point\narithmetic. libmpdec conforms to IBM’s General Decimal Arithmetic Specification.\nPerformance gains range from 10x for database applications to 100x for\nnumerically intensive applications. These numbers are expected gains\nfor standard precisions used in decimal floating point arithmetic. Since\nthe precision is user configurable, the exact figures may vary. For example,\nin integer bignum arithmetic the differences can be significantly higher.\nThe following table is meant as an illustration. Benchmarks are available\nat http://www.bytereef.org/mpdecimal/quickstart.html.\n\n\n\n\n\n\n\n\n\n \ndecimal.py\n_decimal\nspeedup\n\n\n\npi\n42.02s\n0.345s\n120x\n\ntelco\n172.19s\n5.68s\n30x\n\npsycopg\n3.57s\n0.29s\n12x\n\n\n\n\n\nFeatures\n\n\nThe FloatOperation signal optionally enables stricter\nsemantics for mixing floats and Decimals.\nIf Python is compiled without threads, the C version automatically\ndisables the expensive thread local context machinery. In this case,\nthe variable HAVE_THREADS is set to False.\n\n\n\nAPI changes\n\n\nThe C module has the following context limits, depending on the machine\narchitecture:\n\n\n\n\n\n\n\n\n \n32-bit\n64-bit\n\n\n\nMAX_PREC\n425000000\n999999999999999999\n\nMAX_EMAX\n425000000\n999999999999999999\n\nMIN_EMIN\n-425000000\n-999999999999999999\n\n\n\n\n\nIn the context templates (DefaultContext,\nBasicContext and ExtendedContext)\nthe magnitude of Emax and\nEmin has changed to 999999.\n\nThe Decimal constructor in decimal.py does not observe\nthe context limits and converts values with arbitrary exponents or precision\nexactly. Since the C version has internal limits, the following scheme is\nused: If possible, values are converted exactly, otherwise\nInvalidOperation is raised and the result is NaN. In the\nlatter case it is always possible to use create_decimal()\nin order to obtain a rounded or inexact value.\n\nThe power function in decimal.py is always correctly-rounded. In the\nC version, it is defined in terms of the correctly-rounded\nexp() and ln() functions,\nbut the final result is only “almost always correctly rounded”.\n\nIn the C version, the context dictionary containing the signals is a\nMutableMapping.  For speed reasons,\nflags and traps always\nrefer to the same MutableMapping that the context\nwas initialized with. If a new signal dictionary is assigned,\nflags and traps\nare updated with the new values, but they do not reference the RHS\ndictionary.\n\nPickling a Context produces a different output in order\nto have a common interchange format for the Python and C versions.\n\nThe order of arguments in the Context constructor has been\nchanged to match the order displayed by repr().\n\nThe watchexp parameter in the quantize() method\nis deprecated.", "code_blocks": []}, "improved-modules - email": {"text": "email\n\n\nPolicy Framework\n\nThe email package now has a policy framework.  A\nPolicy is an object with several methods and properties\nthat control how the email package behaves.  The primary policy for Python 3.3\nis the Compat32 policy, which provides backward\ncompatibility with the email package in Python 3.2.  A policy can be\nspecified when an email message is parsed by a parser, or when a\nMessage object is created, or when an email is\nserialized using a generator.  Unless overridden, a policy passed\nto a parser is inherited by all the Message object and sub-objects\ncreated by the parser.  By default a generator will use the policy of\nthe Message object it is serializing.  The default policy is\ncompat32.\nThe minimum set of controls implemented by all policy objects are:\n\n\n\n\n\n\n\nmax_line_length\nThe maximum length, excluding the linesep character(s),\nindividual lines may have when a Message is\nserialized.  Defaults to 78.\n\nlinesep\nThe character used to separate individual lines when a\nMessage is serialized.  Defaults to \\n.\n\ncte_type\n7bit or 8bit.  8bit applies only to a\nBytes generator, and means that non-ASCII may\nbe used where allowed by the protocol (or where it\nexists in the original input).\n\nraise_on_defect\nCauses a parser to raise error when defects are\nencountered instead of adding them to the Message\nobject’s defects list.\n\n\n\n\nA new policy instance, with new settings, is created using the\nclone() method of policy objects.  clone takes\nany of the above controls as keyword arguments.  Any control not specified in\nthe call retains its default value.  Thus you can create a policy that uses\n\\r\\n linesep characters like this:\nmypolicy = compat32.clone(linesep='\\r\\n')\n\n\nPolicies can be used to make the generation of messages in the format needed by\nyour application simpler.  Instead of having to remember to specify\nlinesep='\\r\\n' in all the places you call a generator, you can specify\nit once, when you set the policy used by the parser or the Message,\nwhichever your program uses to create Message objects.  On the other hand,\nif you need to generate messages in multiple forms, you can still specify the\nparameters in the appropriate generator call.  Or you can have custom\npolicy instances for your different cases, and pass those in when you create\nthe generator.\n\n\nProvisional Policy with New Header API\n\nWhile the policy framework is worthwhile all by itself, the main motivation for\nintroducing it is to allow the creation of new policies that implement new\nfeatures for the email package in a way that maintains backward compatibility\nfor those who do not use the new policies.  Because the new policies introduce a\nnew API, we are releasing them in Python 3.3 as a provisional policy.  Backwards incompatible changes (up to and including\nremoval of the code) may occur if deemed necessary by the core developers.\nThe new policies are instances of EmailPolicy,\nand add the following additional controls:\n\n\n\n\n\n\n\nrefold_source\nControls whether or not headers parsed by a\nparser are refolded by the\ngenerator.  It can be none, long,\nor all.  The default is long, which means that\nsource headers with a line longer than\nmax_line_length get refolded.  none means no\nline get refolded, and all means that all lines\nget refolded.\n\nheader_factory\nA callable that take a name and value and\nproduces a custom header object.\n\n\n\n\nThe header_factory is the key to the new features provided by the new\npolicies.  When one of the new policies is used, any header retrieved from\na Message object is an object produced by the header_factory, and any\ntime you set a header on a Message it becomes an object produced by\nheader_factory.  All such header objects have a name attribute equal\nto the header name.  Address and Date headers have additional attributes\nthat give you access to the parsed data of the header.  This means you can now\ndo things like this:\n>>> m = Message(policy=SMTP)\n>>> m['To'] = 'Éric <foo@example.com>'\n>>> m['to']\n'Éric <foo@example.com>'\n>>> m['to'].addresses\n(Address(display_name='Éric', username='foo', domain='example.com'),)\n>>> m['to'].addresses[0].username\n'foo'\n>>> m['to'].addresses[0].display_name\n'Éric'\n>>> m['Date'] = email.utils.localtime()\n>>> m['Date'].datetime\ndatetime.datetime(2012, 5, 25, 21, 39, 24, 465484, tzinfo=datetime.timezone(datetime.timedelta(-1, 72000), 'EDT'))\n>>> m['Date']\n'Fri, 25 May 2012 21:44:27 -0400'\n>>> print(m)\nTo: =?utf-8?q?=C3=89ric?= <foo@example.com>\nDate: Fri, 25 May 2012 21:44:27 -0400\n\n\nYou will note that the unicode display name is automatically encoded as\nutf-8 when the message is serialized, but that when the header is accessed\ndirectly, you get the unicode version.  This eliminates any need to deal with\nthe email.header decode_header() or\nmake_header() functions.\nYou can also create addresses from parts:\n>>> m['cc'] = [Group('pals', [Address('Bob', 'bob', 'example.com'),\n...                           Address('Sally', 'sally', 'example.com')]),\n...            Address('Bonzo', addr_spec='bonz@laugh.com')]\n>>> print(m)\nTo: =?utf-8?q?=C3=89ric?= <foo@example.com>\nDate: Fri, 25 May 2012 21:44:27 -0400\ncc: pals: Bob <bob@example.com>, Sally <sally@example.com>;, Bonzo <bonz@laugh.com>\n\n\nDecoding to unicode is done automatically:\n>>> m2 = message_from_string(str(m))\n>>> m2['to']\n'Éric <foo@example.com>'\n\n\nWhen you parse a message, you can use the addresses and groups\nattributes of the header objects to access the groups and individual\naddresses:\n>>> m2['cc'].addresses\n(Address(display_name='Bob', username='bob', domain='example.com'), Address(display_name='Sally', username='sally', domain='example.com'), Address(display_name='Bonzo', username='bonz', domain='laugh.com'))\n>>> m2['cc'].groups\n(Group(display_name='pals', addresses=(Address(display_name='Bob', username='bob', domain='example.com'), Address(display_name='Sally', username='sally', domain='example.com')), Group(display_name=None, addresses=(Address(display_name='Bonzo', username='bonz', domain='laugh.com'),))\n\n\nIn summary, if you use one of the new policies, header manipulation works the\nway it ought to:  your application works with unicode strings, and the email\npackage transparently encodes and decodes the unicode to and from the RFC\nstandard Content Transfer Encodings.\n\n\nOther API Changes\n\nNew BytesHeaderParser, added to the parser\nmodule to complement HeaderParser and complete the Bytes\nAPI.\nNew utility functions:\n\n\nformat_datetime(): given a datetime,\nproduce a string formatted for use in an email header.\nparsedate_to_datetime(): given a date string from\nan email header, convert it into an aware datetime,\nor a naive datetime if the offset is -0000.\nlocaltime(): With no argument, returns the\ncurrent local time as an aware datetime using the local\ntimezone.  Given an aware datetime,\nconverts it into an aware datetime using the\nlocal timezone.", "code_blocks": ["mypolicy = compat32.clone(linesep='\\r\\n')\n", ">>> m = Message(policy=SMTP)\n>>> m['To'] = 'Éric <foo@example.com>'\n>>> m['to']\n'Éric <foo@example.com>'\n>>> m['to'].addresses\n(Address(display_name='Éric', username='foo', domain='example.com'),)\n>>> m['to'].addresses[0].username\n'foo'\n>>> m['to'].addresses[0].display_name\n'Éric'\n>>> m['Date'] = email.utils.localtime()\n>>> m['Date'].datetime\ndatetime.datetime(2012, 5, 25, 21, 39, 24, 465484, tzinfo=datetime.timezone(datetime.timedelta(-1, 72000), 'EDT'))\n>>> m['Date']\n'Fri, 25 May 2012 21:44:27 -0400'\n>>> print(m)\nTo: =?utf-8?q?=C3=89ric?= <foo@example.com>\nDate: Fri, 25 May 2012 21:44:27 -0400\n", ">>> m['cc'] = [Group('pals', [Address('Bob', 'bob', 'example.com'),\n...                           Address('Sally', 'sally', 'example.com')]),\n...            Address('Bonzo', addr_spec='bonz@laugh.com')]\n>>> print(m)\nTo: =?utf-8?q?=C3=89ric?= <foo@example.com>\nDate: Fri, 25 May 2012 21:44:27 -0400\ncc: pals: Bob <bob@example.com>, Sally <sally@example.com>;, Bonzo <bonz@laugh.com>\n", ">>> m2 = message_from_string(str(m))\n>>> m2['to']\n'Éric <foo@example.com>'\n", ">>> m2['cc'].addresses\n(Address(display_name='Bob', username='bob', domain='example.com'), Address(display_name='Sally', username='sally', domain='example.com'), Address(display_name='Bonzo', username='bonz', domain='laugh.com'))\n>>> m2['cc'].groups\n(Group(display_name='pals', addresses=(Address(display_name='Bob', username='bob', domain='example.com'), Address(display_name='Sally', username='sally', domain='example.com')), Group(display_name=None, addresses=(Address(display_name='Bonzo', username='bonz', domain='laugh.com'),))\n"]}, "improved-modules - ftplib": {"text": "ftplib\n\n\nftplib.FTP now accepts a source_address keyword argument to\nspecify the (host, port) to use as the source address in the bind call\nwhen creating the outgoing socket.  (Contributed by Giampaolo Rodolà\nin issue 8594.)\nThe FTP_TLS class now provides a new\nccc() function to revert control channel back to\nplaintext.  This can be useful to take advantage of firewalls that know how\nto handle NAT with non-secure FTP without opening fixed ports.  (Contributed\nby Giampaolo Rodolà in issue 12139)\nAdded ftplib.FTP.mlsd() method which provides a parsable directory\nlisting format and deprecates ftplib.FTP.nlst() and\nftplib.FTP.dir().  (Contributed by Giampaolo Rodolà in issue 11072)", "code_blocks": []}, "improved-modules - functools": {"text": "functools\n\nThe functools.lru_cache() decorator now accepts a typed keyword\nargument (that defaults to False to ensure that it caches values of\ndifferent types that compare equal in separate cache slots.  (Contributed\nby Raymond Hettinger in issue 13227.)", "code_blocks": []}, "improved-modules - gc": {"text": "gc\n\nIt is now possible to register callbacks invoked by the garbage collector\nbefore and after collection using the new callbacks list.", "code_blocks": []}, "improved-modules - hmac": {"text": "hmac\n\nA new compare_digest() function has been added to prevent side\nchannel attacks on digests through timing analysis.  (Contributed by Nick\nCoghlan and Christian Heimes in issue 15061)", "code_blocks": []}, "improved-modules - http": {"text": "http\n\nhttp.server.BaseHTTPRequestHandler now buffers the headers and writes\nthem all at once when end_headers() is\ncalled.  A new method flush_headers()\ncan be used to directly manage when the accumlated headers are sent.\n(Contributed by Andrew Schaaf in issue 3709.)\nhttp.server now produces valid HTML 4.01 strict output.\n(Contributed by Ezio Melotti in issue 13295.)\nhttp.client.HTTPResponse now has a\nreadinto() method, which means it can be used\nas a io.RawIOBase class.  (Contributed by John Kuhn in\nissue 13464.)", "code_blocks": []}, "improved-modules - html": {"text": "html\n\nhtml.parser.HTMLParser is now able to parse broken markup without\nraising errors, therefore the strict argument of the constructor and the\nHTMLParseError exception are now deprecated.\nThe ability to parse broken markup is the result of a number of bug fixes that\nare also available on the latest bug fix releases of Python 2.7/3.2.\n(Contributed by Ezio Melotti in issue 15114, and issue 14538,\nissue 13993, issue 13960, issue 13358, issue 1745761,\nissue 755670, issue 13357, issue 12629, issue 1200313,\nissue 670664, issue 13273, issue 12888, issue 7311)\nA new html5 dictionary that maps HTML5 named character\nreferences to the equivalent Unicode character(s) (e.g. html5['gt;'] ==\n'>') has been added to the html.entities module.  The dictionary is\nnow also used by HTMLParser.  (Contributed by Ezio\nMelotti in issue 11113 and issue 15156)", "code_blocks": []}, "improved-modules - imaplib": {"text": "imaplib\n\nThe IMAP4_SSL constructor now accepts an SSLContext\nparameter to control parameters of the secure channel.\n(Contributed by Sijin Joseph in issue 8808)", "code_blocks": []}, "improved-modules - inspect": {"text": "inspect\n\nA new getclosurevars() function has been added. This function\nreports the current binding of all names referenced from the function body and\nwhere those names were resolved, making it easier to verify correct internal\nstate when testing code that relies on stateful closures.\n(Contributed by Meador Inge and Nick Coghlan in issue 13062)\nA new getgeneratorlocals() function has been added. This\nfunction reports the current binding of local variables in the generator’s\nstack frame, making it easier to verify correct internal state when testing\ngenerators.\n(Contributed by Meador Inge in issue 15153)", "code_blocks": []}, "improved-modules - io": {"text": "io\n\nThe open() function has a new 'x' mode that can be used to\nexclusively create a new file, and raise a FileExistsError if the file\nalready exists. It is based on the C11 ‘x’ mode to fopen().\n(Contributed by David Townshend in issue 12760)\nThe constructor of the TextIOWrapper class has a new\nwrite_through optional argument. If write_through is True, calls to\nwrite() are guaranteed not to be buffered: any data\nwritten on the TextIOWrapper object is immediately handled to its\nunderlying binary buffer.", "code_blocks": []}, "improved-modules - itertools": {"text": "itertools\n\naccumulate() now takes an optional func argument for\nproviding a user-supplied binary function.", "code_blocks": []}, "improved-modules - logging": {"text": "logging\n\nThe basicConfig() function now supports an optional handlers\nargument taking an iterable of handlers to be added to the root logger.\nA class level attribute append_nul has\nbeen added to SysLogHandler to allow control of the\nappending of the NUL (\\000) byte to syslog records, since for some\ndeamons it is required while for others it is passed through to the log.", "code_blocks": []}, "improved-modules - math": {"text": "math\n\nThe math module has a new function, log2(),  which returns\nthe base-2 logarithm of x.\n(Written by Mark Dickinson in issue 11888).", "code_blocks": []}, "improved-modules - mmap": {"text": "mmap\n\nThe read() method is now more compatible with other file-like\nobjects: if the argument is omitted or specified as None, it returns the\nbytes from the current file position to the end of the mapping.  (Contributed\nby Petri Lehtinen in issue 12021.)", "code_blocks": []}, "improved-modules - multiprocessing": {"text": "multiprocessing\n\nThe new multiprocessing.connection.wait() function allows to poll\nmultiple objects (such as connections, sockets and pipes) with a timeout.\n(Contributed by Richard Oudkerk in issue 12328.)\nmultiprocessing.Connection objects can now be transferred over\nmultiprocessing connections.\n(Contributed by Richard Oudkerk in issue 4892.)\nmultiprocessing.Process now accepts a daemon keyword argument\nto override the default behavior of inheriting the daemon flag from\nthe parent process (issue 6064).\nNew attribute attribute multiprocessing.Process.sentinel allows a\nprogram to wait on multiple Process objects at one\ntime using the appropriate OS primitives (for example, select on\nposix systems).\nNew methods multiprocessing.pool.Pool.starmap() and\nstarmap_async() provide\nitertools.starmap() equivalents to the existing\nmultiprocessing.pool.Pool.map() and\nmap_async() functions.  (Contributed by Hynek\nSchlawack in issue 12708.)", "code_blocks": []}, "improved-modules - nntplib": {"text": "nntplib\n\nThe nntplib.NNTP class now supports the context manager protocol to\nunconditionally consume socket.error exceptions and to close the NNTP\nconnection when done:\n>>> from nntplib import NNTP\n>>> with NNTP('news.gmane.org') as n:\n...     n.group('gmane.comp.python.committers')\n...\n('211 1755 1 1755 gmane.comp.python.committers', 1755, 1, 1755, 'gmane.comp.python.committers')\n>>>\n\n\n(Contributed by Giampaolo Rodolà in issue 9795)", "code_blocks": [">>> from nntplib import NNTP\n>>> with NNTP('news.gmane.org') as n:\n...     n.group('gmane.comp.python.committers')\n...\n('211 1755 1 1755 gmane.comp.python.committers', 1755, 1, 1755, 'gmane.comp.python.committers')\n>>>\n"]}, "improved-modules - os": {"text": "os\n\n\nThe os module has a new pipe2() function that makes it\npossible to create a pipe with O_CLOEXEC or\nO_NONBLOCK flags set atomically. This is especially useful to\navoid race conditions in multi-threaded programs.\n\nThe os module has a new sendfile() function which provides\nan efficent “zero-copy” way for copying data from one file (or socket)\ndescriptor to another. The phrase “zero-copy” refers to the fact that all of\nthe copying of data between the two descriptors is done entirely by the\nkernel, with no copying of data into userspace buffers. sendfile()\ncan be used to efficiently copy data from a file on disk to a network socket,\ne.g. for downloading a file.\n(Patch submitted by Ross Lagerwall and Giampaolo Rodolà in issue 10882.)\n\nTo avoid race conditions like symlink attacks and issues with temporary\nfiles and directories, it is more reliable (and also faster) to manipulate\nfile descriptors instead of file names. Python 3.3 enhances existing functions\nand introduces new functions to work on file descriptors (issue 4761,\nissue 10755 and issue 14626).\n\nThe os module has a new fwalk() function similar to\nwalk() except that it also yields file descriptors referring to the\ndirectories visited. This is especially useful to avoid symlink races.\nThe following functions get new optional dir_fd (paths relative to\ndirectory descriptors) and/or follow_symlinks (not\nfollowing symlinks):\naccess(), chflags(), chmod(), chown(),\nlink(), lstat(), mkdir(), mkfifo(),\nmknod(), open(), readlink(), remove(),\nrename(), replace(), rmdir(), stat(),\nsymlink(), unlink(), utime().  Platform\nsupport for using these parameters can be checked via the sets\nos.supports_dir_fd and os.supports_follows_symlinks.\nThe following functions now support a file descriptor for their path argument:\nchdir(), chmod(), chown(),\nexecve(), listdir(), pathconf(), exists(),\nstat(), statvfs(), utime().  Platform support\nfor this can be checked via the os.supports_fd set.\n\n\naccess() accepts an effective_ids keyword argument to turn on\nusing the effective uid/gid rather than the real uid/gid in the access check.\nPlatform support for this can be checked via the\nsupports_effective_ids set.\n\nThe os module has two new functions: getpriority() and\nsetpriority(). They can be used to get or set process\nniceness/priority in a fashion similar to os.nice() but extended to all\nprocesses instead of just the current one.\n(Patch submitted by Giampaolo Rodolà in issue 10784.)\n\nThe new os.replace() function allows cross-platform renaming of a\nfile with overwriting the destination.  With os.rename(), an existing\ndestination file is overwritten under POSIX, but raises an error under\nWindows.\n(Contributed by Antoine Pitrou in issue 8828.)\n\nThe stat family of functions (stat(), fstat(),\nand lstat()) now support reading a file’s timestamps\nwith nanosecond precision.  Symmetrically, utime()\ncan now write file timestamps with nanosecond precision.  (Contributed by\nLarry Hastings in issue 14127.)\n\nThe new os.get_terminal_size() function queries the size of the\nterminal attached to a file descriptor. See also\nshutil.get_terminal_size().\n(Contributed by Zbigniew Jędrzejewski-Szmek in issue 13609.)\n\n\n\nNew functions to support Linux extended attributes (issue 12720):\ngetxattr(), listxattr(), removexattr(),\nsetxattr().\nNew interface to the scheduler. These functions\ncontrol how a process is allocated CPU time by the operating system. New\nfunctions:\nsched_get_priority_max(), sched_get_priority_min(),\nsched_getaffinity(), sched_getparam(),\nsched_getscheduler(), sched_rr_get_interval(),\nsched_setaffinity(), sched_setparam(),\nsched_setscheduler(), sched_yield(),\nNew functions to control the file system:\nposix_fadvise(): Announces an intention to access data in a\nspecific pattern thus allowing the kernel to make optimizations.\nposix_fallocate(): Ensures that enough disk space is allocated\nfor a file.\nsync(): Force write of everything to disk.\n\n\nAdditional new  posix functions:\nlockf(): Apply, test or remove a POSIX lock on an open file descriptor.\npread(): Read from a file descriptor at an offset, the file\noffset remains unchanged.\npwrite(): Write to a file descriptor from an offset, leaving\nthe file offset unchanged.\nreadv(): Read from a file descriptor into a number of writable buffers.\ntruncate(): Truncate the file corresponding to path, so that\nit is at most length bytes in size.\nwaitid(): Wait for the completion of one or more child processes.\nwritev(): Write the contents of buffers to a file descriptor,\nwhere buffers is an arbitrary sequence of buffers.\ngetgrouplist() (issue 9344): Return list of group ids that\nspecified user belongs to.\n\n\ntimes() and uname(): Return type changed from a tuple to\na tuple-like object with named attributes.\nSome platforms now support additional constants for the lseek()\nfunction, such as os.SEEK_HOLE and os.SEEK_DATA.\nNew constants RTLD_LAZY, RTLD_NOW,\nRTLD_GLOBAL, RTLD_LOCAL, RTLD_NODELETE,\nRTLD_NOLOAD, and RTLD_DEEPBIND are available on\nplatforms that support them.   These are for use with the\nsys.setdlopenflags() function, and supersede the similar constants\ndefined in ctypes and DLFCN.  (Contributed by Victor Stinner\nin issue 13226.)\nos.symlink() now accepts (and ignores) the target_is_directory\nkeyword argument on non-Windows platforms, to ease cross-platform support.", "code_blocks": []}, "improved-modules - pdb": {"text": "pdb\n\nTab-completion is now available not only for command names, but also their\narguments.  For example, for the break command, function and file names\nare completed.\n(Contributed by Georg Brandl in issue 14210)", "code_blocks": []}, "improved-modules - pickle": {"text": "pickle\n\npickle.Pickler objects now have an optional\ndispatch_table attribute allowing to set per-pickler\nreduction functions.\n(Contributed by Richard Oudkerk in issue 14166.)", "code_blocks": []}, "improved-modules - pydoc": {"text": "pydoc\n\nThe Tk GUI and the serve() function have been removed from the\npydoc module: pydoc -g and serve() have been deprecated\nin Python 3.2.", "code_blocks": []}, "improved-modules - re": {"text": "re\n\nstr regular expressions now support \\u and \\U escapes.\n(Contributed by Serhiy Storchaka in issue 3665.)", "code_blocks": []}, "improved-modules - sched": {"text": "sched\n\n\nrun() now accepts a blocking parameter which when\nset to False makes the method execute the scheduled events due to expire\nsoonest (if any) and then return immediately.\nThis is useful in case you want to use the scheduler in\nnon-blocking applications.  (Contributed by Giampaolo Rodolà in issue 13449)\nscheduler class can now be safely used in multi-threaded\nenvironments.  (Contributed by Josiah Carlson and Giampaolo Rodolà in\nissue 8684)\ntimefunc and delayfunct parameters of scheduler class\nconstructor are now optional and defaults to time.time() and\ntime.sleep() respectively.  (Contributed by Chris Clark in\nissue 13245)\nenter() and enterabs()\nargument parameter is now optional.  (Contributed by Chris Clark in\nissue 13245)\nenter() and enterabs()\nnow accept a kwargs parameter.  (Contributed by Chris Clark in\nissue 13245)", "code_blocks": []}, "improved-modules - select": {"text": "select\n\nSolaris and derivative platforms have a new class select.devpoll\nfor high performance asynchronous sockets via /dev/poll.\n(Contributed by Jesús Cea Avión in issue 6397.)", "code_blocks": []}, "improved-modules - shlex": {"text": "shlex\n\nThe previously undocumented helper function quote from the\npipes modules has been moved to the shlex module and\ndocumented.  quote() properly escapes all characters in a string\nthat might be otherwise given special meaning by the shell.", "code_blocks": []}, "improved-modules - shutil": {"text": "shutil\n\n\nNew functions:\ndisk_usage(): provides total, used and free disk space\nstatistics. (Contributed by Giampaolo Rodolà in issue 12442)\nchown(): allows one to change user and/or group of the given\npath also specifying the user/group names and not only their numeric\nids. (Contributed by Sandro Tosi in issue 12191)\nshutil.get_terminal_size(): returns the size of the terminal window\nto which the interpreter is attached.  (Contributed by Zbigniew\nJędrzejewski-Szmek in issue 13609.)\n\n\ncopy2() and copystat() now preserve file\ntimestamps with nanosecond precision on platforms that support it.\nThey also preserve file “extended attributes” on Linux.  (Contributed\nby Larry Hastings in issue 14127 and  issue 15238.)\nSeveral functions now take an optional symlinks argument: when that\nparameter is true, symlinks aren’t dereferenced and the operation instead\nacts on the symlink itself (or creates one, if relevant).\n(Contributed by Hynek Schlawack in issue 12715.)\nWhen copying files to a different file system, move() now\nhandles symlinks the way the posix mv command does, recreating the\nsymlink rather than copying the target file contents.  (Contributed by\nJonathan Niehof in issue 9993.)  move() now also returns\nthe dst argument as its result.\nrmtree() is now resistant to symlink attacks on platforms\nwhich support the new dir_fd parameter in os.open() and\nos.unlink(). (Contributed by Martin von Löwis and Hynek Schlawack\nin issue 4489.)", "code_blocks": []}, "improved-modules - signal": {"text": "signal\n\n\nThe signal module has new functions:\npthread_sigmask(): fetch and/or change the signal mask of the\ncalling thread (Contributed by Jean-Paul Calderone in issue 8407);\npthread_kill(): send a signal to a thread;\nsigpending(): examine pending functions;\nsigwait(): wait a signal;\nsigwaitinfo(): wait for a signal, returning detailed\ninformation about it;\nsigtimedwait(): like sigwaitinfo() but with a\ntimeout.\n\n\nThe signal handler writes the signal number as a single byte instead of\na nul byte into the wakeup file descriptor. So it is possible to wait more\nthan one signal and know which signals were raised.\nsignal.signal() and signal.siginterrupt() raise an OSError,\ninstead of a RuntimeError: OSError has an errno attribute.", "code_blocks": []}, "improved-modules - smtpd": {"text": "smtpd\n\nThe smtpd module now supports RFC 5321 (extended SMTP) and RFC 1870\n(size extension).  Per the standard, these extensions are enabled if and only\nif the client initiates the session with an EHLO command.\n(Initial ELHO support by Alberto Trevino.  Size extension by Juhana\nJauhiainen.  Substantial additional work on the patch contributed by Michele\nOrrù and Dan Boswell.  issue 8739)", "code_blocks": []}, "improved-modules - smtplib": {"text": "smtplib\n\nThe SMTP, SMTP_SSL, and\nLMTP classes now accept a source_address keyword argument\nto specify the (host, port) to use as the source address in the bind call\nwhen creating the outgoing socket.  (Contributed by Paulo Scardine in\nissue 11281.)\nSMTP now supports the context manager protocol, allowing an\nSMTP instance to be used in a with statement.  (Contributed\nby Giampaolo Rodolà in issue 11289.)\nThe SMTP_SSL constructor and the starttls()\nmethod now accept an SSLContext parameter to control parameters of the secure\nchannel.  (Contributed by Kasun Herath in issue 8809)", "code_blocks": []}, "improved-modules - socket": {"text": "socket\n\n\nThe socket class now exposes additional methods to process\nancillary data when supported by the underlying platform:\n\nsendmsg()\nrecvmsg()\nrecvmsg_into()\n\n(Contributed by David Watson in issue 6560, based on an earlier patch by\nHeiko Wundram)\n\nThe socket class now supports the PF_CAN protocol family\n(http://en.wikipedia.org/wiki/Socketcan), on Linux\n(http://lwn.net/Articles/253425).\n(Contributed by Matthias Fuchs, updated by Tiago Gonçalves in issue 10141)\n\nThe socket class now supports the PF_RDS protocol family\n(http://en.wikipedia.org/wiki/Reliable_Datagram_Sockets and\nhttp://oss.oracle.com/projects/rds/).\n\nThe socket class now supports the PF_SYSTEM protocol\nfamily on OS X.  (Contributed by Michael Goderbauer in issue 13777.)\n\nNew function sethostname() allows the hostname to be set\non unix systems if the calling process has sufficient privileges.\n(Contributed by Ross Lagerwall in issue 10866.)", "code_blocks": []}, "improved-modules - socketserver": {"text": "socketserver\n\nBaseServer now has an overridable method\nservice_actions() that is called by the\nserve_forever() method in the service loop.\nForkingMixIn now uses this to clean up zombie\nchild proceses.  (Contributed by Justin Warkentin in issue 11109.)", "code_blocks": []}, "improved-modules - sqlite3": {"text": "sqlite3\n\nNew sqlite3.Connection method\nset_trace_callback() can be used to capture a trace of\nall sql commands processed by sqlite.  (Contributed by Torsten Landschoff\nin issue 11688.)", "code_blocks": []}, "improved-modules - ssl": {"text": "ssl\n\n\nThe ssl module has two new random generation functions:\n\nRAND_bytes(): generate cryptographically strong\npseudo-random bytes.\nRAND_pseudo_bytes(): generate pseudo-random bytes.\n\n(Contributed by Victor Stinner in issue 12049)\n\nThe ssl module now exposes a finer-grained exception hierarchy\nin order to make it easier to inspect the various kinds of errors.\n(Contributed by Antoine Pitrou in issue 11183)\n\nload_cert_chain() now accepts a password argument\nto be used if the private key is encrypted.\n(Contributed by Adam Simpkins in issue 12803)\n\nDiffie-Hellman key exchange, both regular and Elliptic Curve-based, is\nnow supported through the load_dh_params() and\nset_ecdh_curve() methods.\n(Contributed by Antoine Pitrou in issue 13626 and issue 13627)\n\nSSL sockets have a new get_channel_binding() method\nallowing the implementation of certain authentication mechanisms such as\nSCRAM-SHA-1-PLUS.  (Contributed by Jacek Konieczny in issue 12551)\n\nYou can query the SSL compression algorithm used by an SSL socket, thanks\nto its new compression() method.  The new attribute\nOP_NO_COMPRESSION can be used to disable compression.\n(Contributed by Antoine Pitrou in issue 13634)\n\nSupport has been added for the Next Procotol Negotiation extension using\nthe ssl.SSLContext.set_npn_protocols() method.\n(Contributed by Colin Marc in issue 14204)\n\nSSL errors can now be introspected more easily thanks to\nlibrary and reason attributes.\n(Contributed by Antoine Pitrou in issue 14837)\n\nThe get_server_certificate() function now supports IPv6.\n(Contributed by Charles-François Natali in issue 11811.)\n\nNew attribute OP_CIPHER_SERVER_PREFERENCE allows setting\nSSLv3 server sockets to use the server’s cipher ordering preference rather\nthan the client’s (issue 13635).", "code_blocks": []}, "improved-modules - stat": {"text": "stat\n\nThe undocumented tarfile.filemode function has been moved to\nstat.filemode(). It can be used to convert a file’s mode to a string of\nthe form ‘-rwxrwxrwx’.\n(Contributed by Giampaolo Rodolà in issue 14807)", "code_blocks": []}, "improved-modules - struct": {"text": "struct\n\nThe struct module now supports ssize_t and size_t via the\nnew codes n and N, respectively.  (Contributed by Antoine Pitrou\nin issue 3163.)", "code_blocks": []}, "improved-modules - subprocess": {"text": "subprocess\n\nCommand strings can now be bytes objects on posix platforms.  (Contributed by\nVictor Stinner in issue 8513.)\nA new constant DEVNULL allows suppressing output in a\nplatform-independent fashion.  (Contributed by Ross Lagerwall in\nissue 5870.)", "code_blocks": []}, "improved-modules - sys": {"text": "sys\n\nThe sys module has a new thread_info struct\nsequence holding informations about the thread implementation\n(issue 11223).", "code_blocks": []}, "improved-modules - tarfile": {"text": "tarfile\n\ntarfile now supports lzma encoding via the lzma module.\n(Contributed by Lars Gustäbel in issue 5689.)", "code_blocks": []}, "improved-modules - tempfile": {"text": "tempfile\n\ntempfile.SpooledTemporaryFile‘s\ntruncate() method now accepts\na size parameter.  (Contributed by Ryan Kelly in issue 9957.)", "code_blocks": []}, "improved-modules - textwrap": {"text": "textwrap\n\nThe textwrap module has a new indent() that makes\nit straightforward to add a common prefix to selected lines in a block\nof text  (issue 13857).", "code_blocks": []}, "improved-modules - threading": {"text": "threading\n\nthreading.Condition, threading.Semaphore,\nthreading.BoundedSemaphore, threading.Event, and\nthreading.Timer, all of which used to be factory functions returning a\nclass instance, are now classes and may be subclassed. (Contributed by Éric\nAraujo in issue 10968).\nThe threading.Thread constructor now accepts a daemon keyword\nargument to override the default behavior of inheriting the deamon flag\nvalue from the parent thread (issue 6064).\nThe formerly private function _thread.get_ident is now available as the\npublic function threading.get_ident().  This eliminates several cases of\ndirect access to the _thread module in the stdlib.  Third party code that\nused _thread.get_ident should likewise be changed to use the new public\ninterface.", "code_blocks": []}, "improved-modules - time": {"text": "time\n\nThe PEP 418 added new functions to the time module:\n\nget_clock_info(): Get information on a clock.\nmonotonic(): Monotonic clock (cannot go backward), not affected\nby system clock updates.\nperf_counter(): Performance counter with the highest available\nresolution to measure a short duration.\nprocess_time(): Sum of the system and user CPU time of the\ncurrent process.\n\nOther new functions:\n\nclock_getres(), clock_gettime() and\nclock_settime() functions with CLOCK_xxx constants.\n(Contributed by Victor Stinner in issue 10278)\n\nTo improve cross platform consistency, sleep() now raises a\nValueError when passed a negative sleep value.  Previously this was an\nerror on posix, but produced an infinite sleep on Windows.", "code_blocks": []}, "improved-modules - types": {"text": "types\n\nAdd a new types.MappingProxyType class: Read-only proxy of a mapping.\n(issue 14386)\nThe new functions types.new_class and types.prepare_class provide support\nfor PEP 3115 compliant dynamic type creation. (issue 14588)", "code_blocks": []}, "improved-modules - unittest": {"text": "unittest\n\nassertRaises(), assertRaisesRegex(), assertWarns(), and\nassertWarnsRegex() now accept a keyword argument msg when used as\ncontext managers.  (Contributed by Ezio Melotti and Winston Ewert in\nissue 10775)\nunittest.TestCase.run() now returns the TestResult\nobject.", "code_blocks": []}, "improved-modules - urllib": {"text": "urllib\n\nThe Request class, now accepts a method argument\nused by get_method() to determine what HTTP method\nshould be used.  For example, this will send a 'HEAD' request:\n>>> urlopen(Request('http://www.python.org', method='HEAD'))\n\n\n(issue 1673007)", "code_blocks": [">>> urlopen(Request('http://www.python.org', method='HEAD'))\n"]}, "improved-modules - webbrowser": {"text": "webbrowser\n\nThe webbrowser module supports more “browsers”: Google Chrome (named\nchrome, chromium, chrome-browser or\nchromium-browser depending on the version and operating system),\nand the generic launchers xdg-open, from the FreeDesktop.org\nproject, and gvfs-open, which is the default URI handler for GNOME\n3.  (The former contributed by Arnaud Calmettes in issue 13620, the latter\nby Matthias Klose in issue 14493)", "code_blocks": []}, "improved-modules - xml-etree-elementtree": {"text": "xml.etree.ElementTree\n\nThe xml.etree.ElementTree module now imports its C accelerator by\ndefault; there is no longer a need to explicitly import\nxml.etree.cElementTree (this module stays for backwards compatibility,\nbut is now deprecated).  In addition,  the iter family of methods of\nElement has been optimized (rewritten in C).\nThe module’s documentation has also been greatly improved with added examples\nand a more detailed reference.", "code_blocks": []}, "improved-modules - zlib": {"text": "zlib\n\nNew attribute zlib.Decompress.eof makes it possible to distinguish\nbetween a properly-formed compressed stream and an incomplete or truncated one.\n(Contributed by Nadeem Vawda in issue 12646.)\nNew attribute zlib.ZLIB_RUNTIME_VERSION reports the version string of\nthe underlying zlib library that is loaded at runtime.  (Contributed by\nTorsten Landschoff in issue 12306.)", "code_blocks": []}, "optimizations": {"text": "Optimizations\n\nMajor performance enhancements have been added:\n\nThanks to PEP 393, some operations on Unicode strings have been optimized:\n\nthe memory footprint is divided by 2 to 4 depending on the text\nencode an ASCII string to UTF-8 doesn’t need to encode characters anymore,\nthe UTF-8 representation is shared with the ASCII representation\nthe UTF-8 encoder has been optimized\nrepeating a single ASCII letter and getting a substring of a ASCII strings\nis 4 times faster\n\n\nUTF-8 is now 2x to 4x faster.  UTF-16 encoding is now up to 10x faster.\n(contributed by Serhiy Storchaka, issue 14624, issue 14738 and\nissue 15026.)", "code_blocks": []}, "build-and-c-api-changes": {"text": "Build and C API Changes\n\nChanges to Python’s build process and to the C API include:\n\nNew PEP 3118 related function:\nPyMemoryView_FromMemory()\n\n\nPEP 393 added new Unicode types, macros and functions:\nHigh-level API:\nPyUnicode_CopyCharacters()\nPyUnicode_FindChar()\nPyUnicode_GetLength(), PyUnicode_GET_LENGTH\nPyUnicode_New()\nPyUnicode_Substring()\nPyUnicode_ReadChar(), PyUnicode_WriteChar()\n\n\nLow-level API:\nPy_UCS1, Py_UCS2, Py_UCS4 types\nPyASCIIObject and PyCompactUnicodeObject structures\nPyUnicode_READY\nPyUnicode_FromKindAndData()\nPyUnicode_AsUCS4(), PyUnicode_AsUCS4Copy()\nPyUnicode_DATA, PyUnicode_1BYTE_DATA,\nPyUnicode_2BYTE_DATA, PyUnicode_4BYTE_DATA\nPyUnicode_KIND with PyUnicode_Kind enum:\nPyUnicode_WCHAR_KIND, PyUnicode_1BYTE_KIND,\nPyUnicode_2BYTE_KIND, PyUnicode_4BYTE_KIND\nPyUnicode_READ, PyUnicode_READ_CHAR, PyUnicode_WRITE\nPyUnicode_MAX_CHAR_VALUE\n\n\n\n\nPyArg_ParseTuple now accepts a bytearray for the c\nformat (issue 12380).", "code_blocks": []}, "deprecated - unsupported-operating-systems": {"text": "Unsupported Operating Systems\n\nOS/2 and VMS are no longer supported due to the lack of a maintainer.\nWindows 2000 and Windows platforms which set COMSPEC to command.com\nare no longer supported due to maintenance burden.\nOSF support, which was deprecated in 3.2, has been completely removed.", "code_blocks": []}, "deprecated - deprecated-python-modules-functions-and-methods": {"text": "Deprecated Python modules, functions and methods\n\n\nPassing a non-empty string to object.__format__() is deprecated, and\nwill produce a TypeError in Python 3.4 (issue 9856).\nThe unicode_internal codec has been deprecated because of the\nPEP 393, use UTF-8, UTF-16 (utf-16-le or utf-16-be), or UTF-32\n(utf-32-le or utf-32-be)\nftplib.FTP.nlst() and ftplib.FTP.dir(): use\nftplib.FTP.mlsd()\nplatform.popen(): use the subprocess module. Check especially\nthe Replacing Older Functions with the subprocess Module section (issue 11377).\nissue 13374: The Windows bytes API has been deprecated in the os\nmodule. Use Unicode filenames, instead of bytes filenames, to not depend on\nthe ANSI code page anymore and to support any filename.\nissue 13988: The xml.etree.cElementTree module is deprecated.  The\naccelerator is used automatically whenever available.\nThe behaviour of time.clock() depends on the platform: use the new\ntime.perf_counter() or time.process_time() function instead,\ndepending on your requirements, to have a well defined behaviour.\nThe os.stat_float_times() function is deprecated.\nabc module:\nabc.abstractproperty has been deprecated, use property\nwith abc.abstractmethod() instead.\nabc.abstractclassmethod has been deprecated, use\nclassmethod with abc.abstractmethod() instead.\nabc.abstractstaticmethod has been deprecated, use\nstaticmethod with abc.abstractmethod() instead.\n\n\nimportlib package:\nimportlib.abc.SourceLoader.path_mtime() is now deprecated in favour of\nimportlib.abc.SourceLoader.path_stats() as bytecode files now store\nboth the modification time and size of the source file the bytecode file was\ncompiled from.", "code_blocks": []}, "deprecated - deprecated-functions-and-types-of-the-c-api": {"text": "Deprecated functions and types of the C API\n\nThe Py_UNICODE has been deprecated by PEP 393 and will be\nremoved in Python 4. All functions using this type are deprecated:\nUnicode functions and methods using Py_UNICODE and\nPy_UNICODE* types:\n\nPyUnicode_FromUnicode: use PyUnicode_FromWideChar() or\nPyUnicode_FromKindAndData()\nPyUnicode_AS_UNICODE, PyUnicode_AsUnicode(),\nPyUnicode_AsUnicodeAndSize(): use PyUnicode_AsWideCharString()\nPyUnicode_AS_DATA: use PyUnicode_DATA with\nPyUnicode_READ and PyUnicode_WRITE\nPyUnicode_GET_SIZE, PyUnicode_GetSize(): use\nPyUnicode_GET_LENGTH or PyUnicode_GetLength()\nPyUnicode_GET_DATA_SIZE: use\nPyUnicode_GET_LENGTH(str) * PyUnicode_KIND(str) (only work on ready\nstrings)\nPyUnicode_AsUnicodeCopy(): use PyUnicode_AsUCS4Copy() or\nPyUnicode_AsWideCharString()\nPyUnicode_GetMax()\n\nFunctions and macros manipulating Py_UNICODE* strings:\n\nPy_UNICODE_strlen: use PyUnicode_GetLength() or\nPyUnicode_GET_LENGTH\nPy_UNICODE_strcat: use PyUnicode_CopyCharacters() or\nPyUnicode_FromFormat()\nPy_UNICODE_strcpy, Py_UNICODE_strncpy,\nPy_UNICODE_COPY: use PyUnicode_CopyCharacters() or\nPyUnicode_Substring()\nPy_UNICODE_strcmp: use PyUnicode_Compare()\nPy_UNICODE_strncmp: use PyUnicode_Tailmatch()\nPy_UNICODE_strchr, Py_UNICODE_strrchr: use\nPyUnicode_FindChar()\nPy_UNICODE_FILL: use PyUnicode_Fill()\nPy_UNICODE_MATCH\n\nEncoders:\n\nPyUnicode_Encode(): use PyUnicode_AsEncodedObject()\nPyUnicode_EncodeUTF7()\nPyUnicode_EncodeUTF8(): use PyUnicode_AsUTF8() or\nPyUnicode_AsUTF8String()\nPyUnicode_EncodeUTF32()\nPyUnicode_EncodeUTF16()\nPyUnicode_EncodeUnicodeEscape:() use\nPyUnicode_AsUnicodeEscapeString()\nPyUnicode_EncodeRawUnicodeEscape:() use\nPyUnicode_AsRawUnicodeEscapeString()\nPyUnicode_EncodeLatin1(): use PyUnicode_AsLatin1String()\nPyUnicode_EncodeASCII(): use PyUnicode_AsASCIIString()\nPyUnicode_EncodeCharmap()\nPyUnicode_TranslateCharmap()\nPyUnicode_EncodeMBCS(): use PyUnicode_AsMBCSString() or\nPyUnicode_EncodeCodePage() (with CP_ACP code_page)\nPyUnicode_EncodeDecimal(),\nPyUnicode_TransformDecimalToASCII()", "code_blocks": []}, "deprecated - deprecated-features": {"text": "Deprecated features\n\nThe array module’s 'u' format code is now deprecated and will be\nremoved in Python 4 together with the rest of the (Py_UNICODE) API.", "code_blocks": []}, "porting-to-python-3-3 - porting-python-code": {"text": "Porting Python code\n\n\nHash randomization is enabled by default. Set the PYTHONHASHSEED\nenvironment variable to 0 to disable hash randomization. See also the\nobject.__hash__() method.\nissue 12326: On Linux, sys.platform doesn’t contain the major version\nanymore. It is now always ‘linux’, instead of ‘linux2’ or ‘linux3’ depending\non the Linux version used to build Python. Replace sys.platform == ‘linux2’\nwith sys.platform.startswith(‘linux’), or directly sys.platform == ‘linux’ if\nyou don’t need to support older Python versions.\nissue 13847, issue 14180: time and datetime:\nOverflowError is now raised instead of ValueError if a\ntimestamp is out of range. OSError is now raised if C functions\ngmtime() or localtime() failed.\nThe default finders used by import now utilize a cache of what is contained\nwithin a specific directory. If you create a Python source file or sourceless\nbytecode file, make sure to call importlib.invalidate_caches() to clear\nout the cache for the finders to notice the new file.\nImportError now uses the full name of the module that was attemped to\nbe imported. Doctests that check ImportErrors’ message will need to be\nupdated to use the full name of the module instead of just the tail of the\nname.\nThe index argument to __import__() now defaults to 0 instead of -1\nand no longer support negative values. It was an oversight when PEP 328 was\nimplemented that the default value remained -1. If you need to continue to\nperform a relative import followed by an absolute import, then perform the\nrelative import using an index of 1, followed by another import using an\nindex of 0. It is preferred, though, that you use\nimportlib.import_module() rather than call __import__() directly.\n__import__() no longer allows one to use an index value other than 0\nfor top-level modules. E.g. __import__('sys', level=1) is now an error.\nBecause sys.meta_path and sys.path_hooks now have finders on\nthem by default, you will most likely want to use list.insert() instead\nof list.append() to add to those lists.\nBecause None is now inserted into sys.path_importer_cache, if you\nare clearing out entries in the dictionary of paths that do not have a\nfinder, you will need to remove keys paired with values of None and\nimp.NullImporter to be backwards-compatible. This will lead to extra\noverhead on older versions of Python that re-insert None into\nsys.path_importer_cache where it repesents the use of implicit\nfinders, but semantically it should not change anything.\nimportlib.abc.Finder no longer specifies a find_module() abstract\nmethod that must be implemented. If you were relying on subclasses to\nimplement that method, make sure to check for the method’s existence first.\nYou will probably want to check for find_loader() first, though, in the\ncase of working with path entry finders.\npkgutil has been converted to use importlib internally. This\neliminates many edge cases where the old behaviour of the PEP 302 import\nemulation failed to match the behaviour of the real import system. The\nimport emulation itself is still present, but is now deprecated. The\npkgutil.iter_importers() and pkgutil.walk_packages() functions\nspecial case the standard import hooks so they are still supported even\nthough they do not provide the non-standard iter_modules() method.\nA longstanding RFC-compliance bug (issue 1079) in the parsing done by\nemail.header.decode_header() has been fixed.  Code that uses the\nstandard idiom to convert encoded headers into unicode\n(str(make_header(decode_header(h))) will see no change, but code that\nlooks at the individual tuples returned by decode_header will see that\nwhitespace that precedes or follows ASCII sections is now included in the\nASCII section.  Code that builds headers using make_header should\nalso continue to work without change, since make_header continues to add\nwhitespace between ASCII and non-ASCII sections if it is not already\npresent in the input strings.\nemail.utils.formataddr() now does the correct content transfer\nencoding when passed non-ASCII display names.  Any code that depended on\nthe previous buggy behavior that preserved the non-ASCII unicode in the\nformatted output string will need to be changed (issue 1690608).\npoplib.POP3.quit() may now raise protocol errors like all other\npoplib methods.  Code that assumes quit does not raise\npoplib.error_proto errors may need to be changed if errors on quit\nare encountered by a particular application (issue 11291).\nThe strict argument to email.parser.Parser, deprecated since\nPython 2.4, has finally been removed.\nThe deprecated method unittest.TestCase.assertSameElements has been\nremoved.\nThe deprecated variable time.accept2dyear has been removed.\nThe deprecated Context._clamp attribute has been removed from the\ndecimal module.  It was previously replaced by the public attribute\nclamp.  (See issue 8540.)\nThe undocumented internal helper class SSLFakeFile has been removed\nfrom smtplib, since its functionality has long been provided directly\nby socket.socket.makefile().\nPassing a negative value to time.sleep() on Windows now raises an\nerror instead of sleeping forever.  It has always raised an error on posix.\nThe ast.__version__ constant has been removed.  If you need to\nmake decisions affected by the AST version, use sys.version_info\nto make the decision.\nCode that used to work around the fact that the threading module used\nfactory functions by subclassing the private classes will need to change to\nsubclass the now-public classes.\nThe undocumented debugging machinery in the threading module has been\nremoved, simplifying the code.  This should have no effect on production\ncode, but is mentioned here in case any application debug frameworks were\ninteracting with it (issue 13550).", "code_blocks": []}, "porting-to-python-3-3 - porting-c-code": {"text": "Porting C code\n\n\nIn the course of changes to the buffer API the undocumented\nsmalltable member of the\nPy_buffer structure has been removed and the\nlayout of the PyMemoryViewObject has changed.\nAll extensions relying on the relevant parts in memoryobject.h\nor object.h must be rebuilt.\n\nDue to PEP 393, the Py_UNICODE type and all\nfunctions using this type are deprecated (but will stay available for\nat least five years).  If you were using low-level Unicode APIs to\nconstruct and access unicode objects and you want to benefit of the\nmemory footprint reduction provided by PEP 393, you have to convert\nyour code to the new Unicode API.\nHowever, if you only have been using high-level functions such as\nPyUnicode_Concat(), PyUnicode_Join() or\nPyUnicode_FromFormat(), your code will automatically take\nadvantage of the new unicode representations.\n\nPyImport_GetMagicNumber() now returns -1 upon failure.\n\nAs a negative value for the level argument to __import__() is no\nlonger valid, the same now holds for PyImport_ImportModuleLevel().\nThis also means that the value of level used by\nPyImport_ImportModuleEx() is now 0 instead of -1.", "code_blocks": []}, "porting-to-python-3-3 - building-c-extensions": {"text": "Building C extensions\n\n\nThe range of possible file names for C extensions has been narrowed.\nVery rarely used spellings have been suppressed: under POSIX, files\nnamed xxxmodule.so, xxxmodule.abi3.so and\nxxxmodule.cpython-*.so are no longer recognized as implementing\nthe xxx module.  If you had been generating such files, you have\nto switch to the other spellings (i.e., remove the module string\nfrom the file names).\n(implemented in issue 14040.)", "code_blocks": []}, "porting-to-python-3-3 - command-line-switch-changes": {"text": "Command Line Switch Changes\n\n\nThe -Q command-line flag and related artifacts have been removed.  Code\nchecking sys.flags.division_warning will need updating.\n(issue 10998, contributed by Éric Araujo.)\n\nWhen python is started with -S, import site\nwill no longer add site-specific paths to the module search paths.  In\nprevious versions, it did.\n(issue 11591, contributed by Carl Meyer with editions by Éric Araujo.)", "code_blocks": []}}}
{"index": 6, "python_version": "3.4", "url": "https://docs.python.org/3.4/whatsnew/3.4.html", "sections": {"summary-release-highlights": {"text": "Summary – Release Highlights\n\nNew syntax features:\n\nNo new syntax features were added in Python 3.4.\n\nOther new features:\n\npip should always be available (PEP 453).\nNewly created file descriptors are non-inheritable\n(PEP 446).\ncommand line option for isolated mode\n(issue 16499).\nimprovements in the handling of codecs\nthat are not text encodings (multiple issues).\nA ModuleSpec Type for the Import System\n(PEP 451).  (Affects importer authors.)\nThe marshal format has been made more compact and efficient (issue 16475).\n\nNew library modules:\n\nasyncio: New provisional API for asynchronous IO (PEP 3156).\nensurepip: Bootstrapping the pip installer\n(PEP 453).\nenum: Support for enumeration types\n(PEP 435).\npathlib: Object-oriented filesystem paths\n(PEP 428).\nselectors: High-level and efficient I/O multiplexing, built upon the select module primitives (part\nof PEP 3156).\nstatistics: A basic numerically stable statistics library (PEP 450).\ntracemalloc: Trace Python memory allocations (PEP 454).\n\nSignificantly improved library modules:\n\nSingle-dispatch generic functions in\nfunctools (PEP 443).\nNew pickle protocol 4 (PEP 3154).\nmultiprocessing now has an option to avoid using os.fork\non Unix (issue 8713).\nemail has a new submodule, contentmanager, and\na new Message subclass\n(EmailMessage) that simplify MIME\nhandling (issue 18891).\nThe inspect and pydoc modules are now capable of\ncorrect introspection of a much wider variety of callable objects,\nwhich improves the output of the Python help() system.\nThe ipaddress module API has been declared stable\n\nSecurity improvements:\n\nSecure and interchangeable hash algorithm\n(PEP 456).\nMake newly created file descriptors non-inheritable\n(PEP 446) to avoid leaking file descriptors to child processes.\nNew command line option for isolated mode,\n(issue 16499).\nmultiprocessing now has an option to avoid using os.fork\non Unix.  spawn and forkserver are\nmore secure because they avoid sharing data with child processes.\nmultiprocessing child processes on Windows no longer inherit\nall of the parent’s inheritable handles, only the necessary ones.\nA new hashlib.pbkdf2_hmac() function provides\nthe PKCS#5 password-based key derivation function 2.\nTLSv1.1 and TLSv1.2 support for ssl.\nRetrieving certificates from the Windows system cert store support for ssl.\nServer-side SNI (Server Name Indication) support for ssl.\nThe ssl.SSLContext class has a lot of improvements.\nAll modules in the standard library that support SSL now support server\ncertificate verification, including hostname matching\n(ssl.match_hostname()) and CRLs (Certificate Revocation lists, see\nssl.SSLContext.load_verify_locations()).\n\nCPython implementation improvements:\n\nSafe object finalization (PEP 442).\nLeveraging PEP 442, in most cases module globals are no longer set\nto None during finalization (issue 18214).\nConfigurable memory allocators (PEP 445).\nArgument Clinic (PEP 436).\n\nPlease read on for a comprehensive list of user-facing changes, including many\nother smaller improvements, CPython optimizations, deprecations, and potential\nporting issues.", "code_blocks": []}, "new-features - pep-453-explicit-bootstrapping-of-pip-in-python-installations": {"text": "PEP 453: Explicit Bootstrapping of PIP in Python Installations\n\n\nBootstrapping pip By Default\n\nThe new ensurepip module (defined in PEP 453) provides a standard\ncross-platform mechanism to bootstrap the pip installer into Python\ninstallations and virtual environments. The version of pip included\nwith Python 3.4.0 is pip 1.5.4, and future 3.4.x maintenance releases\nwill update the bundled version to the latest version of pip that is\navailable at the time of creating the release candidate.\nBy default, the commands pipX and pipX.Y will be installed on all\nplatforms (where X.Y stands for the version of the Python installation),\nalong with the pip Python package and its dependencies. On Windows and\nin virtual environments on all platforms, the unversioned pip command\nwill also be installed. On other platforms, the system wide unversioned\npip command typically refers to the separately installed Python 2\nversion.\nThe pyvenv command line utility and the venv\nmodule make use of the ensurepip module to make pip readily\navailable in virtual environments. When using the command line utility,\npip is installed by default, while when using the venv module\nAPI installation of pip must be requested explicitly.\nFor CPython source builds on POSIX systems,\nthe make install and make altinstall commands bootstrap pip by\ndefault.  This behaviour can be controlled through configure options, and\noverridden through Makefile options.\nOn Windows and Mac OS X, the CPython installers now default to installing\npip along with CPython itself (users may opt out of installing it\nduring the installation process). Window users will need to opt in to the\nautomatic PATH modifications to have pip available from the command\nline by default, otherwise it can still be accessed through the Python\nlauncher for Windows as py -m pip.\nAs discussed in the PEP, platform packagers may choose not to install\nthese commands by default, as long as, when invoked, they provide clear and\nsimple directions on how to install them on that platform (usually using\nthe system package manager).\n\nNote\nTo avoid conflicts between parallel Python 2 and Python 3 installations,\nonly the versioned pip3 and pip3.4 commands are bootstrapped by\ndefault when ensurepip is invoked directly - the --default-pip\noption is needed to also request the unversioned pip command.\npyvenv and the Windows installer ensure that the unqualified pip\ncommand is made available in those environments, and pip can always be\ninvoked via the -m switch rather than directly to avoid ambiguity on\nsystems with multiple Python installations.\n\n\n\nDocumentation Changes\n\nAs part of this change, the Installing Python Modules and\nDistributing Python Modules sections of the documentation have been\ncompletely redesigned as short getting started and FAQ documents. Most\npackaging documentation has now been moved out to the Python Packaging\nAuthority maintained Python Packaging User Guide and the documentation of the individual\nprojects.\nHowever, as this migration is currently still incomplete, the legacy\nversions of those guides remaining available as Installing Python Modules (Legacy version)\nand Distributing Python Modules (Legacy version).\n\nSee also\n\nPEP 453 – Explicit bootstrapping of pip in Python installations\nPEP written by Donald Stufft and Nick Coghlan, implemented by\nDonald Stufft, Nick Coghlan, Martin von Löwis and Ned Deily.", "code_blocks": []}, "new-features - pep-446-newly-created-file-descriptors-are-non-inheritable": {"text": "PEP 446: Newly Created File Descriptors Are Non-Inheritable\n\nPEP 446 makes newly created file descriptors non-inheritable.  In general, this is the behavior an application will\nwant: when launching a new process, having currently open files also\nopen in the new process can lead to all sorts of hard to find bugs,\nand potentially to security issues.\nHowever, there are occasions when inheritance is desired.  To support\nthese cases, the following new functions and methods are available:\n\nos.get_inheritable(), os.set_inheritable()\nos.get_handle_inheritable(), os.set_handle_inheritable()\nsocket.socket.get_inheritable(), socket.socket.set_inheritable()\n\n\nSee also\n\nPEP 446 – Make newly created file descriptors non-inheritable\nPEP written and implemented by Victor Stinner.", "code_blocks": []}, "new-features - improvements-to-codec-handling": {"text": "Improvements to Codec Handling\n\nSince it was first introduced, the codecs module has always been\nintended to operate as a type-neutral dynamic encoding and decoding\nsystem. However, its close coupling with the Python text model, especially\nthe type restricted convenience methods on the builtin str,\nbytes and bytearray types, has historically obscured that\nfact.\nAs a key step in clarifying the situation, the codecs.encode() and\ncodecs.decode() convenience functions are now properly documented in\nPython 2.7, 3.3 and 3.4. These functions have existed in the codecs\nmodule (and have been covered by the regression test suite) since Python 2.4,\nbut were previously only discoverable through runtime introspection.\nUnlike the convenience methods on str, bytes and\nbytearray, the codecs convenience functions support arbitrary\ncodecs in both Python 2 and Python 3, rather than being limited to Unicode text\nencodings (in Python 3) or basestring <-> basestring conversions (in\nPython 2).\nIn Python 3.4, the interpreter is able to identify the known non-text\nencodings provided in the standard library and direct users towards these\ngeneral purpose convenience functions when appropriate:\n>>> b\"abcdef\".decode(\"hex\")\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nLookupError: 'hex' is not a text encoding; use codecs.decode() to handle arbitrary codecs\n\n>>> \"hello\".encode(\"rot13\")\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nLookupError: 'rot13' is not a text encoding; use codecs.encode() to handle arbitrary codecs\n\n>>> open(\"foo.txt\", encoding=\"hex\")\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nLookupError: 'hex' is not a text encoding; use codecs.open() to handle arbitrary codecs\n\n\nIn a related change, whenever it is feasible without breaking backwards\ncompatibility, exceptions raised during encoding and decoding operations\nare wrapped in a chained exception of the same type that mentions the\nname of the codec responsible for producing the error:\n>>> import codecs\n\n>>> codecs.decode(b\"abcdefgh\", \"hex\")\nTraceback (most recent call last):\n  File \"/usr/lib/python3.4/encodings/hex_codec.py\", line 20, in hex_decode\n    return (binascii.a2b_hex(input), len(input))\nbinascii.Error: Non-hexadecimal digit found\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nbinascii.Error: decoding with 'hex' codec failed (Error: Non-hexadecimal digit found)\n\n>>> codecs.encode(\"hello\", \"bz2\")\nTraceback (most recent call last):\n  File \"/usr/lib/python3.4/encodings/bz2_codec.py\", line 17, in bz2_encode\n    return (bz2.compress(input), len(input))\n  File \"/usr/lib/python3.4/bz2.py\", line 498, in compress\n    return comp.compress(data) + comp.flush()\nTypeError: 'str' does not support the buffer interface\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: encoding with 'bz2' codec failed (TypeError: 'str' does not support the buffer interface)\n\n\nFinally, as the examples above show, these improvements have permitted\nthe restoration of the convenience aliases for the non-Unicode codecs that\nwere themselves restored in Python 3.2. This means that encoding binary data\nto and from its hexadecimal representation (for example) can now be written\nas:\n>>> from codecs import encode, decode\n>>> encode(b\"hello\", \"hex\")\nb'68656c6c6f'\n>>> decode(b\"68656c6c6f\", \"hex\")\nb'hello'\n\n\nThe binary and text transforms provided in the standard library are detailed\nin Binary Transforms and Text Transforms.\n(Contributed by Nick Coghlan in issue 7475, issue 17827,\nissue 17828 and issue 19619.)", "code_blocks": [">>> b\"abcdef\".decode(\"hex\")\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nLookupError: 'hex' is not a text encoding; use codecs.decode() to handle arbitrary codecs\n\n>>> \"hello\".encode(\"rot13\")\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nLookupError: 'rot13' is not a text encoding; use codecs.encode() to handle arbitrary codecs\n\n>>> open(\"foo.txt\", encoding=\"hex\")\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nLookupError: 'hex' is not a text encoding; use codecs.open() to handle arbitrary codecs\n", ">>> import codecs\n\n>>> codecs.decode(b\"abcdefgh\", \"hex\")\nTraceback (most recent call last):\n  File \"/usr/lib/python3.4/encodings/hex_codec.py\", line 20, in hex_decode\n    return (binascii.a2b_hex(input), len(input))\nbinascii.Error: Non-hexadecimal digit found\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nbinascii.Error: decoding with 'hex' codec failed (Error: Non-hexadecimal digit found)\n\n>>> codecs.encode(\"hello\", \"bz2\")\nTraceback (most recent call last):\n  File \"/usr/lib/python3.4/encodings/bz2_codec.py\", line 17, in bz2_encode\n    return (bz2.compress(input), len(input))\n  File \"/usr/lib/python3.4/bz2.py\", line 498, in compress\n    return comp.compress(data) + comp.flush()\nTypeError: 'str' does not support the buffer interface\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: encoding with 'bz2' codec failed (TypeError: 'str' does not support the buffer interface)\n", ">>> from codecs import encode, decode\n>>> encode(b\"hello\", \"hex\")\nb'68656c6c6f'\n>>> decode(b\"68656c6c6f\", \"hex\")\nb'hello'\n"]}, "new-features - pep-451-a-modulespec-type-for-the-import-system": {"text": "PEP 451: A ModuleSpec Type for the Import System\n\nPEP 451 provides an encapsulation of the information about a module that the\nimport machinery will use to load it (that is, a module specification).  This\nhelps simplify both the import implementation and several import-related APIs.\nThe change is also a stepping stone for several future import-related\nimprovements.\nThe public-facing changes from the PEP are entirely backward-compatible.\nFurthermore, they should be transparent to everyone but importer authors.  Key\nfinder and loader methods have been deprecated, but they will continue working.\nNew importers should use the new methods described in the PEP.  Existing\nimporters should be updated to implement the new methods.  See the\nDeprecated section for a list of methods that should be replaced and\ntheir replacements.", "code_blocks": []}, "new-features - other-language-changes": {"text": "Other Language Changes\n\nSome smaller changes made to the core Python language are:\n\nUnicode database updated to UCD version 6.3.\nmin() and max() now accept a default keyword-only argument that\ncan be used to specify the value they return if the iterable they are\nevaluating has no elements.  (Contributed by Julian Berman in\nissue 18111.)\nModule objects are now weakref‘able.\nModule __file__ attributes (and related values) should now always\ncontain absolute paths by default, with the sole exception of\n__main__.__file__ when a script has been executed directly using\na relative path.  (Contributed by Brett Cannon in issue 18416.)\nAll the UTF-* codecs (except UTF-7) now reject surrogates during both\nencoding and decoding unless the surrogatepass error handler is used,\nwith the exception of the UTF-16 decoder (which accepts valid surrogate pairs)\nand the UTF-16 encoder (which produces them while encoding non-BMP characters).\n(Contributed by Victor Stinner, Kang-Hao (Kenny) Lu and Serhiy Storchaka in\nissue 12892.)\nNew German EBCDIC codec cp273.  (Contributed\nby Michael Bierenfeld and Andrew Kuchling in issue 1097797.)\nNew Ukrainian codec cp1125.  (Contributed by\nSerhiy Storchaka in issue 19668.)\nbytes.join() and bytearray.join() now accept arbitrary\nbuffer objects as arguments.  (Contributed by Antoine Pitrou in\nissue 15958.)\nThe int constructor now accepts any object that has an __index__\nmethod for its base argument.  (Contributed by Mark Dickinson in\nissue 16772.)\nFrame objects now have a clear() method that clears all\nreferences to local variables from the frame.  (Contributed by Antoine Pitrou\nin issue 17934.)\nmemoryview is now registered as a Sequence,\nand supports the reversed() builtin.  (Contributed by Nick Coghlan\nand Claudiu Popa in issue 18690 and issue 19078.)\nSignatures reported by help() have been modified and improved in\nseveral cases as a result of the introduction of Argument Clinic and other\nchanges to the inspect and pydoc modules.\n__length_hint__() is now part of the formal language\nspecification (see PEP 424).  (Contributed by Armin Ronacher in\nissue 16148.)", "code_blocks": []}, "new-modules - asyncio": {"text": "asyncio\n\nThe new asyncio module (defined in PEP 3156) provides a standard\npluggable event loop model for Python, providing solid asynchronous IO\nsupport in the standard library, and making it easier for other event loop\nimplementations to interoperate with the standard library and each other.\nFor Python 3.4, this module is considered a provisional API.\n\nSee also\n\nPEP 3156 – Asynchronous IO Support Rebooted: the “asyncio” Module\nPEP written and implementation led by Guido van Rossum.", "code_blocks": []}, "new-modules - ensurepip": {"text": "ensurepip\n\nThe new ensurepip module is the primary infrastructure for the\nPEP 453 implementation.  In the normal course of events end users will not\nneed to interact with this module, but it can be used to manually bootstrap\npip if the automated bootstrapping into an installation or virtual\nenvironment was declined.\nensurepip includes a bundled copy of pip, up-to-date as of the first\nrelease candidate of the release of CPython with which it ships (this applies\nto both maintenance releases and feature releases).  ensurepip does not\naccess the internet.  If the installation has Internet access, after\nensurepip is run the bundled pip can be used to upgrade pip to a\nmore recent release than the bundled one.  (Note that such an upgraded version\nof pip is considered to be a separately installed package and will not be\nremoved if Python is uninstalled.)\nThe module is named ensurepip because if called when pip is already\ninstalled, it does nothing.  It also has an --upgrade option that will\ncause it to install the bundled copy of pip if the existing installed\nversion of pip is older than the bundled copy.", "code_blocks": []}, "new-modules - enum": {"text": "enum\n\nThe new enum module (defined in PEP 435) provides a standard\nimplementation of enumeration types, allowing other modules (such as\nsocket) to provide more informative error messages and better\ndebugging support by replacing opaque integer constants with backwards\ncompatible enumeration values.\n\nSee also\n\nPEP 435 – Adding an Enum type to the Python standard library\nPEP written by Barry Warsaw, Eli Bendersky and Ethan Furman,\nimplemented by Ethan Furman.", "code_blocks": []}, "new-modules - pathlib": {"text": "pathlib\n\nThe new pathlib module offers classes representing filesystem paths\nwith semantics appropriate for different operating systems.  Path classes are\ndivided between pure paths, which provide purely computational operations\nwithout I/O, and concrete paths, which inherit from pure paths but also\nprovide I/O operations.\nFor Python 3.4, this module is considered a provisional API.\n\nSee also\n\nPEP 428 – The pathlib module – object-oriented filesystem paths\nPEP written and implemented by Antoine Pitrou.", "code_blocks": []}, "new-modules - selectors": {"text": "selectors\n\nThe new selectors module (created as part of implementing PEP 3156)\nallows high-level and efficient I/O multiplexing, built upon the\nselect module primitives.", "code_blocks": []}, "new-modules - statistics": {"text": "statistics\n\nThe new statistics module (defined in PEP 450) offers some core\nstatistics functionality directly in the standard library. This module\nsupports calculation of the mean, median, mode, variance and standard\ndeviation of a data series.\n\nSee also\n\nPEP 450 – Adding A Statistics Module To The Standard Library\nPEP written and implemented by Steven D’Aprano", "code_blocks": []}, "new-modules - tracemalloc": {"text": "tracemalloc\n\nThe new tracemalloc module (defined in PEP 454) is a debug tool to\ntrace memory blocks allocated by Python. It provides the following information:\n\nTrace where an object was allocated\nStatistics on allocated memory blocks per filename and per line number:\ntotal size, number and average size of allocated memory blocks\nCompute the differences between two snapshots to detect memory leaks\n\n\nSee also\n\nPEP 454 – Add a new tracemalloc module to trace Python memory allocations\nPEP written and implemented by Victor Stinner", "code_blocks": []}, "improved-modules - abc": {"text": "abc\n\nNew function abc.get_cache_token() can be used to know when to invalidate\ncaches that are affected by changes in the object graph.  (Contributed\nby Łukasz Langa in issue 16832.)\nNew class ABC has ABCMeta as its meta class.\nUsing ABC as a base class has essentially the same effect as specifying\nmetaclass=abc.ABCMeta, but is simpler to type and easier to read.\n(Contributed by Bruno Dupuis in issue 16049.)", "code_blocks": []}, "improved-modules - aifc": {"text": "aifc\n\nThe getparams() method now returns a namedtuple rather than a\nplain tuple.  (Contributed by Claudiu Popa in issue 17818.)\naifc.open() now supports the context management protocol: when used in a\nwith block, the close() method of the returned\nobject will be called automatically at the end of the block.  (Contributed by\nSerhiy Storchacha in issue 16486.)\nThe writeframesraw() and writeframes()\nmethods now accept any bytes-like object.  (Contributed by Serhiy\nStorchaka in issue 8311.)", "code_blocks": []}, "improved-modules - argparse": {"text": "argparse\n\nThe FileType class now accepts encoding and\nerrors arguments, which are passed through to open().  (Contributed\nby Lucas Maystre in issue 11175.)", "code_blocks": []}, "improved-modules - audioop": {"text": "audioop\n\naudioop now supports 24-bit samples.  (Contributed by Serhiy Storchaka\nin issue 12866.)\nNew byteswap() function converts big-endian samples to\nlittle-endian and vice versa.  (Contributed by Serhiy Storchaka in\nissue 19641.)\nAll audioop functions now accept any bytes-like object.  Strings\nare not accepted: they didn’t work before, now they raise an error right away.\n(Contributed by Serhiy Storchaka in issue 16685.)", "code_blocks": []}, "improved-modules - base64": {"text": "base64\n\nThe encoding and decoding functions in base64 now accept any\nbytes-like object in cases where it previously required a\nbytes or bytearray instance.  (Contributed by Nick Coghlan in\nissue 17839.)\nNew functions a85encode(), a85decode(),\nb85encode(), and b85decode() provide the ability to\nencode and decode binary data from and to Ascii85 and the git/mercurial\nBase85 formats, respectively.  The a85 functions have options that can\nbe used to make them compatible with the variants of the Ascii85 encoding,\nincluding the Adobe variant.  (Contributed by Martin Morrison, the Mercurial\nproject, Serhiy Storchaka, and Antoine Pitrou in issue 17618.)", "code_blocks": []}, "improved-modules - collections": {"text": "collections\n\nThe ChainMap.new_child() method now accepts an m argument specifying\nthe child map to add to the chain.  This allows an existing mapping and/or a\ncustom mapping type to be used for the child.  (Contributed by Vinay Sajip in\nissue 16613.)", "code_blocks": []}, "improved-modules - colorsys": {"text": "colorsys\n\nThe number of digits in the coefficients for the RGB — YIQ conversions have\nbeen expanded so that they match the FCC NTSC versions.  The change in\nresults should be less than 1% and may better match results found elsewhere.\n(Contributed by Brian Landers and Serhiy Storchaka in issue 14323.)", "code_blocks": []}, "improved-modules - contextlib": {"text": "contextlib\n\nThe new contextlib.suppress context manager helps to clarify the\nintent of code that deliberately suppresses exceptions from a single\nstatement.  (Contributed by Raymond Hettinger in issue 15806 and\nZero Piraeus in issue 19266.)\nThe new contextlib.redirect_stdout() context manager makes it easier\nfor utility scripts to handle inflexible APIs that write their output to\nsys.stdout and don’t provide any options to redirect it.  Using the\ncontext manager, the sys.stdout output can be redirected to any\nother stream or, in conjunction with io.StringIO, to a string.\nThe latter can be especially useful, for example, to capture output\nfrom a function that was written to implement a command line interface.\nIt is recommended only for utility scripts because it affects the\nglobal state of sys.stdout.  (Contributed by Raymond Hettinger\nin issue 15805.)\nThe contextlib documentation has also been updated to include a\ndiscussion of the\ndifferences between single use, reusable and reentrant context managers.", "code_blocks": []}, "improved-modules - dbm": {"text": "dbm\n\ndbm.open() objects now support the context management protocol.  When\nused in a with statement, the close method of the database\nobject will be called automatically at the end of the block.  (Contributed by\nClaudiu Popa and Nick Coghlan in issue 19282.)", "code_blocks": []}, "improved-modules - dis": {"text": "dis\n\nFunctions show_code(), dis(), distb(), and\ndisassemble() now accept a keyword-only file argument that\ncontrols where they write their output.\nThe dis module is now built around an Instruction class\nthat provides object oriented access to the details of each individual bytecode\noperation.\nA new method, get_instructions(), provides an iterator that emits\nthe Instruction stream for a given piece of Python code.  Thus it is now\npossible to write a program that inspects and manipulates a bytecode\nobject in ways different from those provided by the dis module\nitself.  For example:\n>>> import dis\n>>> for instr in dis.get_instructions(lambda x: x + 1):\n...     print(instr.opname)\nLOAD_FAST\nLOAD_CONST\nBINARY_ADD\nRETURN_VALUE\n\n\nThe various display tools in the dis module have been rewritten to use\nthese new components.\nIn addition, a new application-friendly class Bytecode provides\nan object-oriented API for inspecting bytecode in both in human-readable form\nand for iterating over instructions.  The Bytecode constructor\ntakes the same arguments that get_instruction() does (plus an\noptional current_offset), and the resulting object can be iterated to produce\nInstruction objects.  But it also has a dis\nmethod, equivalent to calling dis on the constructor argument, but\nreturned as a multi-line string:\n>>> bytecode = dis.Bytecode(lambda x: x +1, current_offset=3)\n>>> for instr in bytecode:\n...     print('{} ({})'.format(instr.opname, instr.opcode))\nLOAD_FAST (124)\nLOAD_CONST (100)\nBINARY_ADD (23)\nRETURN_VALUE (83)\n>>> bytecode.dis().splitlines()       \n['  1           0 LOAD_FAST                0 (x)',\n '      -->     3 LOAD_CONST               1 (1)',\n '              6 BINARY_ADD',\n '              7 RETURN_VALUE']\n\n\nBytecode also has a class method,\nfrom_traceback(), that provides the ability to manipulate a\ntraceback (that is, print(Bytecode.from_traceback(tb).dis()) is equivalent\nto distb(tb)).\n(Contributed by Nick Coghlan, Ryan Kelly and Thomas Kluyver in issue 11816\nand Claudiu Popa in issue 17916.)\nNew function stack_effect() computes the effect on the Python stack\nof a given opcode and argument, information that is not otherwise available.\n(Contributed by Larry Hastings in issue 19722.)", "code_blocks": [">>> import dis\n>>> for instr in dis.get_instructions(lambda x: x + 1):\n...     print(instr.opname)\nLOAD_FAST\nLOAD_CONST\nBINARY_ADD\nRETURN_VALUE\n", ">>> bytecode = dis.Bytecode(lambda x: x +1, current_offset=3)\n>>> for instr in bytecode:\n...     print('{} ({})'.format(instr.opname, instr.opcode))\nLOAD_FAST (124)\nLOAD_CONST (100)\nBINARY_ADD (23)\nRETURN_VALUE (83)\n>>> bytecode.dis().splitlines()       \n['  1           0 LOAD_FAST                0 (x)',\n '      -->     3 LOAD_CONST               1 (1)',\n '              6 BINARY_ADD',\n '              7 RETURN_VALUE']\n"]}, "improved-modules - doctest": {"text": "doctest\n\nA new option flag, FAIL_FAST, halts\ntest running as soon as the first failure is detected.  (Contributed by R.\nDavid Murray and Daniel Urban in issue 16522.)\nThe doctest command line interface now uses argparse, and has two\nnew options, -o and -f.  -o allows doctest options to be specified on the command line, and -f is a\nshorthand for -o FAIL_FAST (to parallel the similar option supported by the\nunittest CLI).  (Contributed by R. David Murray in issue 11390.)\ndoctest will now find doctests in extension module __doc__ strings.\n(Contributed by Zachary Ware in issue 3158.)", "code_blocks": []}, "improved-modules - email": {"text": "email\n\nas_string() now accepts a policy argument to\noverride the default policy of the message when generating a string\nrepresentation of it.  This means that as_string can now be used in more\ncircumstances, instead of having to create and use a generator in\norder to pass formatting parameters to its flatten method.  (Contributed by\nR. David Murray in issue 18600.)\nNew method as_bytes() added to produce a bytes\nrepresentation of the message in a fashion similar to how as_string\nproduces a string representation.  It does not accept the maxheaderlen\nargument, but does accept the unixfrom and policy arguments. The\nMessage __bytes__() method\ncalls it, meaning that bytes(mymsg) will now produce the intuitive\nresult:  a bytes object containing the fully formatted message.  (Contributed\nby R. David Murray in issue 18600.)\nThe Message.set_param() message now accepts a replace keyword argument.\nWhen specified, the associated header will be updated without changing\nits location in the list of headers.  For backward compatibility, the default\nis False.  (Contributed by R. David Murray in issue 18891.)\nA pair of new subclasses of Message have been added\n(EmailMessage and MIMEPart), along with a new sub-module,\ncontentmanager and a new policy attribute\ncontent_manager.  All documentation is\ncurrently in the new module, which is being added as part of email’s new\nprovisional API.  These classes provide a number of new methods that\nmake extracting content from and inserting content into email messages much\neasier.  For details, see the contentmanager documentation and\nthe Examples using the Provisional API.  These API additions complete the\nbulk of the work that was planned as part of the email6 project.  The currently\nprovisional API is scheduled to become final in Python 3.5 (possibly with a few\nminor additions in the area of error handling).  (Contributed by R. David\nMurray in issue 18891.)", "code_blocks": []}, "improved-modules - filecmp": {"text": "filecmp\n\nA new clear_cache() function provides the ability to clear the\nfilecmp comparison cache, which uses os.stat() information to\ndetermine if the file has changed since the last compare.  This can be used,\nfor example, if the file might have been changed and re-checked in less time\nthan the resolution of a particular filesystem’s file modification time field.\n(Contributed by Mark Levitt in issue 18149.)\nNew module attribute DEFAULT_IGNORES provides the list of\ndirectories that are used as the default value for the ignore parameter of\nthe dircmp() function.  (Contributed by Eli Bendersky in\nissue 15442.)", "code_blocks": []}, "improved-modules - functools": {"text": "functools\n\nThe new partialmethod() descriptor brings partial argument\napplication to descriptors, just as partial() provides\nfor normal callables. The new descriptor also makes it easier to get\narbitrary callables (including partial() instances)\nto behave like normal instance methods when included in a class definition.\n(Contributed by Alon Horev and Nick Coghlan in issue 4331.)\nThe new singledispatch() decorator brings support for\nsingle-dispatch generic functions to the Python standard library. Where\nobject oriented programming focuses on grouping multiple operations on a\ncommon set of data into a class, a generic function focuses on grouping\nmultiple implementations of an operation that allows it to work with\ndifferent kinds of data.\n\nSee also\n\nPEP 443 – Single-dispatch generic functions\nPEP written and implemented by Łukasz Langa.\n\n\ntotal_ordering() now supports a return value of\nNotImplemented from the underlying comparison function.  (Contributed\nby Katie Miller in issue 10042.)\nA pure-python version of the partial() function is now in the\nstdlib; in CPython it is overridden by the C accelerated version, but it is\navailable for other implementations to use.  (Contributed by Brian Thorne in\nissue 12428.)", "code_blocks": []}, "improved-modules - gc": {"text": "gc\n\nNew function get_stats() returns a list of three per-generation\ndictionaries containing the collections statistics since interpreter startup.\n(Contributed by Antoine Pitrou in issue 16351.)", "code_blocks": []}, "improved-modules - glob": {"text": "glob\n\nA new function escape() provides a way to escape special characters\nin a filename so that they do not become part of the globbing expansion but are\ninstead matched literally.  (Contributed by Serhiy Storchaka in issue 8402.)", "code_blocks": []}, "improved-modules - hashlib": {"text": "hashlib\n\nA new hashlib.pbkdf2_hmac() function provides\nthe PKCS#5 password-based key derivation function 2.  (Contributed by Christian\nHeimes in issue 18582.)\nThe name attribute of hashlib hash objects is now\na formally supported interface.  It has always existed in CPython’s\nhashlib (although it did not return lower case names for all supported\nhashes), but it was not a public interface and so some other Python\nimplementations have not previously supported it.  (Contributed by Jason R.\nCoombs in issue 18532.)", "code_blocks": []}, "improved-modules - hmac": {"text": "hmac\n\nhmac now accepts bytearray as well as bytes for the key\nargument to the new() function, and the msg parameter to both the\nnew() function and the update() method now\naccepts any type supported by the hashlib module.  (Contributed\nby Jonas Borgström in issue 18240.)\nThe digestmod argument to the hmac.new() function may now be any hash\ndigest name recognized by hashlib.  In addition, the current behavior in\nwhich the value of digestmod defaults to MD5 is deprecated: in a\nfuture version of Python there will be no default value.  (Contributed by\nChristian Heimes in issue 17276.)\nWith the addition of block_size and name\nattributes (and the formal documentation of the digest_size\nattribute), the hmac module now conforms fully to the PEP 247 API.\n(Contributed by Christian Heimes in issue 18775.)", "code_blocks": []}, "improved-modules - html": {"text": "html\n\nNew function unescape() function converts HTML5 character references to\nthe corresponding Unicode characters.  (Contributed by Ezio Melotti in\nissue 2927.)\nHTMLParser accepts a new keyword argument\nconvert_charrefs that, when True, automatically converts all character\nreferences.  For backward-compatibility, its value defaults to False, but\nit will change to True in a future version of Python, so you are invited to\nset it explicitly and update your code to use this new feature.  (Contributed\nby Ezio Melotti in issue 13633.)\nThe strict argument of HTMLParser is now deprecated.\n(Contributed by Ezio Melotti in issue 15114.)", "code_blocks": []}, "improved-modules - http": {"text": "http\n\nsend_error() now accepts an\noptional additional explain parameter which can be used to provide an\nextended error description, overriding the hardcoded default if there is one.\nThis extended error description will be formatted using the\nerror_message_format attribute and sent as the body\nof the error response.  (Contributed by Karl Cow in issue 12921.)\nThe http.server command line interface now has\na -b/--bind option that causes the server to listen on a specific address.\n(Contributed by Malte Swart in issue 17764.)", "code_blocks": []}, "improved-modules - idlelib-and-idle": {"text": "idlelib and IDLE\n\nSince idlelib implements the IDLE shell and editor and is not intended for\nimport by other programs, it gets improvements with every release. See\nLib/idlelib/NEWS.txt for a cumulative list of changes since 3.3.0,\nas well as changes made in future 3.4.x releases. This file is also available\nfrom the IDLE Help ‣ About IDLE dialog.", "code_blocks": []}, "improved-modules - importlib": {"text": "importlib\n\nThe InspectLoader ABC defines a new method,\nsource_to_code() that accepts source\ndata and a path and returns a code object.  The default implementation\nis equivalent to compile(data, path, 'exec', dont_inherit=True).\n(Contributed by Eric Snow and Brett Cannon in issue 15627.)\nInspectLoader also now has a default implementation\nfor the get_code() method.  However,\nit will normally be desirable to override the default implementation\nfor performance reasons.  (Contributed by Brett Cannon in issue 18072.)\nThe reload() function has been moved from imp to\nimportlib as part of the imp module deprecation.  (Contributed by\nBerker Peksag in issue 18193.)\nimportlib.util now has a MAGIC_NUMBER attribute\nproviding access to the bytecode version number.  This replaces the\nget_magic() function in the deprecated imp module.\n(Contributed by Brett Cannon in issue 18192.)\nNew importlib.util functions cache_from_source()\nand source_from_cache() replace the same-named functions\nin the deprecated imp module.  (Contributed by Brett Cannon in\nissue 18194.)\nThe importlib bootstrap NamespaceLoader now conforms to\nthe InspectLoader ABC, which means that runpy and\npython -m can now be used with namespace packages.  (Contributed\nby Brett Cannon in issue 18058.)\nimportlib.util has a new function decode_source()\nthat decodes source from bytes using universal newline processing.  This is\nuseful for implementing InspectLoader.get_source() methods.\nimportlib.machinery.ExtensionFileLoader now has a\nget_filename() method.  This was\ninadvertently omitted in the original implementation.  (Contributed by Eric\nSnow in issue 19152.)", "code_blocks": []}, "improved-modules - inspect": {"text": "inspect\n\nThe inspect module now offers a basic command line interface to quickly display source code and other\ninformation for modules, classes and functions.  (Contributed by Claudiu Popa\nand Nick Coghlan in issue 18626.)\nunwrap() makes it easy to unravel wrapper function chains\ncreated by functools.wraps() (and any other API that sets the\n__wrapped__ attribute on a wrapper function).  (Contributed by\nDaniel Urban, Aaron Iles and Nick Coghlan in issue 13266.)\nAs part of the implementation of the new enum module, the\ninspect module now has substantially better support for custom\n__dir__ methods and dynamic class attributes provided through\nmetaclasses.  (Contributed by Ethan Furman in issue 18929 and\nissue 19030.)\ngetfullargspec() and getargspec()\nnow use the signature() API. This allows them to\nsupport a much broader range of callables, including those with\n__signature__ attributes, those with metadata provided by argument\nclinic, functools.partial() objects and more. Note that, unlike\nsignature(), these functions still ignore __wrapped__\nattributes, and report the already bound first argument for bound methods,\nso it is still necessary to update your code to use\nsignature() directly if those features are desired.\n(Contributed by Yury Selivanov in issue 17481.)\nsignature() now supports duck types of CPython functions,\nwhich adds support for functions compiled with Cython.  (Contributed\nby Stefan Behnel and Yury Selivanov in issue 17159.)", "code_blocks": []}, "improved-modules - ipaddress": {"text": "ipaddress\n\nipaddress was added to the standard library in Python 3.3 as a\nprovisional API. With the release of Python 3.4, this qualification\nhas been removed: ipaddress is now considered a stable API, covered\nby the normal standard library requirements to maintain backwards\ncompatibility.\nA new is_global property is True if\nan address is globally routeable.  (Contributed by Peter Moody in\nissue 17400.)", "code_blocks": []}, "improved-modules - logging": {"text": "logging\n\nThe TimedRotatingFileHandler has a new atTime\nparameter that can be used to specify the time of day when rollover should\nhappen.  (Contributed by Ronald Oussoren in issue 9556.)\nSocketHandler and\nDatagramHandler now support Unix domain sockets (by\nsetting port to None).  (Contributed by Vinay Sajip in commit\nce46195b56a9.)\nfileConfig() now accepts a\nconfigparser.RawConfigParser subclass instance for the fname\nparameter.  This facilitates using a configuration file when logging\nconfiguration is just a part of the overall application configuration, or where\nthe application modifies the configuration before passing it to\nfileConfig().  (Contributed by Vinay Sajip in\nissue 16110.)\nLogging configuration data received from a socket via the\nlogging.config.listen() function can now be validated before being\nprocessed by supplying a verification function as the argument to the new\nverify keyword argument.  (Contributed by Vinay Sajip in issue 15452.)", "code_blocks": []}, "improved-modules - marshal": {"text": "marshal\n\nThe default marshal version has been bumped to 3.  The code implementing\nthe new version restores the Python2 behavior of recording only one copy of\ninterned strings and preserving the interning on deserialization, and extends\nthis “one copy” ability to any object type (including handling recursive\nreferences).  This reduces both the size of .pyc files and the amount of\nmemory a module occupies in memory when it is loaded from a .pyc (or\n.pyo) file.  (Contributed by Kristján Valur Jónsson in issue 16475,\nwith additional speedups by Antoine Pitrou in issue 19219.)", "code_blocks": []}, "improved-modules - mmap": {"text": "mmap\n\nmmap objects can now be weakrefed.  (Contributed by Valerie Lambert in\nissue 4885.)", "code_blocks": []}, "improved-modules - multiprocessing": {"text": "multiprocessing\n\nOn Unix two new start methods,\nspawn and forkserver, have been added for starting processes using\nmultiprocessing.  These make the mixing of processes with threads more\nrobust, and the spawn method matches the semantics that multiprocessing has\nalways used on Windows.  New function\nget_all_start_methods() reports all start methods\navailable on the platform, get_start_method() reports\nthe current start method, and set_start_method() sets\nthe start method.  (Contributed by Richard Oudkerk in issue 8713.)\nmultiprocessing also now has the concept of a context, which\ndetermines how child processes are created.  New function\nget_context() returns a context that uses a specified\nstart method.  It has the same API as the multiprocessing module itself,\nso you can use it to create Pools and other\nobjects that will operate within that context.  This allows a framework and an\napplication or different parts of the same application to use multiprocessing\nwithout interfering with each other.  (Contributed by Richard Oudkerk in\nissue 18999.)\nExcept when using the old fork start method, child processes no longer\ninherit unneeded handles/file descriptors from their parents (part of\nissue 8713).\nmultiprocessing now relies on runpy (which implements the\n-m switch) to initialise __main__ appropriately in child processes\nwhen using the spawn or forkserver start methods. This resolves some\nedge cases where combining multiprocessing, the -m command line switch,\nand explicit relative imports could cause obscure failures in child\nprocesses.  (Contributed by Nick Coghlan in issue 19946.)", "code_blocks": []}, "improved-modules - operator": {"text": "operator\n\nNew function length_hint() provides an implementation of the\nspecification for how the __length_hint__() special method should\nbe used, as part of the PEP 424 formal specification of this language\nfeature.  (Contributed by Armin Ronacher in issue 16148.)\nThere is now a pure-python version of the operator module available for\nreference and for use by alternate implementations of Python.  (Contributed by\nZachary Ware in issue 16694.)", "code_blocks": []}, "improved-modules - os": {"text": "os\n\nThere are new functions to get and set the inheritable flag of a file descriptor (os.get_inheritable(),\nos.set_inheritable()) or a Windows handle\n(os.get_handle_inheritable(), os.set_handle_inheritable()).\nNew function cpu_count() reports the number of CPUs available on the\nplatform on which Python is running (or None if the count can’t be\ndetermined).  The multiprocessing.cpu_count() function is now implemented\nin terms of this function).  (Contributed by Trent Nelson, Yogesh Chaudhari,\nVictor Stinner, and Charles-François Natali in issue 17914.)\nos.path.samestat() is now available on the Windows platform (and the\nos.path.samefile() implementation is now shared between Unix and\nWindows).  (Contributed by Brian Curtin in issue 11939.)\nos.path.ismount() now recognizes volumes mounted below a drive\nroot on Windows.  (Contributed by Tim Golden in issue 9035.)\nos.open() supports two new flags on platforms that provide them,\nO_PATH (un-opened file descriptor), and O_TMPFILE\n(unnamed temporary file; as of 3.4.0 release available only on Linux systems\nwith a kernel version of 3.11 or newer that have uapi headers).  (Contributed\nby Christian Heimes in issue 18673 and Benjamin Peterson, respectively.)", "code_blocks": []}, "improved-modules - pdb": {"text": "pdb\n\npdb has been enhanced to handle generators, yield, and\nyield from in a more useful fashion.  This is especially helpful when\ndebugging asyncio based programs.  (Contributed by Andrew Svetlov and\nXavier de Gaye in issue 16596.)\nThe print command has been removed from pdb, restoring access to the\nPython print() function from the pdb command line.  Python2’s pdb did\nnot have a print command; instead, entering print executed the\nprint statement.  In Python3 print was mistakenly made an alias for the\npdb p command.  p, however, prints the repr of its argument,\nnot the str like the Python2 print command did.  Worse, the Python3\npdb print command shadowed the Python3 print function, making it\ninaccessible at the pdb prompt.  (Contributed by Connor Osborn in\nissue 18764.)", "code_blocks": []}, "improved-modules - pickle": {"text": "pickle\n\npickle now supports (but does not use by default) a new pickle protocol,\nprotocol 4.  This new protocol addresses a number of issues that were present\nin previous protocols, such as the serialization of nested classes, very large\nstrings and containers, and classes whose __new__() method takes\nkeyword-only arguments.  It also provides some efficiency improvements.\n\nSee also\n\nPEP 3154 – Pickle protocol 4\nPEP written by Antoine Pitrou and implemented by Alexandre Vassalotti.", "code_blocks": []}, "improved-modules - plistlib": {"text": "plistlib\n\nplistlib now has an API that is similar to the standard pattern for\nstdlib serialization protocols, with new load(),\ndump(), loads(), and dumps()\nfunctions.  (The older API is now deprecated.)  In addition to the already\nsupported XML plist format (FMT_XML), it also now supports\nthe binary plist format (FMT_BINARY).  (Contributed by Ronald\nOussoren and others in issue 14455.)", "code_blocks": []}, "improved-modules - poplib": {"text": "poplib\n\nTwo new methods have been added to poplib: capa(),\nwhich returns the list of capabilities advertised by the POP server, and\nstls(), which switches a clear-text POP3 session into an\nencrypted POP3 session if the POP server supports it.  (Contributed by Lorenzo\nCatucci in issue 4473.)", "code_blocks": []}, "improved-modules - pprint": {"text": "pprint\n\nThe pprint module’s PrettyPrinter class and its\npformat(), and pprint() functions have a new\noption, compact, that controls how the output is formatted.  Currently\nsetting compact to True means that sequences will be printed with as many\nsequence elements as will fit within width on each (indented) line.\n(Contributed by Serhiy Storchaka in issue 19132.)\nLong strings are now wrapped using Python’s normal line continuation\nsyntax.  (Contributed by Antoine Pitrou in issue 17150.)", "code_blocks": []}, "improved-modules - pty": {"text": "pty\n\npty.spawn() now returns the status value from os.waitpid() on\nthe child process, instead of None.  (Contributed by Gregory P. Smith.)", "code_blocks": []}, "improved-modules - pydoc": {"text": "pydoc\n\nThe pydoc module is now based directly on the inspect.signature()\nintrospection API, allowing it to provide signature information for a wider\nvariety of callable objects. This change also means that __wrapped__\nattributes are now taken into account when displaying help information.\n(Contributed by Larry Hastings in issue 19674.)\nThe pydoc module no longer displays the self parameter for\nalready bound methods. Instead, it aims to always display the exact current\nsignature of the supplied callable.  (Contributed by Larry Hastings in\nissue 20710.)\nIn addition to the changes that have been made to pydoc directly,\nits handling of custom __dir__ methods and various descriptor\nbehaviours has also been improved substantially by the underlying changes in\nthe inspect module.\nAs the help() builtin is based on pydoc, the above changes also\naffect the behaviour of help().", "code_blocks": []}, "improved-modules - re": {"text": "re\n\nNew fullmatch() function and regex.fullmatch() method anchor\nthe pattern at both ends of the string to match.  This provides a way to be\nexplicit about the goal of the match, which avoids a class of subtle bugs where\n$ characters get lost during code changes or the addition of alternatives\nto an existing regular expression.  (Contributed by Matthew Barnett in\nissue 16203.)\nThe repr of regex objects now includes the pattern\nand the flags; the repr of match objects now\nincludes the start, end, and the part of the string that matched.  (Contributed\nby Hugo Lopes Tavares and Serhiy Storchaka in issue 13592 and\nissue 17087.)", "code_blocks": []}, "improved-modules - resource": {"text": "resource\n\nNew prlimit() function, available on Linux platforms with a\nkernel version of 2.6.36 or later and glibc of 2.13 or later, provides the\nability to query or set the resource limits for processes other than the one\nmaking the call.  (Contributed by Christian Heimes in issue 16595.)\nOn Linux kernel version 2.6.36 or later, there are there are also some new\nLinux specific constants: RLIMIT_MSGQUEUE,\nRLIMIT_NICE, RLIMIT_RTPRIO,\nRLIMIT_RTTIME, and RLIMIT_SIGPENDING.\n(Contributed by Christian Heimes in issue 19324.)\nOn FreeBSD version 9 and later, there some new FreeBSD specific constants:\nRLIMIT_SBSIZE, RLIMIT_SWAP, and\nRLIMIT_NPTS.  (Contributed by Claudiu Popa in\nissue 19343.)", "code_blocks": []}, "improved-modules - select": {"text": "select\n\nepoll objects now support the context management protocol.\nWhen used in a with statement, the close()\nmethod will be called automatically at the end of the block.  (Contributed\nby Serhiy Storchaka in issue 16488.)\ndevpoll objects now have fileno() and\nclose() methods, as well as a new attribute\nclosed.  (Contributed by Victor Stinner in\nissue 18794.)", "code_blocks": []}, "improved-modules - shelve": {"text": "shelve\n\nShelf instances may now be used in with statements,\nand will be automatically closed at the end of the with block.\n(Contributed by Filip Gruszczyński in issue 13896.)", "code_blocks": []}, "improved-modules - shutil": {"text": "shutil\n\ncopyfile() now raises a specific Error subclass,\nSameFileError, when the source and destination are the same\nfile, which allows an application to take appropriate action on this specific\nerror.  (Contributed by Atsuo Ishimoto and Hynek Schlawack in\nissue 1492704.)", "code_blocks": []}, "improved-modules - smtpd": {"text": "smtpd\n\nThe SMTPServer and SMTPChannel classes now\naccept a map keyword argument which, if specified, is passed in to\nasynchat.async_chat as its map argument.  This allows an application\nto avoid affecting the global socket map.  (Contributed by Vinay Sajip in\nissue 11959.)", "code_blocks": []}, "improved-modules - smtplib": {"text": "smtplib\n\nSMTPException is now a subclass of OSError, which allows\nboth socket level errors and SMTP protocol level errors to be caught in one\ntry/except statement by code that only cares whether or not an error occurred.\n(Contributed by Ned Jackson Lovely in issue 2118.)", "code_blocks": []}, "improved-modules - socket": {"text": "socket\n\nThe socket module now supports the CAN_BCM protocol on\nplatforms that support it.  (Contributed by Brian Thorne in issue 15359.)\nSocket objects have new methods to get or set their inheritable flag, get_inheritable() and\nset_inheritable().\nThe socket.AF_* and socket.SOCK_* constants are now enumeration values\nusing the new enum module.  This allows meaningful names to be printed\nduring debugging, instead of integer “magic numbers”.\nThe AF_LINK constant is now available on BSD and OSX.\ninet_pton() and inet_ntop() are now supported\non Windows.  (Contributed by Atsuo Ishimoto in issue 7171.)", "code_blocks": []}, "improved-modules - sqlite3": {"text": "sqlite3\n\nA new boolean parameter to the connect() function, uri, can be\nused to indicate that the database parameter is a uri (see the SQLite\nURI documentation).  (Contributed by poq in\nissue 13773.)", "code_blocks": []}, "improved-modules - ssl": {"text": "ssl\n\nPROTOCOL_TLSv1_1 and PROTOCOL_TLSv1_2 (TLSv1.1 and\nTLSv1.2 support) have been added; support for these protocols is only available if\nPython is linked with OpenSSL 1.0.1 or later.  (Contributed by Michele Orrù and\nAntoine Pitrou in issue 16692.)\nNew function create_default_context() provides a standard way to\nobtain an SSLContext whose settings are intended to be a\nreasonable balance between compatibility and security.  These settings are\nmore stringent than the defaults provided by the SSLContext\nconstructor, and may be adjusted in the future, without prior deprecation, if\nbest-practice security requirements change.  The new recommended best\npractice for using stdlib libraries that support SSL is to use\ncreate_default_context() to obtain an SSLContext\nobject, modify it if needed, and then pass it as the context argument\nof the appropriate stdlib API.  (Contributed by Christian Heimes\nin issue 19689.)\nSSLContext method load_verify_locations()\naccepts a new optional argument cadata, which can be used to provide PEM or\nDER encoded certificates directly via strings or bytes, respectively.\n(Contributed by Christian Heimes in issue 18138.)\nNew function get_default_verify_paths() returns\na named tuple of the paths and environment variables that the\nset_default_verify_paths() method uses to set\nOpenSSL’s default cafile and capath.  This can be an aid in\ndebugging default verification issues.  (Contributed by Christian Heimes\nin issue 18143.)\nSSLContext has a new method,\ncert_store_stats(), that reports the number of loaded\nX.509 certs, X.509 CA certs, and certificate revocation lists (crls), as well as a get_ca_certs() method that returns a\nlist of the loaded CA certificates.  (Contributed by Christian Heimes in\nissue 18147.)\nIf OpenSSL 0.9.8 or later is available, SSLContext has an new\nattribute verify_flags that can be used to control the\ncertificate verification process by setting it to some combination of the new\nconstants VERIFY_DEFAULT, VERIFY_CRL_CHECK_LEAF,\nVERIFY_CRL_CHECK_CHAIN, or VERIFY_X509_STRICT.\nOpenSSL does not do any CRL verification by default.  (Contributed by\nChristien Heimes in issue 8813.)\nNew SSLContext method load_default_certs()\nloads a set of default “certificate authority” (CA) certificates from default\nlocations, which vary according to the platform.  It can be used to load both\nTLS web server authentication certificates\n(purpose=SERVER_AUTH) for a client to use to verify a\nserver, and certificates for a server to use in verifying client certificates\n(purpose=CLIENT_AUTH).  (Contributed by Christian\nHeimes in issue 19292.)\nTwo new windows-only functions, enum_certificates() and\nenum_crls() provide the ability to retrieve certificates,\ncertificate information, and CRLs from the Windows cert store.  (Contributed\nby Christian Heimes in issue 17134.)\nSupport for server-side SNI (Server Name Indication) using the new\nssl.SSLContext.set_servername_callback() method.\n(Contributed by Daniel Black in issue 8109.)\nThe dictionary returned by SSLSocket.getpeercert() contains additional\nX509v3 extension items: crlDistributionPoints, calIssuers, and\nOCSP URIs.  (Contributed by Christian Heimes in issue 18379.)", "code_blocks": []}, "improved-modules - stat": {"text": "stat\n\nThe stat module is now backed by a C implementation in _stat. A C\nimplementation is required as most of the values aren’t standardized and\nare platform-dependent.  (Contributed by Christian Heimes in issue 11016.)\nThe module supports new ST_MODE flags, S_IFDOOR,\nS_IFPORT, and S_IFWHT.  (Contributed by\nChristian Hiemes in issue 11016.)", "code_blocks": []}, "improved-modules - struct": {"text": "struct\n\nNew function iter_unpack and a new\nstruct.Struct.iter_unpack() method on compiled formats provide streamed\nunpacking of a buffer containing repeated instances of a given format of data.\n(Contributed by Antoine Pitrou in issue 17804.)", "code_blocks": []}, "improved-modules - subprocess": {"text": "subprocess\n\ncheck_output() now accepts an input argument that can\nbe used to provide the contents of stdin for the command that is run.\n(Contributed by Zack Weinberg in issue 16624.)\ngetstatus() and getstatusoutput() now\nwork on Windows.  This change was actually inadvertently made in 3.3.4.\n(Contributed by Tim Golden in issue 10197.)", "code_blocks": []}, "improved-modules - sunau": {"text": "sunau\n\nThe getparams() method now returns a namedtuple rather than a\nplain tuple.  (Contributed by Claudiu Popa in issue 18901.)\nsunau.open() now supports the context management protocol: when used in a\nwith block, the close method of the returned object will be\ncalled automatically at the end of the block.  (Contributed by Serhiy Storchaka\nin issue 18878.)\nAU_write.setsampwidth() now supports 24 bit samples, thus adding\nsupport for writing 24 sample using the module.  (Contributed by\nSerhiy Storchaka in issue 19261.)\nThe writeframesraw() and\nwriteframes() methods now accept any bytes-like\nobject.  (Contributed by Serhiy Storchaka in issue 8311.)", "code_blocks": []}, "improved-modules - sys": {"text": "sys\n\nNew function sys.getallocatedblocks() returns the current number of\nblocks allocated by the interpreter.  (In CPython with the default\n--with-pymalloc setting, this is allocations made through the\nPyObject_Malloc() API.)  This can be useful for tracking memory leaks,\nespecially if automated via a test suite.  (Contributed by Antoine Pitrou\nin issue 13390.)\nWhen the Python interpreter starts in interactive mode, it checks for an __interactivehook__ attribute\non the sys module.  If the attribute exists, its value is called with no\narguments just before interactive mode is started.  The check is made after the\nPYTHONSTARTUP file is read, so it can be set there.  The site\nmodule sets it to a function that enables tab\ncompletion and history saving (in ~/.python-history) if the platform\nsupports readline.  If you do not want this (new) behavior, you can\noverride it in PYTHONSTARTUP, sitecustomize, or\nusercustomize by deleting this attribute from sys (or setting it\nto some other callable).  (Contributed by Éric Araujo and Antoine Pitrou in\nissue 5845.)", "code_blocks": []}, "improved-modules - tarfile": {"text": "tarfile\n\nThe tarfile module now supports a simple Command Line Interface when\ncalled as a script directly or via -m.  This can be used to create and\nextract tarfile archives.  (Contributed by Berker Peksag in issue 13477.)", "code_blocks": []}, "improved-modules - textwrap": {"text": "textwrap\n\nThe TextWrapper class has two new attributes/constructor\narguments: max_lines, which limits the number of\nlines in the output, and placeholder, which is a\nstring that will appear at the end of the output if it has been truncated\nbecause of max_lines.  Building on these capabilities, a new convenience\nfunction shorten() collapses all of the whitespace in the input\nto single spaces and produces a single line of a given width that ends with\nthe placeholder (by default, [...]).  (Contributed by Antoine Pitrou and\nSerhiy Storchaka in issue 18585 and issue 18725.)", "code_blocks": []}, "improved-modules - threading": {"text": "threading\n\nThe Thread object representing the main thread can be\nobtained from the new main_thread() function.  In normal\nconditions this will be the thread from which the Python interpreter was\nstarted.  (Contributed by Andrew Svetlov in issue 18882.)", "code_blocks": []}, "improved-modules - traceback": {"text": "traceback\n\nA new traceback.clear_frames() function takes a traceback object\nand clears the local variables in all of the frames it references,\nreducing the amount of memory consumed.  (Contributed by Andrew Kuchling in\nissue 1565525.)", "code_blocks": []}, "improved-modules - types": {"text": "types\n\nA new DynamicClassAttribute() descriptor provides a way to define\nan attribute that acts normally when looked up through an instance object, but\nwhich is routed to the class __getattr__ when looked up through the\nclass.  This allows one to have properties active on a class, and have virtual\nattributes on the class with the same name (see Enum for an example).\n(Contributed by Ethan Furman in issue 19030.)", "code_blocks": []}, "improved-modules - urllib": {"text": "urllib\n\nurllib.request now supports data: URLs via the\nDataHandler class.  (Contributed by Mathias Panzenböck\nin issue 16423.)\nThe http method that will be used by a Request class\ncan now be specified by setting a method\nclass attribute on the subclass.  (Contributed by Jason R Coombs in\nissue 18978.)\nRequest objects are now reusable: if the\nfull_url or data\nattributes are modified, all relevant internal properties are updated.  This\nmeans, for example, that it is now possible to use the same\nRequest object in more than one\nOpenerDirector.open() call with different data arguments, or to\nmodify a Request‘s url rather than recomputing it\nfrom scratch.  There is also a new\nremove_header() method that can be used to remove\nheaders from a Request.  (Contributed by Alexey\nKachayev in issue 16464, Daniel Wozniak in issue 17485, and Damien Brecht\nand Senthil Kumaran in issue 17272.)\nHTTPError objects now have a\nheaders attribute that provides access to the\nHTTP response headers associated with the error.  (Contributed by\nBerker Peksag in issue 15701.)", "code_blocks": []}, "improved-modules - unittest": {"text": "unittest\n\nThe TestCase class has a new method,\nsubTest(), that produces a context manager whose\nwith block becomes a “sub-test”.  This context manager allows a test\nmethod to dynamically generate subtests  by, say, calling the subTest\ncontext manager inside a loop.  A single test method can thereby produce an\nindefinite number of separately-identified and separately-counted tests, all of\nwhich will run even if one or more of them fail.  For example:\nclass NumbersTest(unittest.TestCase):\n    def test_even(self):\n        for i in range(6):\n            with self.subTest(i=i):\n                self.assertEqual(i % 2, 0)\n\n\nwill result in six subtests, each identified in the unittest verbose output\nwith a label consisting of the variable name i and a particular value for\nthat variable (i=0, i=1, etc).  See Distinguishing test iterations using subtests for the full\nversion of this example.  (Contributed by Antoine Pitrou in issue 16997.)\nunittest.main() now accepts an iterable of test names for\ndefaultTest, where previously it only accepted a single test name as a\nstring.  (Contributed by Jyrki Pulliainen in issue 15132.)\nIf SkipTest is raised during test discovery (that is, at the\nmodule level in the test file), it is now reported as a skip instead of an\nerror.  (Contributed by Zach Ware in issue 16935.)\ndiscover() now sorts the discovered files to provide\nconsistent test ordering.  (Contributed by Martin Melin and Jeff Ramnani in\nissue 16709.)\nTestSuite now drops references to tests as soon as the test\nhas been run, if the test is successful.  On Python interpreters that do\ngarbage collection, this allows the tests to be garbage collected if nothing\nelse is holding a reference to the test.  It is possible to override this\nbehavior by creating a TestSuite subclass that defines a\ncustom _removeTestAtIndex method.  (Contributed by Tom Wardill, Matt\nMcClure, and Andrew Svetlov in issue 11798.)\nA new test assertion context-manager, assertLogs(),\nwill ensure that a given block of code emits a log message using the\nlogging module.  By default the message can come from any logger and\nhave a priority of INFO or higher, but both the logger name and an\nalternative minimum logging level may be specified.  The object returned by the\ncontext manager can be queried for the LogRecords and/or\nformatted messages that were logged.  (Contributed by Antoine Pitrou in\nissue 18937.)\nTest discovery now works with namespace packages (Contributed by Claudiu Popa\nin issue 17457.)\nunittest.mock objects now inspect their specification signatures when\nmatching calls, which means an argument can now be matched by either position\nor name, instead of only by position.  (Contributed by Antoine Pitrou in\nissue 17015.)\nmock_open() objects now have readline and readlines\nmethods.  (Contributed by Toshio Kuratomi in issue 17467.)", "code_blocks": ["class NumbersTest(unittest.TestCase):\n    def test_even(self):\n        for i in range(6):\n            with self.subTest(i=i):\n                self.assertEqual(i % 2, 0)\n"]}, "improved-modules - venv": {"text": "venv\n\nvenv now includes activation scripts for the csh and fish\nshells.  (Contributed by Andrew Svetlov in issue 15417.)\nEnvBuilder and the create() convenience function\ntake a new keyword argument with_pip, which defaults to False, that\ncontrols whether or not EnvBuilder ensures that pip is\ninstalled in the virtual environment.  (Contributed by Nick Coghlan in\nissue 19552 as part of the PEP 453 implementation.)", "code_blocks": []}, "improved-modules - wave": {"text": "wave\n\nThe getparams() method now returns a namedtuple rather than a\nplain tuple.  (Contributed by Claudiu Popa in issue 17487.)\nwave.open() now supports the context management protocol.  (Contributed\nby Claudiu Popa in issue 17616.)\nwave can now write output to unseekable files.  (Contributed by David Jones, Guilherme Polo, and Serhiy\nStorchaka in issue 5202.)\nThe writeframesraw() and\nwriteframes() methods now accept any bytes-like\nobject.  (Contributed by Serhiy Storchaka in issue 8311.)", "code_blocks": []}, "improved-modules - weakref": {"text": "weakref\n\nNew WeakMethod class simulates weak references to bound\nmethods.  (Contributed by Antoine Pitrou in issue 14631.)\nNew finalize class makes it possible to register a callback\nto be invoked when an object is garbage collected, without needing to\ncarefully manage the lifecycle of the weak reference itself.  (Contributed by\nRichard Oudkerk in issue 15528.)\nThe callback, if any, associated with a ref is now\nexposed via the __callback__ attribute.  (Contributed\nby Mark Dickinson in issue 17643.)", "code_blocks": []}, "improved-modules - xml-etree": {"text": "xml.etree\n\nA new parser, XMLPullParser, allows a\nnon-blocking applications to parse XML documents.  An example can be\nseen at Pull API for non-blocking parsing.  (Contributed by Antoine\nPitrou in issue 17741.)\nThe xml.etree.ElementTree tostring() and\ntostringlist() functions, and the\nElementTree\nwrite() method, now have a\nshort_empty_elements keyword-only parameter\nproviding control over whether elements with no content are written in\nabbreviated (<tag />) or expanded (<tag></tag>) form.  (Contributed by\nAriel Poliak and Serhiy Storchaka in issue 14377.)", "code_blocks": []}, "improved-modules - zipfile": {"text": "zipfile\n\nThe writepy() method of the\nPyZipFile class has a new filterfunc option that can be\nused to control which directories and files are added to the archive.  For\nexample, this could be used to exclude test files from the archive.\n(Contributed by Christian Tismer in issue 19274.)\nThe allowZip64 parameter to ZipFile and\nPyZipfile is now True by default.  (Contributed by\nWilliam Mallard in issue 17201.)", "code_blocks": []}, "cpython-implementation-changes - pep-445-customization-of-cpython-memory-allocators": {"text": "PEP 445: Customization of CPython Memory Allocators\n\nPEP 445 adds new C level interfaces to customize memory allocation in\nthe CPython interpreter.\n\nSee also\n\nPEP 445 – Add new APIs to customize Python memory allocators\nPEP written and implemented by Victor Stinner.", "code_blocks": []}, "cpython-implementation-changes - pep-442-safe-object-finalization": {"text": "PEP 442: Safe Object Finalization\n\nPEP 442 removes the current limitations and quirks of object finalization\nin CPython. With it, objects with __del__() methods, as well as\ngenerators with finally clauses, can be finalized when they are\npart of a reference cycle.\nAs part of this change, module globals are no longer forcibly set to\nNone during interpreter shutdown in most cases, instead relying\non the normal operation of the cyclic garbage collector.  This avoids a\nwhole class of interpreter-shutdown-time errors, usually involving\n__del__ methods, that have plagued Python since the cyclic GC\nwas first introduced.\n\nSee also\n\nPEP 442 – Safe object finalization\nPEP written and implemented by Antoine Pitrou.", "code_blocks": []}, "cpython-implementation-changes - pep-456-secure-and-interchangeable-hash-algorithm": {"text": "PEP 456: Secure and Interchangeable Hash Algorithm\n\nPEP 456 follows up on earlier security fix work done on Python’s hash\nalgorithm to address certain DOS attacks to which public facing APIs backed by\ndictionary lookups may be subject.  (See issue 14621 for the start of the\ncurrent round of improvements.)  The PEP unifies CPython’s hash code to make it\neasier for a packager to substitute a different hash algorithm, and switches\nPython’s default implementation to a SipHash implementation on platforms that\nhave a 64 bit data type.  Any performance differences in comparison with the\nolder FNV algorithm are trivial.\nThe PEP adds additional fields to the sys.hash_info struct sequence to\ndescribe the hash algorithm in use by the currently executing binary.  Otherwise,\nthe PEP does not alter any existing CPython APIs.", "code_blocks": []}, "cpython-implementation-changes - pep-436-argument-clinic": {"text": "PEP 436: Argument Clinic\n\n“Argument Clinic” (PEP 436) is now part of the CPython build process\nand can be used to simplify the process of defining and maintaining\naccurate signatures for builtins and standard library extension modules\nimplemented in C.\nSome standard library extension modules have been converted to use Argument\nClinic in Python 3.4, and pydoc and inspect have been updated\naccordingly.\nIt is expected that signature metadata for programmatic introspection will\nbe added to additional callables implemented in C as part of Python 3.4\nmaintenance releases.\n\nNote\nThe Argument Clinic PEP is not fully up to date with the state of the\nimplementation. This has been deemed acceptable by the release manager\nand core development team in this case, as Argument Clinic will not\nbe made available as a public API for third party use in Python 3.4.\n\n\nSee also\n\nPEP 436 – The Argument Clinic DSL\nPEP written and implemented by Larry Hastings.", "code_blocks": []}, "cpython-implementation-changes - other-build-and-c-api-changes": {"text": "Other Build and C API Changes\n\n\nThe new PyType_GetSlot() function has been added to the stable ABI,\nallowing retrieval of function pointers from named type slots when using\nthe limited API.  (Contributed by Martin von Löwis in issue 17162.)\nThe new Py_SetStandardStreamEncoding() pre-initialization API\nallows applications embedding the CPython interpreter to reliably force\na particular encoding and error handler for the standard streams.\n(Contributed by Bastien Montagne and Nick Coghlan in issue 16129.)\nMost Python C APIs that don’t mutate string arguments are now correctly\nmarked as accepting const char * rather than char *.  (Contributed\nby Serhiy Storchaka in issue 1772673.)\nA new shell version of python-config can be used even when a python\ninterpreter is not available (for example, in cross compilation scenarios).\nPyUnicode_FromFormat() now supports width and precision\nspecifications for %s, %A, %U, %V, %S, and %R.\n(Contributed by Ysj Ray and Victor Stinner in issue 7330.)\nNew function PyStructSequence_InitType2() supplements the\nexisting PyStructSequence_InitType() function.  The difference\nis that it returns 0 on success and -1 on failure.\nThe CPython source can now be compiled using the address sanity checking\nfeatures of recent versions of GCC and clang:  the false alarms in the small\nobject allocator have been silenced.  (Contributed by Dhiru Kholia in\nissue 18596.)\nThe Windows build now uses Address Space Layout Randomization and Data Execution Prevention.  (Contributed by\nChristian Heimes in issue 16632.)\nNew function PyObject_LengthHint() is the C API equivalent\nof operator.length_hint().  (Contributed by Armin Ronacher in\nissue 16148.)", "code_blocks": []}, "cpython-implementation-changes - other-improvements": {"text": "Other Improvements\n\n\nThe python command has a new option, -I, which causes it to run in “isolated mode”,\nwhich means that sys.path contains neither the script’s directory nor\nthe user’s site-packages directory, and all PYTHON* environment\nvariables are ignored (it implies both -s and -E).  Other\nrestrictions may also be applied in the future, with the goal being to\nisolate the execution of a script from the user’s environment.  This is\nappropriate, for example, when Python is used to run a system script.  On\nmost POSIX systems it can and should be used in the #! line of system\nscripts.  (Contributed by Christian Heimes in issue 16499.)\nTab-completion is now enabled by default in the interactive interpreter\non systems that support readline.  History is also enabled by default,\nand is written to (and read from) the file ~/.python-history.\n(Contributed by Antoine Pitrou and Éric Araujo in issue 5845.)\nInvoking the Python interpreter with --version now outputs the version to\nstandard output instead of standard error (issue 18338). Similar changes\nwere made to argparse (issue 18920) and other modules that have\nscript-like invocation capabilities (issue 18922).\nThe CPython Windows installer now adds .py to the PATHEXT\nvariable when extensions are registered, allowing users to run a python\nscript at the windows command prompt by just typing its name without the\n.py extension.  (Contributed by Paul Moore in issue 18569.)\nA new make target coverage-report\nwill build python, run the test suite, and generate an HTML coverage report\nfor the C codebase using gcov and lcov.\nThe -R option to the python regression test suite now\nalso checks for memory allocation leaks, using\nsys.getallocatedblocks().  (Contributed by Antoine Pitrou in\nissue 13390.)\npython -m now works with namespace packages.\nThe stat module is now implemented in C, which means it gets the\nvalues for its constants from the C header files, instead of having the\nvalues hard-coded in the python module as was previously the case.\nLoading multiple python modules from a single OS module (.so, .dll)\nnow works correctly (previously it silently returned the first python\nmodule in the file).  (Contributed by Václav Šmilauer in issue 16421.)\nA new opcode, LOAD_CLASSDEREF, has been added to fix a bug in the\nloading of free variables in class bodies that could be triggered by certain\nuses of __prepare__.  (Contributed by Benjamin Peterson in\nissue 17853.)\nA number of MemoryError-related crashes were identified and fixed by Victor\nStinner using his PEP 445-based pyfailmalloc tool (issue 18408,\nissue 18520).\nThe pyvenv command now accepts a --copies option\nto use copies rather than symlinks even on systems where symlinks are the\ndefault.  (Contributed by Vinay Sajip in issue 18807.)\nThe pyvenv command also accepts a --without-pip\noption to suppress the otherwise-automatic bootstrapping of pip into\nthe virtual environment.  (Contributed by Nick Coghlan in issue 19552\nas part of the PEP 453 implementation.)\nThe encoding name is now optional in the value set for the\nPYTHONIOENCODING environment variable.  This makes it possible to\nset just the error handler, without changing the default encoding.\n(Contributed by Serhiy Storchaka in issue 18818.)\nThe bz2, lzma, and gzip module open functions now\nsupport x (exclusive creation) mode.  (Contributed by Tim Heaney and\nVajrasky Kok in issue 19201, issue 19222, and issue 19223.)", "code_blocks": []}, "cpython-implementation-changes - significant-optimizations": {"text": "Significant Optimizations\n\n\nThe UTF-32 decoder is now 3x to 4x faster.  (Contributed by Serhiy Storchaka\nin issue 14625.)\nThe cost of hash collisions for sets is now reduced.  Each hash table\nprobe now checks a series of consecutive, adjacent key/hash pairs before\ncontinuing to make random probes through the hash table.  This exploits\ncache locality to make collision resolution less expensive.\nThe collision resolution scheme can be described as a hybrid of linear\nprobing and open addressing.  The number of additional linear probes\ndefaults to nine.  This can be changed at compile-time by defining\nLINEAR_PROBES to be any value.  Set LINEAR_PROBES=0 to turn-off\nlinear probing entirely.  (Contributed by Raymond Hettinger in\nissue 18771.)\nThe interpreter starts about 30% faster. A couple of measures lead to the\nspeedup. The interpreter loads fewer modules on startup, e.g. the re,\ncollections and locale modules and their dependencies are no\nlonger imported by default. The marshal module has been improved to load\ncompiled Python code faster.  (Contributed by Antoine Pitrou, Christian\nHeimes and Victor Stinner in issue 19219, issue 19218, issue 19209,\nissue 19205 and issue 9548.)\nbz2.BZ2File is now as fast or faster than the Python2 version for\nmost cases.  lzma.LZMAFile has also been optimized.  (Contributed by\nSerhiy Storchaka and Nadeem Vawda in issue 16034.)\nrandom.getrandbits() is 20%-40% faster for small integers (the most\ncommon use case).  (Contributed by Serhiy Storchaka in issue 16674.)\nBy taking advantage of the new storage format for strings, pickling of\nstrings is now significantly faster.  (Contributed by Victor Stinner and\nAntoine Pitrou in issue 15596.)\nA performance issue in io.FileIO.readall() has been solved.  This\nparticularly affects Windows, and significantly speeds up the case of piping\nsignificant amounts of data through subprocess.  (Contributed\nby Richard Oudkerk in issue 15758.)\nhtml.escape() is now 10x faster.  (Contributed by Matt Bryant in\nissue 18020.)\nOn Windows, the native VirtualAlloc is now used instead of the CRT\nmalloc in obmalloc.  Artificial benchmarks show about a 3% memory\nsavings.\nos.urandom() now uses a lazily-opened persistent file descriptor\nso as to avoid using many file descriptors when run in parallel from\nmultiple threads.  (Contributed by Antoine Pitrou in issue 18756.)", "code_blocks": []}, "deprecated - deprecations-in-the-python-api": {"text": "Deprecations in the Python API\n\n\nAs mentioned in PEP 451: A ModuleSpec Type for the Import System, a number of importlib\nmethods and functions are deprecated: importlib.find_loader() is\nreplaced by importlib.util.find_spec();\nimportlib.machinery.PathFinder.find_module() is replaced by\nimportlib.machinery.PathFinder.find_spec();\nimportlib.abc.MetaPathFinder.find_module() is replaced by\nimportlib.abc.MetaPathFinder.find_spec();\nimportlib.abc.PathEntryFinder.find_loader() and\nfind_module() are replaced by\nimportlib.abc.PathEntryFinder.find_spec(); all of the xxxLoader ABC\nload_module methods (importlib.abc.Loader.load_module(),\nimportlib.abc.InspectLoader.load_module(),\nimportlib.abc.FileLoader.load_module(),\nimportlib.abc.SourceLoader.load_module()) should no longer be\nimplemented, instead loaders should implement an\nexec_module method\n(importlib.abc.Loader.exec_module(),\nimportlib.abc.InspectLoader.exec_module()\nimportlib.abc.SourceLoader.exec_module()) and let the import system\ntake care of the rest; and\nimportlib.abc.Loader.module_repr(),\nimportlib.util.module_for_loader(), importlib.util.set_loader(),\nand importlib.util.set_package() are no longer needed because their\nfunctions are now handled automatically by the import system.\nThe imp module is pending deprecation. To keep compatibility with\nPython 2/3 code bases, the module’s removal is currently not scheduled.\nThe formatter module is pending deprecation and is slated for removal\nin Python 3.6.\nMD5 as the default digestmod for the hmac.new() function is\ndeprecated.  Python 3.6 will require an explicit digest name or constructor as\ndigestmod argument.\nThe internal Netrc class in the ftplib module has been documented\nas deprecated in its docstring for quite some time.  It now emits a\nDeprecationWarning and will be removed completely in Python 3.5.\nThe undocumented endtime argument to subprocess.Popen.wait() should\nnot have been exposed and is hopefully not in use; it is deprecated and\nwill mostly likely be removed in Python 3.5.\nThe strict argument of HTMLParser is deprecated.\nThe plistlib readPlist(),\nwritePlist(), readPlistFromBytes(), and\nwritePlistToBytes() functions are deprecated in favor of the\ncorresponding new functions load(), dump(),\nloads(), and dumps().  Data()\nis deprecated in favor of just using the bytes constructor.\nThe sysconfig key SO is deprecated, it has been replaced by\nEXT_SUFFIX.\nThe U mode accepted by various open functions is deprecated.\nIn Python3 it does not do anything useful, and should be replaced by\nappropriate uses of io.TextIOWrapper (if needed) and its newline\nargument.\nThe parser argument of xml.etree.ElementTree.iterparse() has\nbeen deprecated, as has the html argument of\nXMLParser().  To prepare for the removal of the\nlatter, all arguments to XMLParser should be passed by keyword.", "code_blocks": []}, "deprecated - deprecated-features": {"text": "Deprecated Features\n\n\nRunning IDLE with the -n flag (no subprocess) is deprecated.\nHowever, the feature will not be removed until issue 18823 is resolved.\nThe site module adding a “site-python” directory to sys.path, if it\nexists, is deprecated (issue 19375).", "code_blocks": []}, "removed - operating-systems-no-longer-supported": {"text": "Operating Systems No Longer Supported\n\nSupport for the following operating systems has been removed from the source\nand build tools:\n\nOS/2 (issue 16135).\nWindows 2000 (changeset e52df05b496a).\nWindows systems where COMSPEC points to command.com (issue 14470).\nVMS (issue 16136).", "code_blocks": []}, "removed - api-and-feature-removals": {"text": "API and Feature Removals\n\nThe following obsolete and previously deprecated APIs and features have been\nremoved:\n\nThe unmaintained Misc/TextMate and Misc/vim directories have been\nremoved (see the devguide\nfor suggestions on what to use instead).\nThe SO makefile macro is removed (it was replaced by the\nSHLIB_SUFFIX and EXT_SUFFIX macros) (issue 16754).\nThe PyThreadState.tick_counter field has been removed; its value has\nbeen meaningless since Python 3.2, when the “new GIL” was introduced\n(issue 19199).\nPyLoader and PyPycLoader have been removed from importlib.\n(Contributed by Taras Lyapun in issue 15641.)\nThe strict argument to HTTPConnection and\nHTTPSConnection has been removed.  HTTP 0.9-style\n“Simple Responses” are no longer supported.\nThe deprecated urllib.request.Request getter and setter methods\nadd_data, has_data, get_data, get_type, get_host,\nget_selector, set_proxy, get_origin_req_host, and\nis_unverifiable have been removed (use direct attribute access instead).\nSupport for loading the deprecated TYPE_INT64 has been removed from\nmarshal.  (Contributed by Dan Riti in issue 15480.)\ninspect.Signature: positional-only parameters are now required\nto have a valid name.\nobject.__format__() no longer accepts non-empty format strings, it now\nraises a TypeError instead.  Using a non-empty string has been\ndeprecated since Python 3.2.  This change has been made to prevent a\nsituation where previously working (but incorrect) code would start failing\nif an object gained a __format__ method, which means that your code may now\nraise a TypeError if you are using an 's' format code with objects\nthat do not have a __format__ method that handles it.  See issue 7994 for\nbackground.\ndifflib.SequenceMatcher.isbjunk() and\ndifflib.SequenceMatcher.isbpopular() were deprecated in 3.2, and have\nnow been removed: use x in sm.bjunk and\nx in sm.bpopular, where sm is a SequenceMatcher object\n(issue 13248).", "code_blocks": []}, "removed - code-cleanups": {"text": "Code Cleanups\n\n\nThe unused and undocumented internal Scanner class has been removed from\nthe pydoc module.\nThe private and effectively unused _gestalt module has been removed,\nalong with the private platform functions _mac_ver_lookup,\n_mac_ver_gstalt, and _bcd2str, which would only have ever been called\non badly broken OSX systems (see issue 18393).\nThe hardcoded copies of certain stat constants that were included in\nthe tarfile module namespace have been removed.", "code_blocks": []}, "porting-to-python-3-4 - changes-in-python-command-behavior": {"text": "Changes in ‘python’ Command Behavior\n\n\nIn a posix shell, setting the PATH environment variable to\nan empty value is equivalent to not setting it at all.  However, setting\nPYTHONPATH to an empty value was not equivalent to not setting it\nat all: setting PYTHONPATH to an empty value was equivalent to\nsetting it to ., which leads to confusion when reasoning by analogy to\nhow PATH works.  The behavior now conforms to the posix convention\nfor PATH.\nThe [X refs, Y blocks] output of a debug (--with-pydebug) build of the\nCPython interpreter is now off by default.  It can be re-enabled using the\n-X showrefcount option.  (Contributed by Ezio Melotti in issue 17323.)\nThe python command and most stdlib scripts (as well as argparse) now\noutput --version information to stdout instead of stderr (for\nissue list see Other Improvements above).", "code_blocks": []}, "porting-to-python-3-4 - changes-in-the-python-api": {"text": "Changes in the Python API\n\n\nThe ABCs defined in importlib.abc now either raise the appropriate\nexception or return a default value instead of raising\nNotImplementedError blindly. This will only affect code calling\nsuper() and falling through all the way to the ABCs. For compatibility,\ncatch both NotImplementedError or the appropriate exception as needed.\nThe module type now initializes the __package__ and __loader__\nattributes to None by default. To determine if these attributes were set\nin a backwards-compatible fashion, use e.g.\ngetattr(module, '__loader__', None) is not None.  (issue 17115.)\nimportlib.util.module_for_loader() now sets __loader__ and\n__package__ unconditionally to properly support reloading. If this is not\ndesired then you will need to set these attributes manually. You can use\nimportlib.util.module_to_load() for module management.\nImport now resets relevant attributes (e.g. __name__, __loader__,\n__package__, __file__, __cached__) unconditionally when reloading.\nNote that this restores a pre-3.3 behavior in that it means a module is\nre-found when re-loaded (issue 19413).\nFrozen packages no longer set __path__ to a list containing the package\nname, they now set it to an empty list.  The previous behavior could cause\nthe import system to do the wrong thing on submodule imports if there was\nalso a directory with the same name as the frozen package.  The correct way\nto determine if a module is a package or not is to use hasattr(module,\n'__path__') (issue 18065).\nFrozen modules no longer define a __file__ attribute. It’s semantically\nincorrect for frozen modules to set the attribute as they are not loaded from\nany explicit location. If you must know that a module comes from frozen code\nthen you can see if the module’s __spec__.location is set to 'frozen',\ncheck if the loader is a subclass of\nimportlib.machinery.FrozenImporter,\nor if Python 2 compatibility is necessary you can use imp.is_frozen().\npy_compile.compile() now raises FileExistsError if the file path\nit would write to is a symlink or a non-regular file. This is to act as a\nwarning that import will overwrite those files with a regular file regardless\nof what type of file path they were originally.\nimportlib.abc.SourceLoader.get_source() no longer raises\nImportError when the source code being loaded triggers a\nSyntaxError or UnicodeDecodeError. As ImportError is\nmeant to be raised only when source code cannot be found but it should, it was\nfelt to be over-reaching/overloading of that meaning when the source code is\nfound but improperly structured. If you were catching ImportError before and\nwish to continue to ignore syntax or decoding issues, catch all three\nexceptions now.\nfunctools.update_wrapper() and functools.wraps() now correctly\nset the __wrapped__ attribute to the function being wrapped, even if\nthat function also had its __wrapped__ attribute set. This means\n__wrapped__ attributes now correctly link a stack of decorated\nfunctions rather than every __wrapped__ attribute in the chain\nreferring to the innermost function. Introspection libraries that\nassumed the previous behaviour was intentional can use\ninspect.unwrap() to access the first function in the chain that has\nno __wrapped__ attribute.\ninspect.getfullargspec() has been reimplemented on top of\ninspect.signature() and hence handles a much wider variety of callable\nobjects than it did in the past. It is expected that additional builtin and\nextension module callables will gain signature metadata over the course of\nthe Python 3.4 series. Code that assumes that\ninspect.getfullargspec() will fail on non-Python callables may need\nto be adjusted accordingly.\nimportlib.machinery.PathFinder now passes on the current working\ndirectory to objects in sys.path_hooks for the empty string. This\nresults in sys.path_importer_cache never containing '', thus\niterating through sys.path_importer_cache based on sys.path\nwill not find all keys. A module’s __file__ when imported in the current\nworking directory will also now have an absolute path, including when using\n-m with the interpreter (except for __main__.__file__ when a script\nhas been executed directly using a relative path) (Contributed by Brett\nCannon in issue 18416).  is specified on the command-line)\n(issue 18416).\nThe removal of the strict argument to HTTPConnection\nand HTTPSConnection changes the meaning of the\nremaining arguments if you are specifying them positionally rather than by\nkeyword.  If you’ve been paying attention to deprecation warnings your code\nshould already be specifying any additional arguments via keywords.\nStrings between from __future__ import ... statements now always raise\na SyntaxError.  Previously if there was no leading docstring, an\ninterstitial string would sometimes be ignored.  This brings CPython into\ncompliance with the language spec; Jython and PyPy already were.\n(issue 17434).\nssl.SSLSocket.getpeercert() and ssl.SSLSocket.do_handshake()\nnow raise an OSError with ENOTCONN when the SSLSocket is not\nconnected, instead of the previous behavior of raising an\nAttributeError.  In addition, getpeercert()\nwill raise a ValueError if the handshake has not yet been done.\nbase64.b32decode() now raises a binascii.Error when the\ninput string contains non-b32-alphabet characters, instead of a\nTypeError.  This particular TypeError was missed when the other\nTypeErrors were converted.  (Contributed by Serhiy Storchaka in\nissue 18011.)  Note: this change was also inadvertently applied in Python\n3.3.3.\nThe file attribute is now automatically closed when\nthe creating cgi.FieldStorage instance is garbage collected. If you\nwere pulling the file object out separately from the cgi.FieldStorage\ninstance and not keeping the instance alive, then you should either store the\nentire cgi.FieldStorage instance or read the contents of the file\nbefore the cgi.FieldStorage instance is garbage collected.\nCalling read or write on a closed SSL socket now raises an\ninformative ValueError rather than the previous more mysterious\nAttributeError (issue 9177).\nslice.indices() no longer produces an OverflowError for huge\nvalues.  As a consequence of this fix, slice.indices() now raises a\nValueError if given a negative length; previously it returned nonsense\nvalues (issue 14794).\nThe complex constructor, unlike the cmath functions, was\nincorrectly accepting float values if an object’s __complex__\nspecial method returned one.  This now raises a TypeError.\n(issue 16290.)\nThe int constructor in 3.2 and 3.3 erroneously accepts float\nvalues for the base parameter.  It is unlikely anyone was doing this, but\nif so, it will now raise a TypeError (issue 16772).\nDefaults for keyword-only arguments are now evaluated after defaults for\nregular keyword arguments, instead of before.  Hopefully no one wrote any\ncode that depends on the previous buggy behavior (issue 16967).\nStale thread states are now cleared after fork().  This may cause\nsome system resources to be released that previously were incorrectly kept\nperpetually alive (for example, database connections kept in thread-local\nstorage).  (issue 17094.)\nParameter names in __annotations__ dicts are now mangled properly,\nsimilarly to __kwdefaults__.  (Contributed by Yury Selivanov in\nissue 20625.)\nhashlib.hash.name now always returns the identifier in lower case.\nPreviously some builtin hashes had uppercase names, but now that it is a\nformal public interface the naming has been made consistent (issue 18532).\nBecause unittest.TestSuite now drops references to tests after they\nare run, test harnesses that re-use a TestSuite to re-run\na set of tests may fail.   Test suites should not be re-used in this fashion\nsince it means state is retained between test runs, breaking the test\nisolation that unittest is designed to provide.  However, if the lack\nof isolation is considered acceptable, the old behavior can be restored by\ncreating a TestSuite subclass that defines a\n_removeTestAtIndex method that does nothing (see\nTestSuite.__iter__()) (issue 11798).\nunittest now uses argparse for command line parsing.  There are\ncertain invalid command forms that used to work that are no longer allowed;\nin theory this should not cause backward compatibility issues since the\ndisallowed command forms didn’t make any sense and are unlikely to be in use.\nThe re.split(), re.findall(), and re.sub() functions, and\nthe group() and groups() methods of\nmatch objects now always return a bytes object when the string\nto be matched is a bytes-like object.  Previously the return type\nmatched the input type, so if your code was depending on the return value\nbeing, say, a bytearray, you will need to change your code.\naudioop functions now raise an error immediately if passed string\ninput, instead of failing randomly later on (issue 16685).\nThe new convert_charrefs argument to HTMLParser\ncurrently defaults to False for backward compatibility, but will\neventually be changed to default to True.  It is recommended that you add\nthis keyword, with the appropriate value, to any\nHTMLParser calls in your code (issue 13633).\nSince the digestmod argument to the hmac.new() function will in the\nfuture have no default, all calls to hmac.new() should be changed to\nexplicitly specify a digestmod (issue 17276).\nCalling sysconfig.get_config_var() with the SO key, or looking\nSO up in the results of a call to sysconfig.get_config_vars()\nis deprecated.  This key should be replaced by EXT_SUFFIX or\nSHLIB_SUFFIX, depending on the context (issue 19555).\nAny calls to open functions that specify U should be modified.\nU is ineffective in Python3 and will eventually raise an error if used.\nDepending on the function, the equivalent of its old Python2 behavior can be\nachieved using either a newline argument, or if necessary by wrapping the\nstream in TextIOWrapper to use its newline argument\n(issue 15204).\nIf you use pyvenv in a script and desire that pip\nnot be installed, you must add --without-pip to your command\ninvocation.\nThe default behavior of json.dump() and json.dumps() when\nan indent is specified has changed: it no longer produces trailing\nspaces after the item separating commas at the ends of lines.  This\nwill matter only if you have tests that are doing white-space-sensitive\ncomparisons of such output (issue 16333).\ndoctest now looks for doctests in extension module __doc__\nstrings, so if your doctest test discovery includes extension modules that\nhave things that look like doctests in them you may see test failures you’ve\nnever seen before when running your tests (issue 3158).\nThe collections.abc module has been slightly refactored as\npart of the Python startup improvements.  As a consequence of this, it is no\nlonger the case that importing collections automatically imports\ncollections.abc.  If your program depended on the (undocumented)\nimplicit import, you will need to add an explicit import collections.abc\n(issue 20784).", "code_blocks": []}, "porting-to-python-3-4 - changes-in-the-c-api": {"text": "Changes in the C API\n\n\nPyEval_EvalFrameEx(), PyObject_Repr(), and\nPyObject_Str(), along with some other internal C APIs, now include\na debugging assertion that ensures they are not used in situations where\nthey may silently discard a currently active exception. In cases where\ndiscarding the active exception is expected and desired (for example,\nbecause it has already been saved locally with PyErr_Fetch() or\nis being deliberately replaced with a different exception), an explicit\nPyErr_Clear() call will be needed to avoid triggering the\nassertion when invoking these operations (directly or indirectly) and\nrunning against a version of Python that is compiled with assertions\nenabled.\nPyErr_SetImportError() now sets TypeError when its msg\nargument is not set. Previously only NULL was returned with no exception\nset.\nThe result of the PyOS_ReadlineFunctionPointer callback must\nnow be a string allocated by PyMem_RawMalloc() or\nPyMem_RawRealloc(), or NULL if an error occurred, instead of a\nstring allocated by PyMem_Malloc() or PyMem_Realloc()\n(issue 16742)\nPyThread_set_key_value() now always set the value. In Python\n3.3, the function did nothing if the key already exists (if the current\nvalue is a non-NULL pointer).\nThe f_tstate (thread state) field of the PyFrameObject\nstructure has been removed to fix a bug: see issue 14432 for the\nrationale.", "code_blocks": []}, "changed-in-3-4-3 - pep-476-enabling-certificate-verification-by-default-for-stdlib-http-clients": {"text": "PEP 476: Enabling certificate verification by default for stdlib http clients\n\nhttp.client and modules which use it, such as urllib.request and\nxmlrpc.client, will now verify that the server presents a certificate\nwhich is signed by a CA in the platform trust store and whose hostname matches\nthe hostname being requested by default, significantly improving security for\nmany applications.\nFor applications which require the old previous behavior, they can pass an\nalternate context:\nimport urllib.request\nimport ssl\n\n# This disables all verification\ncontext = ssl._create_unverified_context()\n\n# This allows using a specific certificate for the host, which doesn't need\n# to be in the trust store\ncontext = ssl.create_default_context(cafile=\"/path/to/file.crt\")\n\nurllib.request.urlopen(\"https://invalid-cert\", context=context)", "code_blocks": ["import urllib.request\nimport ssl\n\n# This disables all verification\ncontext = ssl._create_unverified_context()\n\n# This allows using a specific certificate for the host, which doesn't need\n# to be in the trust store\ncontext = ssl.create_default_context(cafile=\"/path/to/file.crt\")\n\nurllib.request.urlopen(\"https://invalid-cert\", context=context)\n"]}}}
{"index": 7, "python_version": "3.5", "url": "https://docs.python.org/3.5/whatsnew/3.5.html", "sections": {"summary-release-highlights": {"text": "Summary – Release highlights\n\nNew syntax features:\n\nPEP 492, coroutines with async and await syntax.\nPEP 465, a new matrix multiplication operator: a @ b.\nPEP 448, additional unpacking generalizations.\n\nNew library modules:\n\ntyping: PEP 484 – Type Hints.\nzipapp: PEP 441 Improving Python ZIP Application Support.\n\nNew built-in features:\n\nbytes % args, bytearray % args: PEP 461 –\nAdding % formatting to bytes and bytearray.\nNew bytes.hex(), bytearray.hex() and memoryview.hex()\nmethods. (Contributed by Arnon Yaari in bpo-9951.)\nmemoryview now supports tuple indexing (including multi-dimensional).\n(Contributed by Antoine Pitrou in bpo-23632.)\nGenerators have a new gi_yieldfrom attribute, which returns the\nobject being iterated by yield from expressions. (Contributed\nby Benno Leslie and Yury Selivanov in bpo-24450.)\nA new RecursionError exception is now raised when maximum\nrecursion depth is reached.  (Contributed by Georg Brandl\nin bpo-19235.)\n\nCPython implementation improvements:\n\nWhen the LC_TYPE locale is the POSIX locale (C locale),\nsys.stdin and sys.stdout now use the\nsurrogateescape error handler, instead of the strict error handler.\n(Contributed by Victor Stinner in bpo-19977.)\n.pyo files are no longer used and have been replaced by a more flexible\nscheme that includes the optimization level explicitly in .pyc name.\n(See PEP 488 overview.)\nBuiltin and extension modules are now initialized in a multi-phase process,\nwhich is similar to how Python modules are loaded.\n(See PEP 489 overview.)\n\nSignificant improvements in the standard library:\n\ncollections.OrderedDict is now\nimplemented in C, which makes it\n4 to 100 times faster.\nThe ssl module gained\nsupport for Memory BIO, which decouples SSL\nprotocol handling from network IO.\nThe new os.scandir() function provides a\nbetter and significantly faster way\nof directory traversal.\nfunctools.lru_cache() has been mostly\nreimplemented in C, yielding much better\nperformance.\nThe new subprocess.run() function provides a\nstreamlined way to run subprocesses.\nThe traceback module has been significantly\nenhanced for improved\nperformance and developer convenience.\n\nSecurity improvements:\n\nSSLv3 is now disabled throughout the standard library.\nIt can still be enabled by instantiating a ssl.SSLContext\nmanually.  (See bpo-22638 for more details; this change was\nbackported to CPython 3.4 and 2.7.)\nHTTP cookie parsing is now stricter, in order to protect\nagainst potential injection attacks. (Contributed by Antoine Pitrou\nin bpo-22796.)\n\nWindows improvements:\n\nA new installer for Windows has replaced the old MSI.\nSee Using Python on Windows for more information.\nWindows builds now use Microsoft Visual C++ 14.0, and extension modules\nshould use the same.\n\nPlease read on for a comprehensive list of user-facing changes, including many\nother smaller improvements, CPython optimizations, deprecations, and potential\nporting issues.", "code_blocks": []}, "new-features - pep-492-coroutines-with-async-and-await-syntax": {"text": "PEP 492 - Coroutines with async and await syntax\n\nPEP 492 greatly improves support for asynchronous programming in Python\nby adding awaitable objects,\ncoroutine functions,\nasynchronous iteration,\nand asynchronous context managers.\nCoroutine functions are declared using the new async def syntax:\n>>> async def coro():\n...     return 'spam'\n\n\nInside a coroutine function, the new await expression can be used\nto suspend coroutine execution until the result is available.  Any object\ncan be awaited, as long as it implements the awaitable protocol by\ndefining the __await__() method.\nPEP 492 also adds async for statement for convenient iteration\nover asynchronous iterables.\nAn example of a rudimentary HTTP client written using the new syntax:\nimport asyncio\n\nasync def http_get(domain):\n    reader, writer = await asyncio.open_connection(domain, 80)\n\n    writer.write(b'\\r\\n'.join([\n        b'GET / HTTP/1.1',\n        b'Host: %b' % domain.encode('latin-1'),\n        b'Connection: close',\n        b'', b''\n    ]))\n\n    async for line in reader:\n        print('>>>', line)\n\n    writer.close()\n\nloop = asyncio.get_event_loop()\ntry:\n    loop.run_until_complete(http_get('example.com'))\nfinally:\n    loop.close()\n\n\nSimilarly to asynchronous iteration, there is a new syntax for asynchronous\ncontext managers.  The following script:\nimport asyncio\n\nasync def coro(name, lock):\n    print('coro {}: waiting for lock'.format(name))\n    async with lock:\n        print('coro {}: holding the lock'.format(name))\n        await asyncio.sleep(1)\n        print('coro {}: releasing the lock'.format(name))\n\nloop = asyncio.get_event_loop()\nlock = asyncio.Lock()\ncoros = asyncio.gather(coro(1, lock), coro(2, lock))\ntry:\n    loop.run_until_complete(coros)\nfinally:\n    loop.close()\n\n\nwill output:\ncoro 2: waiting for lock\ncoro 2: holding the lock\ncoro 1: waiting for lock\ncoro 2: releasing the lock\ncoro 1: holding the lock\ncoro 1: releasing the lock\n\n\nNote that both async for and async with can only\nbe used inside a coroutine function declared with async def.\nCoroutine functions are intended to be run inside a compatible event loop,\nsuch as the asyncio loop.\n\nNote\n\nChanged in version 3.5.2: Starting with CPython 3.5.2, __aiter__ can directly return\nasynchronous iterators.  Returning\nan awaitable object will result in a\nPendingDeprecationWarning.\nSee more details in the Asynchronous Iterators documentation\nsection.\n\n\n\nSee also\n\nPEP 492 – Coroutines with async and await syntax\nPEP written and implemented by Yury Selivanov.", "code_blocks": [">>> async def coro():\n...     return 'spam'\n", "import asyncio\n\nasync def http_get(domain):\n    reader, writer = await asyncio.open_connection(domain, 80)\n\n    writer.write(b'\\r\\n'.join([\n        b'GET / HTTP/1.1',\n        b'Host: %b' % domain.encode('latin-1'),\n        b'Connection: close',\n        b'', b''\n    ]))\n\n    async for line in reader:\n        print('>>>', line)\n\n    writer.close()\n\nloop = asyncio.get_event_loop()\ntry:\n    loop.run_until_complete(http_get('example.com'))\nfinally:\n    loop.close()\n", "import asyncio\n\nasync def coro(name, lock):\n    print('coro {}: waiting for lock'.format(name))\n    async with lock:\n        print('coro {}: holding the lock'.format(name))\n        await asyncio.sleep(1)\n        print('coro {}: releasing the lock'.format(name))\n\nloop = asyncio.get_event_loop()\nlock = asyncio.Lock()\ncoros = asyncio.gather(coro(1, lock), coro(2, lock))\ntry:\n    loop.run_until_complete(coros)\nfinally:\n    loop.close()\n", "coro 2: waiting for lock\ncoro 2: holding the lock\ncoro 1: waiting for lock\ncoro 2: releasing the lock\ncoro 1: holding the lock\ncoro 1: releasing the lock\n"]}, "new-features - pep-465-a-dedicated-infix-operator-for-matrix-multiplication": {"text": "PEP 465 - A dedicated infix operator for matrix multiplication\n\nPEP 465 adds the @ infix operator for matrix multiplication.\nCurrently, no builtin Python types implement the new operator, however, it\ncan be implemented by defining __matmul__(), __rmatmul__(),\nand __imatmul__() for regular, reflected, and in-place matrix\nmultiplication.  The semantics of these methods is similar to that of\nmethods defining other infix arithmetic operators.\nMatrix multiplication is a notably common operation in many fields of\nmathematics, science, engineering, and the addition of @ allows writing\ncleaner code:\nS = (H @ beta - r).T @ inv(H @ V @ H.T) @ (H @ beta - r)\n\n\ninstead of:\nS = dot((dot(H, beta) - r).T,\n        dot(inv(dot(dot(H, V), H.T)), dot(H, beta) - r))\n\n\nNumPy 1.10 has support for the new operator:\n>>> import numpy\n\n>>> x = numpy.ones(3)\n>>> x\narray([ 1., 1., 1.])\n\n>>> m = numpy.eye(3)\n>>> m\narray([[ 1., 0., 0.],\n       [ 0., 1., 0.],\n       [ 0., 0., 1.]])\n\n>>> x @ m\narray([ 1., 1., 1.])\n\n\n\nSee also\n\nPEP 465 – A dedicated infix operator for matrix multiplication\nPEP written by Nathaniel J. Smith; implemented by Benjamin Peterson.", "code_blocks": ["S = (H @ beta - r).T @ inv(H @ V @ H.T) @ (H @ beta - r)\n", "S = dot((dot(H, beta) - r).T,\n        dot(inv(dot(dot(H, V), H.T)), dot(H, beta) - r))\n", ">>> import numpy\n\n>>> x = numpy.ones(3)\n>>> x\narray([ 1., 1., 1.])\n\n>>> m = numpy.eye(3)\n>>> m\narray([[ 1., 0., 0.],\n       [ 0., 1., 0.],\n       [ 0., 0., 1.]])\n\n>>> x @ m\narray([ 1., 1., 1.])\n"]}, "new-features - pep-448-additional-unpacking-generalizations": {"text": "PEP 448 - Additional Unpacking Generalizations\n\nPEP 448 extends the allowed uses of the * iterable unpacking\noperator and ** dictionary unpacking operator.  It is now possible\nto use an arbitrary number of unpackings in function calls:\n>>> print(*[1], *[2], 3, *[4, 5])\n1 2 3 4 5\n\n>>> def fn(a, b, c, d):\n...     print(a, b, c, d)\n...\n\n>>> fn(**{'a': 1, 'c': 3}, **{'b': 2, 'd': 4})\n1 2 3 4\n\n\nSimilarly, tuple, list, set, and dictionary displays allow multiple\nunpackings (see Expression lists and Dictionary displays):\n>>> *range(4), 4\n(0, 1, 2, 3, 4)\n\n>>> [*range(4), 4]\n[0, 1, 2, 3, 4]\n\n>>> {*range(4), 4, *(5, 6, 7)}\n{0, 1, 2, 3, 4, 5, 6, 7}\n\n>>> {'x': 1, **{'y': 2}}\n{'x': 1, 'y': 2}\n\n\n\nSee also\n\nPEP 448 – Additional Unpacking Generalizations\nPEP written by Joshua Landau; implemented by Neil Girdhar,\nThomas Wouters, and Joshua Landau.", "code_blocks": [">>> print(*[1], *[2], 3, *[4, 5])\n1 2 3 4 5\n\n>>> def fn(a, b, c, d):\n...     print(a, b, c, d)\n...\n\n>>> fn(**{'a': 1, 'c': 3}, **{'b': 2, 'd': 4})\n1 2 3 4\n", ">>> *range(4), 4\n(0, 1, 2, 3, 4)\n\n>>> [*range(4), 4]\n[0, 1, 2, 3, 4]\n\n>>> {*range(4), 4, *(5, 6, 7)}\n{0, 1, 2, 3, 4, 5, 6, 7}\n\n>>> {'x': 1, **{'y': 2}}\n{'x': 1, 'y': 2}\n"]}, "new-features - pep-461-percent-formatting-support-for-bytes-and-bytearray": {"text": "PEP 461 - percent formatting support for bytes and bytearray\n\nPEP 461 adds support for the %\ninterpolation operator to bytes\nand bytearray.\nWhile interpolation is usually thought of as a string operation, there are\ncases where interpolation on bytes or bytearrays makes sense, and the\nwork needed to make up for this missing functionality detracts from the\noverall readability of the code.  This issue is particularly important when\ndealing with wire format protocols, which are often a mixture of binary\nand ASCII compatible text.\nExamples:\n>>> b'Hello %b!' % b'World'\nb'Hello World!'\n\n>>> b'x=%i y=%f' % (1, 2.5)\nb'x=1 y=2.500000'\n\n\nUnicode is not allowed for %b, but it is accepted by %a (equivalent of\nrepr(obj).encode('ascii', 'backslashreplace')):\n>>> b'Hello %b!' % 'World'\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: %b requires bytes, or an object that implements __bytes__, not 'str'\n\n>>> b'price: %a' % '10€'\nb\"price: '10\\\\u20ac'\"\n\n\nNote that %s and %r conversion types, although supported, should\nonly be used in codebases that need compatibility with Python 2.\n\nSee also\n\nPEP 461 – Adding % formatting to bytes and bytearray\nPEP written by Ethan Furman; implemented by Neil Schemenauer and\nEthan Furman.", "code_blocks": [">>> b'Hello %b!' % b'World'\nb'Hello World!'\n\n>>> b'x=%i y=%f' % (1, 2.5)\nb'x=1 y=2.500000'\n", ">>> b'Hello %b!' % 'World'\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: %b requires bytes, or an object that implements __bytes__, not 'str'\n\n>>> b'price: %a' % '10€'\nb\"price: '10\\\\u20ac'\"\n"]}, "new-features - pep-484-type-hints": {"text": "PEP 484 - Type Hints\n\nFunction annotation syntax has been a Python feature since version 3.0\n(PEP 3107), however the semantics of annotations has been left undefined.\nExperience has shown that the majority of function annotation\nuses were to provide type hints to function parameters and return values.  It\nbecame evident that it would be beneficial for Python users, if the\nstandard library included the base definitions and tools for type annotations.\nPEP 484 introduces a provisional module to\nprovide these standard definitions and tools, along with some conventions\nfor situations where annotations are not available.\nFor example, here is a simple function whose argument and return type\nare declared in the annotations:\ndef greeting(name: str) -> str:\n    return 'Hello ' + name\n\n\nWhile these annotations are available at runtime through the usual\n__annotations__ attribute, no automatic type checking happens at\nruntime.  Instead, it is assumed that a separate off-line type checker\n(e.g. mypy) will be used for on-demand\nsource code analysis.\nThe type system supports unions, generic types, and a special type\nnamed Any which is consistent with (i.e. assignable to\nand from) all types.\n\nSee also\n\ntyping module documentation\n\nPEP 484 – Type Hints\nPEP written by Guido van Rossum, Jukka Lehtosalo, and Łukasz Langa;\nimplemented by Guido van Rossum.\n\n\n\nPEP 483 – The Theory of Type Hints\nPEP written by Guido van Rossum", "code_blocks": ["def greeting(name: str) -> str:\n    return 'Hello ' + name\n"]}, "new-features - pep-471-os-scandir-function-a-better-and-faster-directory-iterator": {"text": "PEP 471 - os.scandir() function – a better and faster directory iterator\n\nPEP 471 adds a new directory iteration function, os.scandir(),\nto the standard library.  Additionally, os.walk() is now\nimplemented using scandir, which makes it 3 to 5 times faster\non POSIX systems and 7 to 20 times faster on Windows systems.  This is\nlargely achieved by greatly reducing the number of calls to os.stat()\nrequired to walk a directory tree.\nAdditionally, scandir returns an iterator, as opposed to returning\na list of file names, which improves memory efficiency when iterating\nover very large directories.\nThe following example shows a simple use of os.scandir() to display all\nthe files (excluding directories) in the given path that don’t start with\n'.'. The entry.is_file() call will generally\nnot make an additional system call:\nfor entry in os.scandir(path):\n    if not entry.name.startswith('.') and entry.is_file():\n        print(entry.name)\n\n\n\nSee also\n\nPEP 471 – os.scandir() function – a better and faster directory iterator\nPEP written and implemented by Ben Hoyt with the help of Victor Stinner.", "code_blocks": ["for entry in os.scandir(path):\n    if not entry.name.startswith('.') and entry.is_file():\n        print(entry.name)\n"]}, "new-features - pep-475-retry-system-calls-failing-with-eintr": {"text": "PEP 475: Retry system calls failing with EINTR\n\nAn errno.EINTR error code is returned whenever a system call, that\nis waiting for I/O, is interrupted by a signal.  Previously, Python would\nraise InterruptedError in such cases.  This meant that, when writing a\nPython application, the developer had two choices:\n\nIgnore the InterruptedError.\nHandle the InterruptedError and attempt to restart the interrupted\nsystem call at every call site.\n\nThe first option makes an application fail intermittently.\nThe second option adds a large amount of boilerplate that makes the\ncode nearly unreadable.  Compare:\nprint(\"Hello World\")\n\n\nand:\nwhile True:\n    try:\n        print(\"Hello World\")\n        break\n    except InterruptedError:\n        continue\n\n\nPEP 475 implements automatic retry of system calls on\nEINTR.  This removes the burden of dealing with EINTR\nor InterruptedError in user code in most situations and makes\nPython programs, including the standard library, more robust.  Note that\nthe system call is only retried if the signal handler does not raise an\nexception.\nBelow is a list of functions which are now retried when interrupted\nby a signal:\n\nopen() and io.open();\nfunctions of the faulthandler module;\nos functions: fchdir(), fchmod(),\nfchown(), fdatasync(), fstat(),\nfstatvfs(), fsync(), ftruncate(),\nmkfifo(), mknod(), open(),\nposix_fadvise(), posix_fallocate(), pread(),\npwrite(), read(), readv(), sendfile(),\nwait3(), wait4(), wait(),\nwaitid(), waitpid(), write(),\nwritev();\nspecial cases: os.close() and os.dup2() now ignore\nEINTR errors; the syscall is not retried (see the PEP\nfor the rationale);\nselect functions: devpoll.poll(),\nepoll.poll(),\nkqueue.control(),\npoll.poll(), select();\nmethods of the socket class: accept(),\nconnect() (except for non-blocking sockets),\nrecv(), recvfrom(),\nrecvmsg(), send(),\nsendall(), sendmsg(),\nsendto();\nsignal.sigtimedwait() and signal.sigwaitinfo();\ntime.sleep().\n\n\nSee also\n\nPEP 475 – Retry system calls failing with EINTR\nPEP and implementation written by Charles-François Natali and\nVictor Stinner, with the help of Antoine Pitrou (the French connection).", "code_blocks": ["print(\"Hello World\")\n", "while True:\n    try:\n        print(\"Hello World\")\n        break\n    except InterruptedError:\n        continue\n"]}, "new-features - pep-479-change-stopiteration-handling-inside-generators": {"text": "PEP 479: Change StopIteration handling inside generators\n\nThe interaction of generators and StopIteration in Python 3.4 and\nearlier was sometimes surprising, and could conceal obscure bugs.  Previously,\nStopIteration raised accidentally inside a generator function was\ninterpreted as the end of the iteration by the loop construct driving the\ngenerator.\nPEP 479 changes the behavior of generators: when a StopIteration\nexception is raised inside a generator, it is replaced with a\nRuntimeError before it exits the generator frame.  The main goal of\nthis change is to ease debugging in the situation where an unguarded\nnext() call raises StopIteration and causes the iteration controlled\nby the generator to terminate silently. This is particularly pernicious in\ncombination with the yield from construct.\nThis is a backwards incompatible change, so to enable the new behavior,\na __future__ import is necessary:\n>>> from __future__ import generator_stop\n\n>>> def gen():\n...     next(iter([]))\n...     yield\n...\n>>> next(gen())\nTraceback (most recent call last):\n  File \"<stdin>\", line 2, in gen\nStopIteration\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nRuntimeError: generator raised StopIteration\n\n\nWithout a __future__ import, a PendingDeprecationWarning will be\nraised whenever a StopIteration exception is raised inside a generator.\n\nSee also\n\nPEP 479 – Change StopIteration handling inside generators\nPEP written by Chris Angelico and Guido van Rossum. Implemented by\nChris Angelico, Yury Selivanov and Nick Coghlan.", "code_blocks": [">>> from __future__ import generator_stop\n\n>>> def gen():\n...     next(iter([]))\n...     yield\n...\n>>> next(gen())\nTraceback (most recent call last):\n  File \"<stdin>\", line 2, in gen\nStopIteration\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nRuntimeError: generator raised StopIteration\n"]}, "new-features - pep-485-a-function-for-testing-approximate-equality": {"text": "PEP 485: A function for testing approximate equality\n\nPEP 485 adds the math.isclose() and cmath.isclose()\nfunctions which tell whether two values are approximately equal or\n“close” to each other.  Whether or not two values are considered\nclose is determined according to given absolute and relative tolerances.\nRelative tolerance is the maximum allowed difference between isclose\narguments, relative to the larger absolute value:\n>>> import math\n>>> a = 5.0\n>>> b = 4.99998\n>>> math.isclose(a, b, rel_tol=1e-5)\nTrue\n>>> math.isclose(a, b, rel_tol=1e-6)\nFalse\n\n\nIt is also possible to compare two values using absolute tolerance, which\nmust be a non-negative value:\n>>> import math\n>>> a = 5.0\n>>> b = 4.99998\n>>> math.isclose(a, b, abs_tol=0.00003)\nTrue\n>>> math.isclose(a, b, abs_tol=0.00001)\nFalse\n\n\n\nSee also\n\nPEP 485 – A function for testing approximate equality\nPEP written by Christopher Barker; implemented by Chris Barker and\nTal Einat.", "code_blocks": [">>> import math\n>>> a = 5.0\n>>> b = 4.99998\n>>> math.isclose(a, b, rel_tol=1e-5)\nTrue\n>>> math.isclose(a, b, rel_tol=1e-6)\nFalse\n", ">>> import math\n>>> a = 5.0\n>>> b = 4.99998\n>>> math.isclose(a, b, abs_tol=0.00003)\nTrue\n>>> math.isclose(a, b, abs_tol=0.00001)\nFalse\n"]}, "new-features - pep-486-make-the-python-launcher-aware-of-virtual-environments": {"text": "PEP 486: Make the Python Launcher aware of virtual environments\n\nPEP 486 makes the Windows launcher (see PEP 397) aware of an active\nvirtual environment. When the default interpreter would be used and the\nVIRTUAL_ENV environment variable is set, the interpreter in the virtual\nenvironment will be used.\n\nSee also\n\nPEP 486 – Make the Python Launcher aware of virtual environments\nPEP written and implemented by Paul Moore.", "code_blocks": []}, "new-features - pep-488-elimination-of-pyo-files": {"text": "PEP 488: Elimination of PYO files\n\nPEP 488 does away with the concept of .pyo files. This means that\n.pyc files represent both unoptimized and optimized bytecode. To prevent the\nneed to constantly regenerate bytecode files, .pyc files now have an\noptional opt- tag in their name when the bytecode is optimized. This has the\nside-effect of no more bytecode file name clashes when running under either\n-O or -OO. Consequently, bytecode files generated from\n-O, and -OO may now exist simultaneously.\nimportlib.util.cache_from_source() has an updated API to help with\nthis change.\n\nSee also\n\nPEP 488 – Elimination of PYO files\nPEP written and implemented by Brett Cannon.", "code_blocks": []}, "new-features - pep-489-multi-phase-extension-module-initialization": {"text": "PEP 489: Multi-phase extension module initialization\n\nPEP 489 updates extension module initialization to take advantage of the\ntwo step module loading mechanism introduced by PEP 451 in Python 3.4.\nThis change brings the import semantics of extension modules that opt-in to\nusing the new mechanism much closer to those of Python source and bytecode\nmodules, including the ability to use any valid identifier as a module name,\nrather than being restricted to ASCII.\n\nSee also\n\nPEP 489 – Multi-phase extension module initialization\nPEP written by Petr Viktorin, Stefan Behnel, and Nick Coghlan;\nimplemented by Petr Viktorin.", "code_blocks": []}, "other-language-changes": {"text": "Other Language Changes\n\nSome smaller changes made to the core Python language are:\n\nAdded the \"namereplace\" error handlers.  The \"backslashreplace\"\nerror handlers now work with decoding and translating.\n(Contributed by Serhiy Storchaka in bpo-19676 and bpo-22286.)\nThe -b option now affects comparisons of bytes with\nint.  (Contributed by Serhiy Storchaka in bpo-23681.)\nNew Kazakh kz1048 and Tajik koi8_t codecs.\n(Contributed by Serhiy Storchaka in bpo-22682 and bpo-22681.)\nProperty docstrings are now writable. This is especially useful for\ncollections.namedtuple() docstrings.\n(Contributed by Berker Peksag in bpo-24064.)\nCircular imports involving relative imports are now supported.\n(Contributed by Brett Cannon and Antoine Pitrou in bpo-17636.)", "code_blocks": []}, "new-modules - typing": {"text": "typing\n\nThe new typing provisional module\nprovides standard definitions and tools for function type annotations.\nSee Type Hints for more information.", "code_blocks": []}, "new-modules - zipapp": {"text": "zipapp\n\nThe new zipapp module (specified in PEP 441) provides an API and\ncommand line tool for creating executable Python Zip Applications, which\nwere introduced in Python 2.6 in bpo-1739468, but which were not well\npublicized, either at the time or since.\nWith the new module, bundling your application is as simple as putting all\nthe files, including a __main__.py file, into a directory myapp\nand running:\n$ python -m zipapp myapp\n$ python myapp.pyz\n\n\nThe module implementation has been contributed by Paul Moore in\nbpo-23491.\n\nSee also\nPEP 441 – Improving Python ZIP Application Support", "code_blocks": ["$ python -m zipapp myapp\n$ python myapp.pyz\n"]}, "improved-modules - argparse": {"text": "argparse\n\nThe ArgumentParser class now allows disabling\nabbreviated usage of long options by setting\nallow_abbrev to False.  (Contributed by Jonathan Paugh,\nSteven Bethard, paul j3 and Daniel Eriksson in bpo-14910.)", "code_blocks": []}, "improved-modules - asyncio": {"text": "asyncio\n\nSince the asyncio module is provisional,\nall changes introduced in Python 3.5 have also been backported to Python 3.4.x.\nNotable changes in the asyncio module since Python 3.4.0:\n\nNew debugging APIs: loop.set_debug()\nand loop.get_debug() methods.\n(Contributed by Victor Stinner.)\nThe proactor event loop now supports SSL.\n(Contributed by Antoine Pitrou and Victor Stinner in bpo-22560.)\nA new loop.is_closed() method to\ncheck if the event loop is closed.\n(Contributed by Victor Stinner in bpo-21326.)\nA new loop.create_task()\nto conveniently create and schedule a new Task\nfor a coroutine.  The create_task method is also used by all\nasyncio functions that wrap coroutines into tasks, such as\nasyncio.wait(), asyncio.gather(), etc.\n(Contributed by Victor Stinner.)\nA new transport.get_write_buffer_limits()\nmethod to inquire for high- and low- water limits of the flow\ncontrol.\n(Contributed by Victor Stinner.)\nThe async() function is deprecated in favor of\nensure_future().\n(Contributed by Yury Selivanov.)\nNew loop.set_task_factory() and\nloop.get_task_factory()\nmethods to customize the task factory that loop.create_task() method uses.  (Contributed by Yury\nSelivanov.)\nNew Queue.join() and\nQueue.task_done() queue methods.\n(Contributed by Victor Stinner.)\nThe JoinableQueue class was removed, in favor of the\nasyncio.Queue class.\n(Contributed by Victor Stinner.)\n\nUpdates in 3.5.1:\n\nThe ensure_future() function and all functions that\nuse it, such as loop.run_until_complete(),\nnow accept all kinds of awaitable objects.\n(Contributed by Yury Selivanov.)\nNew run_coroutine_threadsafe() function to submit\ncoroutines to event loops from other threads.\n(Contributed by Vincent Michel.)\nNew Transport.is_closing()\nmethod to check if the transport is closing or closed.\n(Contributed by Yury Selivanov.)\nThe loop.create_server()\nmethod can now accept a list of hosts.\n(Contributed by Yann Sionneau.)\n\nUpdates in 3.5.2:\n\nNew loop.create_future()\nmethod to create Future objects.  This allows alternative event\nloop implementations, such as\nuvloop, to provide a faster\nasyncio.Future implementation.\n(Contributed by Yury Selivanov.)\nNew loop.get_exception_handler()\nmethod to get the current exception handler.\n(Contributed by Yury Selivanov.)\nNew StreamReader.readuntil()\nmethod to read data from the stream until a separator bytes\nsequence appears.\n(Contributed by Mark Korenberg.)\nThe loop.create_connection()\nand loop.create_server()\nmethods are optimized to avoid calling the system getaddrinfo\nfunction if the address is already resolved.\n(Contributed by A. Jesse Jiryu Davis.)\nThe loop.sock_connect(sock, address)\nno longer requires the address to be resolved prior to the call.\n(Contributed by A. Jesse Jiryu Davis.)", "code_blocks": []}, "improved-modules - bz2": {"text": "bz2\n\nThe BZ2Decompressor.decompress\nmethod now accepts an optional max_length argument to limit the maximum\nsize of decompressed data. (Contributed by Nikolaus Rath in bpo-15955.)", "code_blocks": []}, "improved-modules - cgi": {"text": "cgi\n\nThe FieldStorage class now supports the context manager\nprotocol.  (Contributed by Berker Peksag in bpo-20289.)", "code_blocks": []}, "improved-modules - cmath": {"text": "cmath\n\nA new function isclose() provides a way to test for approximate\nequality.  (Contributed by Chris Barker and Tal Einat in bpo-24270.)", "code_blocks": []}, "improved-modules - code": {"text": "code\n\nThe InteractiveInterpreter.showtraceback()\nmethod now prints the full chained traceback, just like the interactive\ninterpreter.  (Contributed by Claudiu Popa in bpo-17442.)", "code_blocks": []}, "improved-modules - collections": {"text": "collections\n\nThe OrderedDict class is now implemented in C, which\nmakes it 4 to 100 times faster.  (Contributed by Eric Snow in bpo-16991.)\nOrderedDict.items(),\nOrderedDict.keys(),\nOrderedDict.values() views now support\nreversed() iteration.\n(Contributed by Serhiy Storchaka in bpo-19505.)\nThe deque class now defines\nindex(), insert(), and\ncopy(), and supports the + and * operators.\nThis allows deques to be recognized as a MutableSequence\nand improves their substitutability for lists.\n(Contributed by Raymond Hettinger in bpo-23704.)\nDocstrings produced by namedtuple() can now be updated:\nPoint = namedtuple('Point', ['x', 'y'])\nPoint.__doc__ += ': Cartesian coodinate'\nPoint.x.__doc__ = 'abscissa'\nPoint.y.__doc__ = 'ordinate'\n\n\n(Contributed by Berker Peksag in bpo-24064.)\nThe UserString class now implements the\n__getnewargs__(), __rmod__(), casefold(),\nformat_map(), isprintable(), and maketrans()\nmethods to match the corresponding methods of str.\n(Contributed by Joe Jevnik in bpo-22189.)", "code_blocks": ["Point = namedtuple('Point', ['x', 'y'])\nPoint.__doc__ += ': Cartesian coodinate'\nPoint.x.__doc__ = 'abscissa'\nPoint.y.__doc__ = 'ordinate'\n"]}, "improved-modules - collections-abc": {"text": "collections.abc\n\nThe Sequence.index() method now\naccepts start and stop arguments to match the corresponding methods\nof tuple, list, etc.\n(Contributed by Devin Jeanpierre in bpo-23086.)\nA new Generator abstract base class. (Contributed\nby Stefan Behnel in bpo-24018.)\nNew Awaitable, Coroutine,\nAsyncIterator, and\nAsyncIterable abstract base classes.\n(Contributed by Yury Selivanov in bpo-24184.)\nFor earlier Python versions, a backport of the new ABCs is available in an\nexternal PyPI package.", "code_blocks": []}, "improved-modules - compileall": {"text": "compileall\n\nA new compileall option, -j N, allows running N workers\nsimultaneously to perform parallel bytecode compilation.\nThe compile_dir() function has a corresponding workers\nparameter.  (Contributed by Claudiu Popa in bpo-16104.)\nAnother new option, -r, allows controlling the maximum recursion\nlevel for subdirectories.  (Contributed by Claudiu Popa in bpo-19628.)\nThe -q command line option can now be specified more than once, in\nwhich case all output, including errors, will be suppressed.  The corresponding\nquiet parameter in compile_dir(),\ncompile_file(), and compile_path() can now\naccept an integer value indicating the level of output suppression.\n(Contributed by Thomas Kluyver in bpo-21338.)", "code_blocks": []}, "improved-modules - concurrent-futures": {"text": "concurrent.futures\n\nThe Executor.map() method now accepts a\nchunksize argument to allow batching of tasks to improve performance when\nProcessPoolExecutor() is used.\n(Contributed by Dan O’Reilly in bpo-11271.)\nThe number of workers in the ThreadPoolExecutor\nconstructor is optional now.  The default value is 5 times the number of CPUs.\n(Contributed by Claudiu Popa in bpo-21527.)", "code_blocks": []}, "improved-modules - configparser": {"text": "configparser\n\nconfigparser now provides a way to customize the conversion\nof values by specifying a dictionary of converters in the\nConfigParser constructor, or by defining them\nas methods in ConfigParser subclasses.  Converters defined in\na parser instance are inherited by its section proxies.\nExample:\n>>> import configparser\n>>> conv = {}\n>>> conv['list'] = lambda v: [e.strip() for e in v.split() if e.strip()]\n>>> cfg = configparser.ConfigParser(converters=conv)\n>>> cfg.read_string(\"\"\"\n... [s]\n... list = a b c d e f g\n... \"\"\")\n>>> cfg.get('s', 'list')\n'a b c d e f g'\n>>> cfg.getlist('s', 'list')\n['a', 'b', 'c', 'd', 'e', 'f', 'g']\n>>> section = cfg['s']\n>>> section.getlist('list')\n['a', 'b', 'c', 'd', 'e', 'f', 'g']\n\n\n(Contributed by Łukasz Langa in bpo-18159.)", "code_blocks": [">>> import configparser\n>>> conv = {}\n>>> conv['list'] = lambda v: [e.strip() for e in v.split() if e.strip()]\n>>> cfg = configparser.ConfigParser(converters=conv)\n>>> cfg.read_string(\"\"\"\n... [s]\n... list = a b c d e f g\n... \"\"\")\n>>> cfg.get('s', 'list')\n'a b c d e f g'\n>>> cfg.getlist('s', 'list')\n['a', 'b', 'c', 'd', 'e', 'f', 'g']\n>>> section = cfg['s']\n>>> section.getlist('list')\n['a', 'b', 'c', 'd', 'e', 'f', 'g']\n"]}, "improved-modules - contextlib": {"text": "contextlib\n\nThe new redirect_stderr() context manager (similar to\nredirect_stdout()) makes it easier for utility scripts to\nhandle inflexible APIs that write their output to sys.stderr and\ndon’t provide any options to redirect it:\n>>> import contextlib, io, logging\n>>> f = io.StringIO()\n>>> with contextlib.redirect_stderr(f):\n...     logging.warning('warning')\n...\n>>> f.getvalue()\n'WARNING:root:warning\\n'\n\n\n(Contributed by Berker Peksag in bpo-22389.)", "code_blocks": [">>> import contextlib, io, logging\n>>> f = io.StringIO()\n>>> with contextlib.redirect_stderr(f):\n...     logging.warning('warning')\n...\n>>> f.getvalue()\n'WARNING:root:warning\\n'\n"]}, "improved-modules - csv": {"text": "csv\n\nThe writerow() method now supports arbitrary iterables,\nnot just sequences.  (Contributed by Serhiy Storchaka in bpo-23171.)", "code_blocks": []}, "improved-modules - curses": {"text": "curses\n\nThe new update_lines_cols() function updates the LINES\nand COLS environment variables.  This is useful for detecting\nmanual screen resizing.  (Contributed by Arnon Yaari in bpo-4254.)", "code_blocks": []}, "improved-modules - dbm": {"text": "dbm\n\ndumb.open always creates a new database when the flag\nhas the value \"n\".  (Contributed by Claudiu Popa in bpo-18039.)", "code_blocks": []}, "improved-modules - difflib": {"text": "difflib\n\nThe charset of HTML documents generated by\nHtmlDiff.make_file()\ncan now be customized by using a new charset keyword-only argument.\nThe default charset of HTML document changed from \"ISO-8859-1\"\nto \"utf-8\".\n(Contributed by Berker Peksag in bpo-2052.)\nThe diff_bytes() function can now compare lists of byte\nstrings.  This fixes a regression from Python 2.\n(Contributed by Terry J. Reedy and Greg Ward in bpo-17445.)", "code_blocks": []}, "improved-modules - distutils": {"text": "distutils\n\nBoth the build and build_ext commands now accept a -j option to\nenable parallel building of extension modules.\n(Contributed by Antoine Pitrou in bpo-5309.)\nThe distutils module now supports xz compression, and can be\nenabled by passing xztar as an argument to bdist --format.\n(Contributed by Serhiy Storchaka in bpo-16314.)", "code_blocks": []}, "improved-modules - doctest": {"text": "doctest\n\nThe DocTestSuite() function returns an empty\nunittest.TestSuite if module contains no docstrings, instead of\nraising ValueError.  (Contributed by Glenn Jones in bpo-15916.)", "code_blocks": []}, "improved-modules - email": {"text": "email\n\nA new policy option Policy.mangle_from_\ncontrols whether or not lines that start with \"From \" in email bodies are\nprefixed with a \">\" character by generators.  The default is True for\ncompat32 and False for all other policies.\n(Contributed by Milan Oberkirch in bpo-20098.)\nA new\nMessage.get_content_disposition()\nmethod provides easy access to a canonical value for the\nContent-Disposition header.\n(Contributed by Abhilash Raj in bpo-21083.)\nA new policy option EmailPolicy.utf8\ncan be set to True to encode email headers using the UTF-8 charset instead\nof using encoded words.  This allows Messages to be formatted according to\nRFC 6532 and used with an SMTP server that supports the RFC 6531\nSMTPUTF8 extension.  (Contributed by R. David Murray in\nbpo-24211.)\nThe mime.text.MIMEText constructor now\naccepts a charset.Charset instance.\n(Contributed by Claude Paroz and Berker Peksag in bpo-16324.)", "code_blocks": []}, "improved-modules - enum": {"text": "enum\n\nThe Enum callable has a new parameter start to\nspecify the initial number of enum values if only names are provided:\n>>> Animal = enum.Enum('Animal', 'cat dog', start=10)\n>>> Animal.cat\n<Animal.cat: 10>\n>>> Animal.dog\n<Animal.dog: 11>\n\n\n(Contributed by Ethan Furman in bpo-21706.)", "code_blocks": [">>> Animal = enum.Enum('Animal', 'cat dog', start=10)\n>>> Animal.cat\n<Animal.cat: 10>\n>>> Animal.dog\n<Animal.dog: 11>\n"]}, "improved-modules - faulthandler": {"text": "faulthandler\n\nThe enable(), register(),\ndump_traceback() and\ndump_traceback_later() functions now accept file\ndescriptors in addition to file-like objects.\n(Contributed by Wei Wu in bpo-23566.)", "code_blocks": []}, "improved-modules - functools": {"text": "functools\n\nMost of the lru_cache() machinery is now implemented in C, making\nit significantly faster.  (Contributed by Matt Joiner, Alexey Kachayev, and\nSerhiy Storchaka in bpo-14373.)", "code_blocks": []}, "improved-modules - glob": {"text": "glob\n\nThe iglob() and glob() functions now support recursive\nsearch in subdirectories, using the \"**\" pattern.\n(Contributed by Serhiy Storchaka in bpo-13968.)", "code_blocks": []}, "improved-modules - gzip": {"text": "gzip\n\nThe mode argument of the GzipFile constructor now\naccepts \"x\" to request exclusive creation.\n(Contributed by Tim Heaney in bpo-19222.)", "code_blocks": []}, "improved-modules - heapq": {"text": "heapq\n\nElement comparison in merge() can now be customized by\npassing a key function in a new optional key keyword argument,\nand a new optional reverse keyword argument can be used to reverse element\ncomparison:\n>>> import heapq\n>>> a = ['9', '777', '55555']\n>>> b = ['88', '6666']\n>>> list(heapq.merge(a, b, key=len))\n['9', '88', '777', '6666', '55555']\n>>> list(heapq.merge(reversed(a), reversed(b), key=len, reverse=True))\n['55555', '6666', '777', '88', '9']\n\n\n(Contributed by Raymond Hettinger in bpo-13742.)", "code_blocks": [">>> import heapq\n>>> a = ['9', '777', '55555']\n>>> b = ['88', '6666']\n>>> list(heapq.merge(a, b, key=len))\n['9', '88', '777', '6666', '55555']\n>>> list(heapq.merge(reversed(a), reversed(b), key=len, reverse=True))\n['55555', '6666', '777', '88', '9']\n"]}, "improved-modules - http": {"text": "http\n\nA new HTTPStatus enum that defines a set of\nHTTP status codes, reason phrases and long descriptions written in English.\n(Contributed by Demian Brecht in bpo-21793.)", "code_blocks": []}, "improved-modules - http-client": {"text": "http.client\n\nHTTPConnection.getresponse()\nnow raises a RemoteDisconnected exception when a\nremote server connection is closed unexpectedly.  Additionally, if a\nConnectionError (of which RemoteDisconnected\nis a subclass) is raised, the client socket is now closed automatically,\nand will reconnect on the next request:\nimport http.client\nconn = http.client.HTTPConnection('www.python.org')\nfor retries in range(3):\n    try:\n        conn.request('GET', '/')\n        resp = conn.getresponse()\n    except http.client.RemoteDisconnected:\n        pass\n\n\n(Contributed by Martin Panter in bpo-3566.)", "code_blocks": ["import http.client\nconn = http.client.HTTPConnection('www.python.org')\nfor retries in range(3):\n    try:\n        conn.request('GET', '/')\n        resp = conn.getresponse()\n    except http.client.RemoteDisconnected:\n        pass\n"]}, "improved-modules - idlelib-and-idle": {"text": "idlelib and IDLE\n\nSince idlelib implements the IDLE shell and editor and is not intended for\nimport by other programs, it gets improvements with every release.  See\nLib/idlelib/NEWS.txt for a cumulative list of changes since 3.4.0,\nas well as changes made in future 3.5.x releases. This file is also available\nfrom the IDLE Help ‣ About IDLE dialog.", "code_blocks": []}, "improved-modules - imaplib": {"text": "imaplib\n\nThe IMAP4 class now supports the context manager protocol.\nWhen used in a with statement, the IMAP4 LOGOUT\ncommand will be called automatically at the end of the block.\n(Contributed by Tarek Ziadé and Serhiy Storchaka in bpo-4972.)\nThe imaplib module now supports RFC 5161 (ENABLE Extension)\nand RFC 6855 (UTF-8 Support) via the IMAP4.enable()\nmethod.  A new IMAP4.utf8_enabled\nattribute tracks whether or not RFC 6855 support is enabled.\n(Contributed by Milan Oberkirch, R. David Murray, and Maciej Szulik in\nbpo-21800.)\nThe imaplib module now automatically encodes non-ASCII string usernames\nand passwords using UTF-8, as recommended by the RFCs.  (Contributed by Milan\nOberkirch in bpo-21800.)", "code_blocks": []}, "improved-modules - imghdr": {"text": "imghdr\n\nThe what() function now recognizes the\nOpenEXR format\n(contributed by Martin Vignali and Claudiu Popa in bpo-20295),\nand the WebP format\n(contributed by Fabrice Aneche and Claudiu Popa in bpo-20197.)", "code_blocks": []}, "improved-modules - importlib": {"text": "importlib\n\nThe util.LazyLoader class allows for\nlazy loading of modules in applications where startup time is important.\n(Contributed by Brett Cannon in bpo-17621.)\nThe abc.InspectLoader.source_to_code()\nmethod is now a static method.  This makes it easier to initialize a module\nobject with code compiled from a string by running\nexec(code, module.__dict__).\n(Contributed by Brett Cannon in bpo-21156.)\nThe new util.module_from_spec()\nfunction is now the preferred way to create a new module.  As opposed to\ncreating a types.ModuleType instance directly, this new function\nwill set the various import-controlled attributes based on the passed-in\nspec object.  (Contributed by Brett Cannon in bpo-20383.)", "code_blocks": []}, "improved-modules - inspect": {"text": "inspect\n\nBoth the Signature and Parameter classes are\nnow picklable and hashable.  (Contributed by Yury Selivanov in bpo-20726\nand bpo-20334.)\nA new\nBoundArguments.apply_defaults()\nmethod provides a way to set default values for missing arguments:\n>>> def foo(a, b='ham', *args): pass\n>>> ba = inspect.signature(foo).bind('spam')\n>>> ba.apply_defaults()\n>>> ba.arguments\nOrderedDict([('a', 'spam'), ('b', 'ham'), ('args', ())])\n\n\n(Contributed by Yury Selivanov in bpo-24190.)\nA new class method\nSignature.from_callable() makes\nsubclassing of Signature easier.  (Contributed\nby Yury Selivanov and Eric Snow in bpo-17373.)\nThe signature() function now accepts a follow_wrapped\noptional keyword argument, which, when set to False, disables automatic\nfollowing of __wrapped__ links.\n(Contributed by Yury Selivanov in bpo-20691.)\nA set of new functions to inspect\ncoroutine functions and\ncoroutine objects has been added:\niscoroutine(), iscoroutinefunction(),\nisawaitable(), getcoroutinelocals(),\nand getcoroutinestate().\n(Contributed by Yury Selivanov in bpo-24017 and bpo-24400.)\nThe stack(), trace(),\ngetouterframes(), and getinnerframes()\nfunctions now return a list of named tuples.\n(Contributed by Daniel Shahaf in bpo-16808.)", "code_blocks": [">>> def foo(a, b='ham', *args): pass\n>>> ba = inspect.signature(foo).bind('spam')\n>>> ba.apply_defaults()\n>>> ba.arguments\nOrderedDict([('a', 'spam'), ('b', 'ham'), ('args', ())])\n"]}, "improved-modules - io": {"text": "io\n\nA new BufferedIOBase.readinto1()\nmethod, that uses at most one call to the underlying raw stream’s\nRawIOBase.read() or\nRawIOBase.readinto() methods.\n(Contributed by Nikolaus Rath in bpo-20578.)", "code_blocks": []}, "improved-modules - ipaddress": {"text": "ipaddress\n\nBoth the IPv4Network and IPv6Network classes\nnow accept an (address, netmask) tuple argument, so as to easily construct\nnetwork objects from existing addresses:\n>>> import ipaddress\n>>> ipaddress.IPv4Network(('127.0.0.0', 8))\nIPv4Network('127.0.0.0/8')\n>>> ipaddress.IPv4Network(('127.0.0.0', '255.0.0.0'))\nIPv4Network('127.0.0.0/8')\n\n\n(Contributed by Peter Moody and Antoine Pitrou in bpo-16531.)\nA new reverse_pointer attribute for the\nIPv4Network and IPv6Network classes\nreturns the name of the reverse DNS PTR record:\n>>> import ipaddress\n>>> addr = ipaddress.IPv4Address('127.0.0.1')\n>>> addr.reverse_pointer\n'1.0.0.127.in-addr.arpa'\n>>> addr6 = ipaddress.IPv6Address('::1')\n>>> addr6.reverse_pointer\n'1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa'\n\n\n(Contributed by Leon Weber in bpo-20480.)", "code_blocks": [">>> import ipaddress\n>>> ipaddress.IPv4Network(('127.0.0.0', 8))\nIPv4Network('127.0.0.0/8')\n>>> ipaddress.IPv4Network(('127.0.0.0', '255.0.0.0'))\nIPv4Network('127.0.0.0/8')\n", ">>> import ipaddress\n>>> addr = ipaddress.IPv4Address('127.0.0.1')\n>>> addr.reverse_pointer\n'1.0.0.127.in-addr.arpa'\n>>> addr6 = ipaddress.IPv6Address('::1')\n>>> addr6.reverse_pointer\n'1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa'\n"]}, "improved-modules - json": {"text": "json\n\nThe json.tool command line interface now preserves the order of keys in\nJSON objects passed in input.  The new --sort-keys option can be used\nto sort the keys alphabetically. (Contributed by Berker Peksag\nin bpo-21650.)\nJSON decoder now raises JSONDecodeError instead of\nValueError to provide better context information about the error.\n(Contributed by Serhiy Storchaka in bpo-19361.)", "code_blocks": []}, "improved-modules - linecache": {"text": "linecache\n\nA new lazycache() function can be used to capture information\nabout a non-file-based module to permit getting its lines later via\ngetline(). This avoids doing I/O until a line is actually\nneeded, without having to carry the module globals around indefinitely.\n(Contributed by Robert Collins in bpo-17911.)", "code_blocks": []}, "improved-modules - locale": {"text": "locale\n\nA new delocalize() function can be used to convert a string into\na normalized number string, taking the LC_NUMERIC settings into account:\n>>> import locale\n>>> locale.setlocale(locale.LC_NUMERIC, 'de_DE.UTF-8')\n'de_DE.UTF-8'\n>>> locale.delocalize('1.234,56')\n'1234.56'\n>>> locale.setlocale(locale.LC_NUMERIC, 'en_US.UTF-8')\n'en_US.UTF-8'\n>>> locale.delocalize('1,234.56')\n'1234.56'\n\n\n(Contributed by Cédric Krier in bpo-13918.)", "code_blocks": [">>> import locale\n>>> locale.setlocale(locale.LC_NUMERIC, 'de_DE.UTF-8')\n'de_DE.UTF-8'\n>>> locale.delocalize('1.234,56')\n'1234.56'\n>>> locale.setlocale(locale.LC_NUMERIC, 'en_US.UTF-8')\n'en_US.UTF-8'\n>>> locale.delocalize('1,234.56')\n'1234.56'\n"]}, "improved-modules - logging": {"text": "logging\n\nAll logging methods (Logger log(),\nexception(), critical(),\ndebug(), etc.), now accept exception instances\nas an exc_info argument, in addition to boolean values and exception\ntuples:\n>>> import logging\n>>> try:\n...     1/0\n... except ZeroDivisionError as ex:\n...     logging.error('exception', exc_info=ex)\nERROR:root:exception\n\n\n(Contributed by Yury Selivanov in bpo-20537.)\nThe handlers.HTTPHandler class now\naccepts an optional ssl.SSLContext instance to configure SSL\nsettings used in an HTTP connection.\n(Contributed by Alex Gaynor in bpo-22788.)\nThe handlers.QueueListener class now\ntakes a respect_handler_level keyword argument which, if set to True,\nwill pass messages to handlers taking handler levels into account.\n(Contributed by Vinay Sajip.)", "code_blocks": [">>> import logging\n>>> try:\n...     1/0\n... except ZeroDivisionError as ex:\n...     logging.error('exception', exc_info=ex)\nERROR:root:exception\n"]}, "improved-modules - lzma": {"text": "lzma\n\nThe LZMADecompressor.decompress()\nmethod now accepts an optional max_length argument to limit the maximum\nsize of decompressed data.\n(Contributed by Martin Panter in bpo-15955.)", "code_blocks": []}, "improved-modules - math": {"text": "math\n\nTwo new constants have been added to the math module: inf\nand nan.  (Contributed by Mark Dickinson in bpo-23185.)\nA new function isclose() provides a way to test for approximate\nequality. (Contributed by Chris Barker and Tal Einat in bpo-24270.)\nA new gcd() function has been added.  The fractions.gcd()\nfunction is now deprecated. (Contributed by Mark Dickinson and Serhiy\nStorchaka in bpo-22486.)", "code_blocks": []}, "improved-modules - multiprocessing": {"text": "multiprocessing\n\nsharedctypes.synchronized()\nobjects now support the context manager protocol.\n(Contributed by Charles-François Natali in bpo-21565.)", "code_blocks": []}, "improved-modules - operator": {"text": "operator\n\nattrgetter(), itemgetter(),\nand methodcaller() objects now support pickling.\n(Contributed by Josh Rosenberg and Serhiy Storchaka in bpo-22955.)\nNew matmul() and imatmul() functions\nto perform matrix multiplication.\n(Contributed by Benjamin Peterson in bpo-21176.)", "code_blocks": []}, "improved-modules - os": {"text": "os\n\nThe new scandir() function returning an iterator of\nDirEntry objects has been added.  If possible, scandir()\nextracts file attributes while scanning a directory, removing the need to\nperform subsequent system calls to determine file type or attributes, which may\nsignificantly improve performance.  (Contributed by Ben Hoyt with the help\nof Victor Stinner in bpo-22524.)\nOn Windows, a new\nstat_result.st_file_attributes\nattribute is now available.  It corresponds to the dwFileAttributes member\nof the BY_HANDLE_FILE_INFORMATION structure returned by\nGetFileInformationByHandle().  (Contributed by Ben Hoyt in bpo-21719.)\nThe urandom() function now uses the getrandom() syscall on Linux 3.17\nor newer, and getentropy() on OpenBSD 5.6 and newer, removing the need to\nuse /dev/urandom and avoiding failures due to potential file descriptor\nexhaustion.  (Contributed by Victor Stinner in bpo-22181.)\nNew get_blocking() and set_blocking() functions allow\ngetting and setting a file descriptor’s blocking mode (O_NONBLOCK.)\n(Contributed by Victor Stinner in bpo-22054.)\nThe truncate() and ftruncate() functions are now supported\non Windows.  (Contributed by Steve Dower in bpo-23668.)\nThere is a new os.path.commonpath() function returning the longest\ncommon sub-path of each passed pathname.  Unlike the\nos.path.commonprefix() function, it always returns a valid\npath:\n>>> os.path.commonprefix(['/usr/lib', '/usr/local/lib'])\n'/usr/l'\n\n>>> os.path.commonpath(['/usr/lib', '/usr/local/lib'])\n'/usr'\n\n\n(Contributed by Rafik Draoui and Serhiy Storchaka in bpo-10395.)", "code_blocks": [">>> os.path.commonprefix(['/usr/lib', '/usr/local/lib'])\n'/usr/l'\n\n>>> os.path.commonpath(['/usr/lib', '/usr/local/lib'])\n'/usr'\n"]}, "improved-modules - pathlib": {"text": "pathlib\n\nThe new Path.samefile() method can be used\nto check whether the path points to the same file as another path, which can\nbe either another Path object, or a string:\n>>> import pathlib\n>>> p1 = pathlib.Path('/etc/hosts')\n>>> p2 = pathlib.Path('/etc/../etc/hosts')\n>>> p1.samefile(p2)\nTrue\n\n\n(Contributed by Vajrasky Kok and Antoine Pitrou in bpo-19775.)\nThe Path.mkdir() method now accepts a new optional\nexist_ok argument to match mkdir -p and os.makedirs()\nfunctionality.  (Contributed by Berker Peksag in bpo-21539.)\nThere is a new Path.expanduser() method to\nexpand ~ and ~user prefixes.  (Contributed by Serhiy Storchaka and\nClaudiu Popa in bpo-19776.)\nA new Path.home() class method can be used to get\na Path instance representing the user’s home\ndirectory.\n(Contributed by Victor Salgado and Mayank Tripathi in bpo-19777.)\nNew Path.write_text(),\nPath.read_text(),\nPath.write_bytes(),\nPath.read_bytes() methods to simplify\nread/write operations on files.\nThe following code snippet will create or rewrite existing file\n~/spam42:\n>>> import pathlib\n>>> p = pathlib.Path('~/spam42')\n>>> p.expanduser().write_text('ham')\n3\n\n\n(Contributed by Christopher Welborn in bpo-20218.)", "code_blocks": [">>> import pathlib\n>>> p1 = pathlib.Path('/etc/hosts')\n>>> p2 = pathlib.Path('/etc/../etc/hosts')\n>>> p1.samefile(p2)\nTrue\n", ">>> import pathlib\n>>> p = pathlib.Path('~/spam42')\n>>> p.expanduser().write_text('ham')\n3\n"]}, "improved-modules - pickle": {"text": "pickle\n\nNested objects, such as unbound methods or nested classes, can now be pickled\nusing pickle protocols older than protocol version 4.\nProtocol version 4 already supports these cases.  (Contributed by Serhiy\nStorchaka in bpo-23611.)", "code_blocks": []}, "improved-modules - poplib": {"text": "poplib\n\nA new POP3.utf8() command enables RFC 6856\n(Internationalized Email) support, if a POP server supports it.\n(Contributed by Milan OberKirch in bpo-21804.)", "code_blocks": []}, "improved-modules - re": {"text": "re\n\nReferences and conditional references to groups with fixed length are now\nallowed in lookbehind assertions:\n>>> import re\n>>> pat = re.compile(r'(a|b).(?<=\\1)c')\n>>> pat.match('aac')\n<_sre.SRE_Match object; span=(0, 3), match='aac'>\n>>> pat.match('bbc')\n<_sre.SRE_Match object; span=(0, 3), match='bbc'>\n\n\n(Contributed by Serhiy Storchaka in bpo-9179.)\nThe number of capturing groups in regular expressions is no longer limited to\n100.  (Contributed by Serhiy Storchaka in bpo-22437.)\nThe sub() and subn() functions now replace unmatched\ngroups with empty strings instead of raising an exception.\n(Contributed by Serhiy Storchaka in bpo-1519638.)\nThe re.error exceptions have new attributes,\nmsg, pattern,\npos, lineno,\nand colno, that provide better context\ninformation about the error:\n>>> re.compile(\"\"\"\n...     (?x)\n...     .++\n... \"\"\")\nTraceback (most recent call last):\n   ...\nsre_constants.error: multiple repeat at position 16 (line 3, column 7)\n\n\n(Contributed by Serhiy Storchaka in bpo-22578.)", "code_blocks": [">>> import re\n>>> pat = re.compile(r'(a|b).(?<=\\1)c')\n>>> pat.match('aac')\n<_sre.SRE_Match object; span=(0, 3), match='aac'>\n>>> pat.match('bbc')\n<_sre.SRE_Match object; span=(0, 3), match='bbc'>\n", ">>> re.compile(\"\"\"\n...     (?x)\n...     .++\n... \"\"\")\nTraceback (most recent call last):\n   ...\nsre_constants.error: multiple repeat at position 16 (line 3, column 7)\n"]}, "improved-modules - readline": {"text": "readline\n\nA new append_history_file() function can be used to append\nthe specified number of trailing elements in history to the given file.\n(Contributed by Bruno Cauet in bpo-22940.)", "code_blocks": []}, "improved-modules - selectors": {"text": "selectors\n\nThe new DevpollSelector supports efficient\n/dev/poll polling on Solaris.\n(Contributed by Giampaolo Rodola’ in bpo-18931.)", "code_blocks": []}, "improved-modules - shutil": {"text": "shutil\n\nThe move() function now accepts a copy_function argument,\nallowing, for example, the copy() function to be used instead of\nthe default copy2() if there is a need to ignore file metadata\nwhen moving.\n(Contributed by Claudiu Popa in bpo-19840.)\nThe make_archive() function now supports the xztar format.\n(Contributed by Serhiy Storchaka in bpo-5411.)", "code_blocks": []}, "improved-modules - signal": {"text": "signal\n\nOn Windows, the set_wakeup_fd() function now also supports\nsocket handles.  (Contributed by Victor Stinner in bpo-22018.)\nVarious SIG* constants in the signal module have been converted into\nEnums.  This allows meaningful names to be printed\nduring debugging, instead of integer “magic numbers”.\n(Contributed by Giampaolo Rodola’ in bpo-21076.)", "code_blocks": []}, "improved-modules - smtpd": {"text": "smtpd\n\nBoth the SMTPServer and SMTPChannel classes now\naccept a decode_data keyword argument to determine if the DATA portion of\nthe SMTP transaction is decoded using the \"utf-8\" codec or is instead\nprovided to the\nSMTPServer.process_message()\nmethod as a byte string.  The default is True for backward compatibility\nreasons, but will change to False in Python 3.6.  If decode_data is set\nto False, the process_message method must be prepared to accept keyword\narguments.\n(Contributed by Maciej Szulik in bpo-19662.)\nThe SMTPServer class now advertises the 8BITMIME extension\n(RFC 6152) if decode_data has been set True.  If the client\nspecifies BODY=8BITMIME on the MAIL command, it is passed to\nSMTPServer.process_message()\nvia the mail_options keyword.\n(Contributed by Milan Oberkirch and R.  David Murray in bpo-21795.)\nThe SMTPServer class now also supports the SMTPUTF8\nextension (RFC 6531: Internationalized Email).  If the client specified\nSMTPUTF8 BODY=8BITMIME on the MAIL command, they are passed to\nSMTPServer.process_message()\nvia the mail_options keyword.  It is the responsibility of the\nprocess_message method to correctly handle the SMTPUTF8 data.\n(Contributed by Milan Oberkirch in bpo-21725.)\nIt is now possible to provide, directly or via name resolution, IPv6\naddresses in the SMTPServer constructor, and have it\nsuccessfully connect.  (Contributed by Milan Oberkirch in bpo-14758.)", "code_blocks": []}, "improved-modules - smtplib": {"text": "smtplib\n\nA new SMTP.auth() method provides a convenient way to\nimplement custom authentication mechanisms. (Contributed by Milan\nOberkirch in bpo-15014.)\nThe SMTP.set_debuglevel() method now\naccepts an additional debuglevel (2), which enables timestamps in debug\nmessages. (Contributed by Gavin Chappell and Maciej Szulik in bpo-16914.)\nBoth the SMTP.sendmail() and\nSMTP.send_message() methods now\nsupport RFC 6531 (SMTPUTF8).\n(Contributed by Milan Oberkirch and R. David Murray in bpo-22027.)", "code_blocks": []}, "improved-modules - sndhdr": {"text": "sndhdr\n\nThe what() and whathdr() functions  now return\na namedtuple().  (Contributed by Claudiu Popa in\nbpo-18615.)", "code_blocks": []}, "improved-modules - socket": {"text": "socket\n\nFunctions with timeouts now use a monotonic clock, instead of a system clock.\n(Contributed by Victor Stinner in bpo-22043.)\nA new socket.sendfile() method allows\nsending a file over a socket by using the high-performance os.sendfile()\nfunction on UNIX, resulting in uploads being from 2 to 3 times faster than when\nusing plain socket.send().\n(Contributed by Giampaolo Rodola’ in bpo-17552.)\nThe socket.sendall() method no longer resets the\nsocket timeout every time bytes are received or sent.  The socket timeout is\nnow the maximum total duration to send all data.\n(Contributed by Victor Stinner in bpo-23853.)\nThe backlog argument of the socket.listen()\nmethod is now optional.  By default it is set to\nSOMAXCONN or to 128, whichever is less.\n(Contributed by Charles-François Natali in bpo-21455.)", "code_blocks": []}, "improved-modules - ssl": {"text": "ssl\n\n\nMemory BIO Support\n\n(Contributed by Geert Jansen in bpo-21965.)\nThe new SSLObject class has been added to provide SSL protocol\nsupport for cases when the network I/O capabilities of SSLSocket\nare not necessary or are suboptimal.  SSLObject represents\nan SSL protocol instance, but does not implement any network I/O methods, and\ninstead provides a memory buffer interface.  The new MemoryBIO\nclass can be used to pass data between Python and an SSL protocol instance.\nThe memory BIO SSL support is primarily intended to be used in frameworks\nimplementing asynchronous I/O for which SSLSocket’s readiness\nmodel (“select/poll”) is inefficient.\nA new SSLContext.wrap_bio() method can be used\nto create a new SSLObject instance.\n\n\nApplication-Layer Protocol Negotiation Support\n\n(Contributed by Benjamin Peterson in bpo-20188.)\nWhere OpenSSL support is present, the ssl module now implements\nthe Application-Layer Protocol Negotiation TLS extension as described\nin RFC 7301.\nThe new SSLContext.set_alpn_protocols()\ncan be used to specify which protocols a socket should advertise during\nthe TLS handshake.\nThe new\nSSLSocket.selected_alpn_protocol()\nreturns the protocol that was selected during the TLS handshake.\nThe HAS_ALPN flag indicates whether ALPN support is present.\n\n\nOther Changes\n\nThere is a new SSLSocket.version() method to\nquery the actual protocol version in use.\n(Contributed by Antoine Pitrou in bpo-20421.)\nThe SSLSocket class now implements\na SSLSocket.sendfile() method.\n(Contributed by Giampaolo Rodola’ in bpo-17552.)\nThe SSLSocket.send() method now raises either\nthe ssl.SSLWantReadError or ssl.SSLWantWriteError exception on a\nnon-blocking socket if the operation would block. Previously, it would return\n0.  (Contributed by Nikolaus Rath in bpo-20951.)\nThe cert_time_to_seconds() function now interprets the input time\nas UTC and not as local time, per RFC 5280.  Additionally, the return\nvalue is always an int. (Contributed by Akira Li in bpo-19940.)\nNew SSLObject.shared_ciphers() and\nSSLSocket.shared_ciphers() methods return\nthe list of ciphers sent by the client during the handshake.\n(Contributed by Benjamin Peterson in bpo-23186.)\nThe SSLSocket.do_handshake(),\nSSLSocket.read(),\nSSLSocket.shutdown(), and\nSSLSocket.write() methods of the SSLSocket\nclass no longer reset the socket timeout every time bytes are received or sent.\nThe socket timeout is now the maximum total duration of the method.\n(Contributed by Victor Stinner in bpo-23853.)\nThe match_hostname() function now supports matching of IP addresses.\n(Contributed by Antoine Pitrou in bpo-23239.)", "code_blocks": []}, "improved-modules - sqlite3": {"text": "sqlite3\n\nThe Row class now fully supports the sequence protocol,\nin particular reversed() iteration and slice indexing.\n(Contributed by Claudiu Popa in bpo-10203; by Lucas Sinclair,\nJessica McKellar, and  Serhiy Storchaka in bpo-13583.)", "code_blocks": []}, "improved-modules - subprocess": {"text": "subprocess\n\nThe new run() function has been added.\nIt runs the specified command and returns a\nCompletedProcess object, which describes a finished\nprocess.  The new API is more consistent and is the recommended approach\nto invoking subprocesses in Python code that does not need to maintain\ncompatibility with earlier Python versions.\n(Contributed by Thomas Kluyver in bpo-23342.)\nExamples:\n>>> subprocess.run([\"ls\", \"-l\"])  # doesn't capture output\nCompletedProcess(args=['ls', '-l'], returncode=0)\n\n>>> subprocess.run(\"exit 1\", shell=True, check=True)\nTraceback (most recent call last):\n  ...\nsubprocess.CalledProcessError: Command 'exit 1' returned non-zero exit status 1\n\n>>> subprocess.run([\"ls\", \"-l\", \"/dev/null\"], stdout=subprocess.PIPE)\nCompletedProcess(args=['ls', '-l', '/dev/null'], returncode=0,\nstdout=b'crw-rw-rw- 1 root root 1, 3 Jan 23 16:23 /dev/null\\n')", "code_blocks": [">>> subprocess.run([\"ls\", \"-l\"])  # doesn't capture output\nCompletedProcess(args=['ls', '-l'], returncode=0)\n\n>>> subprocess.run(\"exit 1\", shell=True, check=True)\nTraceback (most recent call last):\n  ...\nsubprocess.CalledProcessError: Command 'exit 1' returned non-zero exit status 1\n\n>>> subprocess.run([\"ls\", \"-l\", \"/dev/null\"], stdout=subprocess.PIPE)\nCompletedProcess(args=['ls', '-l', '/dev/null'], returncode=0,\nstdout=b'crw-rw-rw- 1 root root 1, 3 Jan 23 16:23 /dev/null\\n')\n"]}, "improved-modules - sys": {"text": "sys\n\nA new set_coroutine_wrapper() function allows setting a global\nhook that will be called whenever a coroutine object\nis created by an async def function.  A corresponding\nget_coroutine_wrapper() can be used to obtain a currently set\nwrapper.  Both functions are provisional,\nand are intended for debugging purposes only.  (Contributed by Yury Selivanov\nin bpo-24017.)\nA new is_finalizing() function can be used to check if the Python\ninterpreter is shutting down.\n(Contributed by Antoine Pitrou in bpo-22696.)", "code_blocks": []}, "improved-modules - sysconfig": {"text": "sysconfig\n\nThe name of the user scripts directory on Windows now includes the first\ntwo components of the Python version. (Contributed by Paul Moore\nin bpo-23437.)", "code_blocks": []}, "improved-modules - tarfile": {"text": "tarfile\n\nThe mode argument of the open() function now accepts \"x\"\nto request exclusive creation.  (Contributed by Berker Peksag in bpo-21717.)\nThe TarFile.extractall() and\nTarFile.extract() methods now take a keyword\nargument numeric_owner.  If set to True, the extracted files and\ndirectories will be owned by the numeric uid and gid from the tarfile.\nIf set to False (the default, and the behavior in versions prior to 3.5),\nthey will be owned by the named user and group in the tarfile.\n(Contributed by Michael Vogt and Eric Smith in bpo-23193.)\nThe TarFile.list() now accepts an optional\nmembers keyword argument that can be set to a subset of the list returned\nby TarFile.getmembers().\n(Contributed by Serhiy Storchaka in bpo-21549.)", "code_blocks": []}, "improved-modules - threading": {"text": "threading\n\nBoth the Lock.acquire() and\nRLock.acquire() methods\nnow use a monotonic clock for timeout management.\n(Contributed by Victor Stinner in bpo-22043.)", "code_blocks": []}, "improved-modules - time": {"text": "time\n\nThe monotonic() function is now always available.\n(Contributed by Victor Stinner in bpo-22043.)", "code_blocks": []}, "improved-modules - timeit": {"text": "timeit\n\nA new command line option -u or --unit=U can be used to specify the time\nunit for the timer output.  Supported options are usec, msec,\nor sec.  (Contributed by Julian Gindi in bpo-18983.)\nThe timeit() function has a new globals parameter for\nspecifying the namespace in which the code will be running.\n(Contributed by Ben Roberts in bpo-2527.)", "code_blocks": []}, "improved-modules - tkinter": {"text": "tkinter\n\nThe tkinter._fix module used for setting up the Tcl/Tk environment\non Windows has been replaced by a private function in the _tkinter\nmodule which makes no permanent changes to environment variables.\n(Contributed by Zachary Ware in bpo-20035.)", "code_blocks": []}, "improved-modules - traceback": {"text": "traceback\n\nNew walk_stack() and walk_tb()\nfunctions to conveniently traverse frame and traceback objects.\n(Contributed by Robert Collins in bpo-17911.)\nNew lightweight classes: TracebackException,\nStackSummary, and FrameSummary.\n(Contributed by Robert Collins in bpo-17911.)\nBoth the print_tb() and print_stack() functions\nnow support negative values for the limit argument.\n(Contributed by Dmitry Kazakov in bpo-22619.)", "code_blocks": []}, "improved-modules - types": {"text": "types\n\nA new coroutine() function to transform\ngenerator and\ngenerator-like objects into\nawaitables.\n(Contributed by Yury Selivanov in bpo-24017.)\nA new type called CoroutineType, which is used for\ncoroutine objects created by async def functions.\n(Contributed by Yury Selivanov in bpo-24400.)", "code_blocks": []}, "improved-modules - unicodedata": {"text": "unicodedata\n\nThe unicodedata module now uses data from Unicode 8.0.0.", "code_blocks": []}, "improved-modules - unittest": {"text": "unittest\n\nThe TestLoader.loadTestsFromModule()\nmethod now accepts a keyword-only argument pattern which is passed to\nload_tests as the third argument.  Found packages are now checked for\nload_tests regardless of whether their path matches pattern, because it\nis impossible for a package name to match the default pattern.\n(Contributed by Robert Collins and Barry A. Warsaw in bpo-16662.)\nUnittest discovery errors now are exposed in the\nTestLoader.errors attribute of the\nTestLoader instance.\n(Contributed by Robert Collins in bpo-19746.)\nA new command line option --locals to show local variables in\ntracebacks.  (Contributed by Robert Collins in bpo-22936.)", "code_blocks": []}, "improved-modules - unittest-mock": {"text": "unittest.mock\n\nThe Mock class has the following improvements:\n\nThe class constructor has a new unsafe parameter, which causes mock\nobjects to raise AttributeError on attribute names starting\nwith \"assert\".\n(Contributed by Kushal Das in bpo-21238.)\nA new Mock.assert_not_called()\nmethod to check if the mock object was called.\n(Contributed by Kushal Das in bpo-21262.)\n\nThe MagicMock class now supports __truediv__(),\n__divmod__() and __matmul__() operators.\n(Contributed by Johannes Baiter in bpo-20968, and Håkan Lövdahl\nin bpo-23581 and bpo-23568.)\nIt is no longer necessary to explicitly pass create=True to the\npatch() function when patching builtin names.\n(Contributed by Kushal Das in bpo-17660.)", "code_blocks": []}, "improved-modules - urllib": {"text": "urllib\n\nA new\nrequest.HTTPPasswordMgrWithPriorAuth\nclass allows HTTP Basic Authentication credentials to be managed so as to\neliminate unnecessary 401 response handling, or to unconditionally send\ncredentials on the first request in order to communicate with servers that\nreturn a 404 response instead of a 401 if the Authorization header\nis not sent. (Contributed by Matej Cepl in bpo-19494 and Akshit Khurana in\nbpo-7159.)\nA new quote_via argument for the\nparse.urlencode()\nfunction provides a way to control the encoding of query parts if needed.\n(Contributed by Samwyse and Arnon Yaari in bpo-13866.)\nThe request.urlopen() function accepts an\nssl.SSLContext object as a context argument, which will be used for\nthe HTTPS connection.  (Contributed by Alex Gaynor in bpo-22366.)\nThe parse.urljoin() was updated to use the\nRFC 3986 semantics for the resolution of relative URLs, rather than\nRFC 1808 and RFC 2396.\n(Contributed by Demian Brecht and Senthil Kumaran in bpo-22118.)", "code_blocks": []}, "improved-modules - wsgiref": {"text": "wsgiref\n\nThe headers argument of the headers.Headers\nclass constructor is now optional.\n(Contributed by Pablo Torres Navarrete and SilentGhost in bpo-5800.)", "code_blocks": []}, "improved-modules - xmlrpc": {"text": "xmlrpc\n\nThe client.ServerProxy class now supports\nthe context manager protocol.\n(Contributed by Claudiu Popa in bpo-20627.)\nThe client.ServerProxy constructor now accepts\nan optional ssl.SSLContext instance.\n(Contributed by Alex Gaynor in bpo-22960.)", "code_blocks": []}, "improved-modules - xml-sax": {"text": "xml.sax\n\nSAX parsers now support a character stream of the\nxmlreader.InputSource object.\n(Contributed by Serhiy Storchaka in bpo-2175.)\nparseString() now accepts a str instance.\n(Contributed by Serhiy Storchaka in bpo-10590.)", "code_blocks": []}, "improved-modules - zipfile": {"text": "zipfile\n\nZIP output can now be written to unseekable streams.\n(Contributed by Serhiy Storchaka in bpo-23252.)\nThe mode argument of ZipFile.open() method now\naccepts \"x\" to request exclusive creation.\n(Contributed by Serhiy Storchaka in bpo-21717.)", "code_blocks": []}, "other-module-level-changes": {"text": "Other module-level changes\n\nMany functions in the mmap, ossaudiodev, socket,\nssl, and codecs modules now accept writable\nbytes-like objects.\n(Contributed by Serhiy Storchaka in bpo-23001.)", "code_blocks": []}, "optimizations": {"text": "Optimizations\n\nThe os.walk() function has been sped up by 3 to 5 times on POSIX systems,\nand by 7 to 20 times on Windows.  This was done using the new os.scandir()\nfunction, which exposes file information from the underlying readdir or\nFindFirstFile/FindNextFile system calls.  (Contributed by\nBen Hoyt with help from Victor Stinner in bpo-23605.)\nConstruction of bytes(int) (filled by zero bytes) is faster and uses less\nmemory for large objects. calloc() is used instead of malloc() to\nallocate memory for these objects.\n(Contributed by Victor Stinner in bpo-21233.)\nSome operations on ipaddress IPv4Network and\nIPv6Network have been massively sped up, such as\nsubnets(), supernet(),\nsummarize_address_range(), collapse_addresses().\nThe speed up can range from 3 to 15 times.\n(Contributed by Antoine Pitrou, Michel Albert, and Markus in\nbpo-21486, bpo-21487, bpo-20826, bpo-23266.)\nPickling of ipaddress objects was optimized to produce significantly\nsmaller output.  (Contributed by Serhiy Storchaka in bpo-23133.)\nMany operations on io.BytesIO are now 50% to 100% faster.\n(Contributed by Serhiy Storchaka in bpo-15381 and David Wilson in\nbpo-22003.)\nThe marshal.dumps() function is now faster: 65–85% with versions 3\nand 4, 20–25% with versions 0 to 2 on typical data, and up to 5 times in\nbest cases.\n(Contributed by Serhiy Storchaka in bpo-20416 and bpo-23344.)\nThe UTF-32 encoder is now 3 to 7 times faster.\n(Contributed by Serhiy Storchaka in bpo-15027.)\nRegular expressions are now parsed up to 10% faster.\n(Contributed by Serhiy Storchaka in bpo-19380.)\nThe json.dumps() function was optimized to run with\nensure_ascii=False as fast as with ensure_ascii=True.\n(Contributed by Naoki Inada in bpo-23206.)\nThe PyObject_IsInstance() and PyObject_IsSubclass()\nfunctions have been sped up in the common case that the second argument\nhas type as its metaclass.\n(Contributed Georg Brandl by in bpo-22540.)\nMethod caching was slightly improved, yielding up to 5% performance\nimprovement in some benchmarks.\n(Contributed by Antoine Pitrou in bpo-22847.)\nObjects from the random module now use 50% less memory on 64-bit\nbuilds.  (Contributed by Serhiy Storchaka in bpo-23488.)\nThe property() getter calls are up to 25% faster.\n(Contributed by Joe Jevnik in bpo-23910.)\nInstantiation of fractions.Fraction is now up to 30% faster.\n(Contributed by Stefan Behnel in bpo-22464.)\nString methods find(), rfind(), split(),\npartition() and the in string operator are now significantly\nfaster for searching 1-character substrings.\n(Contributed by Serhiy Storchaka in bpo-23573.)", "code_blocks": []}, "build-and-c-api-changes": {"text": "Build and C API Changes\n\nNew calloc functions were added:\n\nPyMem_RawCalloc(),\nPyMem_Calloc(),\nPyObject_Calloc(),\n_PyObject_GC_Calloc().\n\n(Contributed by Victor Stinner in bpo-21233.)\nNew encoding/decoding helper functions:\n\nPy_DecodeLocale() (replaced _Py_char2wchar()),\nPy_EncodeLocale() (replaced _Py_wchar2char()).\n\n(Contributed by Victor Stinner in bpo-18395.)\nA new PyCodec_NameReplaceErrors() function to replace the unicode\nencode error with \\N{...} escapes.\n(Contributed by Serhiy Storchaka in bpo-19676.)\nA new PyErr_FormatV() function similar to PyErr_Format(),\nbut accepts a va_list argument.\n(Contributed by Antoine Pitrou in bpo-18711.)\nA new PyExc_RecursionError exception.\n(Contributed by Georg Brandl in bpo-19235.)\nNew PyModule_FromDefAndSpec(), PyModule_FromDefAndSpec2(),\nand PyModule_ExecDef() functions introduced by PEP 489 –\nmulti-phase extension module initialization.\n(Contributed by Petr Viktorin in bpo-24268.)\nNew PyNumber_MatrixMultiply() and\nPyNumber_InPlaceMatrixMultiply() functions to perform matrix\nmultiplication.\n(Contributed by Benjamin Peterson in bpo-21176.  See also PEP 465\nfor details.)\nThe PyTypeObject.tp_finalize slot is now part of the stable ABI.\nWindows builds now require Microsoft Visual C++ 14.0, which\nis available as part of Visual Studio 2015.\nExtension modules now include a platform information tag in their filename on\nsome platforms (the tag is optional, and CPython will import extensions without\nit, although if the tag is present and mismatched, the extension won’t be\nloaded):\n\nOn Linux, extension module filenames end with\n.cpython-<major><minor>m-<architecture>-<os>.pyd:\n<major> is the major number of the Python version;\nfor Python 3.5 this is 3.\n<minor> is the minor number of the Python version;\nfor Python 3.5 this is 5.\n<architecture> is the hardware architecture the extension module\nwas built to run on. It’s most commonly either i386 for 32-bit Intel\nplatforms or x86_64 for 64-bit Intel (and AMD) platforms.\n<os> is always linux-gnu, except for extensions built to\ntalk to the 32-bit ABI on 64-bit platforms, in which case it is\nlinux-gnu32 (and <architecture> will be x86_64).\n\n\nOn Windows, extension module filenames end with\n<debug>.cp<major><minor>-<platform>.pyd:\n<major> is the major number of the Python version;\nfor Python 3.5 this is 3.\n<minor> is the minor number of the Python version;\nfor Python 3.5 this is 5.\n<platform> is the platform the extension module was built for,\neither win32 for Win32, win_amd64 for Win64, win_ia64 for\nWindows Itanium 64, and win_arm for Windows on ARM.\nIf built in debug mode, <debug> will be _d,\notherwise it will be blank.\n\n\nOn OS X platforms, extension module filenames now end with -darwin.so.\nOn all other platforms, extension module filenames are the same as they were\nwith Python 3.4.", "code_blocks": []}, "deprecated - new-keywords": {"text": "New Keywords\n\nasync and await are not recommended to be used as variable, class,\nfunction or module names.  Introduced by PEP 492 in Python 3.5, they will\nbecome proper keywords in Python 3.7.", "code_blocks": []}, "deprecated - deprecated-python-behavior": {"text": "Deprecated Python Behavior\n\nRaising the StopIteration exception inside a generator will now generate a silent\nPendingDeprecationWarning, which will become a non-silent deprecation\nwarning in Python 3.6 and will trigger a RuntimeError in Python 3.7.\nSee PEP 479: Change StopIteration handling inside generators\nfor details.", "code_blocks": []}, "deprecated - unsupported-operating-systems": {"text": "Unsupported Operating Systems\n\nWindows XP is no longer supported by Microsoft, thus, per PEP 11, CPython\n3.5 is no longer officially supported on this OS.", "code_blocks": []}, "deprecated - deprecated-python-modules-functions-and-methods": {"text": "Deprecated Python modules, functions and methods\n\nThe formatter module has now graduated to full deprecation and is still\nslated for removal in Python 3.6.\nThe asyncio.async() function is deprecated in favor of\nensure_future().\nThe smtpd module has in the past always decoded the DATA portion of\nemail messages using the utf-8 codec.  This can now be controlled by the\nnew decode_data keyword to SMTPServer.  The default value is\nTrue, but this default is deprecated.  Specify the decode_data keyword\nwith an appropriate value to avoid the deprecation warning.\nDirectly assigning values to the key,\nvalue and\ncoded_value of http.cookies.Morsel\nobjects is deprecated.  Use the set() method\ninstead.  In addition, the undocumented LegalChars parameter of\nset() is deprecated, and is now ignored.\nPassing a format string as keyword argument format_string to the\nformat() method of the string.Formatter\nclass has been deprecated.\n(Contributed by Serhiy Storchaka in bpo-23671.)\nThe platform.dist() and platform.linux_distribution() functions\nare now deprecated.  Linux distributions use too many different ways of\ndescribing themselves, so the functionality is left to a package.\n(Contributed by Vajrasky Kok and Berker Peksag in bpo-1322.)\nThe previously undocumented from_function and from_builtin methods of\ninspect.Signature are deprecated.  Use the new\nSignature.from_callable()\nmethod instead. (Contributed by Yury Selivanov in bpo-24248.)\nThe inspect.getargspec() function is deprecated and scheduled to be\nremoved in Python 3.6.  (See bpo-20438 for details.)\nThe inspect getfullargspec(),\ngetcallargs(), and formatargspec() functions are\ndeprecated in favor of the inspect.signature() API. (Contributed by Yury\nSelivanov in bpo-20438.)\ngetargvalues() and formatargvalues() functions\nwere inadvertently marked as deprecated with the release of Python 3.5.0.\nUse of re.LOCALE flag with str patterns or re.ASCII is now\ndeprecated.  (Contributed by Serhiy Storchaka in bpo-22407.)\nUse of unrecognized special sequences consisting of '\\' and an ASCII letter\nin regular expression patterns and replacement patterns now raises a\ndeprecation warning and will be forbidden in Python 3.6.\n(Contributed by Serhiy Storchaka in bpo-23622.)\nThe undocumented and unofficial use_load_tests default argument of the\nunittest.TestLoader.loadTestsFromModule() method now is\ndeprecated and ignored.\n(Contributed by Robert Collins and Barry A. Warsaw in bpo-16662.)", "code_blocks": []}, "removed - api-and-feature-removals": {"text": "API and Feature Removals\n\nThe following obsolete and previously deprecated APIs and features have been\nremoved:\n\nThe __version__ attribute has been dropped from the email package.  The\nemail code hasn’t been shipped separately from the stdlib for a long time,\nand the __version__ string was not updated in the last few releases.\nThe internal Netrc class in the ftplib module was deprecated in\n3.4, and has now been removed.\n(Contributed by Matt Chaput in bpo-6623.)\nThe concept of .pyo files has been removed.\nThe JoinableQueue class in the provisional asyncio module was\ndeprecated in 3.4.4 and is now removed.\n(Contributed by A. Jesse Jiryu Davis in bpo-23464.)", "code_blocks": []}, "porting-to-python-3-5 - changes-in-python-behavior": {"text": "Changes in Python behavior\n\n\nDue to an oversight, earlier Python versions erroneously accepted the\nfollowing syntax:\nf(1 for x in [1], *args)\nf(1 for x in [1], **kwargs)\n\n\nPython 3.5 now correctly raises a SyntaxError, as generator\nexpressions must be put in parentheses if not a sole argument to a function.", "code_blocks": ["f(1 for x in [1], *args)\nf(1 for x in [1], **kwargs)\n"]}, "porting-to-python-3-5 - changes-in-the-python-api": {"text": "Changes in the Python API\n\n\nPEP 475: System calls are now retried when interrupted by a signal instead\nof raising InterruptedError if the Python signal handler does not\nraise an exception.\nBefore Python 3.5, a datetime.time object was considered to be false\nif it represented midnight in UTC.  This behavior was considered obscure and\nerror-prone and has been removed in Python 3.5.  See bpo-13936 for full\ndetails.\nThe ssl.SSLSocket.send() method now raises either\nssl.SSLWantReadError or ssl.SSLWantWriteError\non a non-blocking socket if the operation would block.  Previously,\nit would return 0.  (Contributed by Nikolaus Rath in bpo-20951.)\nThe __name__ attribute of generators is now set from the function name,\ninstead of being set from the code name. Use gen.gi_code.co_name to\nretrieve the code name. Generators also have a new __qualname__\nattribute, the qualified name, which is now used for the representation\nof a generator (repr(gen)).\n(Contributed by Victor Stinner in bpo-21205.)\nThe deprecated “strict” mode and argument of HTMLParser,\nHTMLParser.error(), and the HTMLParserError exception have been\nremoved.  (Contributed by Ezio Melotti in bpo-15114.)\nThe convert_charrefs argument of HTMLParser is\nnow True by default.  (Contributed by Berker Peksag in bpo-21047.)\nAlthough it is not formally part of the API, it is worth noting for porting\npurposes (ie: fixing tests) that error messages that were previously of the\nform “‘sometype’ does not support the buffer protocol” are now of the form “a\nbytes-like object is required, not ‘sometype’”.\n(Contributed by Ezio Melotti in bpo-16518.)\nIf the current directory is set to a directory that no longer exists then\nFileNotFoundError will no longer be raised and instead\nfind_spec() will return None\nwithout caching None in sys.path_importer_cache, which is\ndifferent than the typical case (bpo-22834).\nHTTP status code and messages from http.client and http.server\nwere refactored into a common HTTPStatus enum.  The values in\nhttp.client and http.server remain available for backwards\ncompatibility.  (Contributed by Demian Brecht in bpo-21793.)\nWhen an import loader defines importlib.machinery.Loader.exec_module()\nit is now expected to also define\ncreate_module() (raises a\nDeprecationWarning now, will be an error in Python 3.6). If the loader\ninherits from importlib.abc.Loader then there is nothing to do, else\nsimply define create_module() to return\nNone.  (Contributed by Brett Cannon in bpo-23014.)\nThe re.split() function always ignored empty pattern matches, so the\n\"x*\" pattern worked the same as \"x+\", and the \"\\b\" pattern never\nworked.  Now re.split() raises a warning if the pattern could match\nan empty string.  For compatibility, use patterns that never match an empty\nstring (e.g. \"x+\" instead of \"x*\").  Patterns that could only match\nan empty string (such as \"\\b\") now raise an error.\n(Contributed by Serhiy Storchaka in bpo-22818.)\nThe http.cookies.Morsel dict-like interface has been made self\nconsistent:  morsel comparison now takes the key\nand value into account,\ncopy() now results in a\nMorsel instance rather than a dict, and\nupdate() will now raise an exception if any of the\nkeys in the update dictionary are invalid.  In addition, the undocumented\nLegalChars parameter of set() is deprecated and\nis now ignored.  (Contributed by Demian Brecht in bpo-2211.)\nPEP 488 has removed .pyo files from Python and introduced the optional\nopt- tag in .pyc file names. The\nimportlib.util.cache_from_source() has gained an optimization\nparameter to help control the opt- tag. Because of this, the\ndebug_override parameter of the function is now deprecated. .pyo files\nare also no longer supported as a file argument to the Python interpreter and\nthus serve no purpose when distributed on their own (i.e. sourcless code\ndistribution). Due to the fact that the magic number for bytecode has changed\nin Python 3.5, all old .pyo files from previous versions of Python are\ninvalid regardless of this PEP.\nThe socket module now exports the CAN_RAW_FD_FRAMES\nconstant on linux 3.6 and greater.\nThe ssl.cert_time_to_seconds() function now interprets the input time\nas UTC and not as local time, per RFC 5280.  Additionally, the return\nvalue is always an int. (Contributed by Akira Li in bpo-19940.)\nThe pygettext.py Tool now uses the standard +NNNN format for timezones in\nthe POT-Creation-Date header.\nThe smtplib module now uses sys.stderr instead of the previous\nmodule-level stderr variable for debug output.  If your (test)\nprogram depends on patching the module-level variable to capture the debug\noutput, you will need to update it to capture sys.stderr instead.\nThe str.startswith() and str.endswith() methods no longer return\nTrue when finding the empty string and the indexes are completely out of\nrange.  (Contributed by Serhiy Storchaka in bpo-24284.)\nThe inspect.getdoc() function now returns documentation strings\ninherited from base classes.  Documentation strings no longer need to be\nduplicated if the inherited documentation is appropriate.  To suppress an\ninherited string, an empty string must be specified (or the documentation\nmay be filled in).  This change affects the output of the pydoc\nmodule and the help() function.\n(Contributed by Serhiy Storchaka in bpo-15582.)\nNested functools.partial() calls are now flattened.  If you were\nrelying on the previous behavior, you can now either add an attribute to a\nfunctools.partial() object or you can create a subclass of\nfunctools.partial().\n(Contributed by Alexander Belopolsky in bpo-7830.)", "code_blocks": []}, "porting-to-python-3-5 - changes-in-the-c-api": {"text": "Changes in the C API\n\n\nThe undocumented format member of the\n(non-public) PyMemoryViewObject structure has been removed.\nAll extensions relying on the relevant parts in memoryobject.h\nmust be rebuilt.\nThe PyMemAllocator structure was renamed to\nPyMemAllocatorEx and a new calloc field was added.\nRemoved non-documented macro PyObject_REPR which leaked references.\nUse format character %R in PyUnicode_FromFormat()-like functions\nto format the repr() of the object.\n(Contributed by Serhiy Storchaka in bpo-22453.)\nBecause the lack of the __module__ attribute breaks pickling and\nintrospection, a deprecation warning is now raised for builtin types without\nthe __module__ attribute.  This would be an AttributeError in\nthe future.\n(Contributed by Serhiy Storchaka in bpo-20204.)\nAs part of the PEP 492 implementation, the tp_reserved slot of\nPyTypeObject was replaced with a\ntp_as_async slot.  Refer to Coroutine Objects for\nnew types, structures and functions.", "code_blocks": []}}}
{"index": 8, "python_version": "3.6", "url": "https://docs.python.org/3.6/whatsnew/3.6.html", "sections": {"summary-release-highlights": {"text": "Summary – Release highlights\n\nNew syntax features:\n\nPEP 498, formatted string literals.\nPEP 515, underscores in numeric literals.\nPEP 526, syntax for variable annotations.\nPEP 525, asynchronous generators.\nPEP 530: asynchronous comprehensions.\n\nNew library modules:\n\nsecrets: PEP 506 – Adding A Secrets Module To The Standard Library.\n\nCPython implementation improvements:\n\nThe dict type has been reimplemented to use\na more compact representation\nbased on a proposal by Raymond Hettinger\nand similar to the PyPy dict implementation.  This resulted in dictionaries\nusing 20% to 25% less memory when compared to Python 3.5.\nCustomization of class creation has been simplified with the\nnew protocol.\nThe class attribute definition order is\nnow preserved.\nThe order of elements in **kwargs now\ncorresponds to the order in which keyword\narguments were passed to the function.\nDTrace and SystemTap probing support has\nbeen added.\nThe new PYTHONMALLOC environment variable\ncan now be used to debug the interpreter memory allocation and access\nerrors.\n\nSignificant improvements in the standard library:\n\nThe asyncio module has received new features, significant\nusability and performance improvements, and a fair amount of bug fixes.\nStarting with Python 3.6 the asyncio module is no longer provisional\nand its API is considered stable.\nA new file system path protocol has been\nimplemented to support path-like objects.\nAll standard library functions operating on paths have been updated to\nwork with the new protocol.\nThe datetime module has gained support for\nLocal Time Disambiguation.\nThe typing module received a number of\nimprovements.\nThe tracemalloc module has been significantly reworked\nand is now used to provide better output for ResourceWarning\nas well as provide better diagnostics for memory allocation errors.\nSee the PYTHONMALLOC section for more\ninformation.\n\nSecurity improvements:\n\nThe new secrets module has been added to simplify the generation of\ncryptographically strong pseudo-random numbers suitable for\nmanaging secrets such as account authentication, tokens, and similar.\nOn Linux, os.urandom() now blocks until the system urandom entropy\npool is initialized to increase the security. See the PEP 524 for the\nrationale.\nThe hashlib and ssl modules now support OpenSSL 1.1.0.\nThe default settings and feature set of the ssl module have been\nimproved.\nThe hashlib module received support for the BLAKE2, SHA-3 and SHAKE\nhash algorithms and the scrypt() key derivation function.\n\nWindows improvements:\n\nPEP 528 and PEP 529,\nWindows filesystem and console encoding changed to UTF-8.\nThe py.exe launcher, when used interactively, no longer prefers\nPython 2 over Python 3 when the user doesn’t specify a version (via\ncommand line arguments or a config file).  Handling of shebang lines\nremains unchanged - “python” refers to Python 2 in that case.\npython.exe and pythonw.exe have been marked as long-path aware,\nwhich means that the 260 character path limit may no longer apply.\nSee removing the MAX_PATH limitation for details.\nA ._pth file can be added to force isolated mode and fully specify\nall search paths to avoid registry and environment lookup. See\nthe documentation for more information.\nA python36.zip file now works as a landmark to infer\nPYTHONHOME. See the documentation for\nmore information.", "code_blocks": []}, "new-features - pep-498-formatted-string-literals": {"text": "PEP 498: Formatted string literals\n\nPEP 498 introduces a new kind of string literals: f-strings, or\nformatted string literals.\nFormatted string literals are prefixed with 'f' and are similar to\nthe format strings accepted by str.format().  They contain replacement\nfields surrounded by curly braces.  The replacement fields are expressions,\nwhich are evaluated at run time, and then formatted using the\nformat() protocol:\n>>> name = \"Fred\"\n>>> f\"He said his name is {name}.\"\n'He said his name is Fred.'\n>>> width = 10\n>>> precision = 4\n>>> value = decimal.Decimal(\"12.34567\")\n>>> f\"result: {value:{width}.{precision}}\"  # nested fields\n'result:      12.35'\n\n\n\nSee also\n\nPEP 498 – Literal String Interpolation.PEP written and implemented by Eric V. Smith.\n\n\nFeature documentation.", "code_blocks": [">>> name = \"Fred\"\n>>> f\"He said his name is {name}.\"\n'He said his name is Fred.'\n>>> width = 10\n>>> precision = 4\n>>> value = decimal.Decimal(\"12.34567\")\n>>> f\"result: {value:{width}.{precision}}\"  # nested fields\n'result:      12.35'\n"]}, "new-features - pep-526-syntax-for-variable-annotations": {"text": "PEP 526: Syntax for variable annotations\n\nPEP 484 introduced the standard for type annotations of function\nparameters, a.k.a. type hints. This PEP adds syntax to Python for annotating\nthe types of variables including class variables and instance variables:\nprimes: List[int] = []\n\ncaptain: str  # Note: no initial value!\n\nclass Starship:\n    stats: Dict[str, int] = {}\n\n\nJust as for function annotations, the Python interpreter does not attach any\nparticular meaning to variable annotations and only stores them in the\n__annotations__ attribute of a class or module.\nIn contrast to variable declarations in statically typed languages,\nthe goal of annotation syntax is to provide an easy way to specify structured\ntype metadata for third party tools and libraries via the abstract syntax tree\nand the __annotations__ attribute.\n\nSee also\n\nPEP 526 – Syntax for variable annotations.PEP written by Ryan Gonzalez, Philip House, Ivan Levkivskyi, Lisa Roach,\nand Guido van Rossum. Implemented by Ivan Levkivskyi.\n\n\nTools that use or will use the new syntax:\nmypy,\npytype, PyCharm, etc.", "code_blocks": ["primes: List[int] = []\n\ncaptain: str  # Note: no initial value!\n\nclass Starship:\n    stats: Dict[str, int] = {}\n"]}, "new-features - pep-515-underscores-in-numeric-literals": {"text": "PEP 515: Underscores in Numeric Literals\n\nPEP 515 adds the ability to use underscores in numeric literals for\nimproved readability.  For example:\n>>> 1_000_000_000_000_000\n1000000000000000\n>>> 0x_FF_FF_FF_FF\n4294967295\n\n\nSingle underscores are allowed between digits and after any base\nspecifier.  Leading, trailing, or multiple underscores in a row are not\nallowed.\nThe string formatting language also now has support\nfor the '_' option to signal the use of an underscore for a thousands\nseparator for floating point presentation types and for integer\npresentation type 'd'.  For integer presentation types 'b',\n'o', 'x', and 'X', underscores will be inserted every 4\ndigits:\n>>> '{:_}'.format(1000000)\n'1_000_000'\n>>> '{:_x}'.format(0xFFFFFFFF)\n'ffff_ffff'\n\n\n\nSee also\n\nPEP 515 – Underscores in Numeric LiteralsPEP written by Georg Brandl and Serhiy Storchaka.", "code_blocks": [">>> 1_000_000_000_000_000\n1000000000000000\n>>> 0x_FF_FF_FF_FF\n4294967295\n", ">>> '{:_}'.format(1000000)\n'1_000_000'\n>>> '{:_x}'.format(0xFFFFFFFF)\n'ffff_ffff'\n"]}, "new-features - pep-525-asynchronous-generators": {"text": "PEP 525: Asynchronous Generators\n\nPEP 492 introduced support for native coroutines and async / await\nsyntax to Python 3.5.  A notable limitation of the Python 3.5 implementation\nis that it was not possible to use await and yield in the same\nfunction body.  In Python 3.6 this restriction has been lifted, making it\npossible to define asynchronous generators:\nasync def ticker(delay, to):\n    \"\"\"Yield numbers from 0 to *to* every *delay* seconds.\"\"\"\n    for i in range(to):\n        yield i\n        await asyncio.sleep(delay)\n\n\nThe new syntax allows for faster and more concise code.\n\nSee also\n\nPEP 525 – Asynchronous GeneratorsPEP written and implemented by Yury Selivanov.", "code_blocks": ["async def ticker(delay, to):\n    \"\"\"Yield numbers from 0 to *to* every *delay* seconds.\"\"\"\n    for i in range(to):\n        yield i\n        await asyncio.sleep(delay)\n"]}, "new-features - pep-530-asynchronous-comprehensions": {"text": "PEP 530: Asynchronous Comprehensions\n\nPEP 530 adds support for using async for in list, set, dict\ncomprehensions and generator expressions:\nresult = [i async for i in aiter() if i % 2]\n\n\nAdditionally, await expressions are supported in all kinds\nof comprehensions:\nresult = [await fun() for fun in funcs if await condition()]\n\n\n\nSee also\n\nPEP 530 – Asynchronous ComprehensionsPEP written and implemented by Yury Selivanov.", "code_blocks": ["result = [i async for i in aiter() if i % 2]\n", "result = [await fun() for fun in funcs if await condition()]\n"]}, "new-features - pep-487-simpler-customization-of-class-creation": {"text": "PEP 487: Simpler customization of class creation\n\nIt is now possible to customize subclass creation without using a metaclass.\nThe new __init_subclass__ classmethod will be called on the base class\nwhenever a new subclass is created:\nclass PluginBase:\n    subclasses = []\n\n    def __init_subclass__(cls, **kwargs):\n        super().__init_subclass__(**kwargs)\n        cls.subclasses.append(cls)\n\nclass Plugin1(PluginBase):\n    pass\n\nclass Plugin2(PluginBase):\n    pass\n\n\nIn order to allow zero-argument super() calls to work correctly from\n__init_subclass__() implementations, custom metaclasses must\nensure that the new __classcell__ namespace entry is propagated to\ntype.__new__ (as described in Creating the class object).\n\nSee also\n\nPEP 487 – Simpler customization of class creationPEP written and implemented by Martin Teichmann.\n\n\nFeature documentation", "code_blocks": ["class PluginBase:\n    subclasses = []\n\n    def __init_subclass__(cls, **kwargs):\n        super().__init_subclass__(**kwargs)\n        cls.subclasses.append(cls)\n\nclass Plugin1(PluginBase):\n    pass\n\nclass Plugin2(PluginBase):\n    pass\n"]}, "new-features - pep-487-descriptor-protocol-enhancements": {"text": "PEP 487: Descriptor Protocol Enhancements\n\nPEP 487 extends the descriptor protocol to include the new optional\n__set_name__() method.  Whenever a new class is defined, the new\nmethod will be called on all descriptors included in the definition, providing\nthem with a reference to the class being defined and the name given to the\ndescriptor within the class namespace.  In other words, instances of\ndescriptors can now know the attribute name of the descriptor in the\nowner class:\nclass IntField:\n    def __get__(self, instance, owner):\n        return instance.__dict__[self.name]\n\n    def __set__(self, instance, value):\n        if not isinstance(value, int):\n            raise ValueError(f'expecting integer in {self.name}')\n        instance.__dict__[self.name] = value\n\n    # this is the new initializer:\n    def __set_name__(self, owner, name):\n        self.name = name\n\nclass Model:\n    int_field = IntField()\n\n\n\nSee also\n\nPEP 487 – Simpler customization of class creationPEP written and implemented by Martin Teichmann.\n\n\nFeature documentation", "code_blocks": ["class IntField:\n    def __get__(self, instance, owner):\n        return instance.__dict__[self.name]\n\n    def __set__(self, instance, value):\n        if not isinstance(value, int):\n            raise ValueError(f'expecting integer in {self.name}')\n        instance.__dict__[self.name] = value\n\n    # this is the new initializer:\n    def __set_name__(self, owner, name):\n        self.name = name\n\nclass Model:\n    int_field = IntField()\n"]}, "new-features - pep-519-adding-a-file-system-path-protocol": {"text": "PEP 519: Adding a file system path protocol\n\nFile system paths have historically been represented as str\nor bytes objects. This has led to people who write code which\noperate on file system paths to assume that such objects are only one\nof those two types (an int representing a file descriptor\ndoes not count as that is not a file path). Unfortunately that\nassumption prevents alternative object representations of file system\npaths like pathlib from working with pre-existing code,\nincluding Python’s standard library.\nTo fix this situation, a new interface represented by\nos.PathLike has been defined. By implementing the\n__fspath__() method, an object signals that it\nrepresents a path. An object can then provide a low-level\nrepresentation of a file system path as a str or\nbytes object. This means an object is considered\npath-like if it implements\nos.PathLike or is a str or bytes object\nwhich represents a file system path. Code can use os.fspath(),\nos.fsdecode(), or os.fsencode() to explicitly get a\nstr and/or bytes representation of a path-like\nobject.\nThe built-in open() function has been updated to accept\nos.PathLike objects, as have all relevant functions in the\nos and os.path modules, and most other functions and\nclasses in the standard library.  The os.DirEntry class\nand relevant classes in pathlib have also been updated to\nimplement os.PathLike.\nThe hope is that updating the fundamental functions for operating\non file system paths will lead to third-party code to implicitly\nsupport all path-like objects without any\ncode changes, or at least very minimal ones (e.g. calling\nos.fspath() at the beginning of code before operating on a\npath-like object).\nHere are some examples of how the new interface allows for\npathlib.Path to be used more easily and transparently with\npre-existing code:\n>>> import pathlib\n>>> with open(pathlib.Path(\"README\")) as f:\n...     contents = f.read()\n...\n>>> import os.path\n>>> os.path.splitext(pathlib.Path(\"some_file.txt\"))\n('some_file', '.txt')\n>>> os.path.join(\"/a/b\", pathlib.Path(\"c\"))\n'/a/b/c'\n>>> import os\n>>> os.fspath(pathlib.Path(\"some_file.txt\"))\n'some_file.txt'\n\n\n(Implemented by Brett Cannon, Ethan Furman, Dusty Phillips, and Jelle Zijlstra.)\n\nSee also\n\nPEP 519 – Adding a file system path protocolPEP written by Brett Cannon and Koos Zevenhoven.", "code_blocks": [">>> import pathlib\n>>> with open(pathlib.Path(\"README\")) as f:\n...     contents = f.read()\n...\n>>> import os.path\n>>> os.path.splitext(pathlib.Path(\"some_file.txt\"))\n('some_file', '.txt')\n>>> os.path.join(\"/a/b\", pathlib.Path(\"c\"))\n'/a/b/c'\n>>> import os\n>>> os.fspath(pathlib.Path(\"some_file.txt\"))\n'some_file.txt'\n"]}, "new-features - pep-495-local-time-disambiguation": {"text": "PEP 495: Local Time Disambiguation\n\nIn most world locations, there have been and will be times when local clocks\nare moved back.  In those times, intervals are introduced in which local\nclocks show the same time twice in the same day. In these situations, the\ninformation displayed on a local clock (or stored in a Python datetime\ninstance) is insufficient to identify a particular moment in time.\nPEP 495 adds the new fold attribute to instances of\ndatetime.datetime and datetime.time classes to differentiate\nbetween two moments in time for which local times are the same:\n>>> u0 = datetime(2016, 11, 6, 4, tzinfo=timezone.utc)\n>>> for i in range(4):\n...     u = u0 + i*HOUR\n...     t = u.astimezone(Eastern)\n...     print(u.time(), 'UTC =', t.time(), t.tzname(), t.fold)\n...\n04:00:00 UTC = 00:00:00 EDT 0\n05:00:00 UTC = 01:00:00 EDT 0\n06:00:00 UTC = 01:00:00 EST 1\n07:00:00 UTC = 02:00:00 EST 0\n\n\nThe values of the fold attribute have the\nvalue 0 for all instances except those that represent the second\n(chronologically) moment in time in an ambiguous case.\n\nSee also\n\nPEP 495 – Local Time DisambiguationPEP written by Alexander Belopolsky and Tim Peters, implementation\nby Alexander Belopolsky.", "code_blocks": [">>> u0 = datetime(2016, 11, 6, 4, tzinfo=timezone.utc)\n>>> for i in range(4):\n...     u = u0 + i*HOUR\n...     t = u.astimezone(Eastern)\n...     print(u.time(), 'UTC =', t.time(), t.tzname(), t.fold)\n...\n04:00:00 UTC = 00:00:00 EDT 0\n05:00:00 UTC = 01:00:00 EDT 0\n06:00:00 UTC = 01:00:00 EST 1\n07:00:00 UTC = 02:00:00 EST 0\n"]}, "new-features - pep-529-change-windows-filesystem-encoding-to-utf-8": {"text": "PEP 529: Change Windows filesystem encoding to UTF-8\n\nRepresenting filesystem paths is best performed with str (Unicode) rather than\nbytes. However, there are some situations where using bytes is sufficient and\ncorrect.\nPrior to Python 3.6, data loss could result when using bytes paths on Windows.\nWith this change, using bytes to represent paths is now supported on Windows,\nprovided those bytes are encoded with the encoding returned by\nsys.getfilesystemencoding(), which now defaults to 'utf-8'.\nApplications that do not use str to represent paths should use\nos.fsencode() and os.fsdecode() to ensure their bytes are\ncorrectly encoded. To revert to the previous behaviour, set\nPYTHONLEGACYWINDOWSFSENCODING or call\nsys._enablelegacywindowsfsencoding().\nSee PEP 529 for more information and discussion of code modifications that\nmay be required.", "code_blocks": []}, "new-features - pep-528-change-windows-console-encoding-to-utf-8": {"text": "PEP 528: Change Windows console encoding to UTF-8\n\nThe default console on Windows will now accept all Unicode characters and\nprovide correctly read str objects to Python code. sys.stdin,\nsys.stdout and sys.stderr now default to utf-8 encoding.\nThis change only applies when using an interactive console, and not when\nredirecting files or pipes. To revert to the previous behaviour for interactive\nconsole use, set PYTHONLEGACYWINDOWSSTDIO.\n\nSee also\n\nPEP 528 – Change Windows console encoding to UTF-8PEP written and implemented by Steve Dower.", "code_blocks": []}, "new-features - pep-520-preserving-class-attribute-definition-order": {"text": "PEP 520: Preserving Class Attribute Definition Order\n\nAttributes in a class definition body have a natural ordering: the same\norder in which the names appear in the source.  This order is now\npreserved in the new class’s __dict__ attribute.\nAlso, the effective default class execution namespace (returned from\ntype.__prepare__()) is now an insertion-order-preserving\nmapping.\n\nSee also\n\nPEP 520 – Preserving Class Attribute Definition OrderPEP written and implemented by Eric Snow.", "code_blocks": []}, "new-features - pep-468-preserving-keyword-argument-order": {"text": "PEP 468: Preserving Keyword Argument Order\n\n**kwargs in a function signature is now guaranteed to be an\ninsertion-order-preserving mapping.\n\nSee also\n\nPEP 468 – Preserving Keyword Argument OrderPEP written and implemented by Eric Snow.", "code_blocks": []}, "new-features - new-dict-implementation": {"text": "New dict implementation\n\nThe dict type now uses a “compact” representation\nbased on a proposal by Raymond Hettinger\nwhich was first implemented by PyPy.\nThe memory usage of the new dict() is between 20% and 25% smaller\ncompared to Python 3.5.\nThe order-preserving aspect of this new implementation is considered an\nimplementation detail and should not be relied upon (this may change in\nthe future, but it is desired to have this new dict implementation in\nthe language for a few releases before changing the language spec to mandate\norder-preserving semantics for all current and future Python\nimplementations; this also helps preserve backwards-compatibility\nwith older versions of the language where random iteration order is\nstill in effect, e.g. Python 3.5).\n(Contributed by INADA Naoki in bpo-27350. Idea\noriginally suggested by Raymond Hettinger.)", "code_blocks": []}, "new-features - pep-523-adding-a-frame-evaluation-api-to-cpython": {"text": "PEP 523: Adding a frame evaluation API to CPython\n\nWhile Python provides extensive support to customize how code\nexecutes, one place it has not done so is in the evaluation of frame\nobjects.  If you wanted some way to intercept frame evaluation in\nPython there really wasn’t any way without directly manipulating\nfunction pointers for defined functions.\nPEP 523 changes this by providing an API to make frame\nevaluation pluggable at the C level. This will allow for tools such\nas debuggers and JITs to intercept frame evaluation before the\nexecution of Python code begins. This enables the use of alternative\nevaluation implementations for Python code, tracking frame\nevaluation, etc.\nThis API is not part of the limited C API and is marked as private to\nsignal that usage of this API is expected to be limited and only\napplicable to very select, low-level use-cases. Semantics of the\nAPI will change with Python as necessary.\n\nSee also\n\nPEP 523 – Adding a frame evaluation API to CPythonPEP written by Brett Cannon and Dino Viehland.", "code_blocks": []}, "new-features - pythonmalloc-environment-variable": {"text": "PYTHONMALLOC environment variable\n\nThe new PYTHONMALLOC environment variable allows setting the Python\nmemory allocators and installing debug hooks.\nIt is now possible to install debug hooks on Python memory allocators on Python\ncompiled in release mode using PYTHONMALLOC=debug. Effects of debug hooks:\n\nNewly allocated memory is filled with the byte 0xCB\nFreed memory is filled with the byte 0xDB\nDetect violations of the Python memory allocator API. For example,\nPyObject_Free() called on a memory block allocated by\nPyMem_Malloc().\nDetect writes before the start of a buffer (buffer underflows)\nDetect writes after the end of a buffer (buffer overflows)\nCheck that the GIL is held when allocator\nfunctions of PYMEM_DOMAIN_OBJ (ex: PyObject_Malloc()) and\nPYMEM_DOMAIN_MEM (ex: PyMem_Malloc()) domains are called.\n\nChecking if the GIL is held is also a new feature of Python 3.6.\nSee the PyMem_SetupDebugHooks() function for debug hooks on Python\nmemory allocators.\nIt is now also possible to force the usage of the malloc() allocator of\nthe C library for all Python memory allocations using PYTHONMALLOC=malloc.\nThis is helpful when using external memory debuggers like Valgrind on\na Python compiled in release mode.\nOn error, the debug hooks on Python memory allocators now use the\ntracemalloc module to get the traceback where a memory block was\nallocated.\nExample of fatal error on buffer overflow using\npython3.6 -X tracemalloc=5 (store 5 frames in traces):\nDebug memory block at address p=0x7fbcd41666f8: API 'o'\n    4 bytes originally requested\n    The 7 pad bytes at p-7 are FORBIDDENBYTE, as expected.\n    The 8 pad bytes at tail=0x7fbcd41666fc are not all FORBIDDENBYTE (0xfb):\n        at tail+0: 0x02 *** OUCH\n        at tail+1: 0xfb\n        at tail+2: 0xfb\n        at tail+3: 0xfb\n        at tail+4: 0xfb\n        at tail+5: 0xfb\n        at tail+6: 0xfb\n        at tail+7: 0xfb\n    The block was made by call #1233329 to debug malloc/realloc.\n    Data at p: 1a 2b 30 00\n\nMemory block allocated at (most recent call first):\n  File \"test/test_bytes.py\", line 323\n  File \"unittest/case.py\", line 600\n  File \"unittest/case.py\", line 648\n  File \"unittest/suite.py\", line 122\n  File \"unittest/suite.py\", line 84\n\nFatal Python error: bad trailing pad byte\n\nCurrent thread 0x00007fbcdbd32700 (most recent call first):\n  File \"test/test_bytes.py\", line 323 in test_hex\n  File \"unittest/case.py\", line 600 in run\n  File \"unittest/case.py\", line 648 in __call__\n  File \"unittest/suite.py\", line 122 in run\n  File \"unittest/suite.py\", line 84 in __call__\n  File \"unittest/suite.py\", line 122 in run\n  File \"unittest/suite.py\", line 84 in __call__\n  ...\n\n\n(Contributed by Victor Stinner in bpo-26516 and bpo-26564.)", "code_blocks": ["Debug memory block at address p=0x7fbcd41666f8: API 'o'\n    4 bytes originally requested\n    The 7 pad bytes at p-7 are FORBIDDENBYTE, as expected.\n    The 8 pad bytes at tail=0x7fbcd41666fc are not all FORBIDDENBYTE (0xfb):\n        at tail+0: 0x02 *** OUCH\n        at tail+1: 0xfb\n        at tail+2: 0xfb\n        at tail+3: 0xfb\n        at tail+4: 0xfb\n        at tail+5: 0xfb\n        at tail+6: 0xfb\n        at tail+7: 0xfb\n    The block was made by call #1233329 to debug malloc/realloc.\n    Data at p: 1a 2b 30 00\n\nMemory block allocated at (most recent call first):\n  File \"test/test_bytes.py\", line 323\n  File \"unittest/case.py\", line 600\n  File \"unittest/case.py\", line 648\n  File \"unittest/suite.py\", line 122\n  File \"unittest/suite.py\", line 84\n\nFatal Python error: bad trailing pad byte\n\nCurrent thread 0x00007fbcdbd32700 (most recent call first):\n  File \"test/test_bytes.py\", line 323 in test_hex\n  File \"unittest/case.py\", line 600 in run\n  File \"unittest/case.py\", line 648 in __call__\n  File \"unittest/suite.py\", line 122 in run\n  File \"unittest/suite.py\", line 84 in __call__\n  File \"unittest/suite.py\", line 122 in run\n  File \"unittest/suite.py\", line 84 in __call__\n  ...\n"]}, "new-features - dtrace-and-systemtap-probing-support": {"text": "DTrace and SystemTap probing support\n\nPython can now be built --with-dtrace which enables static markers\nfor the following events in the interpreter:\n\nfunction call/return\ngarbage collection started/finished\nline of code executed.\n\nThis can be used to instrument running interpreters in production,\nwithout the need to recompile specific debug builds or providing\napplication-specific profiling/debugging code.\nMore details in Instrumenting CPython with DTrace and SystemTap.\nThe current implementation is tested on Linux and macOS.  Additional\nmarkers may be added in the future.\n(Contributed by Łukasz Langa in bpo-21590, based on patches by\nJesús Cea Avión, David Malcolm, and Nikhil Benesch.)", "code_blocks": []}, "other-language-changes": {"text": "Other Language Changes\n\nSome smaller changes made to the core Python language are:\n\nA global or nonlocal statement must now textually appear\nbefore the first use of the affected name in the same scope.\nPreviously this was a SyntaxWarning.\nIt is now possible to set a special method to\nNone to indicate that the corresponding operation is not available.\nFor example, if a class sets __iter__() to None, the class\nis not iterable.\n(Contributed by Andrew Barnert and Ivan Levkivskyi in bpo-25958.)\nLong sequences of repeated traceback lines are now abbreviated as\n\"[Previous line repeated {count} more times]\" (see\ntraceback for an example).\n(Contributed by Emanuel Barry in bpo-26823.)\nImport now raises the new exception ModuleNotFoundError\n(subclass of ImportError) when it cannot find a module.  Code\nthat currently checks for ImportError (in try-except) will still work.\n(Contributed by Eric Snow in bpo-15767.)\nClass methods relying on zero-argument super() will now work correctly\nwhen called from metaclass methods during class creation.\n(Contributed by Martin Teichmann in bpo-23722.)", "code_blocks": []}, "new-modules - secrets": {"text": "secrets\n\nThe main purpose of the new secrets module is to provide an obvious way\nto reliably generate cryptographically strong pseudo-random values suitable\nfor managing secrets, such as account authentication, tokens, and similar.\n\nWarning\nNote that the pseudo-random generators in the random module\nshould NOT be used for security purposes.  Use secrets\non Python 3.6+ and os.urandom() on Python 3.5 and earlier.\n\n\nSee also\n\nPEP 506 – Adding A Secrets Module To The Standard LibraryPEP written and implemented by Steven D’Aprano.", "code_blocks": []}, "improved-modules - array": {"text": "array\n\nExhausted iterators of array.array will now stay exhausted even\nif the iterated array is extended.  This is consistent with the behavior\nof other mutable sequences.\nContributed by Serhiy Storchaka in bpo-26492.", "code_blocks": []}, "improved-modules - ast": {"text": "ast\n\nThe new ast.Constant AST node has been added.  It can be used\nby external AST optimizers for the purposes of constant folding.\nContributed by Victor Stinner in bpo-26146.", "code_blocks": []}, "improved-modules - asyncio": {"text": "asyncio\n\nStarting with Python 3.6 the asyncio module is no longer provisional and its\nAPI is considered stable.\nNotable changes in the asyncio module since Python 3.5.0\n(all backported to 3.5.x due to the provisional status):\n\nThe get_event_loop() function has been changed to\nalways return the currently running loop when called from coroutines\nand callbacks.\n(Contributed by Yury Selivanov in bpo-28613.)\nThe ensure_future() function and all functions that\nuse it, such as loop.run_until_complete(),\nnow accept all kinds of awaitable objects.\n(Contributed by Yury Selivanov.)\nNew run_coroutine_threadsafe() function to submit\ncoroutines to event loops from other threads.\n(Contributed by Vincent Michel.)\nNew Transport.is_closing()\nmethod to check if the transport is closing or closed.\n(Contributed by Yury Selivanov.)\nThe loop.create_server()\nmethod can now accept a list of hosts.\n(Contributed by Yann Sionneau.)\nNew loop.create_future()\nmethod to create Future objects.  This allows alternative event\nloop implementations, such as\nuvloop, to provide a faster\nasyncio.Future implementation.\n(Contributed by Yury Selivanov in bpo-27041.)\nNew loop.get_exception_handler()\nmethod to get the current exception handler.\n(Contributed by Yury Selivanov in bpo-27040.)\nNew StreamReader.readuntil()\nmethod to read data from the stream until a separator bytes\nsequence appears.\n(Contributed by Mark Korenberg.)\nThe performance of StreamReader.readexactly()\nhas been improved.\n(Contributed by Mark Korenberg in bpo-28370.)\nThe loop.getaddrinfo()\nmethod is optimized to avoid calling the system getaddrinfo\nfunction if the address is already resolved.\n(Contributed by A. Jesse Jiryu Davis.)\nThe loop.stop()\nmethod has been changed to stop the loop immediately after\nthe current iteration.  Any new callbacks scheduled as a result\nof the last iteration will be discarded.\n(Contributed by Guido van Rossum in bpo-25593.)\nFuture.set_exception\nwill now raise TypeError when passed an instance of\nthe StopIteration exception.\n(Contributed by Chris Angelico in bpo-26221.)\nNew loop.connect_accepted_socket()\nmethod to be used by servers that accept connections outside of asyncio,\nbut that use asyncio to handle them.\n(Contributed by Jim Fulton in bpo-27392.)\nTCP_NODELAY flag is now set for all TCP transports by default.\n(Contributed by Yury Selivanov in bpo-27456.)\nNew loop.shutdown_asyncgens()\nto properly close pending asynchronous generators before closing the\nloop.\n(Contributed by Yury Selivanov in bpo-28003.)\nFuture and Task\nclasses now have an optimized C implementation which makes asyncio\ncode up to 30% faster.\n(Contributed by Yury Selivanov and INADA Naoki in bpo-26081\nand bpo-28544.)", "code_blocks": []}, "improved-modules - binascii": {"text": "binascii\n\nThe b2a_base64() function now accepts an optional newline\nkeyword argument to control whether the newline character is appended to the\nreturn value.\n(Contributed by Victor Stinner in bpo-25357.)", "code_blocks": []}, "improved-modules - cmath": {"text": "cmath\n\nThe new cmath.tau (τ) constant has been added.\n(Contributed by Lisa Roach in bpo-12345, see PEP 628 for details.)\nNew constants: cmath.inf and cmath.nan to\nmatch math.inf and math.nan, and also cmath.infj\nand cmath.nanj to match the format used by complex repr.\n(Contributed by Mark Dickinson in bpo-23229.)", "code_blocks": []}, "improved-modules - collections": {"text": "collections\n\nThe new Collection abstract base class has been\nadded to represent sized iterable container classes.\n(Contributed by Ivan Levkivskyi, docs by Neil Girdhar in bpo-27598.)\nThe new Reversible abstract base class represents\niterable classes that also provide the __reversed__() method.\n(Contributed by Ivan Levkivskyi in bpo-25987.)\nThe new AsyncGenerator abstract base class represents\nasynchronous generators.\n(Contributed by Yury Selivanov in bpo-28720.)\nThe namedtuple() function now accepts an optional\nkeyword argument module, which, when specified, is used for\nthe __module__ attribute of the returned named tuple class.\n(Contributed by Raymond Hettinger in bpo-17941.)\nThe verbose and rename arguments for\nnamedtuple() are now keyword-only.\n(Contributed by Raymond Hettinger in bpo-25628.)\nRecursive collections.deque instances can now be pickled.\n(Contributed by Serhiy Storchaka in bpo-26482.)", "code_blocks": []}, "improved-modules - concurrent-futures": {"text": "concurrent.futures\n\nThe ThreadPoolExecutor\nclass constructor now accepts an optional thread_name_prefix argument\nto make it possible to customize the names of the threads created by the\npool.\n(Contributed by Gregory P. Smith in bpo-27664.)", "code_blocks": []}, "improved-modules - contextlib": {"text": "contextlib\n\nThe contextlib.AbstractContextManager class has been added to\nprovide an abstract base class for context managers.  It provides a\nsensible default implementation for __enter__() which returns\nself and leaves __exit__() an abstract method.  A matching\nclass has been added to the typing module as\ntyping.ContextManager.\n(Contributed by Brett Cannon in bpo-25609.)", "code_blocks": []}, "improved-modules - datetime": {"text": "datetime\n\nThe datetime and time classes have\nthe new fold attribute used to disambiguate local time\nwhen necessary.  Many functions in the datetime have been\nupdated to support local time disambiguation.\nSee Local Time Disambiguation section for more\ninformation.\n(Contributed by Alexander Belopolsky in bpo-24773.)\nThe datetime.strftime() and\ndate.strftime() methods now support\nISO 8601 date directives %G, %u and %V.\n(Contributed by Ashley Anderson in bpo-12006.)\nThe datetime.isoformat() function\nnow accepts an optional timespec argument that specifies the number\nof additional components of the time value to include.\n(Contributed by Alessandro Cucci and Alexander Belopolsky in bpo-19475.)\nThe datetime.combine() now\naccepts an optional tzinfo argument.\n(Contributed by Alexander Belopolsky in bpo-27661.)", "code_blocks": []}, "improved-modules - decimal": {"text": "decimal\n\nNew Decimal.as_integer_ratio()\nmethod that returns a pair (n, d) of integers that represent the given\nDecimal instance as a fraction, in lowest terms and\nwith a positive denominator:\n>>> Decimal('-3.14').as_integer_ratio()\n(-157, 50)\n\n\n(Contributed by Stefan Krah amd Mark Dickinson in bpo-25928.)", "code_blocks": [">>> Decimal('-3.14').as_integer_ratio()\n(-157, 50)\n"]}, "improved-modules - distutils": {"text": "distutils\n\nThe default_format attribute has been removed from\ndistutils.command.sdist.sdist and the formats\nattribute defaults to ['gztar']. Although not anticipated,\nany code relying on the presence of default_format may\nneed to be adapted. See bpo-27819 for more details.", "code_blocks": []}, "improved-modules - email": {"text": "email\n\nThe new email API, enabled via the policy keyword to various constructors, is\nno longer provisional.  The email documentation has been reorganized and\nrewritten to focus on the new API, while retaining the old documentation for\nthe legacy API.  (Contributed by R. David Murray in bpo-24277.)\nThe email.mime classes now all accept an optional policy keyword.\n(Contributed by Berker Peksag in bpo-27331.)\nThe DecodedGenerator now supports the policy\nkeyword.\nThere is a new policy attribute,\nmessage_factory, that controls what class is used\nby default when the parser creates new message objects.  For the\nemail.policy.compat32 policy this is Message,\nfor the new policies it is EmailMessage.\n(Contributed by R. David Murray in bpo-20476.)", "code_blocks": []}, "improved-modules - encodings": {"text": "encodings\n\nOn Windows, added the 'oem' encoding to use CP_OEMCP, and the 'ansi'\nalias for the existing 'mbcs' encoding, which uses the CP_ACP code page.\n(Contributed by Steve Dower in bpo-27959.)", "code_blocks": []}, "improved-modules - enum": {"text": "enum\n\nTwo new enumeration base classes have been added to the enum module:\nFlag and IntFlags.  Both are used to define\nconstants that can be combined using the bitwise operators.\n(Contributed by Ethan Furman in bpo-23591.)\nMany standard library modules have been updated to use the\nIntFlags class for their constants.\nThe new enum.auto value can be used to assign values to enum\nmembers automatically:\n>>> from enum import Enum, auto\n>>> class Color(Enum):\n...     red = auto()\n...     blue = auto()\n...     green = auto()\n...\n>>> list(Color)\n[<Color.red: 1>, <Color.blue: 2>, <Color.green: 3>]", "code_blocks": [">>> from enum import Enum, auto\n>>> class Color(Enum):\n...     red = auto()\n...     blue = auto()\n...     green = auto()\n...\n>>> list(Color)\n[<Color.red: 1>, <Color.blue: 2>, <Color.green: 3>]\n"]}, "improved-modules - faulthandler": {"text": "faulthandler\n\nOn Windows, the faulthandler module now installs a handler for Windows\nexceptions: see faulthandler.enable(). (Contributed by Victor Stinner in\nbpo-23848.)", "code_blocks": []}, "improved-modules - fileinput": {"text": "fileinput\n\nhook_encoded() now supports the errors argument.\n(Contributed by Joseph Hackman in bpo-25788.)", "code_blocks": []}, "improved-modules - hashlib": {"text": "hashlib\n\nhashlib supports OpenSSL 1.1.0.  The minimum recommend version is 1.0.2.\n(Contributed by Christian Heimes in bpo-26470.)\nBLAKE2 hash functions were added to the module. blake2b()\nand blake2s() are always available and support the full\nfeature set of BLAKE2.\n(Contributed by Christian Heimes in bpo-26798 based on code by\nDmitry Chestnykh and Samuel Neves. Documentation written by Dmitry Chestnykh.)\nThe SHA-3 hash functions sha3_224(), sha3_256(),\nsha3_384(), sha3_512(), and SHAKE hash functions\nshake_128() and shake_256() were added.\n(Contributed by Christian Heimes in bpo-16113. Keccak Code Package\nby Guido Bertoni, Joan Daemen, Michaël Peeters, Gilles Van Assche, and\nRonny Van Keer.)\nThe password-based key derivation function scrypt() is now\navailable with OpenSSL 1.1.0 and newer.\n(Contributed by Christian Heimes in bpo-27928.)", "code_blocks": []}, "improved-modules - http-client": {"text": "http.client\n\nHTTPConnection.request() and\nendheaders() both now support\nchunked encoding request bodies.\n(Contributed by Demian Brecht and Rolf Krahl in bpo-12319.)", "code_blocks": []}, "improved-modules - idlelib-and-idle": {"text": "idlelib and IDLE\n\nThe idlelib package is being modernized and refactored to make IDLE look and\nwork better and to make the code easier to understand, test, and improve. Part\nof making IDLE look better, especially on Linux and Mac, is using ttk widgets,\nmostly in the dialogs.  As a result, IDLE no longer runs with tcl/tk 8.4.  It\nnow requires tcl/tk 8.5 or 8.6.  We recommend running the latest release of\neither.\n‘Modernizing’ includes renaming and consolidation of idlelib modules. The\nrenaming of files with partial uppercase names is similar to the renaming of,\nfor instance, Tkinter and TkFont to tkinter and tkinter.font in 3.0.  As a\nresult, imports of idlelib files that worked in 3.5 will usually not work in\n3.6.  At least a module name change will be needed (see idlelib/README.txt),\nsometimes more.  (Name changes contributed by Al Swiegart and Terry Reedy in\nbpo-24225.  Most idlelib patches since have been and will be part of the\nprocess.)\nIn compensation, the eventual result with be that some idlelib classes will be\neasier to use, with better APIs and docstrings explaining them.  Additional\nuseful information will be added to idlelib when available.\nNew in 3.6.2:\nMultiple fixes for autocompletion. (Contributed by Louie Lu in bpo-15786.)\nNew in 3.6.3:\nModule Browser (on the File menu, formerly called Class Browser),\nnow displays nested functions and classes in addition to top-level\nfunctions and classes.\n(Contributed by Guilherme Polo, Cheryl Sabella, and Terry Jan Reedy\nin bpo-1612262.)\nThe IDLE features formerly implemented as extensions have been reimplemented\nas normal features.  Their settings have been moved from the Extensions tab\nto other dialog tabs.\n(Contributed by Charles Wohlganger and Terry Jan Reedy in bpo-27099.)\nThe Settings dialog (Options, Configure IDLE) has been partly rewritten\nto improve both appearance and function.\n(Contributed by Cheryl Sabella and Terry Jan Reedy in multiple issues.)\nNew in 3.6.4:\nThe font sample now includes a selection of non-Latin characters so that\nusers can better see the effect of selecting a particular font.\n(Contributed by Terry Jan Reedy in bpo-13802.)\nThe sample can be edited to include other characters.\n(Contributed by Serhiy Storchaka in bpo-31860.)\nNew in 3.6.6:\nEditor code context option revised.  Box displays all context lines up to\nmaxlines.  Clicking on a context line jumps the editor to that line.  Context\ncolors for custom themes is added to Highlights tab of Settings dialog.\n(Contributed by Cheryl Sabella and Terry Jan Reedy in bpo-33642,\nbpo-33768, and bpo-33679.)\nOn Windows, a new API call tells Windows that tk scales for DPI. On Windows\n8.1+ or 10, with DPI compatibility properties of the Python binary\nunchanged, and a monitor resolution greater than 96 DPI, this should\nmake text and lines sharper.  It should otherwise have no effect.\n(Contributed by Terry Jan Reedy in bpo-33656.)\nNew in 3.6.7:\nOutput over N lines (50 by default) is squeezed down to a button.\nN can be changed in the PyShell section of the General page of the\nSettings dialog.  Fewer, but possibly extra long, lines can be squeezed by\nright clicking on the output.  Squeezed output can be expanded in place\nby double-clicking the button or into the clipboard or a separate window\nby right-clicking the button.  (Contributed by Tal Einat in bpo-1529353.)", "code_blocks": []}, "improved-modules - importlib": {"text": "importlib\n\nImport now raises the new exception ModuleNotFoundError\n(subclass of ImportError) when it cannot find a module.  Code\nthat current checks for ImportError (in try-except) will still work.\n(Contributed by Eric Snow in bpo-15767.)\nimportlib.util.LazyLoader now calls\ncreate_module() on the wrapped loader, removing the\nrestriction that importlib.machinery.BuiltinImporter and\nimportlib.machinery.ExtensionFileLoader couldn’t be used with\nimportlib.util.LazyLoader.\nimportlib.util.cache_from_source(),\nimportlib.util.source_from_cache(), and\nimportlib.util.spec_from_file_location() now accept a\npath-like object.", "code_blocks": []}, "improved-modules - inspect": {"text": "inspect\n\nThe inspect.signature() function now reports the\nimplicit .0 parameters generated by the compiler for comprehension and\ngenerator expression scopes as if they were positional-only parameters called\nimplicit0. (Contributed by Jelle Zijlstra in bpo-19611.)\nTo reduce code churn when upgrading from Python 2.7 and the legacy\ninspect.getargspec() API, the previously documented deprecation of\ninspect.getfullargspec() has been reversed. While this function is\nconvenient for single/source Python 2/3 code bases, the richer\ninspect.signature() interface remains the recommended approach for new\ncode. (Contributed by Nick Coghlan in bpo-27172)", "code_blocks": []}, "improved-modules - json": {"text": "json\n\njson.load() and json.loads() now support binary input.  Encoded\nJSON should be represented using either UTF-8, UTF-16, or UTF-32.\n(Contributed by Serhiy Storchaka in bpo-17909.)", "code_blocks": []}, "improved-modules - logging": {"text": "logging\n\nThe new WatchedFileHandler.reopenIfNeeded()\nmethod has been added to add the ability to check if the log file needs to\nbe reopened.\n(Contributed by Marian Horban in bpo-24884.)", "code_blocks": []}, "improved-modules - math": {"text": "math\n\nThe tau (τ) constant has been added to the math and cmath\nmodules.\n(Contributed by Lisa Roach in bpo-12345, see PEP 628 for details.)", "code_blocks": []}, "improved-modules - multiprocessing": {"text": "multiprocessing\n\nProxy Objects returned by\nmultiprocessing.Manager() can now be nested.\n(Contributed by Davin Potts in bpo-6766.)", "code_blocks": []}, "improved-modules - os": {"text": "os\n\nSee the summary of PEP 519 for details on how the\nos and os.path modules now support\npath-like objects.\nscandir() now supports bytes paths on Windows.\nA new close() method allows explicitly closing a\nscandir() iterator.  The scandir() iterator now\nsupports the context manager protocol.  If a scandir()\niterator is neither exhausted nor explicitly closed a ResourceWarning\nwill be emitted in its destructor.\n(Contributed by Serhiy Storchaka in bpo-25994.)\nOn Linux, os.urandom() now blocks until the system urandom entropy pool\nis initialized to increase the security. See the PEP 524 for the rationale.\nThe Linux getrandom() syscall (get random bytes) is now exposed as the new\nos.getrandom() function.\n(Contributed by Victor Stinner, part of the PEP 524)", "code_blocks": []}, "improved-modules - pathlib": {"text": "pathlib\n\npathlib now supports path-like objects.\n(Contributed by Brett Cannon in bpo-27186.)\nSee the summary of PEP 519 for details.", "code_blocks": []}, "improved-modules - pdb": {"text": "pdb\n\nThe Pdb class constructor has a new optional readrc argument\nto control whether .pdbrc files should be read.", "code_blocks": []}, "improved-modules - pickle": {"text": "pickle\n\nObjects that need __new__ called with keyword arguments can now be pickled\nusing pickle protocols older than protocol version 4.\nProtocol version 4 already supports this case.  (Contributed by Serhiy\nStorchaka in bpo-24164.)", "code_blocks": []}, "improved-modules - pickletools": {"text": "pickletools\n\npickletools.dis() now outputs the implicit memo index for the\nMEMOIZE opcode.\n(Contributed by Serhiy Storchaka in bpo-25382.)", "code_blocks": []}, "improved-modules - pydoc": {"text": "pydoc\n\nThe pydoc module has learned to respect the MANPAGER\nenvironment variable.\n(Contributed by Matthias Klose in bpo-8637.)\nhelp() and pydoc can now list named tuple fields in the\norder they were defined rather than alphabetically.\n(Contributed by Raymond Hettinger in bpo-24879.)", "code_blocks": []}, "improved-modules - random": {"text": "random\n\nThe new choices() function returns a list of elements of\nspecified size from the given population with optional weights.\n(Contributed by Raymond Hettinger in bpo-18844.)", "code_blocks": []}, "improved-modules - re": {"text": "re\n\nAdded support of modifier spans in regular expressions.  Examples:\n'(?i:p)ython' matches 'python' and 'Python', but not 'PYTHON';\n'(?i)g(?-i:v)r' matches 'GvR' and 'gvr', but not 'GVR'.\n(Contributed by Serhiy Storchaka in bpo-433028.)\nMatch object groups can be accessed by __getitem__, which is\nequivalent to group().  So mo['name'] is now equivalent to\nmo.group('name').  (Contributed by Eric Smith in bpo-24454.)\nMatch objects now support\nindex-like objects as group\nindices.\n(Contributed by Jeroen Demeyer and Xiang Zhang in bpo-27177.)", "code_blocks": []}, "improved-modules - readline": {"text": "readline\n\nAdded set_auto_history() to enable or disable\nautomatic addition of input to the history list.  (Contributed by\nTyler Crompton in bpo-26870.)", "code_blocks": []}, "improved-modules - rlcompleter": {"text": "rlcompleter\n\nPrivate and special attribute names now are omitted unless the prefix starts\nwith underscores.  A space or a colon is added after some completed keywords.\n(Contributed by Serhiy Storchaka in bpo-25011 and bpo-25209.)", "code_blocks": []}, "improved-modules - shlex": {"text": "shlex\n\nThe shlex has much\nimproved shell compatibility\nthrough the new punctuation_chars argument to control which characters\nare treated as punctuation.\n(Contributed by Vinay Sajip in bpo-1521950.)", "code_blocks": []}, "improved-modules - site": {"text": "site\n\nWhen specifying paths to add to sys.path in a .pth file,\nyou may now specify file paths on top of directories (e.g. zip files).\n(Contributed by Wolfgang Langner in bpo-26587).", "code_blocks": []}, "improved-modules - sqlite3": {"text": "sqlite3\n\nsqlite3.Cursor.lastrowid now supports the REPLACE statement.\n(Contributed by Alex LordThorsen in bpo-16864.)", "code_blocks": []}, "improved-modules - socket": {"text": "socket\n\nThe ioctl() function now supports the\nSIO_LOOPBACK_FAST_PATH control code.\n(Contributed by Daniel Stokes in bpo-26536.)\nThe getsockopt() constants SO_DOMAIN,\nSO_PROTOCOL, SO_PEERSEC, and SO_PASSSEC are now supported.\n(Contributed by Christian Heimes in bpo-26907.)\nThe setsockopt() now supports the\nsetsockopt(level, optname, None, optlen: int) form.\n(Contributed by Christian Heimes in bpo-27744.)\nThe socket module now supports the address family\nAF_ALG to interface with Linux Kernel crypto API. ALG_*,\nSOL_ALG and sendmsg_afalg() were added.\n(Contributed by Christian Heimes in bpo-27744 with support from\nVictor Stinner.)\nNew Linux constants TCP_USER_TIMEOUT and TCP_CONGESTION were added.\n(Contributed by Omar Sandoval, issue:26273).", "code_blocks": []}, "improved-modules - socketserver": {"text": "socketserver\n\nServers based on the socketserver module, including those\ndefined in http.server, xmlrpc.server and\nwsgiref.simple_server, now support the context manager\nprotocol.\n(Contributed by Aviv Palivoda in bpo-26404.)\nThe wfile attribute of\nStreamRequestHandler classes now implements\nthe io.BufferedIOBase writable interface.  In particular,\ncalling write() is now guaranteed to send the\ndata in full.  (Contributed by Martin Panter in bpo-26721.)", "code_blocks": []}, "improved-modules - ssl": {"text": "ssl\n\nssl supports OpenSSL 1.1.0.  The minimum recommend version is 1.0.2.\n(Contributed by Christian Heimes in bpo-26470.)\n3DES has been removed from the default cipher suites and ChaCha20 Poly1305\ncipher suites have been added.\n(Contributed by Christian Heimes in bpo-27850 and bpo-27766.)\nSSLContext has better default configuration for options\nand ciphers.\n(Contributed by Christian Heimes in bpo-28043.)\nSSL session can be copied from one client-side connection to another\nwith the new SSLSession class.  TLS session resumption can\nspeed up the initial handshake, reduce latency and improve performance\n(Contributed by Christian Heimes in bpo-19500 based on a draft by\nAlex Warhawk.)\nThe new get_ciphers() method can be used to\nget a list of enabled ciphers in order of cipher priority.\nAll constants and flags have been converted to IntEnum and\nIntFlags.\n(Contributed by Christian Heimes in bpo-28025.)\nServer and client-side specific TLS protocols for SSLContext\nwere added.\n(Contributed by Christian Heimes in bpo-28085.)\nAdded SSLContext.post_handshake_auth to enable and\nssl.SSLSocket.verify_client_post_handshake() to initiate TLS 1.3\npost-handshake authentication.\n(Contributed by Christian Heimes in bpo-34670.)", "code_blocks": []}, "improved-modules - statistics": {"text": "statistics\n\nA new harmonic_mean() function has been added.\n(Contributed by Steven D’Aprano in bpo-27181.)", "code_blocks": []}, "improved-modules - struct": {"text": "struct\n\nstruct now supports IEEE 754 half-precision floats via the 'e'\nformat specifier.\n(Contributed by Eli Stevens, Mark Dickinson in bpo-11734.)", "code_blocks": []}, "improved-modules - subprocess": {"text": "subprocess\n\nsubprocess.Popen destructor now emits a ResourceWarning warning\nif the child process is still running. Use the context manager protocol (with\nproc: ...) or explicitly call the wait() method to\nread the exit status of the child process. (Contributed by Victor Stinner in\nbpo-26741.)\nThe subprocess.Popen constructor and all functions that pass arguments\nthrough to it now accept encoding and errors arguments. Specifying either\nof these will enable text mode for the stdin, stdout and stderr streams.\n(Contributed by Steve Dower in bpo-6135.)", "code_blocks": []}, "improved-modules - sys": {"text": "sys\n\nThe new getfilesystemencodeerrors() function returns the name of\nthe error mode used to convert between Unicode filenames and bytes filenames.\n(Contributed by Steve Dower in bpo-27781.)\nOn Windows the return value of the getwindowsversion() function\nnow includes the platform_version field which contains the accurate major\nversion, minor version and build number of the current operating system,\nrather than the version that is being emulated for the process\n(Contributed by Steve Dower in bpo-27932.)", "code_blocks": []}, "improved-modules - telnetlib": {"text": "telnetlib\n\nTelnet is now a context manager (contributed by\nStéphane Wirtel in bpo-25485).", "code_blocks": []}, "improved-modules - time": {"text": "time\n\nThe struct_time attributes tm_gmtoff and\ntm_zone are now available on all platforms.", "code_blocks": []}, "improved-modules - timeit": {"text": "timeit\n\nThe new Timer.autorange() convenience\nmethod has been added to call Timer.timeit()\nrepeatedly so that the total run time is greater or equal to 200 milliseconds.\n(Contributed by Steven D’Aprano in bpo-6422.)\ntimeit now warns when there is substantial (4x) variance\nbetween best and worst times.\n(Contributed by Serhiy Storchaka in bpo-23552.)", "code_blocks": []}, "improved-modules - tkinter": {"text": "tkinter\n\nAdded methods trace_add(),\ntrace_remove() and trace_info()\nin the tkinter.Variable class.  They replace old methods\ntrace_variable(), trace(),\ntrace_vdelete() and\ntrace_vinfo() that use obsolete Tcl commands and might\nnot work in future versions of Tcl.\n(Contributed by Serhiy Storchaka in bpo-22115).", "code_blocks": []}, "improved-modules - traceback": {"text": "traceback\n\nBoth the traceback module and the interpreter’s builtin exception display now\nabbreviate long sequences of repeated lines in tracebacks as shown in the\nfollowing example:\n>>> def f(): f()\n...\n>>> f()\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"<stdin>\", line 1, in f\n  File \"<stdin>\", line 1, in f\n  File \"<stdin>\", line 1, in f\n  [Previous line repeated 995 more times]\nRecursionError: maximum recursion depth exceeded\n\n\n(Contributed by Emanuel Barry in bpo-26823.)", "code_blocks": [">>> def f(): f()\n...\n>>> f()\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"<stdin>\", line 1, in f\n  File \"<stdin>\", line 1, in f\n  File \"<stdin>\", line 1, in f\n  [Previous line repeated 995 more times]\nRecursionError: maximum recursion depth exceeded\n"]}, "improved-modules - tracemalloc": {"text": "tracemalloc\n\nThe tracemalloc module now supports tracing memory allocations in\nmultiple different address spaces.\nThe new DomainFilter filter class has been added\nto filter block traces by their address space (domain).\n(Contributed by Victor Stinner in bpo-26588.)", "code_blocks": []}, "improved-modules - typing": {"text": "typing\n\nSince the typing module is provisional,\nall changes introduced in Python 3.6 have also been\nbackported to Python 3.5.x.\nThe typing module has a much improved support for generic type\naliases.  For example Dict[str, Tuple[S, T]] is now a valid\ntype annotation.\n(Contributed by Guido van Rossum in Github #195.)\nThe typing.ContextManager class has been added for\nrepresenting contextlib.AbstractContextManager.\n(Contributed by Brett Cannon in bpo-25609.)\nThe typing.Collection class has been added for\nrepresenting collections.abc.Collection.\n(Contributed by Ivan Levkivskyi in bpo-27598.)\nThe typing.ClassVar type construct has been added to\nmark class variables.  As introduced in PEP 526, a variable annotation\nwrapped in ClassVar indicates that a given attribute is intended to be used as\na class variable and should not be set on instances of that class.\n(Contributed by Ivan Levkivskyi in Github #280.)\nA new TYPE_CHECKING constant that is assumed to be\nTrue by the static type chekers, but is False at runtime.\n(Contributed by Guido van Rossum in Github #230.)\nA new NewType() helper function has been added to create\nlightweight distinct types for annotations:\nfrom typing import NewType\n\nUserId = NewType('UserId', int)\nsome_id = UserId(524313)\n\n\nThe static type checker will treat the new type as if it were a subclass\nof the original type.  (Contributed by Ivan Levkivskyi in Github #189.)", "code_blocks": ["from typing import NewType\n\nUserId = NewType('UserId', int)\nsome_id = UserId(524313)\n"]}, "improved-modules - unicodedata": {"text": "unicodedata\n\nThe unicodedata module now uses data from Unicode 9.0.0.\n(Contributed by Benjamin Peterson.)", "code_blocks": []}, "improved-modules - unittest-mock": {"text": "unittest.mock\n\nThe Mock class has the following improvements:\n\nTwo new methods, Mock.assert_called() and Mock.assert_called_once() to check if the mock object\nwas called.\n(Contributed by Amit Saha in bpo-26323.)\nThe Mock.reset_mock() method\nnow has two optional keyword only arguments: return_value and\nside_effect.\n(Contributed by Kushal Das in bpo-21271.)", "code_blocks": []}, "improved-modules - urllib-request": {"text": "urllib.request\n\nIf a HTTP request has a file or iterable body (other than a\nbytes object) but no Content-Length header, rather than\nthrowing an error, AbstractHTTPHandler now\nfalls back to use chunked transfer encoding.\n(Contributed by Demian Brecht and Rolf Krahl in bpo-12319.)", "code_blocks": []}, "improved-modules - urllib-robotparser": {"text": "urllib.robotparser\n\nRobotFileParser now supports the Crawl-delay and\nRequest-rate extensions.\n(Contributed by Nikolay Bogoychev in bpo-16099.)", "code_blocks": []}, "improved-modules - venv": {"text": "venv\n\nvenv accepts a new parameter --prompt. This parameter provides an\nalternative prefix for the virtual environment. (Proposed by Łukasz Balcerzak\nand ported to 3.6 by Stéphane Wirtel in bpo-22829.)", "code_blocks": []}, "improved-modules - warnings": {"text": "warnings\n\nA new optional source parameter has been added to the\nwarnings.warn_explicit() function: the destroyed object which emitted a\nResourceWarning. A source attribute has also been added to\nwarnings.WarningMessage (contributed by Victor Stinner in\nbpo-26568 and bpo-26567).\nWhen a ResourceWarning warning is logged, the tracemalloc module is now\nused to try to retrieve the traceback where the destroyed object was allocated.\nExample with the script example.py:\nimport warnings\n\ndef func():\n    return open(__file__)\n\nf = func()\nf = None\n\n\nOutput of the command python3.6 -Wd -X tracemalloc=5 example.py:\nexample.py:7: ResourceWarning: unclosed file <_io.TextIOWrapper name='example.py' mode='r' encoding='UTF-8'>\n  f = None\nObject allocated at (most recent call first):\n  File \"example.py\", lineno 4\n    return open(__file__)\n  File \"example.py\", lineno 6\n    f = func()\n\n\nThe “Object allocated at” traceback is new and is only displayed if\ntracemalloc is tracing Python memory allocations and if the\nwarnings module was already imported.", "code_blocks": ["import warnings\n\ndef func():\n    return open(__file__)\n\nf = func()\nf = None\n", "example.py:7: ResourceWarning: unclosed file <_io.TextIOWrapper name='example.py' mode='r' encoding='UTF-8'>\n  f = None\nObject allocated at (most recent call first):\n  File \"example.py\", lineno 4\n    return open(__file__)\n  File \"example.py\", lineno 6\n    f = func()\n"]}, "improved-modules - winreg": {"text": "winreg\n\nAdded the 64-bit integer type REG_QWORD.\n(Contributed by Clement Rouault in bpo-23026.)", "code_blocks": []}, "improved-modules - winsound": {"text": "winsound\n\nAllowed keyword arguments to be passed to Beep,\nMessageBeep, and PlaySound (bpo-27982).", "code_blocks": []}, "improved-modules - xmlrpc-client": {"text": "xmlrpc.client\n\nThe xmlrpc.client module now supports unmarshalling\nadditional data types used by the Apache XML-RPC implementation\nfor numerics and None.\n(Contributed by Serhiy Storchaka in bpo-26885.)", "code_blocks": []}, "improved-modules - zipfile": {"text": "zipfile\n\nA new ZipInfo.from_file() class method\nallows making a ZipInfo instance from a filesystem file.\nA new ZipInfo.is_dir() method can be used\nto check if the ZipInfo instance represents a directory.\n(Contributed by Thomas Kluyver in bpo-26039.)\nThe ZipFile.open() method can now be used to\nwrite data into a ZIP file, as well as for extracting data.\n(Contributed by Thomas Kluyver in bpo-26039.)", "code_blocks": []}, "improved-modules - zlib": {"text": "zlib\n\nThe compress() and decompress() functions now accept\nkeyword arguments.\n(Contributed by Aviv Palivoda in bpo-26243 and\nXiang Zhang in bpo-16764 respectively.)", "code_blocks": []}, "optimizations": {"text": "Optimizations\n\n\nThe Python interpreter now uses a 16-bit wordcode instead of bytecode which\nmade a number of opcode optimizations possible.\n(Contributed by Demur Rumed with input and reviews from\nSerhiy Storchaka and Victor Stinner in bpo-26647 and bpo-28050.)\nThe asyncio.Future class now has an optimized C implementation.\n(Contributed by Yury Selivanov and INADA Naoki in bpo-26081.)\nThe asyncio.Task class now has an optimized\nC implementation. (Contributed by Yury Selivanov in bpo-28544.)\nVarious implementation improvements in the typing module\n(such as caching of generic types) allow up to 30 times performance\nimprovements and reduced memory footprint.\nThe ASCII decoder is now up to 60 times as fast for error handlers\nsurrogateescape, ignore and replace (Contributed\nby Victor Stinner in bpo-24870).\nThe ASCII and the Latin1 encoders are now up to 3 times as fast for the\nerror handler surrogateescape\n(Contributed by Victor Stinner in bpo-25227).\nThe UTF-8 encoder is now up to 75 times as fast for error handlers\nignore, replace, surrogateescape, surrogatepass (Contributed\nby Victor Stinner in bpo-25267).\nThe UTF-8 decoder is now up to 15 times as fast for error handlers\nignore, replace and surrogateescape (Contributed\nby Victor Stinner in bpo-25301).\nbytes % args is now up to 2 times faster. (Contributed by Victor Stinner\nin bpo-25349).\nbytearray % args is now between 2.5 and 5 times faster. (Contributed by\nVictor Stinner in bpo-25399).\nOptimize bytes.fromhex() and bytearray.fromhex(): they are now\nbetween 2x and 3.5x faster. (Contributed by Victor Stinner in bpo-25401).\nOptimize bytes.replace(b'', b'.') and bytearray.replace(b'', b'.'):\nup to 80% faster. (Contributed by Josh Snider in bpo-26574).\nAllocator functions of the PyMem_Malloc() domain\n(PYMEM_DOMAIN_MEM) now use the pymalloc memory allocator instead of malloc() function of the C library. The\npymalloc allocator is optimized for objects smaller or equal to 512 bytes\nwith a short lifetime, and use malloc() for larger memory blocks.\n(Contributed by Victor Stinner in bpo-26249).\npickle.load() and pickle.loads() are now up to 10% faster when\ndeserializing many small objects (Contributed by Victor Stinner in\nbpo-27056).\nPassing keyword arguments to a function has an\noverhead in comparison with passing positional arguments.  Now in extension functions implemented with using\nArgument Clinic this overhead is significantly decreased.\n(Contributed by Serhiy Storchaka in bpo-27574).\nOptimized glob() and iglob() functions in the\nglob module; they are now about 3–6 times faster.\n(Contributed by Serhiy Storchaka in bpo-25596).\nOptimized globbing in pathlib by using os.scandir();\nit is now about 1.5–4 times faster.\n(Contributed by Serhiy Storchaka in bpo-26032).\nxml.etree.ElementTree parsing, iteration and deepcopy performance\nhas been significantly improved.\n(Contributed by Serhiy Storchaka in bpo-25638, bpo-25873,\nand bpo-25869.)\nCreation of fractions.Fraction instances from floats and\ndecimals is now 2 to 3 times faster.\n(Contributed by Serhiy Storchaka in bpo-25971.)", "code_blocks": []}, "build-and-c-api-changes": {"text": "Build and C API Changes\n\n\nPython now requires some C99 support in the toolchain to build.\nMost notably, Python now uses standard integer types and macros in\nplace of custom macros like PY_LONG_LONG.\nFor more information, see PEP 7 and bpo-17884.\nCross-compiling CPython with the Android NDK and the Android API level set to\n21 (Android 5.0 Lollipop) or greater runs successfully. While Android is not\nyet a supported platform, the Python test suite runs on the Android emulator\nwith only about 16 tests failures. See the Android meta-issue bpo-26865.\nThe --enable-optimizations configure flag has been added. Turning it on\nwill activate expensive optimizations like PGO.\n(Original patch by Alecsandru Patrascu of Intel in bpo-26359.)\nThe GIL must now be held when allocator\nfunctions of PYMEM_DOMAIN_OBJ (ex: PyObject_Malloc()) and\nPYMEM_DOMAIN_MEM (ex: PyMem_Malloc()) domains are called.\nNew Py_FinalizeEx() API which indicates if flushing buffered data\nfailed.\n(Contributed by Martin Panter in bpo-5319.)\nPyArg_ParseTupleAndKeywords() now supports positional-only\nparameters.  Positional-only parameters are\ndefined by empty names.\n(Contributed by Serhiy Storchaka in bpo-26282).\nPyTraceback_Print method now abbreviates long sequences of repeated lines\nas \"[Previous line repeated {count} more times]\".\n(Contributed by Emanuel Barry in bpo-26823.)\nThe new PyErr_SetImportErrorSubclass() function allows for\nspecifying a subclass of ImportError to raise.\n(Contributed by Eric Snow in bpo-15767.)\nThe new PyErr_ResourceWarning() function can be used to generate\na ResourceWarning providing the source of the resource allocation.\n(Contributed by Victor Stinner in bpo-26567.)\nThe new PyOS_FSPath() function returns the file system\nrepresentation of a path-like object.\n(Contributed by Brett Cannon in bpo-27186.)\nThe PyUnicode_FSConverter() and PyUnicode_FSDecoder()\nfunctions will now accept path-like objects.", "code_blocks": []}, "other-improvements": {"text": "Other Improvements\n\n\nWhen --version (short form: -V) is supplied twice,\nPython prints sys.version for detailed information.\n$ ./python -VV\nPython 3.6.0b4+ (3.6:223967b49e49+, Nov 21 2016, 20:55:04)\n[GCC 4.2.1 Compatible Apple LLVM 8.0.0 (clang-800.0.42.1)]", "code_blocks": ["$ ./python -VV\nPython 3.6.0b4+ (3.6:223967b49e49+, Nov 21 2016, 20:55:04)\n[GCC 4.2.1 Compatible Apple LLVM 8.0.0 (clang-800.0.42.1)]\n"]}, "deprecated - new-keywords": {"text": "New Keywords\n\nasync and await are not recommended to be used as variable, class,\nfunction or module names.  Introduced by PEP 492 in Python 3.5, they will\nbecome proper keywords in Python 3.7.  Starting in Python 3.6, the use of\nasync or await as names will generate a DeprecationWarning.", "code_blocks": []}, "deprecated - deprecated-python-behavior": {"text": "Deprecated Python behavior\n\nRaising the StopIteration exception inside a generator will now\ngenerate a DeprecationWarning, and will trigger a RuntimeError\nin Python 3.7.  See PEP 479: Change StopIteration handling inside generators for details.\nThe __aiter__() method is now expected to return an asynchronous\niterator directly instead of returning an awaitable as previously.\nDoing the former will trigger a DeprecationWarning.  Backward\ncompatibility will be removed in Python 3.7.\n(Contributed by Yury Selivanov in bpo-27243.)\nA backslash-character pair that is not a valid escape sequence now generates\na DeprecationWarning.  Although this will eventually become a\nSyntaxError, that will not be for several Python releases.\n(Contributed by Emanuel Barry in bpo-27364.)\nWhen performing a relative import, falling back on __name__ and\n__path__ from the calling module when __spec__ or\n__package__ are not defined now raises an ImportWarning.\n(Contributed by Rose Ames in bpo-25791.)", "code_blocks": []}, "deprecated - deprecated-python-modules-functions-and-methods": {"text": "Deprecated Python modules, functions and methods\n\n\nasynchat\n\nThe asynchat has been deprecated in favor of asyncio.\n(Contributed by Mariatta in bpo-25002.)\n\n\nasyncore\n\nThe asyncore has been deprecated in favor of asyncio.\n(Contributed by Mariatta in bpo-25002.)\n\n\ndbm\n\nUnlike other dbm implementations, the dbm.dumb module\ncreates databases with the 'rw' mode and allows modifying the database\nopened with the 'r' mode.  This behavior is now deprecated and will\nbe removed in 3.8.\n(Contributed by Serhiy Storchaka in bpo-21708.)\n\n\ndistutils\n\nThe undocumented extra_path argument to the\nDistribution constructor is now considered deprecated\nand will raise a warning if set.   Support for this parameter will be\nremoved in a future Python release.  See bpo-27919 for details.\n\n\ngrp\n\nThe support of non-integer arguments in getgrgid() has been\ndeprecated.\n(Contributed by Serhiy Storchaka in bpo-26129.)\n\n\nimportlib\n\nThe importlib.machinery.SourceFileLoader.load_module() and\nimportlib.machinery.SourcelessFileLoader.load_module() methods\nare now deprecated. They were the only remaining implementations of\nimportlib.abc.Loader.load_module() in importlib that had not\nbeen deprecated in previous versions of Python in favour of\nimportlib.abc.Loader.exec_module().\nThe importlib.machinery.WindowsRegistryFinder class is now\ndeprecated. As of 3.6.0, it is still added to sys.meta_path by\ndefault (on Windows), but this may change in future releases.\n\n\nos\n\nUndocumented support of general bytes-like objects\nas paths in os functions, compile() and similar functions is\nnow deprecated.\n(Contributed by Serhiy Storchaka in bpo-25791 and bpo-26754.)\n\n\nre\n\nSupport for inline flags (?letters) in the middle of the regular\nexpression has been deprecated and will be removed in a future Python\nversion.  Flags at the start of a regular expression are still allowed.\n(Contributed by Serhiy Storchaka in bpo-22493.)\n\n\nssl\n\nOpenSSL 0.9.8, 1.0.0 and 1.0.1 are deprecated and no longer supported.\nIn the future the ssl module will require at least OpenSSL 1.0.2 or\n1.1.0.\nSSL-related arguments like certfile, keyfile and check_hostname\nin ftplib, http.client, imaplib, poplib,\nand smtplib have been deprecated in favor of context.\n(Contributed by Christian Heimes in bpo-28022.)\nA couple of protocols and functions of the ssl module are now\ndeprecated. Some features will no longer be available in future versions\nof OpenSSL. Other features are deprecated in favor of a different API.\n(Contributed by Christian Heimes in bpo-28022 and bpo-26470.)\n\n\ntkinter\n\nThe tkinter.tix module is now deprecated.  tkinter users\nshould use tkinter.ttk instead.\n\n\nvenv\n\nThe pyvenv script has been deprecated in favour of python3 -m venv.\nThis prevents confusion as to what Python interpreter pyvenv is\nconnected to and thus what Python interpreter will be used by the virtual\nenvironment.  (Contributed by Brett Cannon in bpo-25154.)", "code_blocks": []}, "deprecated - xml": {"text": "xml\n\n\nAs mitigation against DTD and external entity retrieval, the\nxml.dom.minidom and mod:xml.sax modules no longer process\nexternal entities by default.\n(Contributed by Christian Heimes in bpo-17239.)", "code_blocks": []}, "deprecated - deprecated-functions-and-types-of-the-c-api": {"text": "Deprecated functions and types of the C API\n\nUndocumented functions PyUnicode_AsEncodedObject(),\nPyUnicode_AsDecodedObject(), PyUnicode_AsEncodedUnicode()\nand PyUnicode_AsDecodedUnicode() are deprecated now.\nUse the generic codec based API instead.", "code_blocks": []}, "deprecated - deprecated-build-options": {"text": "Deprecated Build Options\n\nThe --with-system-ffi configure flag is now on by default on non-macOS\nUNIX platforms.  It may be disabled by using --without-system-ffi, but\nusing the flag is deprecated and will not be accepted in Python 3.7.\nmacOS is unaffected by this change.  Note that many OS distributors already\nuse the --with-system-ffi flag when building their system Python.", "code_blocks": []}, "removed - api-and-feature-removals": {"text": "API and Feature Removals\n\n\nUnknown escapes consisting of '\\' and an ASCII letter in\nregular expressions will now cause an error.  In replacement templates for\nre.sub() they are still allowed, but deprecated.\nThe re.LOCALE flag can now only be used with binary patterns.\ninspect.getmoduleinfo() was removed (was deprecated since CPython 3.3).\ninspect.getmodulename() should be used for obtaining the module\nname for a given path.\n(Contributed by Yury Selivanov in bpo-13248.)\ntraceback.Ignore class and traceback.usage, traceback.modname,\ntraceback.fullmodname, traceback.find_lines_from_code,\ntraceback.find_lines, traceback.find_strings,\ntraceback.find_executable_lines methods were removed from the\ntraceback module. They were undocumented methods deprecated since\nPython 3.2 and equivalent functionality is available from private methods.\nThe tk_menuBar() and tk_bindForTraversal() dummy methods in\ntkinter widget classes were removed (corresponding Tk commands\nwere obsolete since Tk 4.0).\nThe open() method of the zipfile.ZipFile\nclass no longer supports the 'U' mode (was deprecated since Python 3.4).\nUse io.TextIOWrapper for reading compressed text files in\nuniversal newlines mode.\nThe undocumented IN, CDROM, DLFCN, TYPES, CDIO, and\nSTROPTS modules have been removed.  They had been available in the\nplatform specific Lib/plat-*/ directories, but were chronically out of\ndate, inconsistently available across platforms, and unmaintained.  The\nscript that created these modules is still available in the source\ndistribution at Tools/scripts/h2py.py.\nThe deprecated asynchat.fifo class has been removed.", "code_blocks": []}, "porting-to-python-3-6 - changes-in-python-command-behavior": {"text": "Changes in ‘python’ Command Behavior\n\n\nThe output of a special Python build with defined COUNT_ALLOCS,\nSHOW_ALLOC_COUNT or SHOW_TRACK_COUNT macros is now off by\ndefault.  It can be re-enabled using the -X showalloccount option.\nIt now outputs to stderr instead of stdout.\n(Contributed by Serhiy Storchaka in bpo-23034.)", "code_blocks": []}, "porting-to-python-3-6 - changes-in-the-python-api": {"text": "Changes in the Python API\n\n\nopen() will no longer allow combining the 'U' mode flag\nwith '+'.\n(Contributed by Jeff Balogh and John O’Connor in bpo-2091.)\nsqlite3 no longer implicitly commits an open transaction before DDL\nstatements.\nOn Linux, os.urandom() now blocks until the system urandom entropy pool\nis initialized to increase the security.\nWhen importlib.abc.Loader.exec_module() is defined,\nimportlib.abc.Loader.create_module() must also be defined.\nPyErr_SetImportError() now sets TypeError when its msg\nargument is not set. Previously only NULL was returned.\nThe format of the co_lnotab attribute of code objects changed to support\na negative line number delta. By default, Python does not emit bytecode with\na negative line number delta. Functions using frame.f_lineno,\nPyFrame_GetLineNumber() or PyCode_Addr2Line() are not affected.\nFunctions directly decoding co_lnotab should be updated to use a signed\n8-bit integer type for the line number delta, but this is only required to\nsupport applications using a negative line number delta. See\nObjects/lnotab_notes.txt for the co_lnotab format and how to decode\nit, and see the PEP 511 for the rationale.\nThe functions in the compileall module now return booleans instead\nof 1 or 0 to represent success or failure, respectively. Thanks to\nbooleans being a subclass of integers, this should only be an issue if you\nwere doing identity checks for 1 or 0. See bpo-25768.\nReading the port attribute of\nurllib.parse.urlsplit() and urlparse() results\nnow raises ValueError for out-of-range values, rather than\nreturning None.  See bpo-20059.\nThe imp module now raises a DeprecationWarning instead of\nPendingDeprecationWarning.\nThe following modules have had missing APIs added to their __all__\nattributes to match the documented APIs:\ncalendar, cgi, csv,\nElementTree, enum,\nfileinput, ftplib, logging, mailbox,\nmimetypes, optparse, plistlib, smtpd,\nsubprocess, tarfile, threading and\nwave.  This means they will export new symbols when import *\nis used.\n(Contributed by Joel Taddei and Jacek Kołodziej in bpo-23883.)\nWhen performing a relative import, if __package__ does not compare equal\nto __spec__.parent then ImportWarning is raised.\n(Contributed by Brett Cannon in bpo-25791.)\nWhen a relative import is performed and no parent package is known, then\nImportError will be raised. Previously, SystemError could be\nraised. (Contributed by Brett Cannon in bpo-18018.)\nServers based on the socketserver module, including those\ndefined in http.server, xmlrpc.server and\nwsgiref.simple_server, now only catch exceptions derived\nfrom Exception. Therefore if a request handler raises\nan exception like SystemExit or KeyboardInterrupt,\nhandle_error() is no longer called, and\nthe exception will stop a single-threaded server. (Contributed by\nMartin Panter in bpo-23430.)\nspwd.getspnam() now raises a PermissionError instead of\nKeyError if the user doesn’t have privileges.\nThe socket.socket.close() method now raises an exception if\nan error (e.g. EBADF) was reported by the underlying system call.\n(Contributed by Martin Panter in bpo-26685.)\nThe decode_data argument for the smtpd.SMTPChannel and\nsmtpd.SMTPServer constructors is now False by default.\nThis means that the argument passed to\nprocess_message() is now a bytes object by\ndefault, and process_message() will be passed keyword arguments.\nCode that has already been updated in accordance with the deprecation\nwarning generated by 3.5 will not be affected.\nAll optional arguments of the dump(), dumps(),\nload() and loads() functions and\nJSONEncoder and JSONDecoder class\nconstructors in the json module are now keyword-only.\n(Contributed by Serhiy Storchaka in bpo-18726.)\nSubclasses of type which don’t override type.__new__ may no\nlonger use the one-argument form to get the type of an object.\nAs part of PEP 487, the handling of keyword arguments passed to\ntype (other than the metaclass hint, metaclass) is now\nconsistently delegated to object.__init_subclass__(). This means that\ntype.__new__() and type.__init__() both now accept arbitrary\nkeyword arguments, but object.__init_subclass__() (which is called from\ntype.__new__()) will reject them by default. Custom metaclasses\naccepting additional keyword arguments will need to adjust their calls to\ntype.__new__() (whether direct or via super) accordingly.\nIn distutils.command.sdist.sdist, the default_format\nattribute has been removed and is no longer honored. Instead, the\ngzipped tarfile format is the default on all platforms and no\nplatform-specific selection is made.\nIn environments where distributions are\nbuilt on Windows and zip distributions are required, configure\nthe project with a setup.cfg file containing the following:\n[sdist]\nformats=zip\n\n\nThis behavior has also been backported to earlier Python versions\nby Setuptools 26.0.0.\n\nIn the urllib.request module and the\nhttp.client.HTTPConnection.request() method, if no Content-Length\nheader field has been specified and the request body is a file object,\nit is now sent with HTTP 1.1 chunked encoding. If a file object has to\nbe sent to a HTTP 1.0 server, the Content-Length value now has to be\nspecified by the caller.\n(Contributed by Demian Brecht and Rolf Krahl with tweaks from\nMartin Panter in bpo-12319.)\nThe DictReader now returns rows of type\nOrderedDict.\n(Contributed by Steve Holden in bpo-27842.)\nThe crypt.METHOD_CRYPT will no longer be added to crypt.methods\nif unsupported by the platform.\n(Contributed by Victor Stinner in bpo-25287.)\nThe verbose and rename arguments for\nnamedtuple() are now keyword-only.\n(Contributed by Raymond Hettinger in bpo-25628.)\nOn Linux, ctypes.util.find_library() now looks in\nLD_LIBRARY_PATH for shared libraries.\n(Contributed by Vinay Sajip in bpo-9998.)\nThe imaplib.IMAP4 class now handles flags containing the\n']' character in messages sent from the server to improve\nreal-world compatibility.\n(Contributed by Lita Cho in bpo-21815.)\nThe mmap.write() function now returns the number\nof bytes written like other write methods.\n(Contributed by Jakub Stasiak in bpo-26335.)\nThe pkgutil.iter_modules() and pkgutil.walk_packages()\nfunctions now return ModuleInfo named tuples.\n(Contributed by Ramchandra Apte in bpo-17211.)\nre.sub() now raises an error for invalid numerical group\nreferences in replacement templates even if the pattern is not\nfound in the string.  The error message for invalid group references\nnow includes the group index and the position of the reference.\n(Contributed by SilentGhost, Serhiy Storchaka in bpo-25953.)\nzipfile.ZipFile will now raise NotImplementedError for\nunrecognized compression values.  Previously a plain RuntimeError\nwas raised.  Additionally, calling ZipFile methods\non a closed ZipFile or calling the write() method\non a ZipFile created with mode 'r' will raise a ValueError.\nPreviously, a RuntimeError was raised in those scenarios.\nwhen custom metaclasses are combined with zero-argument super() or\ndirect references from methods to the implicit __class__ closure\nvariable, the implicit __classcell__ namespace entry must now be passed\nup to type.__new__ for initialisation. Failing to do so will result in\na DeprecationWarning in Python 3.6 and a RuntimeError in\nPython 3.8.\nWith the introduction of ModuleNotFoundError, import system consumers\nmay start expecting import system replacements to raise that more specific\nexception when appropriate, rather than the less-specific ImportError.\nTo provide future compatibility with such consumers, implementors of\nalternative import systems that completely replace __import__() will\nneed to update their implementations to raise the new subclass when a module\ncan’t be found at all. Implementors of compliant plugins to the default\nimport system shouldn’t need to make any changes, as the default import\nsystem will raise the new subclass when appropriate.", "code_blocks": ["[sdist]\nformats=zip\n"]}, "porting-to-python-3-6 - changes-in-the-c-api": {"text": "Changes in the C API\n\n\nThe PyMem_Malloc() allocator family now uses the pymalloc allocator rather than the system malloc(). Applications calling\nPyMem_Malloc() without holding the GIL can now crash. Set the\nPYTHONMALLOC environment variable to debug to validate the\nusage of memory allocators in your application. See bpo-26249.\nPy_Exit() (and the main interpreter) now override the exit status\nwith 120 if flushing buffered data failed.  See bpo-5319.", "code_blocks": []}, "porting-to-python-3-6 - cpython-bytecode-changes": {"text": "CPython bytecode changes\n\nThere have been several major changes to the bytecode in Python 3.6.\n\nThe Python interpreter now uses a 16-bit wordcode instead of bytecode.\n(Contributed by Demur Rumed with input and reviews from\nSerhiy Storchaka and Victor Stinner in bpo-26647 and bpo-28050.)\nThe new FORMAT_VALUE and BUILD_STRING opcodes as part\nof the  formatted string literal implementation.\n(Contributed by Eric Smith in bpo-25483 and\nSerhiy Storchaka in bpo-27078.)\nThe new BUILD_CONST_KEY_MAP opcode to optimize the creation\nof dictionaries with constant keys.\n(Contributed by Serhiy Storchaka in bpo-27140.)\nThe function call opcodes have been heavily reworked for better performance\nand simpler implementation.\nThe MAKE_FUNCTION, CALL_FUNCTION,\nCALL_FUNCTION_KW and BUILD_MAP_UNPACK_WITH_CALL opcodes\nhave been modified, the new CALL_FUNCTION_EX and\nBUILD_TUPLE_UNPACK_WITH_CALL have been added, and\nCALL_FUNCTION_VAR, CALL_FUNCTION_VAR_KW and MAKE_CLOSURE opcodes\nhave been removed.\n(Contributed by Demur Rumed in bpo-27095, and Serhiy Storchaka in\nbpo-27213, bpo-28257.)\nThe new SETUP_ANNOTATIONS and STORE_ANNOTATION opcodes\nhave been added to support the new variable annotation syntax.\n(Contributed by Ivan Levkivskyi in bpo-27985.)", "code_blocks": []}, "notable-changes-in-python-3-6-2 - new-make-regen-all-build-target": {"text": "New make regen-all build target\n\nTo simplify cross-compilation, and to ensure that CPython can reliably be\ncompiled without requiring an existing version of Python to already be\navailable, the autotools-based build system no longer attempts to implicitly\nrecompile generated files based on file modification times.\nInstead, a new make regen-all command has been added to force regeneration\nof these files when desired (e.g. after an initial version of Python has\nalready been built based on the pregenerated versions).\nMore selective regeneration targets are also defined - see\nMakefile.pre.in for details.\n(Contributed by Victor Stinner in bpo-23404.)\n\nNew in version 3.6.2.", "code_blocks": []}, "notable-changes-in-python-3-6-2 - removal-of-make-touch-build-target": {"text": "Removal of make touch build target\n\nThe make touch build target previously used to request implicit regeneration\nof generated files by updating their modification times has been removed.\nIt has been replaced by the new make regen-all target.\n(Contributed by Victor Stinner in bpo-23404.)\n\nChanged in version 3.6.2.", "code_blocks": []}, "notable-changes-in-python-3-6-4": {"text": "Notable changes in Python 3.6.4\n\nThe PyExc_RecursionErrorInst singleton that was part of the public API\nhas been removed as its members being never cleared may cause a segfault\nduring finalization of the interpreter.\n(Contributed by Xavier de Gaye in bpo-22898 and bpo-30697.)", "code_blocks": []}, "notable-changes-in-python-3-6-5": {"text": "Notable changes in Python 3.6.5\n\nThe locale.localeconv() function now sets temporarily the LC_CTYPE\nlocale to the LC_NUMERIC locale in some cases.\n(Contributed by Victor Stinner in bpo-31900.)", "code_blocks": []}, "notable-changes-in-python-3-6-7": {"text": "Notable changes in Python 3.6.7\n\nxml.dom.minidom and mod:xml.sax modules no longer process\nexternal entities by default. See also bpo-17239.\nIn 3.6.7 the tokenize module now implicitly emits a NEWLINE token\nwhen provided with input that does not have a trailing new line.  This behavior\nnow matches what the C tokenizer does internally.\n(Contributed by Ammar Askar in bpo-33899.)", "code_blocks": []}, "notable-changes-in-python-3-6-10": {"text": "Notable changes in Python 3.6.10\n\nDue to significant security concerns, the reuse_address parameter of\nasyncio.loop.create_datagram_endpoint() is no longer supported. This is\nbecause of the behavior of the socket option SO_REUSEADDR in UDP. For more\ndetails, see the documentation for loop.create_datagram_endpoint().\n(Contributed by Kyle Stanley, Antoine Pitrou, and Yury Selivanov in\nbpo-37228.)", "code_blocks": []}, "notable-changes-in-python-3-6-13": {"text": "Notable changes in Python 3.6.13\n\nEarlier Python versions allowed using both ; and & as\nquery parameter separators in urllib.parse.parse_qs() and\nurllib.parse.parse_qsl().  Due to security concerns, and to conform with\nnewer W3C recommendations, this has been changed to allow only a single\nseparator key, with & as the default.  This change also affects\ncgi.parse() and cgi.parse_multipart() as they use the affected\nfunctions internally. For more details, please see their respective\ndocumentation.\n(Contributed by Adam Goldschmidt, Senthil Kumaran and Ken Jin in bpo-42967.)", "code_blocks": []}, "notable-changes-in-python-3-6-14": {"text": "Notable changes in Python 3.6.14\n\nA security fix alters the ftplib.FTP behavior to not trust the\nIPv4 address sent from the remote server when setting up a passive data\nchannel.  We reuse the ftp server IP address instead.  For unusual code\nrequiring the old behavior, set a trust_server_pasv_ipv4_address\nattribute on your FTP instance to True.  (See bpo-43285)\nThe presence of newline or tab characters in parts of a URL allows for some\nforms of attacks. Following the WHATWG specification that updates RFC 3986,\nASCII newline \\n, \\r and tab \\t characters are stripped from the\nURL by the parser urllib.parse() preventing such attacks. The removal\ncharacters are controlled by a new module level variable\nurllib.parse._UNSAFE_URL_BYTES_TO_REMOVE. (See bpo-43882)", "code_blocks": []}}}
{"index": 9, "python_version": "3.7", "url": "https://docs.python.org/3.7/whatsnew/3.7.html", "sections": {"summary-release-highlights": {"text": "Summary – Release Highlights\n\nNew syntax features:\n\nPEP 563, postponed evaluation of type annotations.\n\nBackwards incompatible syntax changes:\n\nasync and await are now reserved keywords.\n\nNew library modules:\n\ncontextvars: PEP 567 – Context Variables\ndataclasses: PEP 557 – Data Classes\nimportlib.resources\n\nNew built-in features:\n\nPEP 553, the new breakpoint() function.\n\nPython data model improvements:\n\nPEP 562, customization of access to\nmodule attributes.\nPEP 560, core support for typing module and\ngeneric types.\nthe insertion-order preservation nature of dict\nobjects has been declared to be an official\npart of the Python language spec.\n\nSignificant improvements in the standard library:\n\nThe asyncio module has received new features, significant\nusability and performance improvements.\nThe time module gained support for\nfunctions with nanosecond resolution.\n\nCPython implementation improvements:\n\nAvoiding the use of ASCII as a default text encoding:\n\nPEP 538, legacy C locale coercion\nPEP 540, forced UTF-8 runtime mode\n\n\nPEP 552, deterministic .pycs\nthe new development runtime mode\nPEP 565, improved DeprecationWarning\nhandling\n\nC API improvements:\n\nPEP 539, new C API for thread-local storage\n\nDocumentation improvements:\n\nPEP 545, Python documentation translations\nNew documentation translations: Japanese,\nFrench, and\nKorean.\n\nThis release features notable performance improvements in many areas.\nThe Optimizations section lists them in detail.\nFor a list of changes that may affect compatibility with previous Python\nreleases please refer to the Porting to Python 3.7 section.", "code_blocks": []}, "new-features - pep-563-postponed-evaluation-of-annotations": {"text": "PEP 563: Postponed Evaluation of Annotations\n\nThe advent of type hints in Python uncovered two glaring usability issues\nwith the functionality of annotations added in PEP 3107 and refined\nfurther in PEP 526:\n\nannotations could only use names which were already available in the\ncurrent scope, in other words they didn’t support forward references\nof any kind; and\nannotating source code had adverse effects on startup time of Python\nprograms.\n\nBoth of these issues are fixed by postponing the evaluation of\nannotations.  Instead of compiling code which executes expressions in\nannotations at their definition time, the compiler stores the annotation\nin a string form equivalent to the AST of the expression in question.\nIf needed, annotations can be resolved at runtime using\ntyping.get_type_hints().  In the common case where this is not\nrequired, the annotations are cheaper to store (since short strings\nare interned by the interpreter) and make startup time faster.\nUsability-wise, annotations now support forward references, making the\nfollowing syntax valid:\nclass C:\n    @classmethod\n    def from_string(cls, source: str) -> C:\n        ...\n\n    def validate_b(self, obj: B) -> bool:\n        ...\n\nclass B:\n    ...\n\n\nSince this change breaks compatibility, the new behavior needs to be enabled\non a per-module basis in Python 3.7 using a __future__ import:\nfrom __future__ import annotations\n\n\nIt will become the default in Python 3.10.\n\nSee also\n\nPEP 563 – Postponed evaluation of annotationsPEP written and implemented by Łukasz Langa.", "code_blocks": ["class C:\n    @classmethod\n    def from_string(cls, source: str) -> C:\n        ...\n\n    def validate_b(self, obj: B) -> bool:\n        ...\n\nclass B:\n    ...\n", "from __future__ import annotations\n"]}, "new-features - pep-538-legacy-c-locale-coercion": {"text": "PEP 538: Legacy C Locale Coercion\n\nAn ongoing challenge within the Python 3 series has been determining a sensible\ndefault strategy for handling the “7-bit ASCII” text encoding assumption\ncurrently implied by the use of the default C or POSIX locale on non-Windows\nplatforms.\nPEP 538 updates the default interpreter command line interface to\nautomatically coerce that locale to an available UTF-8 based locale as\ndescribed in the documentation of the new PYTHONCOERCECLOCALE\nenvironment variable. Automatically setting LC_CTYPE this way means that\nboth the core interpreter and locale-aware C extensions (such as\nreadline) will assume the use of UTF-8 as the default text encoding,\nrather than ASCII.\nThe platform support definition in PEP 11 has also been updated to limit\nfull text handling support to suitably configured non-ASCII based locales.\nAs part of this change, the default error handler for stdin and\nstdout is now surrogateescape (rather than strict) when\nusing any of the defined coercion target locales (currently C.UTF-8,\nC.utf8, and UTF-8).  The default error handler for stderr\ncontinues to be backslashreplace, regardless of locale.\nLocale coercion is silent by default, but to assist in debugging potentially\nlocale related integration problems, explicit warnings (emitted directly on\nstderr) can be requested by setting PYTHONCOERCECLOCALE=warn.\nThis setting will also cause the Python runtime to emit a warning if the\nlegacy C locale remains active when the core interpreter is initialized.\nWhile PEP 538’s locale coercion has the benefit of also affecting extension\nmodules (such as GNU readline), as well as child processes (including those\nrunning non-Python applications and older versions of Python), it has the\ndownside of requiring that a suitable target locale be present on the running\nsystem. To better handle the case where no suitable target locale is available\n(as occurs on RHEL/CentOS 7, for example), Python 3.7 also implements\nPEP 540: Forced UTF-8 Runtime Mode.\n\nSee also\n\nPEP 538 – Coercing the legacy C locale to a UTF-8 based localePEP written and implemented by Nick Coghlan.", "code_blocks": []}, "new-features - pep-540-forced-utf-8-runtime-mode": {"text": "PEP 540: Forced UTF-8 Runtime Mode\n\nThe new -X utf8 command line option and PYTHONUTF8\nenvironment variable can be used to enable the CPython UTF-8 mode.\nWhen in UTF-8 mode, CPython ignores the locale settings, and uses the\nUTF-8 encoding by default.  The error handlers for sys.stdin and\nsys.stdout streams are set to surrogateescape.\nThe forced UTF-8 mode can be used to change the text handling behavior in\nan embedded Python interpreter without changing the locale settings of\nan embedding application.\nWhile PEP 540’s UTF-8 mode has the benefit of working regardless of which\nlocales are available on the running system, it has the downside of having no\neffect on extension modules (such as GNU readline), child processes running\nnon-Python applications, and child processes running older versions of Python.\nTo reduce the risk of corrupting text data when communicating with such\ncomponents, Python 3.7 also implements PEP 540: Forced UTF-8 Runtime Mode).\nThe UTF-8 mode is enabled by default when the locale is C or POSIX, and\nthe PEP 538 locale coercion feature fails to change it to a UTF-8 based\nalternative (whether that failure is due to PYTHONCOERCECLOCALE=0 being set,\nLC_ALL being set, or the lack of a suitable target locale).\n\nSee also\n\nPEP 540 – Add a new UTF-8 modePEP written and implemented by Victor Stinner", "code_blocks": []}, "new-features - pep-553-built-in-breakpoint": {"text": "PEP 553: Built-in breakpoint()\n\nPython 3.7 includes the new built-in breakpoint() function as\nan easy and consistent way to enter the Python debugger.\nBuilt-in breakpoint() calls sys.breakpointhook().  By default, the\nlatter imports pdb and then calls pdb.set_trace(), but by binding\nsys.breakpointhook() to the function of your choosing, breakpoint() can\nenter any debugger. Additionally, the environment variable\nPYTHONBREAKPOINT can be set to the callable of your debugger of\nchoice.  Set PYTHONBREAKPOINT=0 to completely disable built-in\nbreakpoint().\n\nSee also\n\nPEP 553 – Built-in breakpoint()PEP written and implemented by Barry Warsaw", "code_blocks": []}, "new-features - pep-539-new-c-api-for-thread-local-storage": {"text": "PEP 539: New C API for Thread-Local Storage\n\nWhile Python provides a C API for thread-local storage support; the existing\nThread Local Storage (TLS) API has used\nint to represent TLS keys across all platforms.  This has not\ngenerally been a problem for officially-support platforms, but that is neither\nPOSIX-compliant, nor portable in any practical sense.\nPEP 539 changes this by providing a new Thread Specific Storage (TSS)\nAPI to CPython which supersedes use of the\nexisting TLS API within the CPython interpreter, while deprecating the existing\nAPI.  The TSS API uses a new type Py_tss_t instead of int\nto represent TSS keys–an opaque type the definition of which may depend on\nthe underlying TLS implementation.  Therefore, this will allow to build CPython\non platforms where the native TLS key is defined in a way that cannot be safely\ncast to int.\nNote that on platforms where the native TLS key is defined in a way that cannot\nbe safely cast to int, all functions of the existing TLS API will be\nno-op and immediately return failure. This indicates clearly that the old API\nis not supported on platforms where it cannot be used reliably, and that no\neffort will be made to add such support.\n\nSee also\n\nPEP 539 – A New C-API for Thread-Local Storage in CPythonPEP written by Erik M. Bray; implementation by Masayuki Yamamoto.", "code_blocks": []}, "new-features - pep-562-customization-of-access-to-module-attributes": {"text": "PEP 562: Customization of Access to Module Attributes\n\nPython 3.7 allows defining __getattr__() on modules and will call\nit whenever a module attribute is otherwise not found.  Defining\n__dir__() on modules is now also allowed.\nA typical example of where this may be useful is module attribute deprecation\nand lazy loading.\n\nSee also\n\nPEP 562 – Module __getattr__ and __dir__PEP written and implemented by Ivan Levkivskyi", "code_blocks": []}, "new-features - pep-564-new-time-functions-with-nanosecond-resolution": {"text": "PEP 564: New Time Functions With Nanosecond Resolution\n\nThe resolution of clocks in modern systems can exceed the limited precision\nof a floating point number returned by the time.time() function\nand its variants.  To avoid loss of precision, PEP 564 adds six new\n“nanosecond” variants of the existing timer functions to the time\nmodule:\n\ntime.clock_gettime_ns()\ntime.clock_settime_ns()\ntime.monotonic_ns()\ntime.perf_counter_ns()\ntime.process_time_ns()\ntime.time_ns()\n\nThe new functions return the number of nanoseconds as an integer value.\nMeasurements\nshow that on Linux and Windows the resolution of time.time_ns() is\napproximately 3 times better than that of time.time().\n\nSee also\n\nPEP 564 – Add new time functions with nanosecond resolutionPEP written and implemented by Victor Stinner", "code_blocks": []}, "new-features - pep-565-show-deprecationwarning-in-main": {"text": "PEP 565: Show DeprecationWarning in __main__\n\nThe default handling of DeprecationWarning has been changed such that\nthese warnings are once more shown by default, but only when the code\ntriggering them is running directly in the __main__ module.  As a result,\ndevelopers of single file scripts and those using Python interactively should\nonce again start seeing deprecation warnings for the APIs they use, but\ndeprecation warnings triggered by imported application, library and framework\nmodules will continue to be hidden by default.\nAs a result of this change, the standard library now allows developers to choose\nbetween three different deprecation warning behaviours:\n\nFutureWarning: always displayed by default, recommended for warnings\nintended to be seen by application end users (e.g. for deprecated application\nconfiguration settings).\nDeprecationWarning: displayed by default only in __main__ and when\nrunning tests, recommended for warnings intended to be seen by other Python\ndevelopers where a version upgrade may result in changed behaviour or an\nerror.\nPendingDeprecationWarning: displayed by default only when running\ntests, intended for cases where a future version upgrade will change the\nwarning category to DeprecationWarning or FutureWarning.\n\nPreviously both DeprecationWarning and PendingDeprecationWarning\nwere only visible when running tests, which meant that developers primarily\nwriting single file scripts or using Python interactively could be surprised\nby breaking changes in the APIs they used.\n\nSee also\n\nPEP 565 – Show DeprecationWarning in __main__PEP written and implemented by Nick Coghlan", "code_blocks": []}, "new-features - pep-560-core-support-for-typing-module-and-generic-types": {"text": "PEP 560: Core Support for typing module and Generic Types\n\nInitially PEP 484 was designed in such way that it would not introduce any\nchanges to the core CPython interpreter. Now type hints and the typing\nmodule are extensively used by the community, so this restriction is removed.\nThe PEP introduces two special methods __class_getitem__() and\n__mro_entries__, these methods are now used by most classes and special\nconstructs in typing. As a result, the speed of various operations\nwith types increased up to 7 times, the generic types can be used without\nmetaclass conflicts, and several long standing bugs in typing module are\nfixed.\n\nSee also\n\nPEP 560 – Core support for typing module and generic typesPEP written and implemented by Ivan Levkivskyi", "code_blocks": []}, "new-features - pep-552-hash-based-pyc-files": {"text": "PEP 552: Hash-based .pyc Files\n\nPython has traditionally checked the up-to-dateness of bytecode cache files\n(i.e., .pyc files) by comparing the source metadata (last-modified timestamp\nand size) with source metadata saved in the cache file header when it was\ngenerated. While effective, this invalidation method has its drawbacks.  When\nfilesystem timestamps are too coarse, Python can miss source updates, leading to\nuser confusion. Additionally, having a timestamp in the cache file is\nproblematic for build reproducibility and\ncontent-based build systems.\nPEP 552 extends the pyc format to allow the hash of the source file to be\nused for invalidation instead of the source timestamp. Such .pyc files are\ncalled “hash-based”. By default, Python still uses timestamp-based invalidation\nand does not generate hash-based .pyc files at runtime. Hash-based .pyc\nfiles may be generated with py_compile or compileall.\nHash-based .pyc files come in two variants: checked and unchecked. Python\nvalidates checked hash-based .pyc files against the corresponding source\nfiles at runtime but doesn’t do so for unchecked hash-based pycs. Unchecked\nhash-based .pyc files are a useful performance optimization for environments\nwhere a system external to Python (e.g., the build system) is responsible for\nkeeping .pyc files up-to-date.\nSee Cached bytecode invalidation for more information.\n\nSee also\n\nPEP 552 – Deterministic pycsPEP written and implemented by Benjamin Peterson", "code_blocks": []}, "new-features - pep-545-python-documentation-translations": {"text": "PEP 545: Python Documentation Translations\n\nPEP 545 describes the process of creating and maintaining Python\ndocumentation translations.\nThree new translations have been added:\n\nJapanese: https://docs.python.org/ja/\nFrench: https://docs.python.org/fr/\nKorean: https://docs.python.org/ko/\n\n\nSee also\n\nPEP 545 – Python Documentation TranslationsPEP written and implemented by Julien Palard, Inada Naoki, and\nVictor Stinner.", "code_blocks": []}, "new-features - development-runtime-mode-x-dev": {"text": "Development Runtime Mode: -X dev\n\nThe new -X dev command line option or the new\nPYTHONDEVMODE environment variable can be used to enable\nCPython’s development mode.  When in development mode, CPython performs\nadditional runtime checks that are too expensive to be enabled by default.\nSee -X dev documentation for the full description of the effects\nof this mode.", "code_blocks": []}, "other-language-changes": {"text": "Other Language Changes\n\n\nAn await expression and comprehensions containing an\nasync for clause were illegal in the expressions in\nformatted string literals due to a problem with the\nimplementation.  In Python 3.7 this restriction was lifted.\nMore than 255 arguments can now be passed to a function, and a function can\nnow have more than 255 parameters. (Contributed by Serhiy Storchaka in\nbpo-12844 and bpo-18896.)\nbytes.fromhex() and bytearray.fromhex() now ignore all ASCII\nwhitespace, not only spaces. (Contributed by Robert Xiao in bpo-28927.)\nstr, bytes, and bytearray gained support for\nthe new isascii() method, which can be used to\ntest if a string or bytes contain only the ASCII characters.\n(Contributed by INADA Naoki in bpo-32677.)\nImportError now displays module name and module __file__ path when\nfrom ... import ... fails. (Contributed by Matthias Bussonnier in\nbpo-29546.)\nCircular imports involving absolute imports with binding a submodule to\na name are now supported.\n(Contributed by Serhiy Storchaka in bpo-30024.)\nobject.__format__(x, '') is now equivalent to str(x) rather than\nformat(str(self), '').\n(Contributed by Serhiy Storchaka in bpo-28974.)\nIn order to better support dynamic creation of stack traces,\ntypes.TracebackType can now be instantiated from Python code, and\nthe tb_next attribute on tracebacks is now\nwritable.\n(Contributed by Nathaniel J. Smith in bpo-30579.)\nWhen using the -m switch, sys.path[0] is now eagerly expanded\nto the full starting directory path, rather than being left as the empty\ndirectory (which allows imports from the current working directory at the\ntime when an import occurs)\n(Contributed by Nick Coghlan in bpo-33053.)\nThe new -X importtime option or the\nPYTHONPROFILEIMPORTTIME environment variable can be used to show\nthe timing of each module import.\n(Contributed by Victor Stinner in bpo-31415.)", "code_blocks": []}, "new-modules - contextvars": {"text": "contextvars\n\nThe new contextvars module and a set of\nnew C APIs introduce\nsupport for context variables.  Context variables are conceptually\nsimilar to thread-local variables.  Unlike TLS, context variables\nsupport asynchronous code correctly.\nThe asyncio and decimal modules have been updated to use\nand support context variables out of the box.  Particularly the active\ndecimal context is now stored in a context variable, which allows\ndecimal operations to work with the correct context in asynchronous code.\n\nSee also\n\nPEP 567 – Context VariablesPEP written and implemented by Yury Selivanov", "code_blocks": []}, "new-modules - dataclasses": {"text": "dataclasses\n\nThe new dataclass() decorator provides a way to declare\ndata classes.  A data class describes its attributes using class variable\nannotations.  Its constructor and other magic methods, such as\n__repr__(), __eq__(), and\n__hash__() are generated automatically.\nExample:\n@dataclass\nclass Point:\n    x: float\n    y: float\n    z: float = 0.0\n\np = Point(1.5, 2.5)\nprint(p)   # produces \"Point(x=1.5, y=2.5, z=0.0)\"\n\n\n\nSee also\n\nPEP 557 – Data ClassesPEP written and implemented by Eric V. Smith", "code_blocks": ["@dataclass\nclass Point:\n    x: float\n    y: float\n    z: float = 0.0\n\np = Point(1.5, 2.5)\nprint(p)   # produces \"Point(x=1.5, y=2.5, z=0.0)\"\n"]}, "new-modules - importlib-resources": {"text": "importlib.resources\n\nThe new importlib.resources module provides several new APIs and one\nnew ABC for access to, opening, and reading resources inside packages.\nResources are roughly similar to files inside packages, but they needn’t\nbe actual files on the physical file system.  Module loaders can provide a\nget_resource_reader() function which returns\na importlib.abc.ResourceReader instance to support this\nnew API.  Built-in file path loaders and zip file loaders both support this.\nContributed by Barry Warsaw and Brett Cannon in bpo-32248.\n\nSee also\nimportlib_resources\n– a PyPI backport for earlier Python versions.", "code_blocks": []}, "improved-modules - argparse": {"text": "argparse\n\nThe new ArgumentParser.parse_intermixed_args()\nmethod allows intermixing options and positional arguments.\n(Contributed by paul.j3 in bpo-14191.)", "code_blocks": []}, "improved-modules - asyncio": {"text": "asyncio\n\nThe asyncio module has received many new features, usability and\nperformance improvements.  Notable changes\ninclude:\n\nThe new provisional asyncio.run() function can\nbe used to run a coroutine from synchronous code by automatically creating and\ndestroying the event loop.\n(Contributed by Yury Selivanov in bpo-32314.)\nasyncio gained support for contextvars.\nloop.call_soon(),\nloop.call_soon_threadsafe(),\nloop.call_later(),\nloop.call_at(), and\nFuture.add_done_callback()\nhave a new optional keyword-only context parameter.\nTasks now track their context automatically.\nSee PEP 567 for more details.\n(Contributed by Yury Selivanov in bpo-32436.)\nThe new asyncio.create_task() function has been added as a shortcut\nto asyncio.get_event_loop().create_task().\n(Contributed by Andrew Svetlov in bpo-32311.)\nThe new loop.start_tls()\nmethod can be used to upgrade an existing connection to TLS.\n(Contributed by Yury Selivanov in bpo-23749.)\nThe new loop.sock_recv_into()\nmethod allows reading data from a socket directly into a provided buffer making\nit possible to reduce data copies.\n(Contributed by Antoine Pitrou in bpo-31819.)\nThe new asyncio.current_task() function returns the currently running\nTask instance, and the new asyncio.all_tasks()\nfunction returns a set of all existing Task instances in a given loop.\nThe Task.current_task() and\nTask.all_tasks() methods have been deprecated.\n(Contributed by Andrew Svetlov in bpo-32250.)\nThe new provisional BufferedProtocol class allows\nimplementing streaming protocols with manual control over the receive buffer.\n(Contributed by Yury Selivanov in bpo-32251.)\nThe new asyncio.get_running_loop() function returns the currently\nrunning loop, and raises a RuntimeError if no loop is running.\nThis is in contrast with asyncio.get_event_loop(), which will create\na new event loop if none is running.\n(Contributed by Yury Selivanov in bpo-32269.)\nThe new StreamWriter.wait_closed()\ncoroutine method allows waiting until the stream writer is closed.  The new\nStreamWriter.is_closing() method\ncan be used to determine if the writer is closing.\n(Contributed by Andrew Svetlov in bpo-32391.)\nThe new loop.sock_sendfile()\ncoroutine method allows sending files using os.sendfile when possible.\n(Contributed by Andrew Svetlov in bpo-32410.)\nThe new Future.get_loop() and\nTask.get_loop() methods return the instance of the loop on which a task or\na future were created.\nServer.get_loop() allows doing the same for\nasyncio.Server objects.\n(Contributed by Yury Selivanov in bpo-32415 and\nSrinivas Reddy Thatiparthy in bpo-32418.)\nIt is now possible to control how instances of asyncio.Server begin\nserving.  Previously, the server would start serving immediately when created.\nThe new start_serving keyword argument to\nloop.create_server() and\nloop.create_unix_server(),\nas well as Server.start_serving(), and\nServer.serve_forever()\ncan be used to decouple server instantiation and serving.  The new\nServer.is_serving() method returns True\nif the server is serving.  Server objects are now\nasynchronous context managers:\nsrv = await loop.create_server(...)\n\nasync with srv:\n    # some code\n\n# At this point, srv is closed and no longer accepts new connections.\n\n\n(Contributed by Yury Selivanov in bpo-32662.)\n\nCallback objects returned by\nloop.call_later()\ngained the new when() method which\nreturns an absolute scheduled callback timestamp.\n(Contributed by Andrew Svetlov in bpo-32741.)\nThe loop.create_datagram_endpoint()  method\ngained support for Unix sockets.\n(Contributed by Quentin Dawans in bpo-31245.)\nThe asyncio.open_connection(), asyncio.start_server() functions,\nloop.create_connection(),\nloop.create_server(),\nloop.create_accepted_socket()\nmethods and their corresponding UNIX socket variants now accept the\nssl_handshake_timeout keyword argument.\n(Contributed by Neil Aspinall in bpo-29970.)\nThe new Handle.cancelled() method returns\nTrue if the callback was cancelled.\n(Contributed by Marat Sharafutdinov in bpo-31943.)\nThe asyncio source has been converted to use the\nasync/await syntax.\n(Contributed by Andrew Svetlov in bpo-32193.)\nThe new ReadTransport.is_reading()\nmethod can be used to determine the reading state of the transport.\nAdditionally, calls to\nReadTransport.resume_reading()\nand ReadTransport.pause_reading()\nare now idempotent.\n(Contributed by Yury Selivanov in bpo-32356.)\nLoop methods which accept socket paths now support passing\npath-like objects.\n(Contributed by Yury Selivanov in bpo-32066.)\nIn asyncio TCP sockets on Linux are now created with TCP_NODELAY\nflag set by default.\n(Contributed by Yury Selivanov and Victor Stinner in bpo-27456.)\nExceptions occurring in cancelled tasks are no longer logged.\n(Contributed by Yury Selivanov in bpo-30508.)\nNew WindowsSelectorEventLoopPolicy and\nWindowsProactorEventLoopPolicy classes.\n(Contributed by Yury Selivanov in bpo-33792.)\n\nSeveral asyncio APIs have been\ndeprecated.", "code_blocks": ["srv = await loop.create_server(...)\n\nasync with srv:\n    # some code\n\n# At this point, srv is closed and no longer accepts new connections.\n"]}, "improved-modules - binascii": {"text": "binascii\n\nThe b2a_uu() function now accepts an optional backtick\nkeyword argument.  When it’s true, zeros are represented by '`'\ninstead of spaces.  (Contributed by Xiang Zhang in bpo-30103.)", "code_blocks": []}, "improved-modules - calendar": {"text": "calendar\n\nThe HTMLCalendar class has new class attributes which ease\nthe customization of CSS classes in the produced HTML calendar.\n(Contributed by Oz Tiram in bpo-30095.)", "code_blocks": []}, "improved-modules - collections": {"text": "collections\n\ncollections.namedtuple() now supports default values.\n(Contributed by Raymond Hettinger in bpo-32320.)", "code_blocks": []}, "improved-modules - compileall": {"text": "compileall\n\ncompileall.compile_dir() learned the new invalidation_mode parameter,\nwhich can be used to enable\nhash-based .pyc invalidation.  The invalidation\nmode can also be specified on the command line using the new\n--invalidation-mode argument.\n(Contributed by Benjamin Peterson in bpo-31650.)", "code_blocks": []}, "improved-modules - concurrent-futures": {"text": "concurrent.futures\n\nProcessPoolExecutor and\nThreadPoolExecutor now\nsupport the new initializer and initargs constructor arguments.\n(Contributed by Antoine Pitrou in bpo-21423.)\nThe ProcessPoolExecutor\ncan now take the multiprocessing context via the new mp_context argument.\n(Contributed by Thomas Moreau in bpo-31540.)", "code_blocks": []}, "improved-modules - contextlib": {"text": "contextlib\n\nThe new nullcontext() is a simpler and faster no-op\ncontext manager than ExitStack.\n(Contributed by Jesse-Bakker in bpo-10049.)\nThe new asynccontextmanager(),\nAbstractAsyncContextManager, and\nAsyncExitStack have been added to\ncomplement their synchronous counterparts.  (Contributed\nby Jelle Zijlstra in bpo-29679 and bpo-30241,\nand by Alexander Mohr and Ilya Kulakov in bpo-29302.)", "code_blocks": []}, "improved-modules - cprofile": {"text": "cProfile\n\nThe cProfile command line now accepts -m module_name as an\nalternative to script path.  (Contributed by Sanyam Khurana in bpo-21862.)", "code_blocks": []}, "improved-modules - crypt": {"text": "crypt\n\nThe crypt module now supports the Blowfish hashing method.\n(Contributed by Serhiy Storchaka in bpo-31664.)\nThe mksalt() function now allows specifying the number of rounds\nfor hashing.  (Contributed by Serhiy Storchaka in bpo-31702.)", "code_blocks": []}, "improved-modules - datetime": {"text": "datetime\n\nThe new datetime.fromisoformat()\nmethod constructs a datetime object from a string\nin one of the formats output by\ndatetime.isoformat().\n(Contributed by Paul Ganssle in bpo-15873.)\nThe tzinfo class now supports sub-minute offsets.\n(Contributed by Alexander Belopolsky in bpo-5288.)", "code_blocks": []}, "improved-modules - dbm": {"text": "dbm\n\ndbm.dumb now supports reading read-only files and no longer writes the\nindex file when it is not changed.", "code_blocks": []}, "improved-modules - decimal": {"text": "decimal\n\nThe decimal module now uses context variables\nto store the decimal context.\n(Contributed by Yury Selivanov in bpo-32630.)", "code_blocks": []}, "improved-modules - dis": {"text": "dis\n\nThe dis() function is now able to\ndisassemble nested code objects (the code of comprehensions, generator\nexpressions and nested functions, and the code used for building nested\nclasses).  The maximum depth of disassembly recursion is controlled by\nthe new depth parameter.\n(Contributed by Serhiy Storchaka in bpo-11822.)", "code_blocks": []}, "improved-modules - distutils": {"text": "distutils\n\nREADME.rst is now included in the list of distutils standard READMEs and\ntherefore included in source distributions.\n(Contributed by Ryan Gonzalez in bpo-11913.)", "code_blocks": []}, "improved-modules - enum": {"text": "enum\n\nThe Enum learned the new _ignore_ class property,\nwhich allows listing the names of properties which should not become\nenum members.\n(Contributed by Ethan Furman in bpo-31801.)\nIn Python 3.8, attempting to check for non-Enum objects in Enum\nclasses will raise a TypeError (e.g. 1 in Color); similarly,\nattempting to check for non-Flag objects in a Flag member will\nraise TypeError (e.g. 1 in Perm.RW); currently, both operations\nreturn False instead and are deprecated.\n(Contributed by Ethan Furman in bpo-33217.)", "code_blocks": []}, "improved-modules - functools": {"text": "functools\n\nfunctools.singledispatch() now supports registering implementations\nusing type annotations.\n(Contributed by Łukasz Langa in bpo-32227.)", "code_blocks": []}, "improved-modules - gc": {"text": "gc\n\nThe new gc.freeze() function allows freezing all objects tracked\nby the garbage collector and excluding them from future collections.\nThis can be used before a POSIX fork() call to make the GC copy-on-write\nfriendly or to speed up collection.  The new gc.unfreeze() functions\nreverses this operation.  Additionally, gc.get_freeze_count() can\nbe used to obtain the number of frozen objects.\n(Contributed by Li Zekun in bpo-31558.)", "code_blocks": []}, "improved-modules - hmac": {"text": "hmac\n\nThe hmac module now has an optimized one-shot digest()\nfunction, which is up to three times faster than HMAC().\n(Contributed by Christian Heimes in bpo-32433.)", "code_blocks": []}, "improved-modules - http-client": {"text": "http.client\n\nHTTPConnection and HTTPSConnection\nnow support the new blocksize argument for improved upload throughput.\n(Contributed by Nir Soffer in bpo-31945.)", "code_blocks": []}, "improved-modules - http-server": {"text": "http.server\n\nSimpleHTTPRequestHandler now supports the HTTP\nIf-Modified-Since header.  The server returns the 304 response status if\nthe target file was not modified after the time specified in the header.\n(Contributed by Pierre Quentel in bpo-29654.)\nSimpleHTTPRequestHandler accepts the new directory\nargument, in addition to the new --directory command line argument.\nWith this parameter, the server serves the specified directory, by default it\nuses the current working directory.\n(Contributed by Stéphane Wirtel and Julien Palard in bpo-28707.)\nThe new ThreadingHTTPServer class\nuses threads to handle requests using ThreadingMixin.\nIt is used when http.server is run with -m.\n(Contributed by Julien Palard in bpo-31639.)", "code_blocks": []}, "improved-modules - idlelib-and-idle": {"text": "idlelib and IDLE\n\nMultiple fixes for autocompletion. (Contributed by Louie Lu in bpo-15786.)\nModule Browser (on the File menu, formerly called Class Browser),\nnow displays nested functions and classes in addition to top-level\nfunctions and classes.\n(Contributed by Guilherme Polo, Cheryl Sabella, and Terry Jan Reedy\nin bpo-1612262.)\nThe Settings dialog (Options, Configure IDLE) has been partly rewritten\nto improve both appearance and function.\n(Contributed by Cheryl Sabella and Terry Jan Reedy in multiple issues.)\nThe font sample now includes a selection of non-Latin characters so that\nusers can better see the effect of selecting a particular font.\n(Contributed by Terry Jan Reedy in bpo-13802.)\nThe sample can be edited to include other characters.\n(Contributed by Serhiy Storchaka in bpo-31860.)\nThe IDLE features formerly implemented as extensions have been reimplemented\nas normal features.  Their settings have been moved from the Extensions tab\nto other dialog tabs.\n(Contributed by Charles Wohlganger and Terry Jan Reedy in bpo-27099.)\nEditor code context option revised.  Box displays all context lines up to\nmaxlines.  Clicking on a context line jumps the editor to that line.  Context\ncolors for custom themes is added to Highlights tab of Settings dialog.\n(Contributed by Cheryl Sabella and Terry Jan Reedy in bpo-33642,\nbpo-33768, and bpo-33679.)\nOn Windows, a new API call tells Windows that tk scales for DPI. On Windows\n8.1+ or 10, with DPI compatibility properties of the Python binary\nunchanged, and a monitor resolution greater than 96 DPI, this should\nmake text and lines sharper.  It should otherwise have no effect.\n(Contributed by Terry Jan Reedy in bpo-33656.)\nNew in 3.7.1:\nOutput over N lines (50 by default) is squeezed down to a button.\nN can be changed in the PyShell section of the General page of the\nSettings dialog.  Fewer, but possibly extra long, lines can be squeezed by\nright clicking on the output.  Squeezed output can be expanded in place\nby double-clicking the button or into the clipboard or a separate window\nby right-clicking the button.  (Contributed by Tal Einat in bpo-1529353.)\nThe changes above have been backported to 3.6 maintenance releases.\nNEW in 3.7.4:\nAdd “Run Customized” to the Run menu to run a module with customized\nsettings. Any command line arguments entered are added to sys.argv.\nThey re-appear in the box for the next customized run.  One can also\nsuppress the normal Shell main module restart.  (Contributed by Cheryl\nSabella, Terry Jan Reedy, and others in bpo-5680 and bpo-37627.)\nNew in 3.7.5:\nAdd optional line numbers for IDLE editor windows. Windows\nopen without line numbers unless set otherwise in the General\ntab of the configuration dialog.  Line numbers for an existing\nwindow are shown and hidden in the Options menu.\n(Contributed by Tal Einat and Saimadhav Heblikar in bpo-17535.)", "code_blocks": []}, "improved-modules - importlib": {"text": "importlib\n\nThe importlib.abc.ResourceReader ABC was introduced to\nsupport the loading of resources from packages.  See also\nimportlib.resources.\n(Contributed by Barry Warsaw, Brett Cannon in bpo-32248.)\nimportlib.reload() now raises ModuleNotFoundError if the module\nlacks a spec.\n(Contributed by Garvit Khatri in bpo-29851.)\nimportlib.find_spec() now raises ModuleNotFoundError instead of\nAttributeError if the specified parent module is not a package (i.e.\nlacks a __path__ attribute).\n(Contributed by Milan Oberkirch in bpo-30436.)\nThe new importlib.source_hash() can be used to compute the hash of\nthe passed source.  A hash-based .pyc file\nembeds the value returned by this function.", "code_blocks": []}, "improved-modules - io": {"text": "io\n\nThe new TextIOWrapper.reconfigure()\nmethod can be used to reconfigure the text stream with the new settings.\n(Contributed by Antoine Pitrou in bpo-30526 and\nINADA Naoki in bpo-15216.)", "code_blocks": []}, "improved-modules - ipaddress": {"text": "ipaddress\n\nThe new subnet_of() and supernet_of() methods of\nipaddress.IPv6Network and ipaddress.IPv4Network can\nbe used for network containment tests.\n(Contributed by Michel Albert and Cheryl Sabella in bpo-20825.)", "code_blocks": []}, "improved-modules - itertools": {"text": "itertools\n\nitertools.islice() now accepts\ninteger-like objects as start, stop,\nand slice arguments.\n(Contributed by Will Roberts in bpo-30537.)", "code_blocks": []}, "improved-modules - locale": {"text": "locale\n\nThe new monetary argument to locale.format_string() can be used\nto make the conversion use monetary thousands separators and\ngrouping strings.  (Contributed by Garvit in bpo-10379.)\nThe locale.getpreferredencoding() function now always returns 'UTF-8'\non Android or when in the forced UTF-8 mode.", "code_blocks": []}, "improved-modules - logging": {"text": "logging\n\nLogger instances can now be pickled.\n(Contributed by Vinay Sajip in bpo-30520.)\nThe new StreamHandler.setStream()\nmethod can be used to replace the logger stream after handler creation.\n(Contributed by Vinay Sajip in bpo-30522.)\nIt is now possible to specify keyword arguments to handler constructors in\nconfiguration passed to logging.config.fileConfig().\n(Contributed by Preston Landers in bpo-31080.)", "code_blocks": []}, "improved-modules - math": {"text": "math\n\nThe new math.remainder() function implements the IEEE 754-style remainder\noperation.  (Contributed by Mark Dickinson in bpo-29962.)", "code_blocks": []}, "improved-modules - mimetypes": {"text": "mimetypes\n\nThe MIME type of .bmp has been changed from 'image/x-ms-bmp' to\n'image/bmp'.\n(Contributed by Nitish Chandra in bpo-22589.)", "code_blocks": []}, "improved-modules - msilib": {"text": "msilib\n\nThe new Database.Close() method can be used\nto close the MSI database.\n(Contributed by Berker Peksag in bpo-20486.)", "code_blocks": []}, "improved-modules - multiprocessing": {"text": "multiprocessing\n\nThe new Process.close() method\nexplicitly closes the process object and releases all resources associated\nwith it.  ValueError is raised if the underlying process is still\nrunning.\n(Contributed by Antoine Pitrou in bpo-30596.)\nThe new Process.kill() method can\nbe used to terminate the process using the SIGKILL signal on Unix.\n(Contributed by Vitor Pereira in bpo-30794.)\nNon-daemonic threads created by Process are now\njoined on process exit.\n(Contributed by Antoine Pitrou in bpo-18966.)", "code_blocks": []}, "improved-modules - os": {"text": "os\n\nos.fwalk() now accepts the path argument as bytes.\n(Contributed by Serhiy Storchaka in bpo-28682.)\nos.scandir() gained support for file descriptors.\n(Contributed by Serhiy Storchaka in bpo-25996.)\nThe new register_at_fork() function allows registering Python\ncallbacks to be executed at process fork.\n(Contributed by Antoine Pitrou in bpo-16500.)\nAdded os.preadv() (combine the functionality of os.readv() and\nos.pread()) and os.pwritev() functions (combine the functionality\nof os.writev() and os.pwrite()). (Contributed by Pablo Galindo in\nbpo-31368.)\nThe mode argument of os.makedirs() no longer affects the file\npermission bits of newly-created intermediate-level directories.\n(Contributed by Serhiy Storchaka in bpo-19930.)\nos.dup2() now returns the new file descriptor.  Previously, None\nwas always returned.\n(Contributed by Benjamin Peterson in bpo-32441.)\nThe structure returned by os.stat() now contains the\nst_fstype attribute on Solaris and its derivatives.\n(Contributed by Jesús Cea Avión in bpo-32659.)", "code_blocks": []}, "improved-modules - pathlib": {"text": "pathlib\n\nThe new Path.is_mount() method is now available\non POSIX systems and can be used to determine whether a path is a mount point.\n(Contributed by Cooper Ry Lees in bpo-30897.)", "code_blocks": []}, "improved-modules - pdb": {"text": "pdb\n\npdb.set_trace() now takes an optional header keyword-only\nargument.  If given, it is printed to the console just before debugging\nbegins.  (Contributed by Barry Warsaw in bpo-31389.)\npdb command line now accepts -m module_name as an alternative to\nscript file.  (Contributed by Mario Corchero in bpo-32206.)", "code_blocks": []}, "improved-modules - py-compile": {"text": "py_compile\n\npy_compile.compile() – and by extension, compileall – now\nrespects the SOURCE_DATE_EPOCH environment variable by\nunconditionally creating .pyc files for hash-based validation.\nThis allows for guaranteeing\nreproducible builds of .pyc\nfiles when they are created eagerly. (Contributed by Bernhard M. Wiedemann\nin bpo-29708.)", "code_blocks": []}, "improved-modules - pydoc": {"text": "pydoc\n\nThe pydoc server can now bind to an arbitrary hostname specified by the\nnew -n command-line argument.\n(Contributed by Feanil Patel in bpo-31128.)", "code_blocks": []}, "improved-modules - queue": {"text": "queue\n\nThe new SimpleQueue class is an unbounded FIFO queue.\n(Contributed by Antoine Pitrou in bpo-14976.)", "code_blocks": []}, "improved-modules - re": {"text": "re\n\nThe flags re.ASCII, re.LOCALE and re.UNICODE\ncan be set within the scope of a group.\n(Contributed by Serhiy Storchaka in bpo-31690.)\nre.split() now supports splitting on a pattern like r'\\b',\n'^$' or (?=-) that matches an empty string.\n(Contributed by Serhiy Storchaka in bpo-25054.)\nRegular expressions compiled with the re.LOCALE flag no longer\ndepend on the locale at compile time.  Locale settings are applied only\nwhen the compiled regular expression is used.\n(Contributed by Serhiy Storchaka in bpo-30215.)\nFutureWarning is now emitted if a regular expression contains\ncharacter set constructs that will change semantically in the future,\nsuch as nested sets and set operations.\n(Contributed by Serhiy Storchaka in bpo-30349.)\nCompiled regular expression and match objects can now be copied\nusing copy.copy() and copy.deepcopy().\n(Contributed by Serhiy Storchaka in bpo-10076.)", "code_blocks": []}, "improved-modules - signal": {"text": "signal\n\nThe new warn_on_full_buffer argument to the signal.set_wakeup_fd()\nfunction makes it possible to specify whether Python prints a warning on\nstderr when the wakeup buffer overflows.\n(Contributed by Nathaniel J. Smith in bpo-30050.)", "code_blocks": []}, "improved-modules - socket": {"text": "socket\n\nThe new socket.getblocking() method\nreturns True if the socket is in blocking mode and False otherwise.\n(Contributed by Yury Selivanov in bpo-32373.)\nThe new socket.close() function closes the passed socket file descriptor.\nThis function should be used instead of os.close() for better\ncompatibility across platforms.\n(Contributed by Christian Heimes in bpo-32454.)\nThe socket module now exposes the socket.TCP_CONGESTION\n(Linux 2.6.13), socket.TCP_USER_TIMEOUT (Linux 2.6.37), and\nsocket.TCP_NOTSENT_LOWAT (Linux 3.12) constants.\n(Contributed by Omar Sandoval in bpo-26273 and\nNathaniel J. Smith in bpo-29728.)\nSupport for socket.AF_VSOCK sockets has been added to allow\ncommunication between virtual machines and their hosts.\n(Contributed by Cathy Avery in bpo-27584.)\nSockets now auto-detect family, type and protocol from file descriptor\nby default.\n(Contributed by Christian Heimes in bpo-28134.)", "code_blocks": []}, "improved-modules - socketserver": {"text": "socketserver\n\nsocketserver.ThreadingMixIn.server_close() now waits until all non-daemon\nthreads complete. socketserver.ForkingMixIn.server_close() now waits\nuntil all child processes complete.\nAdd a new socketserver.ForkingMixIn.block_on_close class attribute to\nsocketserver.ForkingMixIn and socketserver.ThreadingMixIn\nclasses. Set the class attribute to False to get the pre-3.7 behaviour.", "code_blocks": []}, "improved-modules - sqlite3": {"text": "sqlite3\n\nsqlite3.Connection now exposes the backup()\nmethod when the underlying SQLite library is at version 3.6.11 or higher.\n(Contributed by Lele Gaifax in bpo-27645.)\nThe database argument of sqlite3.connect() now accepts any\npath-like object, instead of just a string.\n(Contributed by Anders Lorentsen in bpo-31843.)", "code_blocks": []}, "improved-modules - ssl": {"text": "ssl\n\nThe ssl module now uses OpenSSL’s builtin API instead of\nmatch_hostname() to check a host name or an IP address.  Values\nare validated during TLS handshake.  Any certificate validation error\nincluding failing the host name check now raises\nSSLCertVerificationError and aborts the handshake with a proper\nTLS Alert message.  The new exception contains additional information.\nHost name validation can be customized with\nSSLContext.hostname_checks_common_name.\n(Contributed by Christian Heimes in bpo-31399.)\n\nNote\nThe improved host name check requires a libssl implementation compatible\nwith OpenSSL 1.0.2 or 1.1.  Consequently, OpenSSL 0.9.8 and 1.0.1 are no\nlonger supported (see Platform Support Removals for more details).\nThe ssl module is mostly compatible with LibreSSL 2.7.2 and newer.\n\nThe ssl module no longer sends IP addresses in SNI TLS extension.\n(Contributed by Christian Heimes in bpo-32185.)\nmatch_hostname() no longer supports partial wildcards like\nwww*.example.org.\n(Contributed by Mandeep Singh in bpo-23033 and Christian Heimes in\nbpo-31399.)\nThe default cipher suite selection of the ssl module now uses a blacklist\napproach rather than a hard-coded whitelist.  Python no longer re-enables\nciphers that have been blocked by OpenSSL security updates.  Default cipher\nsuite selection can be configured at compile time.\n(Contributed by Christian Heimes in bpo-31429.)\nValidation of server certificates containing internationalized domain names\n(IDNs) is now supported.  As part of this change, the\nSSLSocket.server_hostname attribute\nnow stores the expected hostname in A-label form (\"xn--pythn-mua.org\"),\nrather than the U-label form (\"pythön.org\").  (Contributed by\nNathaniel J. Smith and Christian Heimes in bpo-28414.)\nThe ssl module has preliminary and experimental support for TLS 1.3 and\nOpenSSL 1.1.1.  At the time of Python 3.7.0 release, OpenSSL 1.1.1 is still\nunder development and TLS 1.3 hasn’t been finalized yet.  The TLS 1.3\nhandshake and protocol behaves slightly differently than TLS 1.2 and earlier,\nsee TLS 1.3.\n(Contributed by Christian Heimes in bpo-32947, bpo-20995,\nbpo-29136, bpo-30622 and bpo-33618)\nSSLSocket and SSLObject no longer have a public\nconstructor.  Direct instantiation was never a documented and supported\nfeature.  Instances must be created with SSLContext methods\nwrap_socket() and wrap_bio().\n(Contributed by Christian Heimes in bpo-32951)\nOpenSSL 1.1 APIs for setting the minimum and maximum TLS protocol version are\navailable as SSLContext.minimum_version\nand SSLContext.maximum_version.\nSupported protocols are indicated by several new flags, such as\nHAS_TLSv1_1.\n(Contributed by Christian Heimes in bpo-32609.)\nAdded SSLContext.post_handshake_auth to enable and\nssl.SSLSocket.verify_client_post_handshake() to initiate TLS 1.3\npost-handshake authentication.\n(Contributed by Christian Heimes in bpo-34670.)", "code_blocks": []}, "improved-modules - string": {"text": "string\n\nstring.Template now lets you to optionally modify the regular\nexpression pattern for braced placeholders and non-braced placeholders\nseparately.  (Contributed by Barry Warsaw in bpo-1198569.)", "code_blocks": []}, "improved-modules - subprocess": {"text": "subprocess\n\nThe subprocess.run() function accepts the new capture_output\nkeyword argument.  When true, stdout and stderr will be captured.\nThis is equivalent to passing subprocess.PIPE as stdout and\nstderr arguments.\n(Contributed by Bo Bayles in bpo-32102.)\nThe subprocess.run function and the subprocess.Popen constructor\nnow accept the text keyword argument as an alias\nto universal_newlines.\n(Contributed by Andrew Clegg in bpo-31756.)\nOn Windows the default for close_fds was changed from False to\nTrue when redirecting the standard handles.  It’s now possible to set\nclose_fds to true when redirecting the standard handles.  See\nsubprocess.Popen.  This means that close_fds now defaults to\nTrue on all supported platforms.\n(Contributed by Segev Finer in bpo-19764.)\nThe subprocess module is now more graceful when handling\nKeyboardInterrupt during subprocess.call(),\nsubprocess.run(), or in a Popen\ncontext manager.  It now waits a short amount of time for the child\nto exit, before continuing the handling of the KeyboardInterrupt\nexception.\n(Contributed by Gregory P. Smith in bpo-25942.)", "code_blocks": []}, "improved-modules - sys": {"text": "sys\n\nThe new sys.breakpointhook() hook function is called by the\nbuilt-in breakpoint().\n(Contributed by Barry Warsaw in bpo-31353.)\nOn Android, the new sys.getandroidapilevel() returns the build-time\nAndroid API version.\n(Contributed by Victor Stinner in bpo-28740.)\nThe new sys.get_coroutine_origin_tracking_depth() function returns\nthe current coroutine origin tracking depth, as set by\nthe new sys.set_coroutine_origin_tracking_depth().  asyncio\nhas been converted to use this new API instead of\nthe deprecated sys.set_coroutine_wrapper().\n(Contributed by Nathaniel J. Smith in bpo-32591.)", "code_blocks": []}, "improved-modules - time": {"text": "time\n\nPEP 564 adds six new functions with nanosecond resolution to the\ntime module:\n\ntime.clock_gettime_ns()\ntime.clock_settime_ns()\ntime.monotonic_ns()\ntime.perf_counter_ns()\ntime.process_time_ns()\ntime.time_ns()\n\nNew clock identifiers have been added:\n\ntime.CLOCK_BOOTTIME (Linux): Identical to\ntime.CLOCK_MONOTONIC, except it also includes any time that the\nsystem is suspended.\ntime.CLOCK_PROF (FreeBSD, NetBSD and OpenBSD): High-resolution\nper-process CPU timer.\ntime.CLOCK_UPTIME (FreeBSD, OpenBSD): Time whose absolute value is\nthe time the system has been running and not suspended, providing accurate\nuptime measurement.\n\nThe new time.thread_time() and time.thread_time_ns() functions\ncan be used to get per-thread CPU time measurements.\n(Contributed by Antoine Pitrou in bpo-32025.)\nThe new time.pthread_getcpuclockid() function returns the clock ID\nof the thread-specific CPU-time clock.", "code_blocks": []}, "improved-modules - tkinter": {"text": "tkinter\n\nThe new tkinter.ttk.Spinbox class is now available.\n(Contributed by Alan Moore in bpo-32585.)", "code_blocks": []}, "improved-modules - tracemalloc": {"text": "tracemalloc\n\ntracemalloc.Traceback behaves more like regular tracebacks,\nsorting the frames from oldest to most recent.\nTraceback.format()\nnow accepts negative limit, truncating the result to the\nabs(limit) oldest frames.  To get the old behaviour, use\nthe new most_recent_first argument to Traceback.format().\n(Contributed by Jesse Bakker in bpo-32121.)", "code_blocks": []}, "improved-modules - types": {"text": "types\n\nThe new WrapperDescriptorType,\nMethodWrapperType, MethodDescriptorType,\nand ClassMethodDescriptorType classes are now available.\n(Contributed by Manuel Krebber and Guido van Rossum in bpo-29377,\nand Serhiy Storchaka in bpo-32265.)\nThe new types.resolve_bases() function resolves MRO entries\ndynamically as specified by PEP 560.\n(Contributed by Ivan Levkivskyi in bpo-32717.)", "code_blocks": []}, "improved-modules - unicodedata": {"text": "unicodedata\n\nThe internal unicodedata database has been upgraded to use Unicode 11. (Contributed by Benjamin\nPeterson.)", "code_blocks": []}, "improved-modules - unittest": {"text": "unittest\n\nThe new -k command-line option allows filtering tests by a name\nsubstring or a Unix shell-like pattern.\nFor example, python -m unittest -k foo runs\nfoo_tests.SomeTest.test_something, bar_tests.SomeTest.test_foo,\nbut not bar_tests.FooTest.test_something.\n(Contributed by Jonas Haag in bpo-32071.)", "code_blocks": []}, "improved-modules - unittest-mock": {"text": "unittest.mock\n\nThe sentinel attributes now preserve their identity\nwhen they are copied or pickled. (Contributed by\nSerhiy Storchaka in bpo-20804.)\nThe new seal() function allows sealing\nMock instances, which will disallow further creation\nof attribute mocks.  The seal is applied recursively to all attributes that\nare themselves mocks.\n(Contributed by Mario Corchero in bpo-30541.)", "code_blocks": []}, "improved-modules - urllib-parse": {"text": "urllib.parse\n\nurllib.parse.quote() has been updated from RFC 2396 to RFC 3986,\nadding ~ to the set of characters that are never quoted by default.\n(Contributed by Christian Theune and Ratnadeep Debnath in bpo-16285.)", "code_blocks": []}, "improved-modules - uu": {"text": "uu\n\nThe uu.encode() function now accepts an optional backtick\nkeyword argument.  When it’s true, zeros are represented by '`'\ninstead of spaces.  (Contributed by Xiang Zhang in bpo-30103.)", "code_blocks": []}, "improved-modules - uuid": {"text": "uuid\n\nThe new UUID.is_safe attribute relays information\nfrom the platform about whether generated UUIDs are generated with a\nmultiprocessing-safe method.\n(Contributed by Barry Warsaw in bpo-22807.)\nuuid.getnode() now prefers universally administered\nMAC addresses over locally administered MAC addresses.\nThis makes a better guarantee for global uniqueness of UUIDs returned\nfrom uuid.uuid1().  If only locally administered MAC addresses are\navailable, the first such one found is returned.\n(Contributed by Barry Warsaw in bpo-32107.)", "code_blocks": []}, "improved-modules - warnings": {"text": "warnings\n\nThe initialization of the default warnings filters has changed as follows:\n\nwarnings enabled via command line options (including those for -b\nand the new CPython-specific -X dev option) are always passed\nto the warnings machinery via the sys.warnoptions attribute.\nwarnings filters enabled via the command line or the environment now have the\nfollowing order of precedence:\n\n\nthe BytesWarning filter for -b (or -bb)\nany filters specified with the -W option\nany filters specified with the PYTHONWARNINGS environment\nvariable\nany other CPython specific filters (e.g. the default filter added\nfor the new -X dev mode)\nany implicit filters defined directly by the warnings machinery\n\n\n\nin CPython debug builds, all warnings are now displayed by default (the\nimplicit filter list is empty)\n\n(Contributed by Nick Coghlan and Victor Stinner in bpo-20361,\nbpo-32043, and bpo-32230.)\nDeprecation warnings are once again shown by default in single-file scripts and\nat the interactive prompt.  See PEP 565: Show DeprecationWarning in __main__ for details.\n(Contributed by Nick Coghlan in bpo-31975.)", "code_blocks": []}, "improved-modules - xml": {"text": "xml\n\nAs mitigation against DTD and external entity retrieval, the\nxml.dom.minidom and xml.sax modules no longer process\nexternal entities by default.\n(Contributed by Christian Heimes in bpo-17239.)", "code_blocks": []}, "improved-modules - xml-etree": {"text": "xml.etree\n\nElementPath predicates in the find()\nmethods can now compare text of the current node with [. = \"text\"],\nnot only text in children.  Predicates also allow adding spaces for\nbetter readability.  (Contributed by Stefan Behnel in bpo-31648.)", "code_blocks": []}, "improved-modules - xmlrpc-server": {"text": "xmlrpc.server\n\nSimpleXMLRPCDispatcher.register_function\ncan now be used as a decorator.  (Contributed by Xiang Zhang in\nbpo-7769.)", "code_blocks": []}, "improved-modules - zipapp": {"text": "zipapp\n\nFunction create_archive() now accepts an optional filter\nargument to allow the user to select which files should be included in the\narchive.  (Contributed by Irmen de Jong in bpo-31072.)\nFunction create_archive() now accepts an optional compressed\nargument to generate a compressed archive.  A command line option\n--compress has also been added to support compression.\n(Contributed by Zhiming Wang in bpo-31638.)", "code_blocks": []}, "improved-modules - zipfile": {"text": "zipfile\n\nZipFile now accepts the new compresslevel parameter to\ncontrol the compression level.\n(Contributed by Bo Bayles in bpo-21417.)\nSubdirectories in archives created by ZipFile are now stored in\nalphabetical order.\n(Contributed by Bernhard M. Wiedemann in bpo-30693.)", "code_blocks": []}, "c-api-changes": {"text": "C API Changes\n\nA new API for thread-local storage has been implemented.  See\nPEP 539: New C API for Thread-Local Storage for an overview and\nThread Specific Storage (TSS) API for a complete reference.\n(Contributed by Masayuki Yamamoto in bpo-25658.)\nThe new context variables functionality\nexposes a number of new C APIs.\nThe new PyImport_GetModule() function returns the previously\nimported module with the given name.\n(Contributed by Eric Snow in bpo-28411.)\nThe new Py_RETURN_RICHCOMPARE macro eases writing rich\ncomparison functions.\n(Contributed by Petr Victorin in bpo-23699.)\nThe new Py_UNREACHABLE macro can be used to mark unreachable\ncode paths.\n(Contributed by Barry Warsaw in bpo-31338.)\nThe tracemalloc now exposes a C API through the new\nPyTraceMalloc_Track() and PyTraceMalloc_Untrack()\nfunctions.\n(Contributed by Victor Stinner in bpo-30054.)\nThe new import__find__load__start() and\nimport__find__load__done() static markers can be used to trace\nmodule imports.\n(Contributed by Christian Heimes in bpo-31574.)\nThe fields name and doc of structures\nPyMemberDef, PyGetSetDef,\nPyStructSequence_Field, PyStructSequence_Desc,\nand wrapperbase are now of type const char * rather of\nchar *.  (Contributed by Serhiy Storchaka in bpo-28761.)\nThe result of PyUnicode_AsUTF8AndSize() and PyUnicode_AsUTF8()\nis now of type const char * rather of char *. (Contributed by Serhiy\nStorchaka in bpo-28769.)\nThe result of PyMapping_Keys(), PyMapping_Values() and\nPyMapping_Items() is now always a list, rather than a list or a\ntuple. (Contributed by Oren Milman in bpo-28280.)\nAdded functions PySlice_Unpack() and PySlice_AdjustIndices().\n(Contributed by Serhiy Storchaka in bpo-27867.)\nPyOS_AfterFork() is deprecated in favour of the new functions\nPyOS_BeforeFork(), PyOS_AfterFork_Parent() and\nPyOS_AfterFork_Child().  (Contributed by Antoine Pitrou in\nbpo-16500.)\nThe PyExc_RecursionErrorInst singleton that was part of the public API\nhas been removed as its members being never cleared may cause a segfault\nduring finalization of the interpreter. Contributed by Xavier de Gaye in\nbpo-22898 and bpo-30697.\nAdded C API support for timezones with timezone constructors\nPyTimeZone_FromOffset() and PyTimeZone_FromOffsetAndName(),\nand access to the UTC singleton with PyDateTime_TimeZone_UTC.\nContributed by Paul Ganssle in bpo-10381.\nThe type of results of PyThread_start_new_thread() and\nPyThread_get_thread_ident(), and the id parameter of\nPyThreadState_SetAsyncExc() changed from long to\nunsigned long.\n(Contributed by Serhiy Storchaka in bpo-6532.)\nPyUnicode_AsWideCharString() now raises a ValueError if the\nsecond argument is NULL and the wchar_t* string contains null\ncharacters.  (Contributed by Serhiy Storchaka in bpo-30708.)\nChanges to the startup sequence and the management of dynamic memory\nallocators mean that the long documented requirement to call\nPy_Initialize() before calling most C API functions is now\nrelied on more heavily, and failing to abide by it may lead to segfaults in\nembedding applications. See the Porting to Python 3.7 section in this\ndocument and the Before Python Initialization section in the C API documentation\nfor more details.\nThe new PyInterpreterState_GetID() returns the unique ID for a\ngiven interpreter.\n(Contributed by Eric Snow in bpo-29102.)\nPy_DecodeLocale(), Py_EncodeLocale() now use the UTF-8\nencoding when the UTF-8 mode is enabled.\n(Contributed by Victor Stinner in bpo-29240.)\nPyUnicode_DecodeLocaleAndSize() and PyUnicode_EncodeLocale()\nnow use the current locale encoding for surrogateescape error handler.\n(Contributed by Victor Stinner in bpo-29240.)\nThe start and end parameters of PyUnicode_FindChar() are\nnow adjusted to behave like string slices.\n(Contributed by Xiang Zhang in bpo-28822.)", "code_blocks": []}, "build-changes": {"text": "Build Changes\n\nSupport for building --without-threads has been removed.  The\nthreading module is now always available.\n(Contributed by Antoine Pitrou in bpo-31370.).\nA full copy of libffi is no longer bundled for use when building the\n_ctypes module on non-OSX UNIX platforms.  An installed copy\nof libffi is now required when building _ctypes on such platforms.\n(Contributed by Zachary Ware in bpo-27979.)\nThe Windows build process no longer depends on Subversion to pull in external\nsources, a Python script is used to download zipfiles from GitHub instead.\nIf Python 3.6 is not found on the system (via py -3.6), NuGet is used to\ndownload a copy of 32-bit Python for this purpose.  (Contributed by Zachary\nWare in bpo-30450.)\nThe ssl module requires OpenSSL 1.0.2 or 1.1 compatible libssl.\nOpenSSL 1.0.1 has reached end of lifetime on 2016-12-31 and is no longer\nsupported. LibreSSL is temporarily not supported as well. LibreSSL releases\nup to version 2.6.4 are missing required OpenSSL 1.0.2 APIs.", "code_blocks": []}, "optimizations": {"text": "Optimizations\n\nThe overhead of calling many methods of various standard library classes\nimplemented in C has been significantly reduced by porting more code\nto use the METH_FASTCALL convention.\n(Contributed by Victor Stinner in bpo-29300, bpo-29507,\nbpo-29452, and bpo-29286.)\nVarious optimizations have reduced Python startup time by 10% on Linux and\nup to 30% on macOS.\n(Contributed by Victor Stinner, INADA Naoki in bpo-29585, and\nIvan Levkivskyi in bpo-31333.)\nMethod calls are now up to 20% faster due to the bytecode changes which\navoid creating bound method instances.\n(Contributed by Yury Selivanov and INADA Naoki in bpo-26110.)\nThe asyncio module received a number of notable optimizations for\ncommonly used functions:\n\nThe asyncio.get_event_loop() function has been reimplemented in C to\nmake it up to 15 times faster.\n(Contributed by Yury Selivanov in bpo-32296.)\nasyncio.Future callback management has been optimized.\n(Contributed by Yury Selivanov in bpo-32348.)\nasyncio.gather() is now up to 15% faster.\n(Contributed by Yury Selivanov in bpo-32355.)\nasyncio.sleep() is now up to 2 times faster when the delay\nargument is zero or negative.\n(Contributed by Andrew Svetlov in bpo-32351.)\nThe performance overhead of asyncio debug mode has been reduced.\n(Contributed by Antoine Pitrou in bpo-31970.)\n\nAs a result of PEP 560 work, the import time\nof typing has been reduced by a factor of 7, and many typing operations\nare now faster.\n(Contributed by Ivan Levkivskyi in bpo-32226.)\nsorted() and list.sort() have been optimized for common cases\nto be up to 40-75% faster.\n(Contributed by Elliot Gorokhovsky in bpo-28685.)\ndict.copy() is now up to 5.5 times faster.\n(Contributed by Yury Selivanov in bpo-31179.)\nhasattr() and getattr() are now about 4 times faster when\nname is not found and obj does not override object.__getattr__()\nor object.__getattribute__().\n(Contributed by INADA Naoki in bpo-32544.)\nSearching for certain Unicode characters (like Ukrainian capital “Є”)\nin a string was up to 25 times slower than searching for other characters.\nIt is now only 3 times slower in the worst case.\n(Contributed by Serhiy Storchaka in bpo-24821.)\nThe collections.namedtuple() factory has been reimplemented to\nmake the creation of named tuples 4 to 6 times faster.\n(Contributed by Jelle Zijlstra with further improvements by INADA Naoki,\nSerhiy Storchaka, and Raymond Hettinger in bpo-28638.)\ndate.fromordinal() and date.fromtimestamp() are now up to\n30% faster in the common case.\n(Contributed by Paul Ganssle in bpo-32403.)\nThe os.fwalk() function is now up to 2 times faster thanks to\nthe use of os.scandir().\n(Contributed by Serhiy Storchaka in bpo-25996.)\nThe speed of the shutil.rmtree() function has been improved by\n20–40% thanks to the use of the os.scandir() function.\n(Contributed by Serhiy Storchaka in bpo-28564.)\nOptimized case-insensitive matching and searching of regular\nexpressions.  Searching some patterns can now be up to 20 times faster.\n(Contributed by Serhiy Storchaka in bpo-30285.)\nre.compile() now converts flags parameter to int object if\nit is RegexFlag.  It is now as fast as Python 3.5, and faster than\nPython 3.6 by about 10% depending on the pattern.\n(Contributed by INADA Naoki in bpo-31671.)\nThe modify() methods of classes\nselectors.EpollSelector, selectors.PollSelector\nand selectors.DevpollSelector may be around 10% faster under\nheavy loads.  (Contributed by Giampaolo Rodola’ in bpo-30014)\nConstant folding has been moved from the peephole optimizer to the new AST\noptimizer, which is able perform optimizations more consistently.\n(Contributed by Eugene Toder and INADA Naoki in bpo-29469 and\nbpo-11549.)\nMost functions and methods in abc have been rewritten in C.\nThis makes creation of abstract base classes, and calling isinstance()\nand issubclass() on them 1.5x faster.  This also reduces Python\nstart-up time by up to 10%. (Contributed by Ivan Levkivskyi and INADA Naoki\nin bpo-31333)\nSignificant speed improvements to alternate constructors for\ndatetime.date and datetime.datetime by using fast-path\nconstructors when not constructing subclasses. (Contributed by Paul Ganssle\nin bpo-32403)\nThe speed of comparison of array.array instances has been\nimproved considerably in certain cases.  It is now from 10x to 70x faster\nwhen comparing arrays holding values of the same integer type.\n(Contributed by Adrian Wielgosik in bpo-24700.)\nThe math.erf() and math.erfc() functions now use the (faster)\nC library implementation on most platforms.\n(Contributed by Serhiy Storchaka in bpo-26121.)", "code_blocks": []}, "other-cpython-implementation-changes": {"text": "Other CPython Implementation Changes\n\n\nTrace hooks may now opt out of receiving the line and opt into receiving\nthe opcode events from the interpreter by setting the corresponding new\nf_trace_lines and f_trace_opcodes attributes on the\nframe being traced. (Contributed by Nick Coghlan in bpo-31344.)\nFixed some consistency problems with namespace package module attributes.\nNamespace module objects now have an __file__ that is set to None\n(previously unset), and their __spec__.origin is also set to None\n(previously the string \"namespace\").  See bpo-32305.  Also, the\nnamespace module object’s __spec__.loader is set to the same value as\n__loader__ (previously, the former was set to None).  See\nbpo-32303.\nThe locals() dictionary now displays in the lexical order that\nvariables were defined.  Previously, the order was undefined.\n(Contributed by Raymond Hettinger in bpo-32690.)\nThe distutils upload command no longer tries to change CR\nend-of-line characters to CRLF.  This fixes a corruption issue with sdists\nthat ended with a byte equivalent to CR.\n(Contributed by Bo Bayles in bpo-32304.)", "code_blocks": []}, "deprecated-python-behavior": {"text": "Deprecated Python Behavior\n\nYield expressions (both yield and yield from clauses) are now deprecated\nin comprehensions and generator expressions (aside from the iterable expression\nin the leftmost for clause). This ensures that comprehensions\nalways immediately return a container of the appropriate type (rather than\npotentially returning a generator iterator object), while generator\nexpressions won’t attempt to interleave their implicit output with the output\nfrom any explicit yield expressions.  In Python 3.7, such expressions emit\nDeprecationWarning when compiled, in Python 3.8 this will be a\nSyntaxError.\n(Contributed by Serhiy Storchaka in bpo-10544.)\nReturning a subclass of complex from object.__complex__() is\ndeprecated and will be an error in future Python versions.  This makes\n__complex__() consistent with object.__int__() and\nobject.__float__().\n(Contributed by Serhiy Storchaka in bpo-28894.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - aifc": {"text": "aifc\n\naifc.openfp() has been deprecated and will be removed in Python 3.9.\nUse aifc.open() instead.\n(Contributed by Brian Curtin in bpo-31985.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - whatsnew37-asyncio-deprecated": {"text": "asyncio\n\nSupport for directly await-ing instances of asyncio.Lock and\nother asyncio synchronization primitives has been deprecated.  An\nasynchronous context manager must be used in order to acquire and release\nthe synchronization resource.\n(Contributed by Andrew Svetlov in bpo-32253.)\nThe asyncio.Task.current_task() and asyncio.Task.all_tasks()\nmethods have been deprecated.\n(Contributed by Andrew Svetlov in bpo-32250.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - id3": {"text": "collections\n\nIn Python 3.8, the abstract base classes in collections.abc will no\nlonger be exposed in the regular collections module.  This will help\ncreate a clearer distinction between the concrete classes and the abstract\nbase classes.\n(Contributed by Serhiy Storchaka in bpo-25988.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - id4": {"text": "dbm\n\ndbm.dumb now supports reading read-only files and no longer writes the\nindex file when it is not changed.  A deprecation warning is now emitted\nif the index file is missing and recreated in the 'r' and 'w'\nmodes (this will be an error in future Python releases).\n(Contributed by Serhiy Storchaka in bpo-28847.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - id5": {"text": "enum\n\nIn Python 3.8, attempting to check for non-Enum objects in Enum\nclasses will raise a TypeError (e.g. 1 in Color); similarly,\nattempting to check for non-Flag objects in a Flag member will\nraise TypeError (e.g. 1 in Perm.RW); currently, both operations\nreturn False instead.\n(Contributed by Ethan Furman in bpo-33217.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - gettext": {"text": "gettext\n\nUsing non-integer value for selecting a plural form in gettext is\nnow deprecated.  It never correctly worked. (Contributed by Serhiy Storchaka\nin bpo-28692.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - id6": {"text": "importlib\n\nMethods\nMetaPathFinder.find_module()\n(replaced by\nMetaPathFinder.find_spec())\nand\nPathEntryFinder.find_loader()\n(replaced by\nPathEntryFinder.find_spec())\nboth deprecated in Python 3.4 now emit DeprecationWarning.\n(Contributed by Matthias Bussonnier in bpo-29576)\nThe importlib.abc.ResourceLoader ABC has been deprecated in\nfavour of importlib.abc.ResourceReader.", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - id7": {"text": "locale\n\nlocale.format() has been deprecated, use locale.format_string()\ninstead.  (Contributed by Garvit in bpo-10379.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - macpath": {"text": "macpath\n\nThe macpath is now deprecated and will be removed in Python 3.8.\n(Contributed by Chi Hsuan Yen in bpo-9850.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - threading": {"text": "threading\n\ndummy_threading and _dummy_thread have been deprecated.  It is\nno longer possible to build Python with threading disabled.\nUse threading instead.\n(Contributed by Antoine Pitrou in bpo-31370.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - id8": {"text": "socket\n\nThe silent argument value truncation in socket.htons() and\nsocket.ntohs() has been deprecated.  In future versions of Python,\nif the passed argument is larger than 16 bits, an exception will be raised.\n(Contributed by Oren Milman in bpo-28332.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - id9": {"text": "ssl\n\nssl.wrap_socket() is deprecated.  Use\nssl.SSLContext.wrap_socket() instead.\n(Contributed by Christian Heimes in bpo-28124.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - sunau": {"text": "sunau\n\nsunau.openfp() has been deprecated and will be removed in Python 3.9.\nUse sunau.open() instead.\n(Contributed by Brian Curtin in bpo-31985.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - id10": {"text": "sys\n\nDeprecated sys.set_coroutine_wrapper() and\nsys.get_coroutine_wrapper().\nThe undocumented sys.callstats() function has been deprecated and\nwill be removed in a future Python version.\n(Contributed by Victor Stinner in bpo-28799.)", "code_blocks": []}, "deprecated-python-modules-functions-and-methods - wave": {"text": "wave\n\nwave.openfp() has been deprecated and will be removed in Python 3.9.\nUse wave.open() instead.\n(Contributed by Brian Curtin in bpo-31985.)", "code_blocks": []}, "deprecated-functions-and-types-of-the-c-api": {"text": "Deprecated functions and types of the C API\n\nFunction PySlice_GetIndicesEx() is deprecated and replaced with\na macro if Py_LIMITED_API is not set or set to a value in the range\nbetween 0x03050400 and 0x03060000 (not inclusive), or is 0x03060100\nor higher.  (Contributed by Serhiy Storchaka in bpo-27867.)\nPyOS_AfterFork() has been deprecated.  Use PyOS_BeforeFork(),\nPyOS_AfterFork_Parent() or PyOS_AfterFork_Child() instead.\n(Contributed by Antoine Pitrou in bpo-16500.)", "code_blocks": []}, "platform-support-removals": {"text": "Platform Support Removals\n\n\nFreeBSD 9 and older are no longer officially supported.\nFor full Unicode support, including within extension modules, *nix platforms\nare now expected to provide at least one of C.UTF-8 (full locale),\nC.utf8 (full locale) or UTF-8 (LC_CTYPE-only locale) as an\nalternative to the legacy ASCII-based C locale.\nOpenSSL 0.9.8 and 1.0.1 are no longer supported, which means building CPython\n3.7 with SSL/TLS support on older platforms still using these versions\nrequires custom build options that link to a more recent version of OpenSSL.\nNotably, this issue affects the Debian 8 (aka “jessie”) and Ubuntu 14.04\n(aka “Trusty”) LTS Linux distributions, as they still use OpenSSL 1.0.1 by\ndefault.\nDebian 9 (“stretch”) and Ubuntu 16.04 (“xenial”), as well as recent releases\nof other LTS Linux releases (e.g. RHEL/CentOS 7.5, SLES 12-SP3), use OpenSSL\n1.0.2 or later, and remain supported in the default build configuration.\nCPython’s own CI configuration file provides an\nexample of using the SSL\ncompatibility testing infrastructure in\nCPython’s test suite to build and link against OpenSSL 1.1.0 rather than an\noutdated system provided OpenSSL.", "code_blocks": []}, "api-and-feature-removals": {"text": "API and Feature Removals\n\nThe following features and APIs have been removed from Python 3.7:\n\nThe os.stat_float_times() function has been removed. It was introduced in\nPython 2.3 for backward compatibility with Python 2.2, and was deprecated\nsince Python 3.1.\nUnknown escapes consisting of '\\' and an ASCII letter in replacement\ntemplates for re.sub() were deprecated in Python 3.5, and will now\ncause an error.\nRemoved support of the exclude argument in tarfile.TarFile.add().\nIt was deprecated in Python 2.7 and 3.2.  Use the filter argument instead.\nThe splitunc() function in the ntpath module was deprecated in\nPython 3.1, and has now been removed.  Use the splitdrive()\nfunction instead.\ncollections.namedtuple() no longer supports the verbose parameter\nor _source attribute which showed the generated source code for the\nnamed tuple class.  This was part of an optimization designed to speed-up\nclass creation.  (Contributed by Jelle Zijlstra with further improvements\nby INADA Naoki, Serhiy Storchaka, and Raymond Hettinger in bpo-28638.)\nFunctions bool(), float(), list() and tuple() no\nlonger take keyword arguments.  The first argument of int() can now\nbe passed only as positional argument.\nRemoved previously deprecated in Python 2.4 classes Plist, Dict and\n_InternalDict in the plistlib module.  Dict values in the result\nof functions readPlist() and\nreadPlistFromBytes() are now normal dicts.  You no longer\ncan use attribute access to access items of these dictionaries.\nThe asyncio.windows_utils.socketpair() function has been\nremoved.  Use the socket.socketpair() function instead,\nit is available on all platforms since Python 3.5.\nasyncio.windows_utils.socketpair was just an alias to\nsocket.socketpair on Python 3.5 and newer.\nasyncio no longer exports the selectors and\n_overlapped modules as asyncio.selectors and\nasyncio._overlapped. Replace from asyncio import selectors with\nimport selectors.\nDirect instantiation of ssl.SSLSocket and ssl.SSLObject\nobjects is now prohibited. The constructors were never documented, tested,\nor designed as public constructors.  Users were supposed to use\nssl.wrap_socket() or ssl.SSLContext.\n(Contributed by Christian Heimes in bpo-32951.)\nThe unused distutils install_misc command has been removed.\n(Contributed by Eric N. Vander Weele in bpo-29218.)", "code_blocks": []}, "module-removals": {"text": "Module Removals\n\nThe fpectl module has been removed.  It was never enabled by\ndefault, never worked correctly on x86-64, and it changed the Python\nABI in ways that caused unexpected breakage of C extensions.\n(Contributed by Nathaniel J. Smith in bpo-29137.)", "code_blocks": []}, "windows-only-changes": {"text": "Windows-only Changes\n\nThe python launcher, (py.exe), can accept 32 & 64 bit specifiers without\nhaving to specify a minor version as well. So py -3-32 and py -3-64\nbecome valid as well as py -3.7-32, also the -m-64 and -m.n-64 forms\nare now accepted to force 64 bit python even if 32 bit would have otherwise\nbeen used. If the specified version is not available py.exe will error exit.\n(Contributed by Steve Barnes in bpo-30291.)\nThe launcher can be run as py -0 to produce a list of the installed pythons,\nwith default marked with an asterisk. Running py -0p will include the paths.\nIf py is run with a version specifier that cannot be matched it will also print\nthe short form list of available specifiers.\n(Contributed by Steve Barnes in bpo-30362.)", "code_blocks": []}, "porting-to-python-3-7 - changes-in-python-behavior": {"text": "Changes in Python Behavior\n\n\nasync and await names are now reserved keywords.\nCode using these names as identifiers will now raise a SyntaxError.\n(Contributed by Jelle Zijlstra in bpo-30406.)\nPEP 479 is enabled for all code in Python 3.7, meaning that\nStopIteration exceptions raised directly or indirectly in\ncoroutines and generators are transformed into RuntimeError\nexceptions.\n(Contributed by Yury Selivanov in bpo-32670.)\nobject.__aiter__() methods can no longer be declared as\nasynchronous.  (Contributed by Yury Selivanov in bpo-31709.)\nDue to an oversight, earlier Python versions erroneously accepted the\nfollowing syntax:\nf(1 for x in [1],)\n\nclass C(1 for x in [1]):\n    pass\n\n\nPython 3.7 now correctly raises a SyntaxError, as a generator\nexpression always needs to be directly inside a set of parentheses\nand cannot have a comma on either side, and the duplication of the\nparentheses can be omitted only on calls.\n(Contributed by Serhiy Storchaka in bpo-32012 and bpo-32023.)\n\nWhen using the -m switch, the initial working directory is now added\nto sys.path, rather than an empty string (which dynamically denoted\nthe current working directory at the time of each import). Any programs that\nare checking for the empty string, or otherwise relying on the previous\nbehaviour, will need to be updated accordingly (e.g. by also checking for\nos.getcwd() or os.path.dirname(__main__.__file__), depending on why\nthe code was checking for the empty string in the first place).", "code_blocks": ["f(1 for x in [1],)\n\nclass C(1 for x in [1]):\n    pass\n"]}, "porting-to-python-3-7 - changes-in-the-python-api": {"text": "Changes in the Python API\n\n\nsocketserver.ThreadingMixIn.server_close() now waits until all\nnon-daemon threads complete.  Set the new\nsocketserver.ThreadingMixIn.block_on_close class attribute to\nFalse to get the pre-3.7 behaviour.\n(Contributed by Victor Stinner in bpo-31233 and bpo-33540.)\nsocketserver.ForkingMixIn.server_close() now waits until all\nchild processes complete. Set the new\nsocketserver.ForkingMixIn.block_on_close class attribute to False\nto get the pre-3.7 behaviour.\n(Contributed by Victor Stinner in bpo-31151 and bpo-33540.)\nThe locale.localeconv() function now temporarily sets the LC_CTYPE\nlocale to the value of LC_NUMERIC in some cases.\n(Contributed by Victor Stinner in bpo-31900.)\npkgutil.walk_packages() now raises a ValueError if path is\na string.  Previously an empty list was returned.\n(Contributed by Sanyam Khurana in bpo-24744.)\nA format string argument for string.Formatter.format()\nis now positional-only.\nPassing it as a keyword argument was deprecated in Python 3.5. (Contributed\nby Serhiy Storchaka in bpo-29193.)\nAttributes key,\nvalue and\ncoded_value of class\nhttp.cookies.Morsel are now read-only.\nAssigning to them was deprecated in Python 3.5.\nUse the set() method for setting them.\n(Contributed by Serhiy Storchaka in bpo-29192.)\nThe mode argument of os.makedirs() no longer affects the file\npermission bits of newly-created intermediate-level directories.\nTo set their file permission bits you can set the umask before invoking\nmakedirs().\n(Contributed by Serhiy Storchaka in bpo-19930.)\nThe struct.Struct.format type is now str instead of\nbytes. (Contributed by Victor Stinner in bpo-21071.)\nparse_multipart() now accepts the encoding and errors\narguments and returns the same results as\nFieldStorage: for non-file fields, the value associated to a key\nis a list of strings, not bytes.\n(Contributed by Pierre Quentel in bpo-29979.)\nDue to internal changes in socket, calling socket.fromshare()\non a socket created by socket.share in older\nPython versions is not supported.\nrepr for BaseException has changed to not include the trailing\ncomma.  Most exceptions are affected by this change.\n(Contributed by Serhiy Storchaka in bpo-30399.)\nrepr for datetime.timedelta has changed to include the keyword\narguments in the output. (Contributed by Utkarsh Upadhyay in bpo-30302.)\nBecause shutil.rmtree() is now implemented using the os.scandir()\nfunction, the user specified handler onerror is now called with the first\nargument os.scandir instead of os.listdir when listing the directory\nis failed.\nSupport for nested sets and set operations in regular expressions as in\nUnicode Technical Standard #18 might be added in the future.  This would\nchange the syntax.  To facilitate this future change a FutureWarning\nwill be raised in ambiguous cases for the time being.\nThat include sets starting with a literal '[' or containing literal\ncharacter sequences '--', '&&', '~~', and '||'.  To\navoid a warning, escape them with a backslash.\n(Contributed by Serhiy Storchaka in bpo-30349.)\n\nThe result of splitting a string on a regular expression\nthat could match an empty string has been changed.  For example\nsplitting on r'\\s*' will now split not only on whitespaces as it\ndid previously, but also on empty strings before all non-whitespace\ncharacters and just before the end of the string.\nThe previous behavior can be restored by changing the pattern\nto r'\\s+'.  A FutureWarning was emitted for such patterns since\nPython 3.5.\nFor patterns that match both empty and non-empty strings, the result of\nsearching for all matches may also be changed in other cases.  For example\nin the string 'a\\n\\n', the pattern r'(?m)^\\s*?$' will not only\nmatch empty strings at positions 2 and 3, but also the string '\\n' at\npositions 2–3.  To match only blank lines, the pattern should be rewritten\nas r'(?m)^[^\\S\\n]*$'.\nre.sub() now replaces empty matches adjacent to a previous\nnon-empty match.  For example re.sub('x*', '-', 'abxd') returns now\n'-a-b--d-' instead of '-a-b-d-' (the first minus between ‘b’ and\n‘d’ replaces ‘x’, and the second minus replaces an empty string between\n‘x’ and ‘d’).\n(Contributed by Serhiy Storchaka in bpo-25054 and bpo-32308.)\n\nChange re.escape() to only escape regex special characters instead\nof escaping all characters other than ASCII letters, numbers, and '_'.\n(Contributed by Serhiy Storchaka in bpo-29995.)\ntracemalloc.Traceback frames are now sorted from oldest to most\nrecent to be more consistent with traceback.\n(Contributed by Jesse Bakker in bpo-32121.)\nOn OSes that support socket.SOCK_NONBLOCK or\nsocket.SOCK_CLOEXEC bit flags, the\nsocket.type no longer has them applied.\nTherefore, checks like if sock.type == socket.SOCK_STREAM\nwork as expected on all platforms.\n(Contributed by Yury Selivanov in bpo-32331.)\nOn Windows the default for the close_fds argument of\nsubprocess.Popen was changed from False to True\nwhen redirecting the standard handles. If you previously depended on handles\nbeing inherited when using subprocess.Popen with standard io\nredirection, you will have to pass close_fds=False to preserve the\nprevious behaviour, or use\nSTARTUPINFO.lpAttributeList.\nimportlib.machinery.PathFinder.invalidate_caches() – which implicitly\naffects importlib.invalidate_caches() – now deletes entries\nin sys.path_importer_cache which are set to None.\n(Contributed by Brett Cannon in bpo-33169.)\nIn asyncio,\nloop.sock_recv(),\nloop.sock_sendall(),\nloop.sock_accept(),\nloop.getaddrinfo(),\nloop.getnameinfo()\nhave been changed to be proper coroutine methods to match their\ndocumentation.  Previously, these methods returned asyncio.Future\ninstances.\n(Contributed by Yury Selivanov in bpo-32327.)\nasyncio.Server.sockets now returns a copy of the internal list\nof server sockets, instead of returning it directly.\n(Contributed by Yury Selivanov in bpo-32662.)\nStruct.format is now a str instance\ninstead of a bytes instance.\n(Contributed by Victor Stinner in bpo-21071.)\nargparse subparsers can now be made mandatory by passing required=True\nto ArgumentParser.add_subparsers().\n(Contributed by Anthony Sottile in bpo-26510.)\nast.literal_eval() is now stricter.  Addition and subtraction of\narbitrary numbers are no longer allowed.\n(Contributed by Serhiy Storchaka in bpo-31778.)\nCalendar.itermonthdates\nwill now consistently raise an exception when a date falls outside of the\n0001-01-01 through 9999-12-31 range.  To support applications that\ncannot tolerate such exceptions, the new\nCalendar.itermonthdays3 and\nCalendar.itermonthdays4 can be used.\nThe new methods return tuples and are not restricted by the range supported by\ndatetime.date.\n(Contributed by Alexander Belopolsky in bpo-28292.)\ncollections.ChainMap now preserves the order of the underlying\nmappings.  (Contributed by Raymond Hettinger in bpo-32792.)\nThe submit() method of concurrent.futures.ThreadPoolExecutor\nand concurrent.futures.ProcessPoolExecutor now raises\na RuntimeError if called during interpreter shutdown.\n(Contributed by Mark Nemec in bpo-33097.)\nThe configparser.ConfigParser constructor now uses read_dict()\nto process the default values, making its behavior consistent with the\nrest of the parser.  Non-string keys and values in the defaults\ndictionary are now being implicitly converted to strings.\n(Contributed by James Tocknell in bpo-23835.)\nSeveral undocumented internal imports were removed.\nOne example is that os.errno is no longer available; use import errno\ndirectly instead.\nNote that such undocumented internal imports may be removed any time without\nnotice, even in micro version releases.", "code_blocks": []}, "porting-to-python-3-7 - changes-in-the-c-api": {"text": "Changes in the C API\n\nThe function PySlice_GetIndicesEx() is considered unsafe for\nresizable sequences.  If the slice indices are not instances of int,\nbut objects that implement the __index__() method, the sequence can be\nresized after passing its length to PySlice_GetIndicesEx().  This\ncan lead to returning indices out of the length of the sequence.  For\navoiding possible problems use new functions PySlice_Unpack() and\nPySlice_AdjustIndices().\n(Contributed by Serhiy Storchaka in bpo-27867.)", "code_blocks": []}, "porting-to-python-3-7 - cpython-bytecode-changes": {"text": "CPython bytecode changes\n\nThere are two new opcodes: LOAD_METHOD and CALL_METHOD.\n(Contributed by Yury Selivanov and INADA Naoki in bpo-26110.)\nThe STORE_ANNOTATION opcode has been removed.\n(Contributed by Mark Shannon in bpo-32550.)", "code_blocks": []}, "porting-to-python-3-7 - id12": {"text": "Windows-only Changes\n\nThe file used to override sys.path is now called\n<python-executable>._pth instead of 'sys.path'.\nSee Finding modules for more information.\n(Contributed by Steve Dower in bpo-28137.)", "code_blocks": []}, "porting-to-python-3-7 - id13": {"text": "Other CPython implementation changes\n\nIn preparation for potential future changes to the public CPython runtime\ninitialization API (see PEP 432 for an initial, but somewhat outdated,\ndraft), CPython’s internal startup\nand configuration management logic has been significantly refactored. While\nthese updates are intended to be entirely transparent to both embedding\napplications and users of the regular CPython CLI, they’re being mentioned\nhere as the refactoring changes the internal order of various operations\nduring interpreter startup, and hence may uncover previously latent defects,\neither in embedding applications, or in CPython itself.\n(Initially contributed by Nick Coghlan and Eric Snow as part of\nbpo-22257, and further updated by Nick, Eric, and Victor Stinner in a\nnumber of other issues). Some known details affected:\n\nPySys_AddWarnOptionUnicode() is not currently usable by embedding\napplications due to the requirement to create a Unicode object prior to\ncalling Py_Initialize. Use PySys_AddWarnOption() instead.\nwarnings filters added by an embedding application with\nPySys_AddWarnOption() should now more consistently take precedence\nover the default filters set by the interpreter\n\nDue to changes in the way the default warnings filters are configured,\nsetting Py_BytesWarningFlag to a value greater than one is no longer\nsufficient to both emit BytesWarning messages and have them converted\nto exceptions.  Instead, the flag must be set (to cause the warnings to be\nemitted in the first place), and an explicit error::BytesWarning\nwarnings filter added to convert them to exceptions.\nDue to a change in the way docstrings are handled by the compiler, the\nimplicit return None in a function body consisting solely of a docstring\nis now marked as occurring on the same line as the docstring, not on the\nfunction’s header line.\nThe current exception state has been moved from the frame object to the co-routine.\nThis simplified the interpreter and fixed a couple of obscure bugs caused by\nhaving swap exception state when entering or exiting a generator.\n(Contributed by Mark Shannon in bpo-25612.)", "code_blocks": []}, "notable-changes-in-python-3-7-1": {"text": "Notable changes in Python 3.7.1\n\nStarting in 3.7.1, Py_Initialize() now consistently reads and respects\nall of the same environment settings as Py_Main() (in earlier Python\nversions, it respected an ill-defined subset of those environment variables,\nwhile in Python 3.7.0 it didn’t read any of them due to bpo-34247). If\nthis behavior is unwanted, set Py_IgnoreEnvironmentFlag to 1 before\ncalling Py_Initialize().\nIn 3.7.1 the C API for Context Variables\nwas updated to use\nPyObject pointers.  See also bpo-34762.\nxml.dom.minidom and xml.sax modules no longer process\nexternal entities by default. See also bpo-17239.\nIn 3.7.1 the tokenize module now implicitly emits a NEWLINE token\nwhen provided with input that does not have a trailing new line.  This behavior\nnow matches what the C tokenizer does internally.\n(Contributed by Ammar Askar in bpo-33899.)", "code_blocks": []}, "notable-changes-in-python-3-7-2": {"text": "Notable changes in Python 3.7.2\n\nIn 3.7.2, venv on Windows no longer copies the original binaries, but\ncreates redirector scripts named python.exe and pythonw.exe instead.\nThis resolves a long standing issue where all virtual environments would have\nto be upgraded or recreated with each Python update. However, note that this\nrelease will still require recreation of virtual environments in order to get\nthe new scripts.", "code_blocks": []}, "notable-changes-in-python-3-7-6": {"text": "Notable changes in Python 3.7.6\n\nDue to significant security concerns, the reuse_address parameter of\nasyncio.loop.create_datagram_endpoint() is no longer supported. This is\nbecause of the behavior of the socket option SO_REUSEADDR in UDP. For more\ndetails, see the documentation for loop.create_datagram_endpoint().\n(Contributed by Kyle Stanley, Antoine Pitrou, and Yury Selivanov in\nbpo-37228.)", "code_blocks": []}, "notable-changes-in-python-3-7-10": {"text": "Notable changes in Python 3.7.10\n\nEarlier Python versions allowed using both ; and & as\nquery parameter separators in urllib.parse.parse_qs() and\nurllib.parse.parse_qsl().  Due to security concerns, and to conform with\nnewer W3C recommendations, this has been changed to allow only a single\nseparator key, with & as the default.  This change also affects\ncgi.parse() and cgi.parse_multipart() as they use the affected\nfunctions internally. For more details, please see their respective\ndocumentation.\n(Contributed by Adam Goldschmidt, Senthil Kumaran and Ken Jin in bpo-42967.)", "code_blocks": []}, "notable-changes-in-python-3-7-11": {"text": "Notable changes in Python 3.7.11\n\nA security fix alters the ftplib.FTP behavior to not trust the\nIPv4 address sent from the remote server when setting up a passive data\nchannel.  We reuse the ftp server IP address instead.  For unusual code\nrequiring the old behavior, set a trust_server_pasv_ipv4_address\nattribute on your FTP instance to True.  (See bpo-43285)\nThe presence of newline or tab characters in parts of a URL allows for some\nforms of attacks. Following the WHATWG specification that updates RFC 3986,\nASCII newline \\n, \\r and tab \\t characters are stripped from the\nURL by the parser urllib.parse() preventing such attacks. The removal\ncharacters are controlled by a new module level variable\nurllib.parse._UNSAFE_URL_BYTES_TO_REMOVE. (See bpo-43882)", "code_blocks": []}, "notable-security-feature-in-3-7-14": {"text": "Notable security feature in 3.7.14\n\nConverting between int and str in bases other than 2\n(binary), 4, 8 (octal), 16 (hexadecimal), or 32 such as base 10 (decimal)\nnow raises a ValueError if the number of digits in string form is\nabove a limit to avoid potential denial of service attacks due to the\nalgorithmic complexity. This is a mitigation for CVE-2020-10735.\nThis limit can be configured or disabled by environment variable, command\nline flag, or sys APIs. See the integer string conversion\nlength limitation documentation.  The default limit\nis 4300 digits in string form.", "code_blocks": []}}}
{"index": 10, "python_version": "3.8", "url": "https://docs.python.org/3.8/whatsnew/3.8.html", "sections": {"summary-release-highlights": {"text": "Summary – Release highlights", "code_blocks": []}, "new-features - assignment-expressions": {"text": "Assignment expressions\n\nThere is new syntax := that assigns values to variables as part of a larger\nexpression. It is affectionately known as “the walrus operator” due to\nits resemblance to the eyes and tusks of a walrus.\nIn this example, the assignment expression helps avoid calling\nlen() twice:\nif (n := len(a)) > 10:\n    print(f\"List is too long ({n} elements, expected <= 10)\")\n\n\nA similar benefit arises during regular expression matching where\nmatch objects are needed twice, once to test whether a match\noccurred and another to extract a subgroup:\ndiscount = 0.0\nif (mo := re.search(r'(\\d+)% discount', advertisement)):\n    discount = float(mo.group(1)) / 100.0\n\n\nThe operator is also useful with while-loops that compute\na value to test loop termination and then need that same\nvalue again in the body of the loop:\n# Loop over fixed length blocks\nwhile (block := f.read(256)) != '':\n    process(block)\n\n\nAnother motivating use case arises in list comprehensions where\na value computed in a filtering condition is also needed in\nthe expression body:\n[clean_name.title() for name in names\n if (clean_name := normalize('NFC', name)) in allowed_names]\n\n\nTry to limit use of the walrus operator to clean cases that reduce\ncomplexity and improve readability.\nSee PEP 572 for a full description.\n(Contributed by Emily Morehouse in bpo-35224.)", "code_blocks": ["if (n := len(a)) > 10:\n    print(f\"List is too long ({n} elements, expected <= 10)\")\n", "discount = 0.0\nif (mo := re.search(r'(\\d+)% discount', advertisement)):\n    discount = float(mo.group(1)) / 100.0\n", "# Loop over fixed length blocks\nwhile (block := f.read(256)) != '':\n    process(block)\n", "[clean_name.title() for name in names\n if (clean_name := normalize('NFC', name)) in allowed_names]\n"]}, "new-features - positional-only-parameters": {"text": "Positional-only parameters\n\nThere is a new function parameter syntax / to indicate that some\nfunction parameters must be specified positionally and cannot be used as\nkeyword arguments.  This is the same notation shown by help() for C\nfunctions annotated with Larry Hastings’ Argument Clinic tool.\nIn the following example, parameters a and b are positional-only,\nwhile c or d can be positional or keyword, and e or f are\nrequired to be keywords:\ndef f(a, b, /, c, d, *, e, f):\n    print(a, b, c, d, e, f)\n\n\nThe following is a valid call:\nf(10, 20, 30, d=40, e=50, f=60)\n\n\nHowever, these are invalid calls:\nf(10, b=20, c=30, d=40, e=50, f=60)   # b cannot be a keyword argument\nf(10, 20, 30, 40, 50, f=60)           # e must be a keyword argument\n\n\nOne use case for this notation is that it allows pure Python functions\nto fully emulate behaviors of existing C coded functions.  For example,\nthe built-in divmod() function does not accept keyword arguments:\ndef divmod(a, b, /):\n    \"Emulate the built in divmod() function\"\n    return (a // b, a % b)\n\n\nAnother use case is to preclude keyword arguments when the parameter\nname is not helpful.  For example, the builtin len() function has\nthe signature len(obj, /).  This precludes awkward calls such as:\nlen(obj='hello')  # The \"obj\" keyword argument impairs readability\n\n\nA further benefit of marking a parameter as positional-only is that it\nallows the parameter name to be changed in the future without risk of\nbreaking client code.  For example, in the statistics module, the\nparameter name dist may be changed in the future.  This was made\npossible with the following function specification:\ndef quantiles(dist, /, *, n=4, method='exclusive')\n    ...\n\n\nSince the parameters to the left of / are not exposed as possible\nkeywords, the parameters names remain available for use in **kwargs:\n>>> def f(a, b, /, **kwargs):\n...     print(a, b, kwargs)\n...\n>>> f(10, 20, a=1, b=2, c=3)         # a and b are used in two ways\n10 20 {'a': 1, 'b': 2, 'c': 3}\n\n\nThis greatly simplifies the implementation of functions and methods\nthat need to accept arbitrary keyword arguments.  For example, here\nis an excerpt from code in the collections module:\nclass Counter(dict):\n\n    def __init__(self, iterable=None, /, **kwds):\n        # Note \"iterable\" is a possible keyword argument\n\n\nSee PEP 570 for a full description.\n(Contributed by Pablo Galindo in bpo-36540.)", "code_blocks": ["def f(a, b, /, c, d, *, e, f):\n    print(a, b, c, d, e, f)\n", "f(10, 20, 30, d=40, e=50, f=60)\n", "f(10, b=20, c=30, d=40, e=50, f=60)   # b cannot be a keyword argument\nf(10, 20, 30, 40, 50, f=60)           # e must be a keyword argument\n", "def divmod(a, b, /):\n    \"Emulate the built in divmod() function\"\n    return (a // b, a % b)\n", "len(obj='hello')  # The \"obj\" keyword argument impairs readability\n", "def quantiles(dist, /, *, n=4, method='exclusive')\n    ...\n", ">>> def f(a, b, /, **kwargs):\n...     print(a, b, kwargs)\n...\n>>> f(10, 20, a=1, b=2, c=3)         # a and b are used in two ways\n10 20 {'a': 1, 'b': 2, 'c': 3}\n", "class Counter(dict):\n\n    def __init__(self, iterable=None, /, **kwds):\n        # Note \"iterable\" is a possible keyword argument\n"]}, "new-features - parallel-filesystem-cache-for-compiled-bytecode-files": {"text": "Parallel filesystem cache for compiled bytecode files\n\nThe new PYTHONPYCACHEPREFIX setting (also available as\n-X pycache_prefix) configures the implicit bytecode\ncache to use a separate parallel filesystem tree, rather than\nthe default __pycache__ subdirectories within each source\ndirectory.\nThe location of the cache is reported in sys.pycache_prefix\n(None indicates the default location in __pycache__\nsubdirectories).\n(Contributed by Carl Meyer in bpo-33499.)", "code_blocks": []}, "new-features - debug-build-uses-the-same-abi-as-release-build": {"text": "Debug build uses the same ABI as release build\n\nPython now uses the same ABI whether it’s built in release or debug mode. On\nUnix, when Python is built in debug mode, it is now possible to load C\nextensions built in release mode and C extensions built using the stable ABI.\nRelease builds and debug builds are now ABI compatible: defining the\nPy_DEBUG macro no longer implies the Py_TRACE_REFS macro, which\nintroduces the only ABI incompatibility. The Py_TRACE_REFS macro, which\nadds the sys.getobjects() function and the PYTHONDUMPREFS\nenvironment variable, can be set using the new ./configure --with-trace-refs\nbuild option.\n(Contributed by Victor Stinner in bpo-36465.)\nOn Unix, C extensions are no longer linked to libpython except on Android\nand Cygwin.\nIt is now possible\nfor a statically linked Python to load a C extension built using a shared\nlibrary Python.\n(Contributed by Victor Stinner in bpo-21536.)\nOn Unix, when Python is built in debug mode, import now also looks for C\nextensions compiled in release mode and for C extensions compiled with the\nstable ABI.\n(Contributed by Victor Stinner in bpo-36722.)\nTo embed Python into an application, a new --embed option must be passed to\npython3-config --libs --embed to get -lpython3.8 (link the application\nto libpython). To support both 3.8 and older, try python3-config --libs\n--embed first and fallback to python3-config --libs (without --embed)\nif the previous command fails.\nAdd a pkg-config python-3.8-embed module to embed Python into an\napplication: pkg-config python-3.8-embed --libs includes -lpython3.8.\nTo support both 3.8 and older, try pkg-config python-X.Y-embed --libs first\nand fallback to pkg-config python-X.Y --libs (without --embed) if the\nprevious command fails (replace X.Y with the Python version).\nOn the other hand, pkg-config python3.8 --libs no longer contains\n-lpython3.8. C extensions must not be linked to libpython (except on\nAndroid and Cygwin, whose cases are handled by the script);\nthis change is backward incompatible on purpose.\n(Contributed by Victor Stinner in bpo-36721.)", "code_blocks": []}, "new-features - f-strings-support-for-self-documenting-expressions-and-debugging": {"text": "f-strings support = for self-documenting expressions and debugging\n\nAdded an = specifier to f-strings. An f-string such as\nf'{expr=}' will expand to the text of the expression, an equal sign,\nthen the representation of the evaluated expression.  For example:\n>>> user = 'eric_idle'\n>>> member_since = date(1975, 7, 31)\n>>> f'{user=} {member_since=}'\n\"user='eric_idle' member_since=datetime.date(1975, 7, 31)\"\n\n\nThe usual f-string format specifiers allow more\ncontrol over how the result of the expression is displayed:\n>>> delta = date.today() - member_since\n>>> f'{user=!s}  {delta.days=:,d}'\n'user=eric_idle  delta.days=16,075'\n\n\nThe = specifier will display the whole expression so that\ncalculations can be shown:\n>>> print(f'{theta=}  {cos(radians(theta))=:.3f}')\ntheta=30  cos(radians(theta))=0.866\n\n\n(Contributed by Eric V. Smith and Larry Hastings in bpo-36817.)", "code_blocks": [">>> user = 'eric_idle'\n>>> member_since = date(1975, 7, 31)\n>>> f'{user=} {member_since=}'\n\"user='eric_idle' member_since=datetime.date(1975, 7, 31)\"\n", ">>> delta = date.today() - member_since\n>>> f'{user=!s}  {delta.days=:,d}'\n'user=eric_idle  delta.days=16,075'\n", ">>> print(f'{theta=}  {cos(radians(theta))=:.3f}')\ntheta=30  cos(radians(theta))=0.866\n"]}, "new-features - pep-578-python-runtime-audit-hooks": {"text": "PEP 578: Python Runtime Audit Hooks\n\nThe PEP adds an Audit Hook and Verified Open Hook. Both are available from\nPython and native code, allowing applications and frameworks written in pure\nPython code to take advantage of extra notifications, while also allowing\nembedders or system administrators to deploy builds of Python where auditing is\nalways enabled.\nSee PEP 578 for full details.", "code_blocks": []}, "new-features - pep-587-python-initialization-configuration": {"text": "PEP 587: Python Initialization Configuration\n\nThe PEP 587 adds a new C API to configure the Python Initialization\nproviding finer control on the whole configuration and better error reporting.\nNew structures:\n\nPyConfig\nPyPreConfig\nPyStatus\nPyWideStringList\n\nNew functions:\n\nPyConfig_Clear()\nPyConfig_InitIsolatedConfig()\nPyConfig_InitPythonConfig()\nPyConfig_Read()\nPyConfig_SetArgv()\nPyConfig_SetBytesArgv()\nPyConfig_SetBytesString()\nPyConfig_SetString()\nPyPreConfig_InitIsolatedConfig()\nPyPreConfig_InitPythonConfig()\nPyStatus_Error()\nPyStatus_Exception()\nPyStatus_Exit()\nPyStatus_IsError()\nPyStatus_IsExit()\nPyStatus_NoMemory()\nPyStatus_Ok()\nPyWideStringList_Append()\nPyWideStringList_Insert()\nPy_BytesMain()\nPy_ExitStatusException()\nPy_InitializeFromConfig()\nPy_PreInitialize()\nPy_PreInitializeFromArgs()\nPy_PreInitializeFromBytesArgs()\nPy_RunMain()\n\nThis PEP also adds _PyRuntimeState.preconfig (PyPreConfig type)\nand PyInterpreterState.config (PyConfig type) fields to these\ninternal structures. PyInterpreterState.config becomes the new\nreference configuration, replacing global configuration variables and\nother private variables.\nSee Python Initialization Configuration for the\ndocumentation.\nSee PEP 587 for a full description.\n(Contributed by Victor Stinner in bpo-36763.)", "code_blocks": []}, "new-features - vectorcall-a-fast-calling-protocol-for-cpython": {"text": "Vectorcall: a fast calling protocol for CPython\n\nThe “vectorcall” protocol is added to the Python/C API.\nIt is meant to formalize existing optimizations which were already done\nfor various classes.\nAny extension type implementing a callable can use this protocol.\nThis is currently provisional.\nThe aim is to make it fully public in Python 3.9.\nSee PEP 590 for a full description.\n(Contributed by Jeroen Demeyer and Mark Shannon in bpo-36974.)", "code_blocks": []}, "new-features - pickle-protocol-5-with-out-of-band-data-buffers": {"text": "Pickle protocol 5 with out-of-band data buffers\n\nWhen pickle is used to transfer large data between Python processes\nin order to take advantage of multi-core or multi-machine processing,\nit is important to optimize the transfer by reducing memory copies, and\npossibly by applying custom techniques such as data-dependent compression.\nThe pickle protocol 5 introduces support for out-of-band buffers\nwhere PEP 3118-compatible data can be transmitted separately from the\nmain pickle stream, at the discretion of the communication layer.\nSee PEP 574 for a full description.\n(Contributed by Antoine Pitrou in bpo-36785.)", "code_blocks": []}, "other-language-changes": {"text": "Other Language Changes\n\n\nA continue statement was illegal in the finally clause\ndue to a problem with the implementation.  In Python 3.8 this restriction\nwas lifted.\n(Contributed by Serhiy Storchaka in bpo-32489.)\nThe bool, int, and fractions.Fraction types\nnow have an as_integer_ratio() method like that found in\nfloat and decimal.Decimal.  This minor API extension\nmakes it possible to write numerator, denominator =\nx.as_integer_ratio() and have it work across multiple numeric types.\n(Contributed by Lisa Roach in bpo-33073 and Raymond Hettinger in\nbpo-37819.)\nConstructors of int, float and complex will now\nuse the __index__() special method, if available and the\ncorresponding method __int__(), __float__()\nor __complex__() is not available.\n(Contributed by Serhiy Storchaka in bpo-20092.)\nAdded support of \\N{name} escapes in regular expressions:\n>>> notice = 'Copyright © 2019'\n>>> copyright_year_pattern = re.compile(r'\\N{copyright sign}\\s*(\\d{4})')\n>>> int(copyright_year_pattern.search(notice).group(1))\n2019\n\n\n(Contributed by Jonathan Eunice and Serhiy Storchaka in bpo-30688.)\n\nDict and dictviews are now iterable in reversed insertion order using\nreversed(). (Contributed by Rémi Lapeyre in bpo-33462.)\nThe syntax allowed for keyword names in function calls was further\nrestricted. In particular, f((keyword)=arg) is no longer allowed. It was\nnever intended to permit more than a bare name on the left-hand side of a\nkeyword argument assignment term.\n(Contributed by Benjamin Peterson in bpo-34641.)\nGeneralized iterable unpacking in yield and\nreturn statements no longer requires enclosing parentheses.\nThis brings the yield and return syntax into better agreement with\nnormal assignment syntax:\n>>> def parse(family):\n        lastname, *members = family.split()\n        return lastname.upper(), *members\n\n>>> parse('simpsons homer marge bart lisa sally')\n('SIMPSONS', 'homer', 'marge', 'bart', 'lisa', 'sally')\n\n\n(Contributed by David Cuthbert and Jordan Chapman in bpo-32117.)\n\nWhen a comma is missed in code such as [(10, 20) (30, 40)], the\ncompiler displays a SyntaxWarning with a helpful suggestion.\nThis improves on just having a TypeError indicating that the\nfirst tuple was not callable.  (Contributed by Serhiy Storchaka in\nbpo-15248.)\nArithmetic operations between subclasses of datetime.date or\ndatetime.datetime and datetime.timedelta objects now return\nan instance of the subclass, rather than the base class. This also affects\nthe return type of operations whose implementation (directly or indirectly)\nuses datetime.timedelta arithmetic, such as\nastimezone().\n(Contributed by Paul Ganssle in bpo-32417.)\nWhen the Python interpreter is interrupted by Ctrl-C (SIGINT) and the\nresulting KeyboardInterrupt exception is not caught, the Python process\nnow exits via a SIGINT signal or with the correct exit code such that the\ncalling process can detect that it died due to a Ctrl-C.  Shells on POSIX\nand Windows use this to properly terminate scripts in interactive sessions.\n(Contributed by Google via Gregory P. Smith in bpo-1054041.)\nSome advanced styles of programming require updating the\ntypes.CodeType object for an existing function.  Since code\nobjects are immutable, a new code object needs to be created, one\nthat is modeled on the existing code object.  With 19 parameters,\nthis was somewhat tedious.  Now, the new replace() method makes\nit possible to create a clone with a few altered parameters.\nHere’s an example that alters the statistics.mean() function to\nprevent the data parameter from being used as a keyword argument:\n>>> from statistics import mean\n>>> mean(data=[10, 20, 90])\n40\n>>> mean.__code__ = mean.__code__.replace(co_posonlyargcount=1)\n>>> mean(data=[10, 20, 90])\nTraceback (most recent call last):\n  ...\nTypeError: mean() got some positional-only arguments passed as keyword arguments: 'data'\n\n\n(Contributed by Victor Stinner in bpo-37032.)\n\nFor integers, the three-argument form of the pow() function now\npermits the exponent to be negative in the case where the base is\nrelatively prime to the modulus. It then computes a modular inverse to\nthe base when the exponent is -1, and a suitable power of that\ninverse for other negative exponents.  For example, to compute the\nmodular multiplicative inverse of 38\nmodulo 137, write:\n>>> pow(38, -1, 137)\n119\n>>> 119 * 38 % 137\n1\n\n\nModular inverses arise in the solution of linear Diophantine\nequations.\nFor example, to find integer solutions for 4258𝑥 + 147𝑦 = 369,\nfirst rewrite as 4258𝑥 ≡ 369 (mod 147) then solve:\n>>> x = 369 * pow(4258, -1, 147) % 147\n>>> y = (4258 * x - 369) // -147\n>>> 4258 * x + 147 * y\n369\n\n\n(Contributed by Mark Dickinson in bpo-36027.)\n\nDict comprehensions have been synced-up with dict literals so that the\nkey is computed first and the value second:\n>>> # Dict comprehension\n>>> cast = {input('role? '): input('actor? ') for i in range(2)}\nrole? King Arthur\nactor? Chapman\nrole? Black Knight\nactor? Cleese\n\n>>> # Dict literal\n>>> cast = {input('role? '): input('actor? ')}\nrole? Sir Robin\nactor? Eric Idle\n\n\nThe guaranteed execution order is helpful with assignment expressions\nbecause variables assigned in the key expression will be available in\nthe value expression:\n>>> names = ['Martin von Löwis', 'Łukasz Langa', 'Walter Dörwald']\n>>> {(n := normalize('NFC', name)).casefold() : n for name in names}\n{'martin von löwis': 'Martin von Löwis',\n 'łukasz langa': 'Łukasz Langa',\n 'walter dörwald': 'Walter Dörwald'}\n\n\n(Contributed by Jörn Heissler in bpo-35224.)\n\nThe object.__reduce__() method can now return a tuple from two to\nsix elements long. Formerly, five was the limit.  The new, optional sixth\nelement is a callable with a (obj, state) signature.  This allows the\ndirect control over the state-updating behavior of a specific object.  If\nnot None, this callable will have priority over the object’s\n__setstate__() method.\n(Contributed by Pierre Glaser and Olivier Grisel in bpo-35900.)", "code_blocks": [">>> notice = 'Copyright © 2019'\n>>> copyright_year_pattern = re.compile(r'\\N{copyright sign}\\s*(\\d{4})')\n>>> int(copyright_year_pattern.search(notice).group(1))\n2019\n", ">>> def parse(family):\n        lastname, *members = family.split()\n        return lastname.upper(), *members\n\n>>> parse('simpsons homer marge bart lisa sally')\n('SIMPSONS', 'homer', 'marge', 'bart', 'lisa', 'sally')\n", ">>> from statistics import mean\n>>> mean(data=[10, 20, 90])\n40\n>>> mean.__code__ = mean.__code__.replace(co_posonlyargcount=1)\n>>> mean(data=[10, 20, 90])\nTraceback (most recent call last):\n  ...\nTypeError: mean() got some positional-only arguments passed as keyword arguments: 'data'\n", ">>> pow(38, -1, 137)\n119\n>>> 119 * 38 % 137\n1\n", ">>> x = 369 * pow(4258, -1, 147) % 147\n>>> y = (4258 * x - 369) // -147\n>>> 4258 * x + 147 * y\n369\n", ">>> # Dict comprehension\n>>> cast = {input('role? '): input('actor? ') for i in range(2)}\nrole? King Arthur\nactor? Chapman\nrole? Black Knight\nactor? Cleese\n\n>>> # Dict literal\n>>> cast = {input('role? '): input('actor? ')}\nrole? Sir Robin\nactor? Eric Idle\n", ">>> names = ['Martin von Löwis', 'Łukasz Langa', 'Walter Dörwald']\n>>> {(n := normalize('NFC', name)).casefold() : n for name in names}\n{'martin von löwis': 'Martin von Löwis',\n 'łukasz langa': 'Łukasz Langa',\n 'walter dörwald': 'Walter Dörwald'}\n"]}, "new-modules": {"text": "New Modules\n\n\nThe new importlib.metadata module provides (provisional) support for\nreading metadata from third-party packages.  For example, it can extract an\ninstalled package’s version number, list of entry points, and more:\n>>> # Note following example requires that the popular \"requests\"\n>>> # package has been installed.\n>>>\n>>> from importlib.metadata import version, requires, files\n>>> version('requests')\n'2.22.0'\n>>> list(requires('requests'))\n['chardet (<3.1.0,>=3.0.2)']\n>>> list(files('requests'))[:5]\n[PackagePath('requests-2.22.0.dist-info/INSTALLER'),\n PackagePath('requests-2.22.0.dist-info/LICENSE'),\n PackagePath('requests-2.22.0.dist-info/METADATA'),\n PackagePath('requests-2.22.0.dist-info/RECORD'),\n PackagePath('requests-2.22.0.dist-info/WHEEL')]\n\n\n(Contributed by Barry Warsaw and Jason R. Coombs in bpo-34632.)", "code_blocks": [">>> # Note following example requires that the popular \"requests\"\n>>> # package has been installed.\n>>>\n>>> from importlib.metadata import version, requires, files\n>>> version('requests')\n'2.22.0'\n>>> list(requires('requests'))\n['chardet (<3.1.0,>=3.0.2)']\n>>> list(files('requests'))[:5]\n[PackagePath('requests-2.22.0.dist-info/INSTALLER'),\n PackagePath('requests-2.22.0.dist-info/LICENSE'),\n PackagePath('requests-2.22.0.dist-info/METADATA'),\n PackagePath('requests-2.22.0.dist-info/RECORD'),\n PackagePath('requests-2.22.0.dist-info/WHEEL')]\n"]}, "improved-modules - ast": {"text": "ast\n\nAST nodes now have end_lineno and end_col_offset attributes,\nwhich give the precise location of the end of the node.  (This only\napplies to nodes that have lineno and col_offset attributes.)\nNew function ast.get_source_segment() returns the source code\nfor a specific AST node.\n(Contributed by Ivan Levkivskyi in bpo-33416.)\nThe ast.parse() function has some new flags:\n\ntype_comments=True causes it to return the text of PEP 484 and\nPEP 526 type comments associated with certain AST nodes;\nmode='func_type' can be used to parse PEP 484 “signature type\ncomments” (returned for function definition AST nodes);\nfeature_version=(3, N) allows specifying an earlier Python 3\nversion.  For example, feature_version=(3, 4) will treat\nasync and await as non-reserved words.\n\n(Contributed by Guido van Rossum in bpo-35766.)", "code_blocks": []}, "improved-modules - asyncio": {"text": "asyncio\n\nasyncio.run() has graduated from the provisional to stable API. This\nfunction can be used to execute a coroutine and return the result while\nautomatically managing the event loop. For example:\nimport asyncio\n\nasync def main():\n    await asyncio.sleep(0)\n    return 42\n\nasyncio.run(main())\n\n\nThis is roughly equivalent to:\nimport asyncio\n\nasync def main():\n    await asyncio.sleep(0)\n    return 42\n\nloop = asyncio.new_event_loop()\nasyncio.set_event_loop(loop)\ntry:\n    loop.run_until_complete(main())\nfinally:\n    asyncio.set_event_loop(None)\n    loop.close()\n\n\nThe actual implementation is significantly more complex. Thus,\nasyncio.run() should be the preferred way of running asyncio programs.\n(Contributed by Yury Selivanov in bpo-32314.)\nRunning python -m asyncio launches a natively async REPL.  This allows rapid\nexperimentation with code that has a top-level await.  There is no\nlonger a need to directly call asyncio.run() which would spawn a new event\nloop on every invocation:\n$ python -m asyncio\nasyncio REPL 3.8.0\nUse \"await\" directly instead of \"asyncio.run()\".\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import asyncio\n>>> await asyncio.sleep(10, result='hello')\nhello\n\n\n(Contributed by Yury Selivanov in bpo-37028.)\nThe exception asyncio.CancelledError now inherits from\nBaseException rather than Exception and no longer inherits\nfrom concurrent.futures.CancelledError.\n(Contributed by Yury Selivanov in bpo-32528.)\nOn Windows, the default event loop is now ProactorEventLoop.\n(Contributed by Victor Stinner in bpo-34687.)\nProactorEventLoop now also supports UDP.\n(Contributed by Adam Meily and Andrew Svetlov in bpo-29883.)\nProactorEventLoop can now be interrupted by\nKeyboardInterrupt (“CTRL+C”).\n(Contributed by Vladimir Matveev in bpo-23057.)\nAdded asyncio.Task.get_coro() for getting the wrapped coroutine\nwithin an asyncio.Task.\n(Contributed by Alex Grönholm in bpo-36999.)\nAsyncio tasks can now be named, either by passing the name keyword\nargument to asyncio.create_task() or\nthe create_task() event loop method, or by\ncalling the set_name() method on the task object. The\ntask name is visible in the repr() output of asyncio.Task and\ncan also be retrieved using the get_name() method.\n(Contributed by Alex Grönholm in bpo-34270.)\nAdded support for\nHappy Eyeballs to\nasyncio.loop.create_connection(). To specify the behavior, two new\nparameters have been added: happy_eyeballs_delay and interleave. The Happy\nEyeballs algorithm improves responsiveness in applications that support IPv4\nand IPv6 by attempting to simultaneously connect using both.\n(Contributed by twisteroid ambassador in bpo-33530.)", "code_blocks": ["import asyncio\n\nasync def main():\n    await asyncio.sleep(0)\n    return 42\n\nasyncio.run(main())\n", "import asyncio\n\nasync def main():\n    await asyncio.sleep(0)\n    return 42\n\nloop = asyncio.new_event_loop()\nasyncio.set_event_loop(loop)\ntry:\n    loop.run_until_complete(main())\nfinally:\n    asyncio.set_event_loop(None)\n    loop.close()\n", "$ python -m asyncio\nasyncio REPL 3.8.0\nUse \"await\" directly instead of \"asyncio.run()\".\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import asyncio\n>>> await asyncio.sleep(10, result='hello')\nhello\n"]}, "improved-modules - builtins": {"text": "builtins\n\nThe compile() built-in has been improved to accept the\nast.PyCF_ALLOW_TOP_LEVEL_AWAIT flag. With this new flag passed,\ncompile() will allow top-level await, async for and async with\nconstructs that are usually considered invalid syntax. Asynchronous code object\nmarked with the CO_COROUTINE flag may then be returned.\n(Contributed by Matthias Bussonnier in bpo-34616)", "code_blocks": []}, "improved-modules - collections": {"text": "collections\n\nThe _asdict() method for\ncollections.namedtuple() now returns a dict instead of a\ncollections.OrderedDict. This works because regular dicts have\nguaranteed ordering since Python 3.7. If the extra features of\nOrderedDict are required, the suggested remediation is to cast the\nresult to the desired type: OrderedDict(nt._asdict()).\n(Contributed by Raymond Hettinger in bpo-35864.)", "code_blocks": []}, "improved-modules - cprofile": {"text": "cProfile\n\nThe cProfile.Profile class can now be used as a context manager.\nProfile a block of code by running:\nimport cProfile\n\nwith cProfile.Profile() as profiler:\n      # code to be profiled\n      ...\n\n\n(Contributed by Scott Sanderson in bpo-29235.)", "code_blocks": ["import cProfile\n\nwith cProfile.Profile() as profiler:\n      # code to be profiled\n      ...\n"]}, "improved-modules - csv": {"text": "csv\n\nThe csv.DictReader now returns instances of dict instead of\na collections.OrderedDict.  The tool is now faster and uses less\nmemory while still preserving the field order.\n(Contributed by Michael Selik in bpo-34003.)", "code_blocks": []}, "improved-modules - curses": {"text": "curses\n\nAdded a new variable holding structured version information for the\nunderlying ncurses library: ncurses_version.\n(Contributed by Serhiy Storchaka in bpo-31680.)", "code_blocks": []}, "improved-modules - ctypes": {"text": "ctypes\n\nOn Windows, CDLL and subclasses now accept a winmode parameter\nto specify flags for the underlying LoadLibraryEx call. The default flags are\nset to only load DLL dependencies from trusted locations, including the path\nwhere the DLL is stored (if a full or partial path is used to load the initial\nDLL) and paths added by add_dll_directory().\n(Contributed by Steve Dower in bpo-36085.)", "code_blocks": []}, "improved-modules - datetime": {"text": "datetime\n\nAdded new alternate constructors datetime.date.fromisocalendar() and\ndatetime.datetime.fromisocalendar(), which construct date and\ndatetime objects respectively from ISO year, week number, and weekday;\nthese are the inverse of each class’s isocalendar method.\n(Contributed by Paul Ganssle in bpo-36004.)", "code_blocks": []}, "improved-modules - functools": {"text": "functools\n\nfunctools.lru_cache() can now be used as a straight decorator rather\nthan as a function returning a decorator.  So both of these are now supported:\n@lru_cache\ndef f(x):\n    ...\n\n@lru_cache(maxsize=256)\ndef f(x):\n    ...\n\n\n(Contributed by Raymond Hettinger in bpo-36772.)\nAdded a new functools.cached_property() decorator, for computed properties\ncached for the life of the instance.\nimport functools\nimport statistics\n\nclass Dataset:\n   def __init__(self, sequence_of_numbers):\n      self.data = sequence_of_numbers\n\n   @functools.cached_property\n   def variance(self):\n      return statistics.variance(self.data)\n\n\n(Contributed by Carl Meyer in bpo-21145)\nAdded a new functools.singledispatchmethod() decorator that converts\nmethods into generic functions using\nsingle dispatch:\nfrom functools import singledispatchmethod\nfrom contextlib import suppress\n\nclass TaskManager:\n\n    def __init__(self, tasks):\n        self.tasks = list(tasks)\n\n    @singledispatchmethod\n    def discard(self, value):\n        with suppress(ValueError):\n            self.tasks.remove(value)\n\n    @discard.register(list)\n    def _(self, tasks):\n        targets = set(tasks)\n        self.tasks = [x for x in self.tasks if x not in targets]\n\n\n(Contributed by Ethan Smith in bpo-32380)", "code_blocks": ["@lru_cache\ndef f(x):\n    ...\n\n@lru_cache(maxsize=256)\ndef f(x):\n    ...\n", "import functools\nimport statistics\n\nclass Dataset:\n   def __init__(self, sequence_of_numbers):\n      self.data = sequence_of_numbers\n\n   @functools.cached_property\n   def variance(self):\n      return statistics.variance(self.data)\n", "from functools import singledispatchmethod\nfrom contextlib import suppress\n\nclass TaskManager:\n\n    def __init__(self, tasks):\n        self.tasks = list(tasks)\n\n    @singledispatchmethod\n    def discard(self, value):\n        with suppress(ValueError):\n            self.tasks.remove(value)\n\n    @discard.register(list)\n    def _(self, tasks):\n        targets = set(tasks)\n        self.tasks = [x for x in self.tasks if x not in targets]\n"]}, "improved-modules - gc": {"text": "gc\n\nget_objects() can now receive an optional generation parameter\nindicating a generation to get objects from.\n(Contributed by Pablo Galindo in bpo-36016.)", "code_blocks": []}, "improved-modules - gettext": {"text": "gettext\n\nAdded pgettext() and its variants.\n(Contributed by Franz Glasner, Éric Araujo, and Cheryl Sabella in bpo-2504.)", "code_blocks": []}, "improved-modules - gzip": {"text": "gzip\n\nAdded the mtime parameter to gzip.compress() for reproducible output.\n(Contributed by Guo Ci Teo in bpo-34898.)\nA BadGzipFile exception is now raised instead of OSError\nfor certain types of invalid or corrupt gzip files.\n(Contributed by Filip Gruszczyński, Michele Orrù, and Zackery Spytz in\nbpo-6584.)", "code_blocks": []}, "improved-modules - idle-and-idlelib": {"text": "IDLE and idlelib\n\nOutput over N lines (50 by default) is squeezed down to a button.\nN can be changed in the PyShell section of the General page of the\nSettings dialog.  Fewer, but possibly extra long, lines can be squeezed by\nright clicking on the output.  Squeezed output can be expanded in place\nby double-clicking the button or into the clipboard or a separate window\nby right-clicking the button.  (Contributed by Tal Einat in bpo-1529353.)\nAdd “Run Customized” to the Run menu to run a module with customized\nsettings. Any command line arguments entered are added to sys.argv.\nThey also re-appear in the box for the next customized run.  One can also\nsuppress the normal Shell main module restart.  (Contributed by Cheryl\nSabella, Terry Jan Reedy, and others in bpo-5680 and bpo-37627.)\nAdded optional line numbers for IDLE editor windows. Windows\nopen without line numbers unless set otherwise in the General\ntab of the configuration dialog.  Line numbers for an existing\nwindow are shown and hidden in the Options menu.\n(Contributed by Tal Einat and Saimadhav Heblikar in bpo-17535.)\nOS native encoding is now used for converting between Python strings and Tcl\nobjects. This allows IDLE to work with emoji and other non-BMP characters.\nThese characters can be displayed or copied and pasted to or from the\nclipboard.  Converting strings from Tcl to Python and back now never fails.\n(Many people worked on this for eight years but the problem was finally\nsolved by Serhiy Storchaka in bpo-13153.)\nNew in 3.8.1:\nAdd option to toggle cursor blink off.  (Contributed by Zackery Spytz\nin bpo-4603.)\nEscape key now closes IDLE completion windows.  (Contributed by Johnny\nNajera in bpo-38944.)\nThe changes above have been backported to 3.7 maintenance releases.\nAdd keywords to module name completion list.  (Contributed by Terry J.\nReedy in bpo-37765.)", "code_blocks": []}, "improved-modules - inspect": {"text": "inspect\n\nThe inspect.getdoc() function can now find docstrings for __slots__\nif that attribute is a dict where the values are docstrings.\nThis provides documentation options similar to what we already have\nfor property(), classmethod(), and staticmethod():\nclass AudioClip:\n    __slots__ = {'bit_rate': 'expressed in kilohertz to one decimal place',\n                 'duration': 'in seconds, rounded up to an integer'}\n    def __init__(self, bit_rate, duration):\n        self.bit_rate = round(bit_rate / 1000.0, 1)\n        self.duration = ceil(duration)\n\n\n(Contributed by Raymond Hettinger in bpo-36326.)", "code_blocks": ["class AudioClip:\n    __slots__ = {'bit_rate': 'expressed in kilohertz to one decimal place',\n                 'duration': 'in seconds, rounded up to an integer'}\n    def __init__(self, bit_rate, duration):\n        self.bit_rate = round(bit_rate / 1000.0, 1)\n        self.duration = ceil(duration)\n"]}, "improved-modules - io": {"text": "io\n\nIn development mode (-X env) and in debug build, the\nio.IOBase finalizer now logs the exception if the close() method\nfails. The exception is ignored silently by default in release build.\n(Contributed by Victor Stinner in bpo-18748.)", "code_blocks": []}, "improved-modules - itertools": {"text": "itertools\n\nThe itertools.accumulate() function added an option initial keyword\nargument to specify an initial value:\n>>> from itertools import accumulate\n>>> list(accumulate([10, 5, 30, 15], initial=1000))\n[1000, 1010, 1015, 1045, 1060]\n\n\n(Contributed by Lisa Roach in bpo-34659.)", "code_blocks": [">>> from itertools import accumulate\n>>> list(accumulate([10, 5, 30, 15], initial=1000))\n[1000, 1010, 1015, 1045, 1060]\n"]}, "improved-modules - json-tool": {"text": "json.tool\n\nAdd option --json-lines to parse every input line as a separate JSON object.\n(Contributed by Weipeng Hong in bpo-31553.)", "code_blocks": []}, "improved-modules - logging": {"text": "logging\n\nAdded a force keyword argument to logging.basicConfig()\nWhen set to true, any existing handlers attached\nto the root logger are removed and closed before carrying out the\nconfiguration specified by the other arguments.\nThis solves a long-standing problem.  Once a logger or basicConfig() had\nbeen called, subsequent calls to basicConfig() were silently ignored.\nThis made it difficult to update, experiment with, or teach the various\nlogging configuration options using the interactive prompt or a Jupyter\nnotebook.\n(Suggested by Raymond Hettinger, implemented by Dong-hee Na, and\nreviewed by Vinay Sajip in bpo-33897.)", "code_blocks": []}, "improved-modules - math": {"text": "math\n\nAdded new function math.dist() for computing Euclidean distance\nbetween two points.  (Contributed by Raymond Hettinger in bpo-33089.)\nExpanded the math.hypot() function to handle multiple dimensions.\nFormerly, it only supported the 2-D case.\n(Contributed by Raymond Hettinger in bpo-33089.)\nAdded new function, math.prod(), as analogous function to sum()\nthat returns the product of a ‘start’ value (default: 1) times an iterable of\nnumbers:\n>>> prior = 0.8\n>>> likelihoods = [0.625, 0.84, 0.30]\n>>> math.prod(likelihoods, start=prior)\n0.126\n\n\n(Contributed by Pablo Galindo in bpo-35606.)\nAdded two new combinatoric functions math.perm() and math.comb():\n>>> math.perm(10, 3)    # Permutations of 10 things taken 3 at a time\n720\n>>> math.comb(10, 3)    # Combinations of 10 things taken 3 at a time\n120\n\n\n(Contributed by Yash Aggarwal, Keller Fuchs, Serhiy Storchaka, and Raymond\nHettinger in bpo-37128, bpo-37178, and bpo-35431.)\nAdded a new function math.isqrt() for computing accurate integer square\nroots without conversion to floating point.  The new function supports\narbitrarily large integers.  It is faster than floor(sqrt(n)) but slower\nthan math.sqrt():\n>>> r = 650320427\n>>> s = r ** 2\n>>> isqrt(s - 1)         # correct\n650320426\n>>> floor(sqrt(s - 1))   # incorrect\n650320427\n\n\n(Contributed by Mark Dickinson in bpo-36887.)\nThe function math.factorial() no longer accepts arguments that are not\nint-like. (Contributed by Pablo Galindo in bpo-33083.)", "code_blocks": [">>> prior = 0.8\n>>> likelihoods = [0.625, 0.84, 0.30]\n>>> math.prod(likelihoods, start=prior)\n0.126\n", ">>> math.perm(10, 3)    # Permutations of 10 things taken 3 at a time\n720\n>>> math.comb(10, 3)    # Combinations of 10 things taken 3 at a time\n120\n", ">>> r = 650320427\n>>> s = r ** 2\n>>> isqrt(s - 1)         # correct\n650320426\n>>> floor(sqrt(s - 1))   # incorrect\n650320427\n"]}, "improved-modules - mmap": {"text": "mmap\n\nThe mmap.mmap class now has an madvise() method to\naccess the madvise() system call.\n(Contributed by Zackery Spytz in bpo-32941.)", "code_blocks": []}, "improved-modules - multiprocessing": {"text": "multiprocessing\n\nAdded new multiprocessing.shared_memory module.\n(Contributed by Davin Potts in bpo-35813.)\nOn macOS, the spawn start method is now used by default.\n(Contributed by Victor Stinner in bpo-33725.)", "code_blocks": []}, "improved-modules - os": {"text": "os\n\nAdded new function add_dll_directory() on Windows for providing\nadditional search paths for native dependencies when importing extension\nmodules or loading DLLs using ctypes.\n(Contributed by Steve Dower in bpo-36085.)\nA new os.memfd_create() function was added to wrap the\nmemfd_create() syscall.\n(Contributed by Zackery Spytz and Christian Heimes in bpo-26836.)\nOn Windows, much of the manual logic for handling reparse points (including\nsymlinks and directory junctions) has been delegated to the operating system.\nSpecifically, os.stat() will now traverse anything supported by the\noperating system, while os.lstat() will only open reparse points that\nidentify as “name surrogates” while others are opened as for os.stat().\nIn all cases, stat_result.st_mode will only have S_IFLNK set for\nsymbolic links and not other kinds of reparse points. To identify other kinds\nof reparse point, check the new stat_result.st_reparse_tag attribute.\nOn Windows, os.readlink() is now able to read directory junctions. Note\nthat islink() will return False for directory junctions,\nand so code that checks islink first will continue to treat junctions as\ndirectories, while code that handles errors from os.readlink() may now\ntreat junctions as links.\n(Contributed by Steve Dower in bpo-37834.)\nAs of 3.8.20, os.mkdir() and os.makedirs() on Windows now support\npassing a mode value of 0o700 to apply access control to the new\ndirectory. This implicitly affects tempfile.mkdtemp() and is a\nmitigation for CVE-2024-4030. Other values for mode continue to be\nignored.\n(Contributed by Steve Dower in gh-118486.)", "code_blocks": []}, "improved-modules - os-path": {"text": "os.path\n\nos.path functions that return a boolean result like\nexists(), lexists(), isdir(),\nisfile(), islink(), and ismount()\nnow return False instead of raising ValueError or its subclasses\nUnicodeEncodeError and UnicodeDecodeError for paths that contain\ncharacters or bytes unrepresentable at the OS level.\n(Contributed by Serhiy Storchaka in bpo-33721.)\nexpanduser() on Windows now prefers the USERPROFILE\nenvironment variable and does not use HOME, which is not normally set\nfor regular user accounts.\n(Contributed by Anthony Sottile in bpo-36264.)\nisdir() on Windows no longer returns True for a link to a\nnon-existent directory.\nrealpath() on Windows now resolves reparse points, including\nsymlinks and directory junctions.\n(Contributed by Steve Dower in bpo-37834.)", "code_blocks": []}, "improved-modules - pathlib": {"text": "pathlib\n\npathlib.Path methods that return a boolean result like\nexists(), is_dir(),\nis_file(), is_mount(),\nis_symlink(), is_block_device(),\nis_char_device(), is_fifo(),\nis_socket() now return False instead of raising\nValueError or its subclass UnicodeEncodeError for paths that\ncontain characters unrepresentable at the OS level.\n(Contributed by Serhiy Storchaka in bpo-33721.)\nAdded pathlib.Path.link_to() which creates a hard link pointing\nto a path.\n(Contributed by Joannah Nanjekye in bpo-26978)", "code_blocks": []}, "improved-modules - pickle": {"text": "pickle\n\npickle extensions subclassing the C-optimized Pickler\ncan now override the pickling logic of functions and classes by defining the\nspecial reducer_override() method.\n(Contributed by Pierre Glaser and Olivier Grisel in bpo-35900.)", "code_blocks": []}, "improved-modules - plistlib": {"text": "plistlib\n\nAdded new plistlib.UID and enabled support for reading and writing\nNSKeyedArchiver-encoded binary plists.\n(Contributed by Jon Janzen in bpo-26707.)", "code_blocks": []}, "improved-modules - pprint": {"text": "pprint\n\nThe pprint module added a sort_dicts parameter to several functions.\nBy default, those functions continue to sort dictionaries before rendering or\nprinting.  However, if sort_dicts is set to false, the dictionaries retain\nthe order that keys were inserted.  This can be useful for comparison to JSON\ninputs during debugging.\nIn addition, there is a convenience new function, pprint.pp() that is\nlike pprint.pprint() but with sort_dicts defaulting to False:\n>>> from pprint import pprint, pp\n>>> d = dict(source='input.txt', operation='filter', destination='output.txt')\n>>> pp(d, width=40)                  # Original order\n{'source': 'input.txt',\n 'operation': 'filter',\n 'destination': 'output.txt'}\n>>> pprint(d, width=40)              # Keys sorted alphabetically\n{'destination': 'output.txt',\n 'operation': 'filter',\n 'source': 'input.txt'}\n\n\n(Contributed by Rémi Lapeyre in bpo-30670.)", "code_blocks": [">>> from pprint import pprint, pp\n>>> d = dict(source='input.txt', operation='filter', destination='output.txt')\n>>> pp(d, width=40)                  # Original order\n{'source': 'input.txt',\n 'operation': 'filter',\n 'destination': 'output.txt'}\n>>> pprint(d, width=40)              # Keys sorted alphabetically\n{'destination': 'output.txt',\n 'operation': 'filter',\n 'source': 'input.txt'}\n"]}, "improved-modules - py-compile": {"text": "py_compile\n\npy_compile.compile() now supports silent mode.\n(Contributed by Joannah Nanjekye in bpo-22640.)", "code_blocks": []}, "improved-modules - shlex": {"text": "shlex\n\nThe new shlex.join() function acts as the inverse of shlex.split().\n(Contributed by Bo Bayles in bpo-32102.)", "code_blocks": []}, "improved-modules - shutil": {"text": "shutil\n\nshutil.copytree() now accepts a new dirs_exist_ok keyword argument.\n(Contributed by Josh Bronson in bpo-20849.)\nshutil.make_archive() now defaults to the modern pax (POSIX.1-2001)\nformat for new archives to improve portability and standards conformance,\ninherited from the corresponding change to the tarfile module.\n(Contributed by C.A.M. Gerlach in bpo-30661.)\nshutil.rmtree() on Windows now removes directory junctions without\nrecursively removing their contents first.\n(Contributed by Steve Dower in bpo-37834.)", "code_blocks": []}, "improved-modules - socket": {"text": "socket\n\nAdded create_server() and has_dualstack_ipv6()\nconvenience functions to automate the necessary tasks usually involved when\ncreating a server socket, including accepting both IPv4 and IPv6 connections\non the same socket.  (Contributed by Giampaolo Rodolà in bpo-17561.)\nThe socket.if_nameindex(), socket.if_nametoindex(), and\nsocket.if_indextoname() functions have been implemented on Windows.\n(Contributed by Zackery Spytz in bpo-37007.)", "code_blocks": []}, "improved-modules - ssl": {"text": "ssl\n\nAdded post_handshake_auth to enable and\nverify_client_post_handshake() to initiate TLS 1.3\npost-handshake authentication.\n(Contributed by Christian Heimes in bpo-34670.)", "code_blocks": []}, "improved-modules - statistics": {"text": "statistics\n\nAdded statistics.fmean() as a faster, floating point variant of\nstatistics.mean().  (Contributed by Raymond Hettinger and\nSteven D’Aprano in bpo-35904.)\nAdded statistics.geometric_mean()\n(Contributed by Raymond Hettinger in bpo-27181.)\nAdded statistics.multimode() that returns a list of the most\ncommon values. (Contributed by Raymond Hettinger in bpo-35892.)\nAdded statistics.quantiles() that divides data or a distribution\nin to equiprobable intervals (e.g. quartiles, deciles, or percentiles).\n(Contributed by Raymond Hettinger in bpo-36546.)\nAdded statistics.NormalDist, a tool for creating\nand manipulating normal distributions of a random variable.\n(Contributed by Raymond Hettinger in bpo-36018.)\n>>> temperature_feb = NormalDist.from_samples([4, 12, -3, 2, 7, 14])\n>>> temperature_feb.mean\n6.0\n>>> temperature_feb.stdev\n6.356099432828281\n\n>>> temperature_feb.cdf(3)            # Chance of being under 3 degrees\n0.3184678262814532\n>>> # Relative chance of being 7 degrees versus 10 degrees\n>>> temperature_feb.pdf(7) / temperature_feb.pdf(10)\n1.2039930378537762\n\n>>> el_niño = NormalDist(4, 2.5)\n>>> temperature_feb += el_niño        # Add in a climate effect\n>>> temperature_feb\nNormalDist(mu=10.0, sigma=6.830080526611674)\n\n>>> temperature_feb * (9/5) + 32      # Convert to Fahrenheit\nNormalDist(mu=50.0, sigma=12.294144947901014)\n>>> temperature_feb.samples(3)        # Generate random samples\n[7.672102882379219, 12.000027119750287, 4.647488369766392]", "code_blocks": [">>> temperature_feb = NormalDist.from_samples([4, 12, -3, 2, 7, 14])\n>>> temperature_feb.mean\n6.0\n>>> temperature_feb.stdev\n6.356099432828281\n\n>>> temperature_feb.cdf(3)            # Chance of being under 3 degrees\n0.3184678262814532\n>>> # Relative chance of being 7 degrees versus 10 degrees\n>>> temperature_feb.pdf(7) / temperature_feb.pdf(10)\n1.2039930378537762\n\n>>> el_niño = NormalDist(4, 2.5)\n>>> temperature_feb += el_niño        # Add in a climate effect\n>>> temperature_feb\nNormalDist(mu=10.0, sigma=6.830080526611674)\n\n>>> temperature_feb * (9/5) + 32      # Convert to Fahrenheit\nNormalDist(mu=50.0, sigma=12.294144947901014)\n>>> temperature_feb.samples(3)        # Generate random samples\n[7.672102882379219, 12.000027119750287, 4.647488369766392]\n"]}, "improved-modules - sys": {"text": "sys\n\nAdd new sys.unraisablehook() function which can be overridden to control\nhow “unraisable exceptions” are handled. It is called when an exception has\noccurred but there is no way for Python to handle it. For example, when a\ndestructor raises an exception or during garbage collection\n(gc.collect()).\n(Contributed by Victor Stinner in bpo-36829.)", "code_blocks": []}, "improved-modules - tarfile": {"text": "tarfile\n\nThe tarfile module now defaults to the modern pax (POSIX.1-2001)\nformat for new archives, instead of the previous GNU-specific one.\nThis improves cross-platform portability with a consistent encoding (UTF-8)\nin a standardized and extensible format, and offers several other benefits.\n(Contributed by C.A.M. Gerlach in bpo-36268.)", "code_blocks": []}, "improved-modules - tempfile": {"text": "tempfile\n\nAs of 3.8.20 on Windows, the default mode 0o700 used by\ntempfile.mkdtemp() now limits access to the new directory due to\nchanges to os.mkdir(). This is a mitigation for CVE-2024-4030.\n(Contributed by Steve Dower in gh-118486.)", "code_blocks": []}, "improved-modules - threading": {"text": "threading\n\nAdd a new threading.excepthook() function which handles uncaught\nthreading.Thread.run() exception. It can be overridden to control how\nuncaught threading.Thread.run() exceptions are handled.\n(Contributed by Victor Stinner in bpo-1230540.)\nAdd a new threading.get_native_id() function and\na native_id\nattribute to the threading.Thread class. These return the native\nintegral Thread ID of the current thread assigned by the kernel.\nThis feature is only available on certain platforms, see\nget_native_id for more information.\n(Contributed by Jake Tesler in bpo-36084.)", "code_blocks": []}, "improved-modules - tokenize": {"text": "tokenize\n\nThe tokenize module now implicitly emits a NEWLINE token when\nprovided with input that does not have a trailing new line.  This behavior\nnow matches what the C tokenizer does internally.\n(Contributed by Ammar Askar in bpo-33899.)", "code_blocks": []}, "improved-modules - tkinter": {"text": "tkinter\n\nAdded methods selection_from(),\nselection_present(),\nselection_range() and\nselection_to()\nin the tkinter.Spinbox class.\n(Contributed by Juliette Monsel in bpo-34829.)\nAdded method moveto()\nin the tkinter.Canvas class.\n(Contributed by Juliette Monsel in bpo-23831.)\nThe tkinter.PhotoImage class now has\ntransparency_get() and\ntransparency_set() methods.  (Contributed by\nZackery Spytz in bpo-25451.)", "code_blocks": []}, "improved-modules - time": {"text": "time\n\nAdded new clock CLOCK_UPTIME_RAW for macOS 10.12.\n(Contributed by Joannah Nanjekye in bpo-35702.)", "code_blocks": []}, "improved-modules - typing": {"text": "typing\n\nThe typing module incorporates several new features:\n\nA dictionary type with per-key types.  See PEP 589 and\ntyping.TypedDict.\nTypedDict uses only string keys.  By default, every key is required\nto be present. Specify “total=False” to allow keys to be optional:\nclass Location(TypedDict, total=False):\n    lat_long: tuple\n    grid_square: str\n    xy_coordinate: tuple\n\n\n\nLiteral types.  See PEP 586 and typing.Literal.\nLiteral types indicate that a parameter or return value\nis constrained to one or more specific literal values:\ndef get_status(port: int) -> Literal['connected', 'disconnected']:\n    ...\n\n\n\n“Final” variables, functions, methods and classes.  See PEP 591,\ntyping.Final and typing.final().\nThe final qualifier instructs a static type checker to restrict\nsubclassing, overriding, or reassignment:\npi: Final[float] = 3.1415926536\n\n\n\nProtocol definitions.  See PEP 544, typing.Protocol and\ntyping.runtime_checkable().  Simple ABCs like\ntyping.SupportsInt are now Protocol subclasses.\nNew protocol class typing.SupportsIndex.\nNew functions typing.get_origin() and typing.get_args().", "code_blocks": ["class Location(TypedDict, total=False):\n    lat_long: tuple\n    grid_square: str\n    xy_coordinate: tuple\n", "def get_status(port: int) -> Literal['connected', 'disconnected']:\n    ...\n", "pi: Final[float] = 3.1415926536\n"]}, "improved-modules - unicodedata": {"text": "unicodedata\n\nThe unicodedata module has been upgraded to use the Unicode 12.1.0 release.\nNew function is_normalized() can be used to verify a string\nis in a specific normal form, often much faster than by actually normalizing\nthe string.  (Contributed by Max Belanger, David Euresti, and Greg Price in\nbpo-32285 and bpo-37966).", "code_blocks": []}, "improved-modules - unittest": {"text": "unittest\n\nAdded AsyncMock to support an asynchronous version of\nMock.  Appropriate new assert functions for testing\nhave been added as well.\n(Contributed by Lisa Roach in bpo-26467).\nAdded addModuleCleanup() and\naddClassCleanup() to unittest to support\ncleanups for setUpModule() and\nsetUpClass().\n(Contributed by Lisa Roach in bpo-24412.)\nSeveral mock assert functions now also print a list of actual calls upon\nfailure. (Contributed by Petter Strandmark in bpo-35047.)\nunittest module gained support for coroutines to be used as test cases\nwith unittest.IsolatedAsyncioTestCase.\n(Contributed by Andrew Svetlov in bpo-32972.)\nExample:\nimport unittest\n\n\nclass TestRequest(unittest.IsolatedAsyncioTestCase):\n\n    async def asyncSetUp(self):\n        self.connection = await AsyncConnection()\n\n    async def test_get(self):\n        response = await self.connection.get(\"https://example.com\")\n        self.assertEqual(response.status_code, 200)\n\n    async def asyncTearDown(self):\n        await self.connection.close()\n\n\nif __name__ == \"__main__\":\n    unittest.main()", "code_blocks": ["import unittest\n\n\nclass TestRequest(unittest.IsolatedAsyncioTestCase):\n\n    async def asyncSetUp(self):\n        self.connection = await AsyncConnection()\n\n    async def test_get(self):\n        response = await self.connection.get(\"https://example.com\")\n        self.assertEqual(response.status_code, 200)\n\n    async def asyncTearDown(self):\n        await self.connection.close()\n\n\nif __name__ == \"__main__\":\n    unittest.main()\n"]}, "improved-modules - venv": {"text": "venv\n\nvenv now includes an Activate.ps1 script on all platforms for\nactivating virtual environments under PowerShell Core 6.1.\n(Contributed by Brett Cannon in bpo-32718.)", "code_blocks": []}, "improved-modules - weakref": {"text": "weakref\n\nThe proxy objects returned by weakref.proxy() now support the matrix\nmultiplication operators @ and @= in addition to the other\nnumeric operators. (Contributed by Mark Dickinson in bpo-36669.)", "code_blocks": []}, "improved-modules - xml": {"text": "xml\n\nAs mitigation against DTD and external entity retrieval, the\nxml.dom.minidom and xml.sax modules no longer process\nexternal entities by default.\n(Contributed by Christian Heimes in bpo-17239.)\nThe .find*() methods in the xml.etree.ElementTree module\nsupport wildcard searches like {*}tag which ignores the namespace\nand {namespace}* which returns all tags in the given namespace.\n(Contributed by Stefan Behnel in bpo-28238.)\nThe xml.etree.ElementTree module provides a new function\n–xml.etree.ElementTree.canonicalize() that implements C14N 2.0.\n(Contributed by Stefan Behnel in bpo-13611.)\nThe target object of xml.etree.ElementTree.XMLParser can\nreceive namespace declaration events through the new callback methods\nstart_ns() and end_ns().  Additionally, the\nxml.etree.ElementTree.TreeBuilder target can be configured\nto process events about comments and processing instructions to include\nthem in the generated tree.\n(Contributed by Stefan Behnel in bpo-36676 and bpo-36673.)", "code_blocks": []}, "improved-modules - xmlrpc": {"text": "xmlrpc\n\nxmlrpc.client.ServerProxy now supports an optional headers keyword\nargument for a sequence of HTTP headers to be sent with each request.  Among\nother things, this makes it possible to upgrade from default basic\nauthentication to faster session authentication.\n(Contributed by Cédric Krier in bpo-35153.)", "code_blocks": []}, "optimizations": {"text": "Optimizations\n\n\nThe subprocess module can now use the os.posix_spawn() function\nin some cases for better performance. Currently, it is only used on macOS\nand Linux (using glibc 2.24 or newer) if all these conditions are met:\n\nclose_fds is false;\npreexec_fn, pass_fds, cwd and start_new_session parameters\nare not set;\nthe executable path contains a directory.\n\n(Contributed by Joannah Nanjekye and Victor Stinner in bpo-35537.)\n\nshutil.copyfile(), shutil.copy(), shutil.copy2(),\nshutil.copytree() and shutil.move() use platform-specific\n“fast-copy” syscalls on Linux and macOS in order to copy the file\nmore efficiently.\n“fast-copy” means that the copying operation occurs within the kernel,\navoiding the use of userspace buffers in Python as in\n“outfd.write(infd.read())”.\nOn Windows shutil.copyfile() uses a bigger default buffer size (1 MiB\ninstead of 16 KiB) and a memoryview()-based variant of\nshutil.copyfileobj() is used.\nThe speedup for copying a 512 MiB file within the same partition is about\n+26% on Linux, +50% on macOS and +40% on Windows. Also, much less CPU cycles\nare consumed.\nSee Platform-dependent efficient copy operations section.\n(Contributed by Giampaolo Rodolà in bpo-33671.)\nshutil.copytree() uses os.scandir() function and all copy\nfunctions depending from it use cached os.stat() values. The speedup\nfor copying a directory with 8000 files is around +9% on Linux, +20% on\nWindows and +30% on a Windows SMB share. Also the number of os.stat()\nsyscalls is reduced by 38% making shutil.copytree() especially faster\non network filesystems. (Contributed by Giampaolo Rodolà in bpo-33695.)\nThe default protocol in the pickle module is now Protocol 4,\nfirst introduced in Python 3.4.  It offers better performance and smaller\nsize compared to Protocol 3 available since Python 3.0.\nRemoved one Py_ssize_t member from PyGC_Head.  All GC tracked\nobjects (e.g. tuple, list, dict) size is reduced 4 or 8 bytes.\n(Contributed by Inada Naoki in bpo-33597.)\nuuid.UUID now uses __slots__ to reduce its memory footprint.\n(Contributed by Wouter Bolsterlee and Tal Einat in bpo-30977)\nImproved performance of operator.itemgetter() by 33%.  Optimized\nargument handling and added a fast path for the common case of a single\nnon-negative integer index into a tuple (which is the typical use case in\nthe standard library).  (Contributed by Raymond Hettinger in\nbpo-35664.)\nSped-up field lookups in collections.namedtuple().  They are now more\nthan two times faster, making them the fastest form of instance variable\nlookup in Python. (Contributed by Raymond Hettinger, Pablo Galindo, and\nJoe Jevnik, Serhiy Storchaka in bpo-32492.)\nThe list constructor does not overallocate the internal item buffer\nif the input iterable has a known length (the input implements __len__).\nThis makes the created list 12% smaller on average. (Contributed by\nRaymond Hettinger and Pablo Galindo in bpo-33234.)\nDoubled the speed of class variable writes.  When a non-dunder attribute\nwas updated, there was an unnecessary call to update slots.\n(Contributed by Stefan Behnel, Pablo Galindo Salgado, Raymond Hettinger,\nNeil Schemenauer, and Serhiy Storchaka in bpo-36012.)\nReduced an overhead of converting arguments passed to many builtin functions\nand methods.  This sped up calling some simple builtin functions and\nmethods up to 20–50%.  (Contributed by Serhiy Storchaka in bpo-23867,\nbpo-35582 and bpo-36127.)\nLOAD_GLOBAL instruction now uses new “per opcode cache” mechanism.\nIt is about 40% faster now.  (Contributed by Yury Selivanov and Inada Naoki in\nbpo-26219.)", "code_blocks": []}, "build-and-c-api-changes": {"text": "Build and C API Changes\n\n\nDefault sys.abiflags became an empty string: the m flag for\npymalloc became useless (builds with and without pymalloc are ABI compatible)\nand so has been removed. (Contributed by Victor Stinner in bpo-36707.)\nExample of changes:\n\nOnly python3.8 program is installed, python3.8m program is gone.\nOnly python3.8-config script is installed, python3.8m-config script\nis gone.\nThe m flag has been removed from the suffix of dynamic library\nfilenames: extension modules in the standard library as well as those\nproduced and installed by third-party packages, like those downloaded from\nPyPI. On Linux, for example, the Python 3.7 suffix\n.cpython-37m-x86_64-linux-gnu.so became\n.cpython-38-x86_64-linux-gnu.so in Python 3.8.\n\n\nThe header files have been reorganized to better separate the different kinds\nof APIs:\n\nInclude/*.h should be the portable public stable C API.\nInclude/cpython/*.h should be the unstable C API specific to CPython;\npublic API, with some private API prefixed by _Py or _PY.\nInclude/internal/*.h is the private internal C API very specific to\nCPython. This API comes with no backward compatibility warranty and should\nnot be used outside CPython. It is only exposed for very specific needs\nlike debuggers and profiles which has to access to CPython internals\nwithout calling functions. This API is now installed by make install.\n\n(Contributed by Victor Stinner in bpo-35134 and bpo-35081,\nwork initiated by Eric Snow in Python 3.7.)\n\nSome macros have been converted to static inline functions: parameter types\nand return type are well defined, they don’t have issues specific to macros,\nvariables have a local scopes. Examples:\n\nPy_INCREF(), Py_DECREF()\nPy_XINCREF(), Py_XDECREF()\nPyObject_INIT(), PyObject_INIT_VAR()\nPrivate functions: _PyObject_GC_TRACK(),\n_PyObject_GC_UNTRACK(), _Py_Dealloc()\n\n(Contributed by Victor Stinner in bpo-35059.)\n\nThe PyByteArray_Init() and PyByteArray_Fini() functions have\nbeen removed. They did nothing since Python 2.7.4 and Python 3.2.0, were\nexcluded from the limited API (stable ABI), and were not documented.\n(Contributed by Victor Stinner in bpo-35713.)\nThe result of PyExceptionClass_Name() is now of type\nconst char * rather of char *.\n(Contributed by Serhiy Storchaka in bpo-33818.)\nThe duality of Modules/Setup.dist and Modules/Setup has been\nremoved.  Previously, when updating the CPython source tree, one had\nto manually copy Modules/Setup.dist (inside the source tree) to\nModules/Setup (inside the build tree) in order to reflect any changes\nupstream.  This was of a small benefit to packagers at the expense of\na frequent annoyance to developers following CPython development, as\nforgetting to copy the file could produce build failures.\nNow the build system always reads from Modules/Setup inside the source\ntree.  People who want to customize that file are encouraged to maintain\ntheir changes in a git fork of CPython or as patch files, as they would do\nfor any other change to the source tree.\n(Contributed by Antoine Pitrou in bpo-32430.)\n\nFunctions that convert Python number to C integer like\nPyLong_AsLong() and argument parsing functions like\nPyArg_ParseTuple() with integer converting format units like 'i'\nwill now use the __index__() special method instead of\n__int__(), if available.  The deprecation warning will be\nemitted for objects with the __int__() method but without the\n__index__() method (like Decimal and\nFraction).  PyNumber_Check() will now return\n1 for objects implementing __index__().\nPyNumber_Long(), PyNumber_Float() and\nPyFloat_AsDouble() also now use the __index__() method if\navailable.\n(Contributed by Serhiy Storchaka in bpo-36048 and bpo-20092.)\nHeap-allocated type objects will now increase their reference count\nin PyObject_Init() (and its parallel macro PyObject_INIT)\ninstead of in PyType_GenericAlloc(). Types that modify instance\nallocation or deallocation may need to be adjusted.\n(Contributed by Eddie Elizondo in bpo-35810.)\nThe new function PyCode_NewWithPosOnlyArgs() allows to create\ncode objects like PyCode_New(), but with an extra posonlyargcount\nparameter for indicating the number of positional-only arguments.\n(Contributed by Pablo Galindo in bpo-37221.)\nPy_SetPath() now sets sys.executable to the program full\npath (Py_GetProgramFullPath()) rather than to the program name\n(Py_GetProgramName()).\n(Contributed by Victor Stinner in bpo-38234.)", "code_blocks": []}, "deprecated": {"text": "Deprecated\n\n\nThe distutils bdist_wininst command is now deprecated, use\nbdist_wheel (wheel packages) instead.\n(Contributed by Victor Stinner in bpo-37481.)\nDeprecated methods getchildren() and getiterator() in\nthe ElementTree module now emit a\nDeprecationWarning instead of PendingDeprecationWarning.\nThey will be removed in Python 3.9.\n(Contributed by Serhiy Storchaka in bpo-29209.)\nPassing an object that is not an instance of\nconcurrent.futures.ThreadPoolExecutor to\nloop.set_default_executor() is\ndeprecated and will be prohibited in Python 3.9.\n(Contributed by Elvis Pranskevichus in bpo-34075.)\nThe __getitem__() methods of xml.dom.pulldom.DOMEventStream,\nwsgiref.util.FileWrapper and fileinput.FileInput have been\ndeprecated.\nImplementations of these methods have been ignoring their index parameter,\nand returning the next item instead.\n(Contributed by Berker Peksag in bpo-9372.)\n\nThe typing.NamedTuple class has deprecated the _field_types\nattribute in favor of the __annotations__ attribute which has the same\ninformation. (Contributed by Raymond Hettinger in bpo-36320.)\nast classes Num, Str, Bytes, NameConstant and\nEllipsis are considered deprecated and will be removed in future Python\nversions. Constant should be used instead.\n(Contributed by Serhiy Storchaka in bpo-32892.)\nast.NodeVisitor methods visit_Num(), visit_Str(),\nvisit_Bytes(), visit_NameConstant() and visit_Ellipsis() are\ndeprecated now and will not be called in future Python versions.\nAdd the visit_Constant() method to handle all\nconstant nodes.\n(Contributed by Serhiy Storchaka in bpo-36917.)\nThe asyncio.coroutine() decorator is deprecated and will be\nremoved in version 3.10.  Instead of @asyncio.coroutine, use\nasync def instead.\n(Contributed by Andrew Svetlov in bpo-36921.)\nIn asyncio, the explicit passing of a loop argument has been\ndeprecated and will be removed in version 3.10 for the following:\nasyncio.sleep(), asyncio.gather(), asyncio.shield(),\nasyncio.wait_for(), asyncio.wait(), asyncio.as_completed(),\nasyncio.Task, asyncio.Lock, asyncio.Event,\nasyncio.Condition, asyncio.Semaphore,\nasyncio.BoundedSemaphore, asyncio.Queue,\nasyncio.create_subprocess_exec(), and\nasyncio.create_subprocess_shell().\nThe explicit passing of coroutine objects to asyncio.wait() has been\ndeprecated and will be removed in version 3.11.\n(Contributed by Yury Selivanov in bpo-34790.)\nThe following functions and methods are deprecated in the gettext\nmodule: lgettext(), ldgettext(),\nlngettext() and ldngettext().\nThey return encoded bytes, and it’s possible that you will get unexpected\nUnicode-related exceptions if there are encoding problems with the\ntranslated strings. It’s much better to use alternatives which return\nUnicode strings in Python 3. These functions have been broken for a long time.\nFunction bind_textdomain_codeset(), methods\noutput_charset() and\nset_output_charset(), and the codeset\nparameter of functions translation() and\ninstall() are also deprecated, since they are only used for\nthe l*gettext() functions.\n(Contributed by Serhiy Storchaka in bpo-33710.)\n\nThe isAlive() method of threading.Thread\nhas been deprecated.\n(Contributed by Dong-hee Na in bpo-35283.)\nMany builtin and extension functions that take integer arguments will\nnow emit a deprecation warning for Decimals,\nFractions and any other objects that can be converted\nto integers only with a loss (e.g. that have the __int__()\nmethod but do not have the __index__() method).  In future\nversion they will be errors.\n(Contributed by Serhiy Storchaka in bpo-36048.)\nDeprecated passing the following arguments as keyword arguments:\n\nfunc in functools.partialmethod(), weakref.finalize(),\nprofile.Profile.runcall(), cProfile.Profile.runcall(),\nbdb.Bdb.runcall(), trace.Trace.runfunc() and\ncurses.wrapper().\nfunction in unittest.TestCase.addCleanup().\nfn in the submit() method of\nconcurrent.futures.ThreadPoolExecutor and\nconcurrent.futures.ProcessPoolExecutor.\ncallback in contextlib.ExitStack.callback(),\ncontextlib.AsyncExitStack.callback() and\ncontextlib.AsyncExitStack.push_async_callback().\nc and typeid in the create()\nmethod of multiprocessing.managers.Server and\nmultiprocessing.managers.SharedMemoryServer.\nobj in weakref.finalize().\n\nIn future releases of Python, they will be positional-only.\n(Contributed by Serhiy Storchaka in bpo-36492.)", "code_blocks": []}, "api-and-feature-removals": {"text": "API and Feature Removals\n\nThe following features and APIs have been removed from Python 3.8:\n\nStarting with Python 3.3, importing ABCs from collections was\ndeprecated, and importing should be done from collections.abc. Being\nable to import from collections was marked for removal in 3.8, but has been\ndelayed to 3.9. (See bpo-36952.)\nThe macpath module, deprecated in Python 3.7, has been removed.\n(Contributed by Victor Stinner in bpo-35471.)\nThe function platform.popen() has been removed, after having been\ndeprecated since Python 3.3: use os.popen() instead.\n(Contributed by Victor Stinner in bpo-35345.)\nThe function time.clock() has been removed, after having been\ndeprecated since Python 3.3: use time.perf_counter() or\ntime.process_time() instead, depending\non your requirements, to have well-defined behavior.\n(Contributed by Matthias Bussonnier in bpo-36895.)\nThe pyvenv script has been removed in favor of python3.8 -m venv\nto help eliminate confusion as to what Python interpreter the pyvenv\nscript is tied to. (Contributed by Brett Cannon in bpo-25427.)\nparse_qs, parse_qsl, and escape are removed from the cgi\nmodule.  They are deprecated in Python 3.2 or older. They should be imported\nfrom the urllib.parse and html modules instead.\nfilemode function is removed from the tarfile module.\nIt is not documented and deprecated since Python 3.3.\nThe XMLParser constructor no longer accepts\nthe html argument.  It never had an effect and was deprecated in Python 3.4.\nAll other parameters are now keyword-only.\n(Contributed by Serhiy Storchaka in bpo-29209.)\nRemoved the doctype() method of XMLParser.\n(Contributed by Serhiy Storchaka in bpo-29209.)\n“unicode_internal” codec is removed.\n(Contributed by Inada Naoki in bpo-36297.)\nThe Cache and Statement objects of the sqlite3 module are not\nexposed to the user.\n(Contributed by Aviv Palivoda in bpo-30262.)\nThe bufsize keyword argument of fileinput.input() and\nfileinput.FileInput() which was ignored and deprecated since Python 3.6\nhas been removed. bpo-36952 (Contributed by Matthias Bussonnier.)\nThe functions sys.set_coroutine_wrapper() and\nsys.get_coroutine_wrapper() deprecated in Python 3.7 have been removed;\nbpo-36933 (Contributed by Matthias Bussonnier.)", "code_blocks": []}, "porting-to-python-3-8 - changes-in-python-behavior": {"text": "Changes in Python behavior\n\n\nYield expressions (both yield and yield from clauses) are now disallowed\nin comprehensions and generator expressions (aside from the iterable expression\nin the leftmost for clause).\n(Contributed by Serhiy Storchaka in bpo-10544.)\nThe compiler now produces a SyntaxWarning when identity checks\n(is and is not) are used with certain types of literals\n(e.g. strings, numbers).  These can often work by accident in CPython,\nbut are not guaranteed by the language spec.  The warning advises users\nto use equality tests (== and !=) instead.\n(Contributed by Serhiy Storchaka in bpo-34850.)\nThe CPython interpreter can swallow exceptions in some circumstances.\nIn Python 3.8 this happens in fewer cases.  In particular, exceptions\nraised when getting the attribute from the type dictionary are no longer\nignored. (Contributed by Serhiy Storchaka in bpo-35459.)\nRemoved __str__ implementations from builtin types bool,\nint, float, complex and few classes from\nthe standard library.  They now inherit __str__() from object.\nAs result, defining the __repr__() method in the subclass of these\nclasses will affect their string representation.\n(Contributed by Serhiy Storchaka in bpo-36793.)\nOn AIX, sys.platform doesn’t contain the major version anymore.\nIt is always 'aix', instead of 'aix3' .. 'aix7'.  Since\nolder Python versions include the version number, so it is recommended to\nalways use sys.platform.startswith('aix').\n(Contributed by M. Felt in bpo-36588.)\nPyEval_AcquireLock() and PyEval_AcquireThread() now\nterminate the current thread if called while the interpreter is\nfinalizing, making them consistent with PyEval_RestoreThread(),\nPy_END_ALLOW_THREADS(), and PyGILState_Ensure(). If this\nbehavior is not desired, guard the call by checking _Py_IsFinalizing()\nor sys.is_finalizing().\n(Contributed by Joannah Nanjekye in bpo-36475.)", "code_blocks": []}, "porting-to-python-3-8 - changes-in-the-python-api": {"text": "Changes in the Python API\n\n\nThe os.getcwdb() function now uses the UTF-8 encoding on Windows,\nrather than the ANSI code page: see PEP 529 for the rationale. The\nfunction is no longer deprecated on Windows.\n(Contributed by Victor Stinner in bpo-37412.)\nsubprocess.Popen can now use os.posix_spawn() in some cases\nfor better performance. On Windows Subsystem for Linux and QEMU User\nEmulation, the Popen constructor using os.posix_spawn() no longer raises an\nexception on errors like “missing program”.  Instead the child process fails with a\nnon-zero returncode.\n(Contributed by Joannah Nanjekye and Victor Stinner in bpo-35537.)\nThe preexec_fn argument of * subprocess.Popen is no longer\ncompatible with subinterpreters. The use of the parameter in a\nsubinterpreter now raises RuntimeError.\n(Contributed by Eric Snow in bpo-34651, modified by Christian Heimes\nin bpo-37951.)\nThe imap.IMAP4.logout() method no longer silently ignores arbitrary\nexceptions.\n(Contributed by Victor Stinner in bpo-36348.)\nThe function platform.popen() has been removed, after having been deprecated since\nPython 3.3: use os.popen() instead.\n(Contributed by Victor Stinner in bpo-35345.)\nThe statistics.mode() function no longer raises an exception\nwhen given multimodal data.  Instead, it returns the first mode\nencountered in the input data.  (Contributed by Raymond Hettinger\nin bpo-35892.)\nThe selection() method of the\ntkinter.ttk.Treeview class no longer takes arguments.  Using it with\narguments for changing the selection was deprecated in Python 3.6.  Use\nspecialized methods like selection_set() for\nchanging the selection.  (Contributed by Serhiy Storchaka in bpo-31508.)\nThe writexml(), toxml() and toprettyxml() methods of\nxml.dom.minidom, and the write() method of xml.etree,\nnow preserve the attribute order specified by the user.\n(Contributed by Diego Rojas and Raymond Hettinger in bpo-34160.)\nA dbm.dumb database opened with flags 'r' is now read-only.\ndbm.dumb.open() with flags 'r' and 'w' no longer creates\na database if it does not exist.\n(Contributed by Serhiy Storchaka in bpo-32749.)\nThe doctype() method defined in a subclass of\nXMLParser will no longer be called and will\nemit a RuntimeWarning instead of a DeprecationWarning.\nDefine the doctype()\nmethod on a target for handling an XML doctype declaration.\n(Contributed by Serhiy Storchaka in bpo-29209.)\nA RuntimeError is now raised when the custom metaclass doesn’t\nprovide the __classcell__ entry in the namespace passed to\ntype.__new__.  A DeprecationWarning was emitted in Python\n3.6–3.7.  (Contributed by Serhiy Storchaka in bpo-23722.)\nThe cProfile.Profile class can now be used as a context\nmanager. (Contributed by Scott Sanderson in bpo-29235.)\nshutil.copyfile(), shutil.copy(), shutil.copy2(),\nshutil.copytree() and shutil.move() use platform-specific\n“fast-copy” syscalls (see\nPlatform-dependent efficient copy operations section).\nshutil.copyfile() default buffer size on Windows was changed from\n16 KiB to 1 MiB.\nThe PyGC_Head struct has changed completely.  All code that touched the\nstruct member should be rewritten.  (See bpo-33597.)\nThe PyInterpreterState struct has been moved into the “internal”\nheader files (specifically Include/internal/pycore_pystate.h).  An\nopaque PyInterpreterState is still available as part of the public\nAPI (and stable ABI).  The docs indicate that none of the struct’s\nfields are public, so we hope no one has been using them.  However,\nif you do rely on one or more of those private fields and have no\nalternative then please open a BPO issue.  We’ll work on helping\nyou adjust (possibly including adding accessor functions to the\npublic API).  (See bpo-35886.)\nThe mmap.flush() method now returns None on\nsuccess and raises an exception on error under all platforms.  Previously,\nits behavior was platform-dependent: a nonzero value was returned on success;\nzero was returned on error under Windows.  A zero value was returned on\nsuccess; an exception was raised on error under Unix.\n(Contributed by Berker Peksag in bpo-2122.)\nxml.dom.minidom and xml.sax modules no longer process\nexternal entities by default.\n(Contributed by Christian Heimes in bpo-17239.)\nDeleting a key from a read-only dbm database (dbm.dumb,\ndbm.gnu or dbm.ndbm) raises error (dbm.dumb.error,\ndbm.gnu.error or dbm.ndbm.error) instead of KeyError.\n(Contributed by Xiang Zhang in bpo-33106.)\nSimplified AST for literals.  All constants will be represented as\nast.Constant instances.  Instantiating old classes Num,\nStr, Bytes, NameConstant and Ellipsis will return\nan instance of Constant.\n(Contributed by Serhiy Storchaka in bpo-32892.)\nexpanduser() on Windows now prefers the USERPROFILE\nenvironment variable and does not use HOME, which is not normally\nset for regular user accounts.\n(Contributed by Anthony Sottile in bpo-36264.)\nThe exception asyncio.CancelledError now inherits from\nBaseException rather than Exception and no longer inherits\nfrom concurrent.futures.CancelledError.\n(Contributed by Yury Selivanov in bpo-32528.)\nThe function asyncio.wait_for() now correctly waits for cancellation\nwhen using an instance of asyncio.Task. Previously, upon reaching\ntimeout, it was cancelled and immediately returned.\n(Contributed by Elvis Pranskevichus in bpo-32751.)\nThe function asyncio.BaseTransport.get_extra_info() now returns a safe\nto use socket object when ‘socket’ is passed to the name parameter.\n(Contributed by Yury Selivanov in bpo-37027.)\nasyncio.BufferedProtocol has graduated to the stable API.\n\n\nDLL dependencies for extension modules and DLLs loaded with ctypes on\nWindows are now resolved more securely. Only the system paths, the directory\ncontaining the DLL or PYD file, and directories added with\nadd_dll_directory() are searched for load-time dependencies.\nSpecifically, PATH and the current working directory are no longer\nused, and modifications to these will no longer have any effect on normal DLL\nresolution. If your application relies on these mechanisms, you should check\nfor add_dll_directory() and if it exists, use it to add your DLLs\ndirectory while loading your library. Note that Windows 7 users will need to\nensure that Windows Update KB2533623 has been installed (this is also verified\nby the installer).\n(Contributed by Steve Dower in bpo-36085.)\nThe header files and functions related to pgen have been removed after its\nreplacement by a pure Python implementation. (Contributed by Pablo Galindo\nin bpo-36623.)\ntypes.CodeType has a new parameter in the second position of the\nconstructor (posonlyargcount) to support positional-only arguments defined\nin PEP 570. The first argument (argcount) now represents the total\nnumber of positional arguments (including positional-only arguments). The new\nreplace() method of types.CodeType can be used to make the code\nfuture-proof.\nThe parameter digestmod for hmac.new() no longer uses the MD5 digest\nby default.", "code_blocks": []}, "porting-to-python-3-8 - changes-in-the-c-api": {"text": "Changes in the C API\n\n\nThe PyCompilerFlags structure got a new cf_feature_version\nfield. It should be initialized to PY_MINOR_VERSION. The field is ignored\nby default, and is used if and only if PyCF_ONLY_AST flag is set in\ncf_flags.\n(Contributed by Guido van Rossum in bpo-35766.)\nThe PyEval_ReInitThreads() function has been removed from the C API.\nIt should not be called explicitly: use PyOS_AfterFork_Child()\ninstead.\n(Contributed by Victor Stinner in bpo-36728.)\nOn Unix, C extensions are no longer linked to libpython except on Android\nand Cygwin. When Python is embedded, libpython must not be loaded with\nRTLD_LOCAL, but RTLD_GLOBAL instead. Previously, using\nRTLD_LOCAL, it was already not possible to load C extensions which\nwere not linked to libpython, like C extensions of the standard\nlibrary built by the *shared* section of Modules/Setup.\n(Contributed by Victor Stinner in bpo-21536.)\nUse of # variants of formats in parsing or building value (e.g.\nPyArg_ParseTuple(), Py_BuildValue(), PyObject_CallFunction(),\netc.) without PY_SSIZE_T_CLEAN defined raises DeprecationWarning now.\nIt will be removed in 3.10 or 4.0.  Read Parsing arguments and building values for detail.\n(Contributed by Inada Naoki in bpo-36381.)\nInstances of heap-allocated types (such as those created with\nPyType_FromSpec()) hold a reference to their type object.\nIncreasing the reference count of these type objects has been moved from\nPyType_GenericAlloc() to the more low-level functions,\nPyObject_Init() and PyObject_INIT().\nThis makes types created through PyType_FromSpec() behave like\nother classes in managed code.\nStatically allocated types are not affected.\nFor the vast majority of cases, there should be no side effect.\nHowever, types that manually increase the reference count after allocating\nan instance (perhaps to work around the bug) may now become immortal.\nTo avoid this, these classes need to call Py_DECREF on the type object\nduring instance deallocation.\nTo correctly port these types into 3.8, please apply the following\nchanges:\n\nRemove Py_INCREF on the type object after allocating an\ninstance - if any.\nThis may happen after calling PyObject_New(),\nPyObject_NewVar(), PyObject_GC_New(),\nPyObject_GC_NewVar(), or any other custom allocator that uses\nPyObject_Init() or PyObject_INIT().\nExample:\nstatic foo_struct *\nfoo_new(PyObject *type) {\n    foo_struct *foo = PyObject_GC_New(foo_struct, (PyTypeObject *) type);\n    if (foo == NULL)\n        return NULL;\n#if PY_VERSION_HEX < 0x03080000\n    // Workaround for Python issue 35810; no longer necessary in Python 3.8\n    PY_INCREF(type)\n#endif\n    return foo;\n}\n\n\n\nEnsure that all custom tp_dealloc functions of heap-allocated types\ndecrease the type’s reference count.\nExample:\nstatic void\nfoo_dealloc(foo_struct *instance) {\n    PyObject *type = Py_TYPE(instance);\n    PyObject_GC_Del(instance);\n#if PY_VERSION_HEX >= 0x03080000\n    // This was not needed before Python 3.8 (Python issue 35810)\n    Py_DECREF(type);\n#endif\n}\n\n\n\n\n(Contributed by Eddie Elizondo in bpo-35810.)\n\nThe Py_DEPRECATED() macro has been implemented for MSVC.\nThe macro now must be placed before the symbol name.\nExample:\nPy_DEPRECATED(3.8) PyAPI_FUNC(int) Py_OldFunction(void);\n\n\n(Contributed by Zackery Spytz in bpo-33407.)\n\nThe interpreter does not pretend to support binary compatibility of\nextension types across feature releases, anymore.  A PyTypeObject\nexported by a third-party extension module is supposed to have all the\nslots expected in the current Python version, including\ntp_finalize (Py_TPFLAGS_HAVE_FINALIZE\nis not checked anymore before reading tp_finalize).\n(Contributed by Antoine Pitrou in bpo-32388.)\n\nThe functions PyNode_AddChild() and PyParser_AddToken() now accept\ntwo additional int arguments end_lineno and end_col_offset.\nThe libpython38.a file to allow MinGW tools to link directly against\npython38.dll is no longer included in the regular Windows distribution.\nIf you require this file, it may be generated with the gendef and\ndlltool tools, which are part of the MinGW binutils package:\ngendef - python38.dll > tmp.def\ndlltool --dllname python38.dll --def tmp.def --output-lib libpython38.a\n\n\nThe location of an installed pythonXY.dll will depend on the\ninstallation options and the version and language of Windows. See\nUsing Python on Windows for more information. The resulting library should be\nplaced in the same directory as pythonXY.lib, which is generally the\nlibs directory under your Python installation.\n(Contributed by Steve Dower in bpo-37351.)", "code_blocks": ["static foo_struct *\nfoo_new(PyObject *type) {\n    foo_struct *foo = PyObject_GC_New(foo_struct, (PyTypeObject *) type);\n    if (foo == NULL)\n        return NULL;\n#if PY_VERSION_HEX < 0x03080000\n    // Workaround for Python issue 35810; no longer necessary in Python 3.8\n    PY_INCREF(type)\n#endif\n    return foo;\n}\n", "static void\nfoo_dealloc(foo_struct *instance) {\n    PyObject *type = Py_TYPE(instance);\n    PyObject_GC_Del(instance);\n#if PY_VERSION_HEX >= 0x03080000\n    // This was not needed before Python 3.8 (Python issue 35810)\n    Py_DECREF(type);\n#endif\n}\n", "Py_DEPRECATED(3.8) PyAPI_FUNC(int) Py_OldFunction(void);\n", "gendef - python38.dll > tmp.def\ndlltool --dllname python38.dll --def tmp.def --output-lib libpython38.a\n"]}, "porting-to-python-3-8 - cpython-bytecode-changes": {"text": "CPython bytecode changes\n\n\nThe interpreter loop  has been simplified by moving the logic of unrolling\nthe stack of blocks into the compiler.  The compiler emits now explicit\ninstructions for adjusting the stack of values and calling the\ncleaning-up code for break, continue and\nreturn.\nRemoved opcodes BREAK_LOOP, CONTINUE_LOOP,\nSETUP_LOOP and SETUP_EXCEPT.  Added new opcodes\nROT_FOUR, BEGIN_FINALLY, CALL_FINALLY and\nPOP_FINALLY.  Changed the behavior of END_FINALLY\nand WITH_CLEANUP_START.\n(Contributed by Mark Shannon, Antoine Pitrou and Serhiy Storchaka in\nbpo-17611.)\n\nAdded new opcode END_ASYNC_FOR for handling exceptions raised\nwhen awaiting a next item in an async for loop.\n(Contributed by Serhiy Storchaka in bpo-33041.)\nThe MAP_ADD now expects the value as the first element in the\nstack and the key as the second element. This change was made so the key\nis always evaluated before the value in dictionary comprehensions, as\nproposed by PEP 572. (Contributed by Jörn Heissler in bpo-35224.)", "code_blocks": []}, "porting-to-python-3-8 - demos-and-tools": {"text": "Demos and Tools\n\nAdded a benchmark script for timing various ways to access variables:\nTools/scripts/var_access_benchmark.py.\n(Contributed by Raymond Hettinger in bpo-35884.)\nHere’s a summary of performance improvements since Python 3.3:\nPython version                       3.3     3.4     3.5     3.6     3.7     3.8\n--------------                       ---     ---     ---     ---     ---     ---\n\nVariable and attribute read access:\n    read_local                       4.0     7.1     7.1     5.4     5.1     3.9\n    read_nonlocal                    5.3     7.1     8.1     5.8     5.4     4.4\n    read_global                     13.3    15.5    19.0    14.3    13.6     7.6\n    read_builtin                    20.0    21.1    21.6    18.5    19.0     7.5\n    read_classvar_from_class        20.5    25.6    26.5    20.7    19.5    18.4\n    read_classvar_from_instance     18.5    22.8    23.5    18.8    17.1    16.4\n    read_instancevar                26.8    32.4    33.1    28.0    26.3    25.4\n    read_instancevar_slots          23.7    27.8    31.3    20.8    20.8    20.2\n    read_namedtuple                 68.5    73.8    57.5    45.0    46.8    18.4\n    read_boundmethod                29.8    37.6    37.9    29.6    26.9    27.7\n\nVariable and attribute write access:\n    write_local                      4.6     8.7     9.3     5.5     5.3     4.3\n    write_nonlocal                   7.3    10.5    11.1     5.6     5.5     4.7\n    write_global                    15.9    19.7    21.2    18.0    18.0    15.8\n    write_classvar                  81.9    92.9    96.0   104.6   102.1    39.2\n    write_instancevar               36.4    44.6    45.8    40.0    38.9    35.5\n    write_instancevar_slots         28.7    35.6    36.1    27.3    26.6    25.7\n\nData structure read access:\n    read_list                       19.2    24.2    24.5    20.8    20.8    19.0\n    read_deque                      19.9    24.7    25.5    20.2    20.6    19.8\n    read_dict                       19.7    24.3    25.7    22.3    23.0    21.0\n    read_strdict                    17.9    22.6    24.3    19.5    21.2    18.9\n\nData structure write access:\n    write_list                      21.2    27.1    28.5    22.5    21.6    20.0\n    write_deque                     23.8    28.7    30.1    22.7    21.8    23.5\n    write_dict                      25.9    31.4    33.3    29.3    29.2    24.7\n    write_strdict                   22.9    28.4    29.9    27.5    25.2    23.1\n\nStack (or queue) operations:\n    list_append_pop                144.2    93.4   112.7    75.4    74.2    50.8\n    deque_append_pop                30.4    43.5    57.0    49.4    49.2    42.5\n    deque_append_popleft            30.8    43.7    57.3    49.7    49.7    42.8\n\nTiming loop:\n    loop_overhead                    0.3     0.5     0.6     0.4     0.3     0.3\n\n\nThe benchmarks were measured on an\nIntel® Core™ i7-4960HQ processor\nrunning the macOS 64-bit builds found at\npython.org.\nThe benchmark script displays timings in nanoseconds.", "code_blocks": ["Python version                       3.3     3.4     3.5     3.6     3.7     3.8\n--------------                       ---     ---     ---     ---     ---     ---\n\nVariable and attribute read access:\n    read_local                       4.0     7.1     7.1     5.4     5.1     3.9\n    read_nonlocal                    5.3     7.1     8.1     5.8     5.4     4.4\n    read_global                     13.3    15.5    19.0    14.3    13.6     7.6\n    read_builtin                    20.0    21.1    21.6    18.5    19.0     7.5\n    read_classvar_from_class        20.5    25.6    26.5    20.7    19.5    18.4\n    read_classvar_from_instance     18.5    22.8    23.5    18.8    17.1    16.4\n    read_instancevar                26.8    32.4    33.1    28.0    26.3    25.4\n    read_instancevar_slots          23.7    27.8    31.3    20.8    20.8    20.2\n    read_namedtuple                 68.5    73.8    57.5    45.0    46.8    18.4\n    read_boundmethod                29.8    37.6    37.9    29.6    26.9    27.7\n\nVariable and attribute write access:\n    write_local                      4.6     8.7     9.3     5.5     5.3     4.3\n    write_nonlocal                   7.3    10.5    11.1     5.6     5.5     4.7\n    write_global                    15.9    19.7    21.2    18.0    18.0    15.8\n    write_classvar                  81.9    92.9    96.0   104.6   102.1    39.2\n    write_instancevar               36.4    44.6    45.8    40.0    38.9    35.5\n    write_instancevar_slots         28.7    35.6    36.1    27.3    26.6    25.7\n\nData structure read access:\n    read_list                       19.2    24.2    24.5    20.8    20.8    19.0\n    read_deque                      19.9    24.7    25.5    20.2    20.6    19.8\n    read_dict                       19.7    24.3    25.7    22.3    23.0    21.0\n    read_strdict                    17.9    22.6    24.3    19.5    21.2    18.9\n\nData structure write access:\n    write_list                      21.2    27.1    28.5    22.5    21.6    20.0\n    write_deque                     23.8    28.7    30.1    22.7    21.8    23.5\n    write_dict                      25.9    31.4    33.3    29.3    29.2    24.7\n    write_strdict                   22.9    28.4    29.9    27.5    25.2    23.1\n\nStack (or queue) operations:\n    list_append_pop                144.2    93.4   112.7    75.4    74.2    50.8\n    deque_append_pop                30.4    43.5    57.0    49.4    49.2    42.5\n    deque_append_popleft            30.8    43.7    57.3    49.7    49.7    42.8\n\nTiming loop:\n    loop_overhead                    0.3     0.5     0.6     0.4     0.3     0.3\n"]}, "notable-changes-in-python-3-8-1": {"text": "Notable changes in Python 3.8.1\n\nDue to significant security concerns, the reuse_address parameter of\nasyncio.loop.create_datagram_endpoint() is no longer supported. This is\nbecause of the behavior of the socket option SO_REUSEADDR in UDP. For more\ndetails, see the documentation for loop.create_datagram_endpoint().\n(Contributed by Kyle Stanley, Antoine Pitrou, and Yury Selivanov in\nbpo-37228.)", "code_blocks": []}, "notable-changes-in-python-3-8-2": {"text": "Notable changes in Python 3.8.2\n\nFixed a regression with the ignore callback of shutil.copytree().\nThe argument types are now str and List[str] again.\n(Contributed by Manuel Barkhau and Giampaolo Rodola in bpo-39390.)", "code_blocks": []}, "notable-changes-in-python-3-8-3": {"text": "Notable changes in Python 3.8.3\n\nThe constant values of future flags in the __future__ module\nare updated in order to prevent collision with compiler flags. Previously\nPyCF_ALLOW_TOP_LEVEL_AWAIT was clashing with CO_FUTURE_DIVISION.\n(Contributed by Batuhan Taskaya in bpo-39562)", "code_blocks": []}, "notable-changes-in-python-3-8-8": {"text": "Notable changes in Python 3.8.8\n\nEarlier Python versions allowed using both ; and & as\nquery parameter separators in urllib.parse.parse_qs() and\nurllib.parse.parse_qsl().  Due to security concerns, and to conform with\nnewer W3C recommendations, this has been changed to allow only a single\nseparator key, with & as the default.  This change also affects\ncgi.parse() and cgi.parse_multipart() as they use the affected\nfunctions internally. For more details, please see their respective\ndocumentation.\n(Contributed by Adam Goldschmidt, Senthil Kumaran and Ken Jin in bpo-42967.)", "code_blocks": []}, "notable-changes-in-python-3-8-9": {"text": "Notable changes in Python 3.8.9\n\nA security fix alters the ftplib.FTP behavior to not trust the\nIPv4 address sent from the remote server when setting up a passive data\nchannel.  We reuse the ftp server IP address instead.  For unusual code\nrequiring the old behavior, set a trust_server_pasv_ipv4_address\nattribute on your FTP instance to True.  (See bpo-43285)", "code_blocks": []}, "notable-changes-in-python-3-8-10 - macos-11-0-big-sur-and-apple-silicon-mac-support": {"text": "macOS 11.0 (Big Sur) and Apple Silicon Mac support\n\nAs of 3.8.10, Python now supports building and running on macOS 11\n(Big Sur) and on Apple Silicon Macs (based on the ARM64 architecture).\nA new universal build variant, universal2, is now available to natively\nsupport both ARM64 and Intel 64 in one set of executables.\nNote that support for “weaklinking”, building binaries targeted for newer\nversions of macOS that will also run correctly on older versions by\ntesting at runtime for missing features, is not included in this backport\nfrom Python 3.9; to support a range of macOS versions, continue to target\nfor and build on the oldest version in the range.\n(Originally contributed by Ronald Oussoren and Lawrence D’Anna in bpo-41100,\nwith fixes by FX Coudert and Eli Rykoff, and backported to 3.8 by Maxime Bélanger\nand Ned Deily)", "code_blocks": []}, "id1 - urllib-parse": {"text": "urllib.parse\n\nThe presence of newline or tab characters in parts of a URL allows for some\nforms of attacks. Following the WHATWG specification that updates RFC 3986,\nASCII newline \\n, \\r and tab \\t characters are stripped from the\nURL by the parser in urllib.parse preventing such attacks. The removal\ncharacters are controlled by a new module level variable\nurllib.parse._UNSAFE_URL_BYTES_TO_REMOVE. (See bpo-43882)", "code_blocks": []}, "notable-changes-in-python-3-8-12 - id2": {"text": "Changes in the Python API\n\nStarting with Python 3.8.12 the ipaddress module no longer accepts\nany leading zeros in IPv4 address strings. Leading zeros are ambiguous and\ninterpreted as octal notation by some libraries. For example the legacy\nfunction socket.inet_aton() treats leading zeros as octal notation.\nglibc implementation of modern inet_pton() does not accept\nany leading zeros.\n(Originally contributed by Christian Heimes in bpo-36384, and backported\nto 3.8 by Achraf Merzouki)", "code_blocks": []}, "notable-security-feature-in-3-8-14": {"text": "Notable security feature in 3.8.14\n\nConverting between int and str in bases other than 2\n(binary), 4, 8 (octal), 16 (hexadecimal), or 32 such as base 10 (decimal)\nnow raises a ValueError if the number of digits in string form is\nabove a limit to avoid potential denial of service attacks due to the\nalgorithmic complexity. This is a mitigation for CVE-2020-10735.\nThis limit can be configured or disabled by environment variable, command\nline flag, or sys APIs. See the integer string conversion\nlength limitation documentation.  The default limit\nis 4300 digits in string form.", "code_blocks": []}, "notable-changes-in-3-8-17 - id3": {"text": "tarfile\n\n\nThe extraction methods in tarfile, and shutil.unpack_archive(),\nhave a new a filter argument that allows limiting tar features than may be\nsurprising or dangerous, such as creating files outside the destination\ndirectory.\nSee Extraction filters for details.\nIn Python 3.12, use without the filter argument will show a\nDeprecationWarning.\nIn Python 3.14, the default will switch to 'data'.\n(Contributed by Petr Viktorin in PEP 706.)", "code_blocks": []}, "notable-changes-in-3-8-20 - ipaddress": {"text": "ipaddress\n\n\nFixed is_global and is_private behavior in IPv4Address,\nIPv6Address, IPv4Network and IPv6Network.", "code_blocks": []}, "notable-changes-in-3-8-20 - email": {"text": "email\n\n\nHeaders with embedded newlines are now quoted on output.\nThe generator will now refuse to serialize (write) headers\nthat are improperly folded or delimited, such that they would be parsed as\nmultiple headers or joined with adjacent data.\nIf you need to turn this safety feature off,\nset verify_generated_headers.\n(Contributed by Bas Bloemsaat and Petr Viktorin in gh-121650.)\n\nemail.utils.getaddresses() and email.utils.parseaddr() now return\n('', '') 2-tuples in more situations where invalid email addresses are\nencountered, instead of potentially inaccurate values.\nAn optional strict parameter was added to these two functions:\nuse strict=False to get the old behavior, accepting malformed inputs.\ngetattr(email.utils, 'supports_strict_parsing', False) can be used to\ncheck if the strict paramater is available.\n(Contributed by Thomas Dwyer and Victor Stinner for gh-102988 to improve\nthe CVE-2023-27043 fix.)", "code_blocks": []}}}
{"index": 11, "python_version": "3.9", "url": "https://docs.python.org/3.9/whatsnew/3.9.html", "sections": {"summary-release-highlights": {"text": "Summary – Release highlights\n\nNew syntax features:\n\nPEP 584, union operators added to dict;\nPEP 585, type hinting generics in standard collections;\nPEP 614, relaxed grammar restrictions on decorators.\n\nNew built-in features:\n\nPEP 616, string methods to remove prefixes and suffixes.\n\nNew features in the standard library:\n\nPEP 593, flexible function and variable annotations;\nos.pidfd_open() added that allows process management without races\nand signals.\n\nInterpreter improvements:\n\nPEP 573, fast access to module state from methods of C extension\ntypes;\nPEP 617, CPython now uses a new parser based on PEG;\na number of Python builtins (range, tuple, set, frozenset, list, dict) are\nnow sped up using PEP 590 vectorcall;\ngarbage collection does not block on resurrected objects;\na number of Python modules (_abc, audioop, _bz2,\n_codecs, _contextvars, _crypt, _functools,\n_json, _locale, math, operator, resource,\ntime, _weakref) now use multiphase initialization as defined\nby PEP 489;\na number of standard library modules (audioop, ast, grp,\n_hashlib, pwd, _posixsubprocess, random,\nselect, struct, termios, zlib) are now using\nthe stable ABI defined by PEP 384.\n\nNew library modules:\n\nPEP 615, the IANA Time Zone Database is now present in the standard\nlibrary in the zoneinfo module;\nan implementation of a topological sort of a graph is now provided in\nthe new graphlib module.\n\nRelease process changes:\n\nPEP 602, CPython adopts an annual release cycle.", "code_blocks": []}, "you-should-check-for-deprecationwarning-in-your-code": {"text": "You should check for DeprecationWarning in your code\n\nWhen Python 2.7 was still supported, a lot of functionality in Python 3\nwas kept for backward compatibility with Python 2.7. With the end of Python\n2 support, these backward compatibility layers have been removed, or will\nbe removed soon. Most of them emitted a DeprecationWarning warning for\nseveral years. For example, using collections.Mapping instead of\ncollections.abc.Mapping emits a DeprecationWarning since Python\n3.3, released in 2012.\nTest your application with the -W default command-line option to see\nDeprecationWarning and PendingDeprecationWarning, or even with\n-W error to treat them as errors. Warnings Filter can be used to ignore warnings from third-party code.\nPython 3.9 is the last version providing those Python 2 backward compatibility\nlayers, to give more time to Python projects maintainers to organize the\nremoval of the Python 2 support and add support for Python 3.9.\nAliases to Abstract Base Classes in\nthe collections module, like collections.Mapping alias to\ncollections.abc.Mapping, are kept for one last release for backward\ncompatibility. They will be removed from Python 3.10.\nMore generally, try to run your tests in the Python Development Mode which helps to prepare your code to make it compatible with the\nnext Python version.\nNote: a number of pre-existing deprecations were removed in this version of\nPython as well. Consult the Removed section.", "code_blocks": []}, "new-features - dictionary-merge-update-operators": {"text": "Dictionary Merge & Update Operators\n\nMerge (|) and update (|=) operators have been added to the built-in\ndict class. Those complement the existing dict.update and\n{**d1, **d2} methods of merging dictionaries.\nExample:\n>>> x = {\"key1\": \"value1 from x\", \"key2\": \"value2 from x\"}\n>>> y = {\"key2\": \"value2 from y\", \"key3\": \"value3 from y\"}\n>>> x | y\n{'key1': 'value1 from x', 'key2': 'value2 from y', 'key3': 'value3 from y'}\n>>> y | x\n{'key2': 'value2 from x', 'key3': 'value3 from y', 'key1': 'value1 from x'}\n\n\nSee PEP 584 for a full description.\n(Contributed by Brandt Bucher in bpo-36144.)", "code_blocks": [">>> x = {\"key1\": \"value1 from x\", \"key2\": \"value2 from x\"}\n>>> y = {\"key2\": \"value2 from y\", \"key3\": \"value3 from y\"}\n>>> x | y\n{'key1': 'value1 from x', 'key2': 'value2 from y', 'key3': 'value3 from y'}\n>>> y | x\n{'key2': 'value2 from x', 'key3': 'value3 from y', 'key1': 'value1 from x'}\n"]}, "new-features - new-string-methods-to-remove-prefixes-and-suffixes": {"text": "New String Methods to Remove Prefixes and Suffixes\n\nstr.removeprefix(prefix) and\nstr.removesuffix(suffix) have been added\nto easily remove an unneeded prefix or a suffix from a string. Corresponding\nbytes, bytearray, and collections.UserString methods have also been\nadded. See PEP 616 for a full description. (Contributed by Dennis Sweeney in\nbpo-39939.)", "code_blocks": []}, "new-features - type-hinting-generics-in-standard-collections": {"text": "Type Hinting Generics in Standard Collections\n\nIn type annotations you can now use built-in collection types such as\nlist and dict as generic types instead of importing the\ncorresponding capitalized types (e.g. List or Dict) from\ntyping.  Some other types in the standard library are also now generic,\nfor example queue.Queue.\nExample:\ndef greet_all(names: list[str]) -> None:\n    for name in names:\n        print(\"Hello\", name)\n\n\nSee PEP 585 for more details.  (Contributed by Guido van Rossum,\nEthan Smith, and Batuhan Taşkaya in bpo-39481.)", "code_blocks": ["def greet_all(names: list[str]) -> None:\n    for name in names:\n        print(\"Hello\", name)\n"]}, "new-features - new-parser": {"text": "New Parser\n\nPython 3.9 uses a new parser, based on PEG instead\nof LL(1).  The new\nparser’s performance is roughly comparable to that of the old parser,\nbut the PEG formalism is more flexible than LL(1) when it comes to\ndesigning new language features.  We’ll start using this flexibility\nin Python 3.10 and later.\nThe ast module uses the new parser and produces the same AST as\nthe old parser.\nIn Python 3.10, the old parser will be deleted and so will all\nfunctionality that depends on it (primarily the parser module,\nwhich has long been deprecated).  In Python 3.9 only, you can switch\nback to the LL(1) parser using a command line switch (-X\noldparser) or an environment variable (PYTHONOLDPARSER=1).\nSee PEP 617 for more details.  (Contributed by Guido van Rossum,\nPablo Galindo and Lysandros Nikolaou in bpo-40334.)", "code_blocks": []}, "other-language-changes": {"text": "Other Language Changes\n\n\n__import__() now raises ImportError instead of\nValueError, which used to occur when a relative import went past\nits top-level package.\n(Contributed by Ngalim Siregar in bpo-37444.)\nPython now gets the absolute path of the script filename specified on\nthe command line (ex: python3 script.py): the __file__ attribute of\nthe __main__ module became an absolute path, rather than a relative\npath. These paths now remain valid after the current directory is changed\nby os.chdir(). As a side effect, the traceback also displays the\nabsolute path for __main__ module frames in this case.\n(Contributed by Victor Stinner in bpo-20443.)\nIn the Python Development Mode and in debug build, the\nencoding and errors arguments are now checked for string encoding and\ndecoding operations. Examples: open(), str.encode() and\nbytes.decode().\nBy default, for best performance, the errors argument is only checked at\nthe first encoding/decoding error and the encoding argument is sometimes\nignored for empty strings.\n(Contributed by Victor Stinner in bpo-37388.)\n\n\"\".replace(\"\", s, n) now returns s instead of an empty string for\nall non-zero n.  It is now consistent with \"\".replace(\"\", s).\nThere are similar changes for bytes and bytearray objects.\n(Contributed by Serhiy Storchaka in bpo-28029.)\nAny valid expression can now be used as a decorator.  Previously, the\ngrammar was much more restrictive.  See PEP 614 for details.\n(Contributed by Brandt Bucher in bpo-39702.)\nImproved help for the typing module. Docstrings are now shown for\nall special forms and special generic aliases (like Union and List).\nUsing help() with generic alias like List[int] will show the help\nfor the correspondent concrete type (list in this case).\n(Contributed by Serhiy Storchaka in bpo-40257.)\nParallel running of aclose() / asend() /\nathrow() is now prohibited, and ag_running now reflects\nthe actual running status of the async generator.\n(Contributed by Yury Selivanov in bpo-30773.)\nUnexpected errors in calling the __iter__ method are no longer masked by\nTypeError in the in operator and functions\ncontains(), indexOf() and\ncountOf() of the operator module.\n(Contributed by Serhiy Storchaka in bpo-40824.)\nUnparenthesized lambda expressions can no longer be the expression part in an\nif clause in comprehensions and generator expressions. See bpo-41848\nand bpo-43755 for details.", "code_blocks": []}, "new-modules - zoneinfo": {"text": "zoneinfo\n\nThe zoneinfo module brings support for the IANA time zone database to\nthe standard library. It adds zoneinfo.ZoneInfo, a concrete\ndatetime.tzinfo implementation backed by the system’s time zone data.\nExample:\n>>> from zoneinfo import ZoneInfo\n>>> from datetime import datetime, timedelta\n\n>>> # Daylight saving time\n>>> dt = datetime(2020, 10, 31, 12, tzinfo=ZoneInfo(\"America/Los_Angeles\"))\n>>> print(dt)\n2020-10-31 12:00:00-07:00\n>>> dt.tzname()\n'PDT'\n\n>>> # Standard time\n>>> dt += timedelta(days=7)\n>>> print(dt)\n2020-11-07 12:00:00-08:00\n>>> print(dt.tzname())\nPST\n\n\nAs a fall-back source of data for platforms that don’t ship the IANA database,\nthe tzdata module was released as a first-party package – distributed via\nPyPI and maintained by the CPython core team.\n\nSee also\n\nPEP 615 – Support for the IANA Time Zone Database in the Standard LibraryPEP written and implemented by Paul Ganssle", "code_blocks": [">>> from zoneinfo import ZoneInfo\n>>> from datetime import datetime, timedelta\n\n>>> # Daylight saving time\n>>> dt = datetime(2020, 10, 31, 12, tzinfo=ZoneInfo(\"America/Los_Angeles\"))\n>>> print(dt)\n2020-10-31 12:00:00-07:00\n>>> dt.tzname()\n'PDT'\n\n>>> # Standard time\n>>> dt += timedelta(days=7)\n>>> print(dt)\n2020-11-07 12:00:00-08:00\n>>> print(dt.tzname())\nPST\n"]}, "new-modules - graphlib": {"text": "graphlib\n\nA new module, graphlib, was added that contains the\ngraphlib.TopologicalSorter class to offer functionality to perform\ntopological sorting of graphs. (Contributed by Pablo Galindo, Tim Peters and\nLarry Hastings in bpo-17005.)", "code_blocks": []}, "improved-modules - ast": {"text": "ast\n\nAdded the indent option to dump() which allows it to produce a\nmultiline indented output.\n(Contributed by Serhiy Storchaka in bpo-37995.)\nAdded ast.unparse() as a function in the ast module that can\nbe used to unparse an ast.AST object and produce a string with code\nthat would produce an equivalent ast.AST object when parsed.\n(Contributed by Pablo Galindo and Batuhan Taskaya in bpo-38870.)\nAdded docstrings to AST nodes that contains the ASDL signature used to\nconstruct that node. (Contributed by Batuhan Taskaya in bpo-39638.)", "code_blocks": []}, "improved-modules - asyncio": {"text": "asyncio\n\nDue to significant security concerns, the reuse_address parameter of\nasyncio.loop.create_datagram_endpoint() is no longer supported. This is\nbecause of the behavior of the socket option SO_REUSEADDR in UDP. For more\ndetails, see the documentation for loop.create_datagram_endpoint().\n(Contributed by Kyle Stanley, Antoine Pitrou, and Yury Selivanov in\nbpo-37228.)\nAdded a new coroutine shutdown_default_executor()\nthat schedules a shutdown for the default executor that waits on the\nThreadPoolExecutor to finish closing. Also,\nasyncio.run() has been updated to use the new coroutine.\n(Contributed by Kyle Stanley in bpo-34037.)\nAdded asyncio.PidfdChildWatcher, a Linux-specific child watcher\nimplementation that polls process file descriptors. (bpo-38692)\nAdded a new coroutine asyncio.to_thread(). It is mainly used for\nrunning IO-bound functions in a separate thread to avoid blocking the event\nloop, and essentially works as a high-level version of\nrun_in_executor() that can directly take keyword arguments.\n(Contributed by Kyle Stanley and Yury Selivanov in bpo-32309.)\nWhen cancelling the task due to a timeout, asyncio.wait_for() will now\nwait until the cancellation is complete also in the case when timeout is\n<= 0, like it does with positive timeouts.\n(Contributed by Elvis Pranskevichus in bpo-32751.)\nasyncio now raises TyperError when calling incompatible\nmethods with an ssl.SSLSocket socket.\n(Contributed by Ido Michael in bpo-37404.)", "code_blocks": []}, "improved-modules - compileall": {"text": "compileall\n\nAdded new possibility to use hardlinks for duplicated .pyc files: hardlink_dupes parameter and –hardlink-dupes command line option.\n(Contributed by  Lumír ‘Frenzy’ Balhar in bpo-40495.)\nAdded new options for path manipulation in resulting .pyc files: stripdir, prependdir, limit_sl_dest parameters and -s, -p, -e command line options.\nAdded the possibility to specify the option for an optimization level multiple times.\n(Contributed by Lumír ‘Frenzy’ Balhar in bpo-38112.)", "code_blocks": []}, "improved-modules - concurrent-futures": {"text": "concurrent.futures\n\nAdded a new cancel_futures parameter to\nconcurrent.futures.Executor.shutdown() that cancels all pending futures\nwhich have not started running, instead of waiting for them to complete before\nshutting down the executor.\n(Contributed by Kyle Stanley in bpo-39349.)\nRemoved daemon threads from ThreadPoolExecutor\nand ProcessPoolExecutor. This improves\ncompatibility with subinterpreters and predictability in their shutdown\nprocesses. (Contributed by Kyle Stanley in bpo-39812.)\nWorkers in ProcessPoolExecutor are now spawned on\ndemand, only when there are no available idle workers to reuse. This optimizes\nstartup overhead and reduces the amount of lost CPU time to idle workers.\n(Contributed by Kyle Stanley in bpo-39207.)", "code_blocks": []}, "improved-modules - curses": {"text": "curses\n\nAdded curses.get_escdelay(), curses.set_escdelay(),\ncurses.get_tabsize(), and curses.set_tabsize() functions.\n(Contributed by Anthony Sottile in bpo-38312.)", "code_blocks": []}, "improved-modules - datetime": {"text": "datetime\n\nThe isocalendar() of datetime.date\nand isocalendar() of datetime.datetime\nmethods now returns a namedtuple() instead of a tuple.\n(Contributed by Dong-hee Na in bpo-24416.)", "code_blocks": []}, "improved-modules - distutils": {"text": "distutils\n\nThe upload command now creates SHA2-256 and Blake2b-256 hash\ndigests. It skips MD5 on platforms that block MD5 digest.\n(Contributed by Christian Heimes in bpo-40698.)", "code_blocks": []}, "improved-modules - fcntl": {"text": "fcntl\n\nAdded constants F_OFD_GETLK, F_OFD_SETLK\nand F_OFD_SETLKW.\n(Contributed by Dong-hee Na in bpo-38602.)", "code_blocks": []}, "improved-modules - ftplib": {"text": "ftplib\n\nFTP and FTP_TLS now raise a ValueError\nif the given timeout for their constructor is zero to prevent the creation of\na non-blocking socket. (Contributed by Dong-hee Na in bpo-39259.)", "code_blocks": []}, "improved-modules - gc": {"text": "gc\n\nWhen the garbage collector makes a collection in which some objects resurrect\n(they are reachable from outside the isolated cycles after the finalizers have\nbeen executed), do not block the collection of all objects that are still\nunreachable. (Contributed by Pablo Galindo and Tim Peters in bpo-38379.)\nAdded a new function gc.is_finalized() to check if an object has been\nfinalized by the garbage collector. (Contributed by Pablo Galindo in\nbpo-39322.)", "code_blocks": []}, "improved-modules - hashlib": {"text": "hashlib\n\nThe hashlib module can now use SHA3 hashes and SHAKE XOF from OpenSSL\nwhen available.\n(Contributed by Christian Heimes in bpo-37630.)\nBuiltin hash modules can now be disabled with\n./configure --without-builtin-hashlib-hashes or selectively enabled with\ne.g. ./configure --with-builtin-hashlib-hashes=sha3,blake2 to force use\nof OpenSSL based implementation.\n(Contributed by Christian Heimes in bpo-40479)", "code_blocks": []}, "improved-modules - http": {"text": "http\n\nHTTP status codes 103 EARLY_HINTS, 418 IM_A_TEAPOT and 425 TOO_EARLY are added to\nhttp.HTTPStatus. (Contributed by Dong-hee Na in bpo-39509 and Ross Rhodes in bpo-39507.)", "code_blocks": []}, "improved-modules - idle-and-idlelib": {"text": "IDLE and idlelib\n\nAdded option to toggle cursor blink off.  (Contributed by Zackery Spytz\nin bpo-4603.)\nEscape key now closes IDLE completion windows.  (Contributed by Johnny\nNajera in bpo-38944.)\nAdded keywords to module name completion list.  (Contributed by Terry J.\nReedy in bpo-37765.)\nNew in 3.9 maintenance releases\nMake IDLE invoke sys.excepthook() (when started without ‘-n’).\nUser hooks were previously ignored.  (Contributed by Ken Hilton in\nbpo-43008.)\nThe changes above have been backported to 3.8 maintenance releases.\nRearrange the settings dialog.  Split the General tab into Windows\nand Shell/Ed tabs.  Move help sources, which extend the Help menu, to the\nExtensions tab.  Make space for new options and shorten the dialog. The\nlatter makes the dialog better fit small screens.  (Contributed by Terry Jan\nReedy in bpo-40468.)  Move the indent space setting from the Font tab to\nthe new Windows tab.  (Contributed by Mark Roseman and Terry Jan Reedy in\nbpo-33962.)\nApply syntax highlighting to .pyi files. (Contributed by Alex\nWaygood and Terry Jan Reedy in bpo-45447.)", "code_blocks": []}, "improved-modules - imaplib": {"text": "imaplib\n\nIMAP4 and IMAP4_SSL now have\nan optional timeout parameter for their constructors.\nAlso, the open() method now has an optional timeout parameter\nwith this change. The overridden methods of IMAP4_SSL and\nIMAP4_stream were applied to this change.\n(Contributed by Dong-hee Na in bpo-38615.)\nimaplib.IMAP4.unselect() is added.\nimaplib.IMAP4.unselect() frees server’s resources associated with the\nselected mailbox and returns the server to the authenticated\nstate. This command performs the same actions as imaplib.IMAP4.close(), except\nthat no messages are permanently removed from the currently\nselected mailbox. (Contributed by Dong-hee Na in bpo-40375.)", "code_blocks": []}, "improved-modules - importlib": {"text": "importlib\n\nTo improve consistency with import statements, importlib.util.resolve_name()\nnow raises ImportError instead of ValueError for invalid relative\nimport attempts.\n(Contributed by Ngalim Siregar in bpo-37444.)\nImport loaders which publish immutable module objects can now publish\nimmutable packages in addition to individual modules.\n(Contributed by Dino Viehland in bpo-39336.)\nAdded importlib.resources.files() function with support for\nsubdirectories in package data, matching backport in importlib_resources\nversion 1.5.\n(Contributed by Jason R. Coombs in bpo-39791.)\nRefreshed importlib.metadata from importlib_metadata version 1.6.1.", "code_blocks": []}, "improved-modules - inspect": {"text": "inspect\n\ninspect.BoundArguments.arguments is changed from OrderedDict to regular\ndict.  (Contributed by Inada Naoki in bpo-36350 and bpo-39775.)", "code_blocks": []}, "improved-modules - ipaddress": {"text": "ipaddress\n\nipaddress now supports IPv6 Scoped Addresses (IPv6 address with suffix %<scope_id>).\nScoped IPv6 addresses can be parsed using ipaddress.IPv6Address.\nIf present, scope zone ID is available through the scope_id attribute.\n(Contributed by Oleksandr Pavliuk in bpo-34788.)\nStarting with Python 3.9.5 the ipaddress module no longer\naccepts any leading zeros in IPv4 address strings.\n(Contributed by Christian Heimes in bpo-36384).", "code_blocks": []}, "improved-modules - math": {"text": "math\n\nExpanded the math.gcd() function to handle multiple arguments.\nFormerly, it only supported two arguments.\n(Contributed by Serhiy Storchaka in bpo-39648.)\nAdded math.lcm(): return the least common multiple of specified arguments.\n(Contributed by Mark Dickinson, Ananthakrishnan and Serhiy Storchaka in\nbpo-39479 and bpo-39648.)\nAdded math.nextafter(): return the next floating-point value after x\ntowards y.\n(Contributed by Victor Stinner in bpo-39288.)\nAdded math.ulp(): return the value of the least significant bit\nof a float.\n(Contributed by Victor Stinner in bpo-39310.)", "code_blocks": []}, "improved-modules - multiprocessing": {"text": "multiprocessing\n\nThe multiprocessing.SimpleQueue class has a new\nclose() method to explicitly close the\nqueue.\n(Contributed by Victor Stinner in bpo-30966.)", "code_blocks": []}, "improved-modules - nntplib": {"text": "nntplib\n\nNNTP and NNTP_SSL now raise a ValueError\nif the given timeout for their constructor is zero to prevent the creation of\na non-blocking socket. (Contributed by Dong-hee Na in bpo-39259.)", "code_blocks": []}, "improved-modules - os": {"text": "os\n\nAdded CLD_KILLED and CLD_STOPPED for si_code.\n(Contributed by Dong-hee Na in bpo-38493.)\nExposed the Linux-specific os.pidfd_open() (bpo-38692) and\nos.P_PIDFD (bpo-38713) for process management with file\ndescriptors.\nThe os.unsetenv() function is now also available on Windows.\n(Contributed by Victor Stinner in bpo-39413.)\nThe os.putenv() and os.unsetenv() functions are now always\navailable.\n(Contributed by Victor Stinner in bpo-39395.)\nAdded os.waitstatus_to_exitcode() function:\nconvert a wait status to an exit code.\n(Contributed by Victor Stinner in bpo-40094.)\nAs of 3.9.20, os.mkdir() and os.makedirs() on Windows now support\npassing a mode value of 0o700 to apply access control to the new\ndirectory. This implicitly affects tempfile.mkdtemp() and is a\nmitigation for CVE-2024-4030. Other values for mode continue to be\nignored.\n(Contributed by Steve Dower in gh-118486.)", "code_blocks": []}, "improved-modules - pathlib": {"text": "pathlib\n\nAdded pathlib.Path.readlink() which acts similarly to\nos.readlink().\n(Contributed by Girts Folkmanis in bpo-30618)", "code_blocks": []}, "improved-modules - pdb": {"text": "pdb\n\nOn Windows now Pdb supports ~/.pdbrc.\n(Contributed by Tim Hopper and Dan Lidral-Porter in bpo-20523.)", "code_blocks": []}, "improved-modules - poplib": {"text": "poplib\n\nPOP3 and POP3_SSL now raise a ValueError\nif the given timeout for their constructor is zero to prevent the creation of\na non-blocking socket. (Contributed by Dong-hee Na in bpo-39259.)", "code_blocks": []}, "improved-modules - pprint": {"text": "pprint\n\npprint can now pretty-print types.SimpleNamespace.\n(Contributed by Carl Bordum Hansen in bpo-37376.)", "code_blocks": []}, "improved-modules - pydoc": {"text": "pydoc\n\nThe documentation string is now shown not only for class, function,\nmethod etc, but for any object that has its own __doc__ attribute.\n(Contributed by Serhiy Storchaka in bpo-40257.)", "code_blocks": []}, "improved-modules - random": {"text": "random\n\nAdded a new random.Random.randbytes method: generate random bytes.\n(Contributed by Victor Stinner in bpo-40286.)", "code_blocks": []}, "improved-modules - signal": {"text": "signal\n\nExposed the Linux-specific signal.pidfd_send_signal() for sending to\nsignals to a process using a file descriptor instead of a pid. (bpo-38712)", "code_blocks": []}, "improved-modules - smtplib": {"text": "smtplib\n\nSMTP and SMTP_SSL now raise a ValueError\nif the given timeout for their constructor is zero to prevent the creation of\na non-blocking socket. (Contributed by Dong-hee Na in bpo-39259.)\nLMTP constructor  now has an optional timeout parameter.\n(Contributed by Dong-hee Na in bpo-39329.)", "code_blocks": []}, "improved-modules - socket": {"text": "socket\n\nThe socket module now exports the CAN_RAW_JOIN_FILTERS\nconstant on Linux 4.1 and greater.\n(Contributed by Stefan Tatschner and Zackery Spytz in bpo-25780.)\nThe socket module now supports the CAN_J1939 protocol on\nplatforms that support it.  (Contributed by Karl Ding in bpo-40291.)\nThe socket module now has the socket.send_fds() and\nsocket.recv_fds() functions. (Contributed by Joannah Nanjekye, Shinya\nOkano and Victor Stinner in bpo-28724.)", "code_blocks": []}, "improved-modules - time": {"text": "time\n\nOn AIX, thread_time() is now implemented with thread_cputime()\nwhich has nanosecond resolution, rather than\nclock_gettime(CLOCK_THREAD_CPUTIME_ID) which has a resolution of 10 ms.\n(Contributed by Batuhan Taskaya in bpo-40192)", "code_blocks": []}, "improved-modules - sys": {"text": "sys\n\nAdded a new sys.platlibdir attribute: name of the platform-specific\nlibrary directory. It is used to build the path of standard library and the\npaths of installed extension modules. It is equal to \"lib\" on most\nplatforms.  On Fedora and SuSE, it is equal to \"lib64\" on 64-bit platforms.\n(Contributed by Jan Matějek, Matěj Cepl, Charalampos Stratakis and Victor Stinner in bpo-1294959.)\nPreviously, sys.stderr was block-buffered when non-interactive. Now\nstderr defaults to always being line-buffered.\n(Contributed by Jendrik Seipp in bpo-13601.)", "code_blocks": []}, "improved-modules - tempfile": {"text": "tempfile\n\nAs of 3.9.20 on Windows, the default mode 0o700 used by\ntempfile.mkdtemp() now limits access to the new directory due to\nchanges to os.mkdir(). This is a mitigation for CVE-2024-4030.\n(Contributed by Steve Dower in gh-118486.)", "code_blocks": []}, "improved-modules - tracemalloc": {"text": "tracemalloc\n\nAdded tracemalloc.reset_peak() to set the peak size of traced memory\nblocks to the current size, to measure the peak of specific pieces of code.\n(Contributed by Huon Wilson in bpo-40630.)", "code_blocks": []}, "improved-modules - typing": {"text": "typing\n\nPEP 593 introduced an typing.Annotated type to decorate existing\ntypes with context-specific metadata and new include_extras parameter to\ntyping.get_type_hints() to access the metadata at runtime. (Contributed\nby Till Varoquaux and Konstantin Kashin.)", "code_blocks": []}, "improved-modules - unicodedata": {"text": "unicodedata\n\nThe Unicode database has been updated to version 13.0.0. (bpo-39926).", "code_blocks": []}, "improved-modules - venv": {"text": "venv\n\nThe activation scripts provided by venv now all specify their prompt\ncustomization consistently by always using the value specified by\n__VENV_PROMPT__. Previously some scripts unconditionally used\n__VENV_PROMPT__, others only if it happened to be set (which was the default\ncase), and one used __VENV_NAME__ instead.\n(Contributed by Brett Cannon in bpo-37663.)", "code_blocks": []}, "improved-modules - xml": {"text": "xml\n\nWhite space characters within attributes are now preserved when serializing\nxml.etree.ElementTree to XML file. EOLNs are no longer normalized\nto “n”. This is the result of discussion about how to interpret\nsection 2.11 of XML spec.\n(Contributed by Mefistotelis in bpo-39011.)", "code_blocks": []}, "optimizations": {"text": "Optimizations\n\n\nOptimized the idiom for assignment a temporary variable in comprehensions.\nNow for y in [expr] in comprehensions is as fast as a simple assignment\ny = expr.  For example:\n\nsums = [s for s in [0] for x in data for s in [s + x]]\n\nUnlike the := operator this idiom does not leak a variable to the\nouter scope.\n(Contributed by Serhiy Storchaka in bpo-32856.)\n\nOptimized signal handling in multithreaded applications. If a thread different\nthan the main thread gets a signal, the bytecode evaluation loop is no longer\ninterrupted at each bytecode instruction to check for pending signals which\ncannot be handled. Only the main thread of the main interpreter can handle\nsignals.\nPreviously, the bytecode evaluation loop was interrupted at each instruction\nuntil the main thread handles signals.\n(Contributed by Victor Stinner in bpo-40010.)\n\nOptimized the subprocess module on FreeBSD using closefrom().\n(Contributed by Ed Maste, Conrad Meyer, Kyle Evans, Kubilay Kocak and Victor\nStinner in bpo-38061.)\nPyLong_FromDouble() is now up to 1.87x faster for values that\nfit into long.\n(Contributed by Sergey Fedoseev in bpo-37986.)\nA number of Python builtins (range, tuple, set,\nfrozenset, list, dict) are now sped up by using\nPEP 590 vectorcall protocol.\n(Contributed by Dong-hee Na, Mark Shannon, Jeroen Demeyer and Petr Viktorin in bpo-37207.)\nOptimized difference_update() for the case when the other set\nis much larger than the base set.\n(Suggested by Evgeny Kapun with code contributed by Michele Orrù in bpo-8425.)\nPython’s small object allocator (obmalloc.c) now allows (no more than)\none empty arena to remain available for immediate reuse, without returning\nit to the OS.  This prevents thrashing in simple loops where an arena could\nbe created and destroyed anew on each iteration.\n(Contributed by Tim Peters in bpo-37257.)\nfloor division of float operation now has a better performance. Also\nthe message of ZeroDivisionError for this operation is updated.\n(Contributed by Dong-hee Na in bpo-39434.)\nDecoding short ASCII strings with UTF-8 and ascii codecs is now about\n15% faster.  (Contributed by Inada Naoki in bpo-37348.)\n\nHere’s a summary of performance improvements from Python 3.4 through Python 3.9:\nPython version                       3.4     3.5     3.6     3.7     3.8    3.9\n--------------                       ---     ---     ---     ---     ---    ---\n\nVariable and attribute read access:\n    read_local                       7.1     7.1     5.4     5.1     3.9    3.9\n    read_nonlocal                    7.1     8.1     5.8     5.4     4.4    4.5\n    read_global                     15.5    19.0    14.3    13.6     7.6    7.8\n    read_builtin                    21.1    21.6    18.5    19.0     7.5    7.8\n    read_classvar_from_class        25.6    26.5    20.7    19.5    18.4   17.9\n    read_classvar_from_instance     22.8    23.5    18.8    17.1    16.4   16.9\n    read_instancevar                32.4    33.1    28.0    26.3    25.4   25.3\n    read_instancevar_slots          27.8    31.3    20.8    20.8    20.2   20.5\n    read_namedtuple                 73.8    57.5    45.0    46.8    18.4   18.7\n    read_boundmethod                37.6    37.9    29.6    26.9    27.7   41.1\n\nVariable and attribute write access:\n    write_local                      8.7     9.3     5.5     5.3     4.3    4.3\n    write_nonlocal                  10.5    11.1     5.6     5.5     4.7    4.8\n    write_global                    19.7    21.2    18.0    18.0    15.8   16.7\n    write_classvar                  92.9    96.0   104.6   102.1    39.2   39.8\n    write_instancevar               44.6    45.8    40.0    38.9    35.5   37.4\n    write_instancevar_slots         35.6    36.1    27.3    26.6    25.7   25.8\n\nData structure read access:\n    read_list                       24.2    24.5    20.8    20.8    19.0   19.5\n    read_deque                      24.7    25.5    20.2    20.6    19.8   20.2\n    read_dict                       24.3    25.7    22.3    23.0    21.0   22.4\n    read_strdict                    22.6    24.3    19.5    21.2    18.9   21.5\n\nData structure write access:\n    write_list                      27.1    28.5    22.5    21.6    20.0   20.0\n    write_deque                     28.7    30.1    22.7    21.8    23.5   21.7\n    write_dict                      31.4    33.3    29.3    29.2    24.7   25.4\n    write_strdict                   28.4    29.9    27.5    25.2    23.1   24.5\n\nStack (or queue) operations:\n    list_append_pop                 93.4   112.7    75.4    74.2    50.8   50.6\n    deque_append_pop                43.5    57.0    49.4    49.2    42.5   44.2\n    deque_append_popleft            43.7    57.3    49.7    49.7    42.8   46.4\n\nTiming loop:\n    loop_overhead                    0.5     0.6     0.4     0.3     0.3    0.3\n\n\nThese results were generated from the variable access benchmark script at:\nTools/scripts/var_access_benchmark.py. The benchmark script displays timings\nin nanoseconds.  The benchmarks were measured on an\nIntel® Core™ i7-4960HQ processor\nrunning the macOS 64-bit builds found at\npython.org.", "code_blocks": ["Python version                       3.4     3.5     3.6     3.7     3.8    3.9\n--------------                       ---     ---     ---     ---     ---    ---\n\nVariable and attribute read access:\n    read_local                       7.1     7.1     5.4     5.1     3.9    3.9\n    read_nonlocal                    7.1     8.1     5.8     5.4     4.4    4.5\n    read_global                     15.5    19.0    14.3    13.6     7.6    7.8\n    read_builtin                    21.1    21.6    18.5    19.0     7.5    7.8\n    read_classvar_from_class        25.6    26.5    20.7    19.5    18.4   17.9\n    read_classvar_from_instance     22.8    23.5    18.8    17.1    16.4   16.9\n    read_instancevar                32.4    33.1    28.0    26.3    25.4   25.3\n    read_instancevar_slots          27.8    31.3    20.8    20.8    20.2   20.5\n    read_namedtuple                 73.8    57.5    45.0    46.8    18.4   18.7\n    read_boundmethod                37.6    37.9    29.6    26.9    27.7   41.1\n\nVariable and attribute write access:\n    write_local                      8.7     9.3     5.5     5.3     4.3    4.3\n    write_nonlocal                  10.5    11.1     5.6     5.5     4.7    4.8\n    write_global                    19.7    21.2    18.0    18.0    15.8   16.7\n    write_classvar                  92.9    96.0   104.6   102.1    39.2   39.8\n    write_instancevar               44.6    45.8    40.0    38.9    35.5   37.4\n    write_instancevar_slots         35.6    36.1    27.3    26.6    25.7   25.8\n\nData structure read access:\n    read_list                       24.2    24.5    20.8    20.8    19.0   19.5\n    read_deque                      24.7    25.5    20.2    20.6    19.8   20.2\n    read_dict                       24.3    25.7    22.3    23.0    21.0   22.4\n    read_strdict                    22.6    24.3    19.5    21.2    18.9   21.5\n\nData structure write access:\n    write_list                      27.1    28.5    22.5    21.6    20.0   20.0\n    write_deque                     28.7    30.1    22.7    21.8    23.5   21.7\n    write_dict                      31.4    33.3    29.3    29.2    24.7   25.4\n    write_strdict                   28.4    29.9    27.5    25.2    23.1   24.5\n\nStack (or queue) operations:\n    list_append_pop                 93.4   112.7    75.4    74.2    50.8   50.6\n    deque_append_pop                43.5    57.0    49.4    49.2    42.5   44.2\n    deque_append_popleft            43.7    57.3    49.7    49.7    42.8   46.4\n\nTiming loop:\n    loop_overhead                    0.5     0.6     0.4     0.3     0.3    0.3\n"]}, "deprecated": {"text": "Deprecated\n\n\nThe distutils bdist_msi command is now deprecated, use\nbdist_wheel (wheel packages) instead.\n(Contributed by Hugo van Kemenade in bpo-39586.)\nCurrently math.factorial() accepts float instances with\nnon-negative integer values (like 5.0).  It raises a ValueError\nfor non-integral and negative floats.  It is now deprecated.  In future\nPython versions it will raise a TypeError for all floats.\n(Contributed by Serhiy Storchaka in bpo-37315.)\nThe parser and symbol modules are deprecated and will be\nremoved in future versions of Python. For the majority of use cases,\nusers can leverage the Abstract Syntax Tree (AST) generation and compilation\nstage, using the ast module.\nThe Public C API functions PyParser_SimpleParseStringFlags(),\nPyParser_SimpleParseStringFlagsFilename(),\nPyParser_SimpleParseFileFlags() and PyNode_Compile()\nare deprecated and will be removed in Python 3.10 together with the old parser.\nUsing NotImplemented in a boolean context has been deprecated,\nas it is almost exclusively the result of incorrect rich comparator\nimplementations. It will be made a TypeError in a future version\nof Python.\n(Contributed by Josh Rosenberg in bpo-35712.)\nThe random module currently accepts any hashable type as a\npossible seed value.  Unfortunately, some of those types are not\nguaranteed to have a deterministic hash value.  After Python 3.9,\nthe module will restrict its seeds to None, int,\nfloat, str, bytes, and bytearray.\nOpening the GzipFile file for writing without specifying\nthe mode argument is deprecated.  In future Python versions it will always\nbe opened for reading by default.  Specify the mode argument for opening\nit for writing and silencing a warning.\n(Contributed by Serhiy Storchaka in bpo-28286.)\nDeprecated the split() method of _tkinter.TkappType in\nfavour of the splitlist() method which has more consistent and\npredicable behavior.\n(Contributed by Serhiy Storchaka in bpo-38371.)\nThe explicit passing of coroutine objects to asyncio.wait() has been\ndeprecated and will be removed in version 3.11.\n(Contributed by Yury Selivanov and Kyle Stanley in bpo-34790.)\nbinhex4 and hexbin4 standards are now deprecated. The binhex module\nand the following binascii functions are now deprecated:\n\nb2a_hqx(), a2b_hqx()\nrlecode_hqx(), rledecode_hqx()\n\n(Contributed by Victor Stinner in bpo-39353.)\n\nast classes slice, Index and ExtSlice are considered deprecated\nand will be removed in future Python versions.  value itself should be\nused instead of Index(value).  Tuple(slices, Load()) should be\nused instead of ExtSlice(slices).\n(Contributed by Serhiy Storchaka in bpo-34822.)\nast classes Suite, Param, AugLoad and AugStore\nare considered deprecated and will be removed in future Python versions.\nThey were not generated by the parser and not accepted by the code\ngenerator in Python 3.\n(Contributed by Batuhan Taskaya in bpo-39639 and bpo-39969\nand Serhiy Storchaka in bpo-39988.)\nThe PyEval_InitThreads() and PyEval_ThreadsInitialized()\nfunctions are now deprecated and will be removed in Python 3.11. Calling\nPyEval_InitThreads() now does nothing. The GIL is initialized\nby Py_Initialize() since Python 3.7.\n(Contributed by Victor Stinner in bpo-39877.)\nPassing None as the first argument to the shlex.split() function\nhas been deprecated.  (Contributed by Zackery Spytz in bpo-33262.)\nsmtpd.MailmanProxy() is now deprecated as it is unusable without\nan external module, mailman.  (Contributed by Samuel Colvin in bpo-35800.)\nThe lib2to3 module now emits a PendingDeprecationWarning.\nPython 3.9 switched to a PEG parser (see PEP 617), and Python 3.10 may\ninclude new language syntax that is not parsable by lib2to3’s LL(1) parser.\nThe lib2to3 module may be removed from the standard library in a future\nPython version. Consider third-party alternatives such as LibCST or\nparso.\n(Contributed by Carl Meyer in bpo-40360.)\nThe random parameter of random.shuffle() has been deprecated.\n(Contributed by Raymond Hettinger in bpo-40465)", "code_blocks": []}, "removed": {"text": "Removed\n\n\nThe erroneous version at unittest.mock.__version__ has been removed.\nnntplib.NNTP: xpath() and xgtitle() methods have been removed.\nThese methods are deprecated since Python 3.3. Generally, these extensions\nare not supported or not enabled by NNTP server administrators.\nFor xgtitle(), please use nntplib.NNTP.descriptions() or\nnntplib.NNTP.description() instead.\n(Contributed by Dong-hee Na in bpo-39366.)\narray.array: tostring() and fromstring() methods have been\nremoved. They were aliases to tobytes() and frombytes(), deprecated\nsince Python 3.2.\n(Contributed by Victor Stinner in bpo-38916.)\nThe undocumented sys.callstats() function has been removed. Since Python\n3.7, it was deprecated and always returned None. It required a special\nbuild option CALL_PROFILE which was already removed in Python 3.7.\n(Contributed by Victor Stinner in bpo-37414.)\nThe sys.getcheckinterval() and sys.setcheckinterval() functions have\nbeen removed. They were deprecated since Python 3.2. Use\nsys.getswitchinterval() and sys.setswitchinterval() instead.\n(Contributed by Victor Stinner in bpo-37392.)\nThe C function PyImport_Cleanup() has been removed. It was documented as:\n“Empty the module table.  For internal use only.”\n(Contributed by Victor Stinner in bpo-36710.)\n_dummy_thread and dummy_threading modules have been removed. These\nmodules were deprecated since Python 3.7 which requires threading support.\n(Contributed by Victor Stinner in bpo-37312.)\naifc.openfp() alias to aifc.open(), sunau.openfp() alias to\nsunau.open(), and wave.openfp() alias to wave.open() have been\nremoved. They were deprecated since Python 3.7.\n(Contributed by Victor Stinner in bpo-37320.)\nThe isAlive() method of threading.Thread\nhas been removed. It was deprecated since Python 3.8.\nUse is_alive() instead.\n(Contributed by Dong-hee Na in bpo-37804.)\nMethods getchildren() and getiterator() of classes\nElementTree and\nElement in the ElementTree\nmodule have been removed.  They were deprecated in Python 3.2.\nUse iter(x) or list(x) instead of x.getchildren() and\nx.iter() or list(x.iter()) instead of x.getiterator().\n(Contributed by Serhiy Storchaka in bpo-36543.)\nThe old plistlib API has been removed, it was deprecated since Python\n3.4. Use the load(), loads(), dump(), and\ndumps() functions. Additionally, the use_builtin_types parameter was\nremoved, standard bytes objects are always used instead.\n(Contributed by Jon Janzen in bpo-36409.)\nThe C function PyGen_NeedsFinalizing has been removed. It was not\ndocumented, tested, or used anywhere within CPython after the implementation\nof PEP 442. Patch by Joannah Nanjekye.\n(Contributed by Joannah Nanjekye in bpo-15088)\nbase64.encodestring() and base64.decodestring(), aliases deprecated\nsince Python 3.1, have been removed: use base64.encodebytes() and\nbase64.decodebytes() instead.\n(Contributed by Victor Stinner in bpo-39351.)\nfractions.gcd() function has been removed, it was deprecated since Python\n3.5 (bpo-22486): use math.gcd() instead.\n(Contributed by Victor Stinner in bpo-39350.)\nThe buffering parameter of bz2.BZ2File has been removed. Since\nPython 3.0, it was ignored and using it emitted a DeprecationWarning.\nPass an open file object to control how the file is opened.\n(Contributed by Victor Stinner in bpo-39357.)\nThe encoding parameter of json.loads() has been removed.\nAs of Python 3.1, it was deprecated and ignored; using it has emitted a\nDeprecationWarning since Python 3.8.\n(Contributed by Inada Naoki in bpo-39377)\nwith (await asyncio.lock): and with (yield from asyncio.lock): statements are\nnot longer supported, use async with lock instead.  The same is correct for\nasyncio.Condition and asyncio.Semaphore.\n(Contributed by Andrew Svetlov in bpo-34793.)\nThe sys.getcounts() function, the -X showalloccount command line\noption and the show_alloc_count field of the C structure\nPyConfig have been removed. They required a special Python build by\ndefining COUNT_ALLOCS macro.\n(Contributed by Victor Stinner in bpo-39489.)\nThe _field_types attribute of the typing.NamedTuple class\nhas been removed.  It was deprecated since Python 3.8.  Use\nthe __annotations__ attribute instead.\n(Contributed by Serhiy Storchaka in bpo-40182.)\nThe symtable.SymbolTable.has_exec() method has been removed. It was\ndeprecated since 2006, and only returning False when it’s called.\n(Contributed by Batuhan Taskaya in bpo-40208)\nThe asyncio.Task.current_task() and asyncio.Task.all_tasks()\nhave been removed. They were deprecated since Python 3.7 and you can use\nasyncio.current_task() and asyncio.all_tasks() instead.\n(Contributed by Rémi Lapeyre in bpo-40967)\nThe unescape() method in the html.parser.HTMLParser class\nhas been removed (it was deprecated since Python 3.4).  html.unescape()\nshould be used for converting character references to the corresponding\nunicode characters.", "code_blocks": []}, "porting-to-python-3-9 - changes-in-the-python-api": {"text": "Changes in the Python API\n\n\n__import__() and importlib.util.resolve_name() now raise\nImportError where it previously raised ValueError. Callers\ncatching the specific exception type and supporting both Python 3.9 and\nearlier versions will need to catch both using except (ImportError, ValueError):.\nThe venv activation scripts no longer special-case when\n__VENV_PROMPT__ is set to \"\".\nThe select.epoll.unregister() method no longer ignores the\nEBADF error.\n(Contributed by Victor Stinner in bpo-39239.)\nThe compresslevel parameter of bz2.BZ2File became keyword-only,\nsince the buffering parameter has been removed.\n(Contributed by Victor Stinner in bpo-39357.)\nSimplified AST for subscription. Simple indices will be represented by\ntheir value, extended slices will be represented as tuples.\nIndex(value) will return a value itself, ExtSlice(slices)\nwill return Tuple(slices, Load()).\n(Contributed by Serhiy Storchaka in bpo-34822.)\nThe importlib module now ignores the PYTHONCASEOK\nenvironment variable when the -E or -I command line\noptions are being used.\nThe encoding parameter has been added to the classes ftplib.FTP and\nftplib.FTP_TLS as a keyword-only parameter, and the default encoding\nis changed from Latin-1 to UTF-8 to follow RFC 2640.\nasyncio.loop.shutdown_default_executor() has been added to\nAbstractEventLoop, meaning alternative event loops that\ninherit from it should have this method defined.\n(Contributed by Kyle Stanley in bpo-34037.)\nThe constant values of future flags in the __future__ module\nis updated in order to prevent collision with compiler flags. Previously\nPyCF_ALLOW_TOP_LEVEL_AWAIT was clashing with CO_FUTURE_DIVISION.\n(Contributed by Batuhan Taskaya in bpo-39562)\narray('u') now uses wchar_t as C type instead of Py_UNICODE.\nThis change doesn’t affect to its behavior because Py_UNICODE is alias\nof wchar_t since Python 3.3.\n(Contributed by Inada Naoki in bpo-34538.)\nThe logging.getLogger() API now returns the root logger when passed\nthe name 'root', whereas previously it returned a non-root logger named\n'root'. This could affect cases where user code explicitly wants a\nnon-root logger named 'root', or instantiates a logger using\nlogging.getLogger(__name__) in some top-level module called 'root.py'.\n(Contributed by Vinay Sajip in bpo-37742.)\nDivision handling of PurePath now returns NotImplemented\ninstead of raising a TypeError when passed something other than an\ninstance of str or PurePath.  This allows creating\ncompatible classes that don’t inherit from those mentioned types.\n(Contributed by Roger Aiudi in bpo-34775).\nStarting with Python 3.9.5 the ipaddress module no longer\naccepts any leading zeros in IPv4 address strings. Leading zeros are\nambiguous and interpreted as octal notation by some libraries. For example\nthe legacy function socket.inet_aton() treats leading zeros as octal\nnotatation. glibc implementation of modern inet_pton() does\nnot accept any leading zeros.\n(Contributed by Christian Heimes in bpo-36384).\ncodecs.lookup() now normalizes the encoding name the same way as\nencodings.normalize_encoding(), except that codecs.lookup() also\nconverts the name to lower case. For example, \"latex+latin1\" encoding\nname is now normalized to \"latex_latin1\".\n(Contributed by Jordon Xu in bpo-37751.)", "code_blocks": []}, "porting-to-python-3-9 - changes-in-the-c-api": {"text": "Changes in the C API\n\n\nInstances of heap-allocated types (such as those created with\nPyType_FromSpec() and similar APIs) hold a reference to their type\nobject since Python 3.8. As indicated in the “Changes in the C API” of Python\n3.8, for the vast majority of cases, there should be no side effect but for\ntypes that have a custom tp_traverse function,\nensure that all custom tp_traverse functions of heap-allocated types\nvisit the object’s type.\n\nExample:\nint\nfoo_traverse(foo_struct *self, visitproc visit, void *arg) {\n// Rest of the traverse function\n#if PY_VERSION_HEX >= 0x03090000\n    // This was not needed before Python 3.9 (Python issue 35810 and 40217)\n    Py_VISIT(Py_TYPE(self));\n#endif\n}\n\n\n\nIf your traverse function delegates to tp_traverse of its base class\n(or another type), ensure that Py_TYPE(self) is visited only once.\nNote that only heap types are expected to visit the type in tp_traverse.\n\nFor example, if your tp_traverse function includes:\nbase->tp_traverse(self, visit, arg)\n\n\nthen add:\n#if PY_VERSION_HEX >= 0x03090000\n    // This was not needed before Python 3.9 (Python issue 35810 and 40217)\n    if (base->tp_flags & Py_TPFLAGS_HEAPTYPE) {\n        // a heap type's tp_traverse already visited Py_TYPE(self)\n    } else {\n        Py_VISIT(Py_TYPE(self));\n    }\n#else\n\n\n\n(See bpo-35810 and bpo-40217 for more information.)\n\nThe functions PyEval_CallObject, PyEval_CallFunction,\nPyEval_CallMethod and PyEval_CallObjectWithKeywords are deprecated.\nUse PyObject_Call() and its variants instead.\n(See more details in bpo-29548.)", "code_blocks": ["int\nfoo_traverse(foo_struct *self, visitproc visit, void *arg) {\n// Rest of the traverse function\n#if PY_VERSION_HEX >= 0x03090000\n    // This was not needed before Python 3.9 (Python issue 35810 and 40217)\n    Py_VISIT(Py_TYPE(self));\n#endif\n}\n", "base->tp_traverse(self, visit, arg)\n", "#if PY_VERSION_HEX >= 0x03090000\n    // This was not needed before Python 3.9 (Python issue 35810 and 40217)\n    if (base->tp_flags & Py_TPFLAGS_HEAPTYPE) {\n        // a heap type's tp_traverse already visited Py_TYPE(self)\n    } else {\n        Py_VISIT(Py_TYPE(self));\n    }\n#else\n"]}, "porting-to-python-3-9 - cpython-bytecode-changes": {"text": "CPython bytecode changes\n\n\nThe LOAD_ASSERTION_ERROR opcode was added for handling the\nassert statement. Previously, the assert statement would not work\ncorrectly if the AssertionError exception was being shadowed.\n(Contributed by Zackery Spytz in bpo-34880.)\nThe COMPARE_OP opcode was split into four distinct instructions:\n\nCOMPARE_OP for rich comparisons\nIS_OP for ‘is’ and ‘is not’ tests\nCONTAINS_OP for ‘in’ and ‘not in’ tests\nJUMP_IF_NOT_EXC_MATCH for checking exceptions in ‘try-except’\nstatements.\n\n(Contributed by Mark Shannon in bpo-39156.)", "code_blocks": []}, "build-changes": {"text": "Build Changes\n\n\nAdded --with-platlibdir option to the configure script: name of the\nplatform-specific library directory, stored in the new sys.platlibdir\nattribute. See sys.platlibdir attribute for more information.\n(Contributed by Jan Matějek, Matěj Cepl, Charalampos Stratakis\nand Victor Stinner in bpo-1294959.)\nThe COUNT_ALLOCS special build macro has been removed.\n(Contributed by Victor Stinner in bpo-39489.)\nOn non-Windows platforms, the setenv() and unsetenv()\nfunctions are now required to build Python.\n(Contributed by Victor Stinner in bpo-39395.)\nOn non-Windows platforms, creating bdist_wininst installers is now\nofficially unsupported.  (See bpo-10945 for more details.)\nWhen building Python on macOS from source, _tkinter now links with\nnon-system Tcl and Tk frameworks if they are installed in\n/Library/Frameworks, as had been the case on older releases\nof macOS. If a macOS SDK is explicitly configured, by using\n--enable-universalsdk= or -isysroot, only the SDK itself is\nsearched. The default behavior can still be overridden with\n--with-tcltk-includes and --with-tcltk-libs.\n(Contributed by Ned Deily in bpo-34956.)\nPython can now be built for Windows 10 ARM64.\n(Contributed by Steve Dower in bpo-33125.)\nSome individual tests are now skipped when --pgo is used.  The tests\nin question increased the PGO task time significantly and likely\ndidn’t help improve optimization of the final executable. This\nspeeds up the task by a factor of about 15x.  Running the full unit test\nsuite is slow.  This change may result in a slightly less optimized build\nsince not as many code branches will be executed.  If you are willing to\nwait for the much slower build, the old behavior can be restored using\n./configure [..] PROFILE_TASK=\"-m test --pgo-extended\".  We make no\nguarantees as to which PGO task set produces a faster build.  Users who care\nshould run their own relevant benchmarks as results can depend on the\nenvironment, workload, and compiler tool chain.\n(See bpo-36044 and bpo-37707 for more details.)", "code_blocks": []}, "c-api-changes - id1": {"text": "New Features\n\n\nPEP 573: Added PyType_FromModuleAndSpec() to associate\na module with a class; PyType_GetModule() and\nPyType_GetModuleState() to retrieve the module and its state; and\nPyCMethod and METH_METHOD to allow a method to\naccess the class it was defined in.\n(Contributed by Marcel Plch and Petr Viktorin in bpo-38787.)\nAdded PyFrame_GetCode() function: get a frame code.\nAdded PyFrame_GetBack() function: get the frame next outer frame.\n(Contributed by Victor Stinner in bpo-40421.)\nAdded PyFrame_GetLineNumber() to the limited C API.\n(Contributed by Victor Stinner in bpo-40421.)\nAdded PyThreadState_GetInterpreter() and\nPyInterpreterState_Get() functions to get the interpreter.\nAdded PyThreadState_GetFrame() function to get the current frame of a\nPython thread state.\nAdded PyThreadState_GetID() function: get the unique identifier of a\nPython thread state.\n(Contributed by Victor Stinner in bpo-39947.)\nAdded a new public PyObject_CallNoArgs() function to the C API, which\ncalls a callable Python object without any arguments. It is the most efficient\nway to call a callable Python object without any argument.\n(Contributed by Victor Stinner in bpo-37194.)\nChanges in the limited C API (if Py_LIMITED_API macro is defined):\n\nProvide Py_EnterRecursiveCall() and Py_LeaveRecursiveCall()\nas regular functions for the limited API. Previously, there were defined as\nmacros, but these macros didn’t compile with the limited C API which cannot\naccess PyThreadState.recursion_depth field (the structure is opaque in\nthe limited C API).\nPyObject_INIT() and PyObject_INIT_VAR() become regular “opaque”\nfunction to hide implementation details.\n\n(Contributed by Victor Stinner in bpo-38644 and bpo-39542.)\n\nThe PyModule_AddType() function is added to help adding a type\nto a module.\n(Contributed by Dong-hee Na in bpo-40024.)\nAdded the functions PyObject_GC_IsTracked() and\nPyObject_GC_IsFinalized() to the public API to allow to query if\nPython objects are being currently tracked or have been already finalized by\nthe garbage collector respectively.\n(Contributed by Pablo Galindo Salgado in bpo-40241.)\nAdded _PyObject_FunctionStr() to get a user-friendly string\nrepresentation of a function-like object.\n(Patch by Jeroen Demeyer in bpo-37645.)\nAdded PyObject_CallOneArg() for calling an object with one\npositional argument\n(Patch by Jeroen Demeyer in bpo-37483.)", "code_blocks": []}, "c-api-changes - id2": {"text": "Porting to Python 3.9\n\n\nPyInterpreterState.eval_frame (PEP 523) now requires a new mandatory\ntstate parameter (PyThreadState*).\n(Contributed by Victor Stinner in bpo-38500.)\nExtension modules: m_traverse,\nm_clear and m_free\nfunctions of PyModuleDef are no longer called if the module state\nwas requested but is not allocated yet. This is the case immediately after\nthe module is created and before the module is executed\n(Py_mod_exec function). More precisely, these functions are not called\nif m_size is greater than 0 and the module state (as\nreturned by PyModule_GetState()) is NULL.\nExtension modules without module state (m_size <= 0) are not affected.\n\nIf Py_AddPendingCall() is called in a subinterpreter, the function is\nnow scheduled to be called from the subinterpreter, rather than being called\nfrom the main interpreter. Each subinterpreter now has its own list of\nscheduled calls.\n(Contributed by Victor Stinner in bpo-39984.)\nThe Windows registry is no longer used to initialize sys.path when\nthe -E option is used (if PyConfig.use_environment is set to\n0). This is significant when embedding Python on Windows.\n(Contributed by Zackery Spytz in bpo-8901.)\nThe global variable PyStructSequence_UnnamedField is now a constant\nand refers to a constant string.\n(Contributed by Serhiy Storchaka in bpo-38650.)\nThe PyGC_Head structure is now opaque. It is only defined in the\ninternal C API (pycore_gc.h).\n(Contributed by Victor Stinner in bpo-40241.)\nThe Py_UNICODE_COPY, Py_UNICODE_FILL, PyUnicode_WSTR_LENGTH,\nPyUnicode_FromUnicode(), PyUnicode_AsUnicode(),\n_PyUnicode_AsUnicode, and PyUnicode_AsUnicodeAndSize() are\nmarked as deprecated in C.  They have been deprecated by PEP 393 since\nPython 3.3.\n(Contributed by Inada Naoki in bpo-36346.)\nThe Py_FatalError() function is replaced with a macro which logs\nautomatically the name of the current function, unless the\nPy_LIMITED_API macro is defined.\n(Contributed by Victor Stinner in bpo-39882.)\nThe vectorcall protocol now requires that the caller passes only strings as\nkeyword names. (See bpo-37540 for more information.)\nImplementation details of a number of macros and functions are now hidden:\n\nPyObject_IS_GC() macro was converted to a function.\nThe PyObject_NEW() macro becomes an alias to the\nPyObject_New() macro, and the PyObject_NEW_VAR() macro\nbecomes an alias to the PyObject_NewVar() macro. They no longer\naccess directly the PyTypeObject.tp_basicsize member.\nPyObject_GET_WEAKREFS_LISTPTR() macro was converted to a function:\nthe macro accessed directly the PyTypeObject.tp_weaklistoffset\nmember.\nPyObject_CheckBuffer() macro was converted to a function: the macro\naccessed directly the PyTypeObject.tp_as_buffer member.\nPyIndex_Check() is now always declared as an opaque function to hide\nimplementation details: removed the PyIndex_Check() macro. The macro accessed\ndirectly the PyTypeObject.tp_as_number member.\n\n(See bpo-40170 for more details.)", "code_blocks": []}, "c-api-changes - id3": {"text": "Removed\n\n\nExcluded PyFPE_START_PROTECT() and PyFPE_END_PROTECT() macros of\npyfpe.h from the limited C API.\n(Contributed by Victor Stinner in bpo-38835.)\nThe tp_print slot of PyTypeObject has been removed.\nIt was used for printing objects to files in Python 2.7 and before. Since\nPython 3.0, it has been ignored and unused.\n(Contributed by Jeroen Demeyer in bpo-36974.)\nChanges in the limited C API (if Py_LIMITED_API macro is defined):\n\nExcluded the following functions from the limited C API:\n\nPyThreadState_DeleteCurrent()\n(Contributed by Joannah Nanjekye in bpo-37878.)\n_Py_CheckRecursionLimit\n_Py_NewReference()\n_Py_ForgetReference()\n_PyTraceMalloc_NewReference()\n_Py_GetRefTotal()\nThe trashcan mechanism which never worked in the limited C API.\nPyTrash_UNWIND_LEVEL\nPy_TRASHCAN_BEGIN_CONDITION\nPy_TRASHCAN_BEGIN\nPy_TRASHCAN_END\nPy_TRASHCAN_SAFE_BEGIN\nPy_TRASHCAN_SAFE_END\n\n\nMoved following functions and definitions to the internal C API:\n\n_PyDebug_PrintTotalRefs()\n_Py_PrintReferences()\n_Py_PrintReferenceAddresses()\n_Py_tracemalloc_config\n_Py_AddToAllObjects() (specific to Py_TRACE_REFS build)\n\n\n\n(Contributed by Victor Stinner in bpo-38644 and bpo-39542.)\n\nRemoved _PyRuntime.getframe hook and removed _PyThreadState_GetFrame\nmacro which was an alias to _PyRuntime.getframe. They were only exposed\nby the internal C API. Removed also PyThreadFrameGetter type.\n(Contributed by Victor Stinner in bpo-39946.)\nRemoved the following functions from the C API. Call PyGC_Collect()\nexplicitly to clear all free lists.\n(Contributed by Inada Naoki and Victor Stinner in bpo-37340,\nbpo-38896 and bpo-40428.)\n\nPyAsyncGen_ClearFreeLists()\nPyContext_ClearFreeList()\nPyDict_ClearFreeList()\nPyFloat_ClearFreeList()\nPyFrame_ClearFreeList()\nPyList_ClearFreeList()\nPyMethod_ClearFreeList() and PyCFunction_ClearFreeList():\nthe free lists of bound method objects have been removed.\nPySet_ClearFreeList(): the set free list has been removed\nin Python 3.4.\nPyTuple_ClearFreeList()\nPyUnicode_ClearFreeList(): the Unicode free list has been removed in\nPython 3.3.\n\n\nRemoved _PyUnicode_ClearStaticStrings() function.\n(Contributed by Victor Stinner in bpo-39465.)\nRemoved Py_UNICODE_MATCH. It has been deprecated by PEP 393, and\nbroken since Python 3.3. The PyUnicode_Tailmatch() function can be\nused instead.\n(Contributed by Inada Naoki in bpo-36346.)\nCleaned header files of interfaces defined but with no implementation.\nThe public API symbols being removed are:\n_PyBytes_InsertThousandsGroupingLocale,\n_PyBytes_InsertThousandsGrouping, _Py_InitializeFromArgs,\n_Py_InitializeFromWideArgs, _PyFloat_Repr, _PyFloat_Digits,\n_PyFloat_DigitsInit, PyFrame_ExtendStack, _PyAIterWrapper_Type,\nPyNullImporter_Type, PyCmpWrapper_Type, PySortWrapper_Type,\nPyNoArgsFunction.\n(Contributed by Pablo Galindo Salgado in bpo-39372.)", "code_blocks": []}, "notable-changes-in-python-3-9-1 - id4": {"text": "typing\n\nThe behavior of typing.Literal was changed to conform with PEP 586\nand to match the behavior of static type checkers specified in the PEP.\n\nLiteral now de-duplicates parameters.\nEquality comparisons between Literal objects are now order independent.\nLiteral comparisons now respect types.  For example,\nLiteral[0] == Literal[False] previously evaluated to True.  It is\nnow False.  To support this change, the internally used type cache now\nsupports differentiating types.\nLiteral objects will now raise a TypeError exception during\nequality comparisons if any of their parameters are not hashable.\nNote that declaring Literal with mutable parameters will not throw\nan error:\n>>> from typing import Literal\n>>> Literal[{0}]\n>>> Literal[{0}] == Literal[{False}]\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: unhashable type: 'set'\n\n\n\n\n(Contributed by Yurii Karabas in bpo-42345.)", "code_blocks": [">>> from typing import Literal\n>>> Literal[{0}]\n>>> Literal[{0}] == Literal[{False}]\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: unhashable type: 'set'\n"]}, "notable-changes-in-python-3-9-1 - macos-11-0-big-sur-and-apple-silicon-mac-support": {"text": "macOS 11.0 (Big Sur) and Apple Silicon Mac support\n\nAs of 3.9.1, Python now fully supports building and running on macOS 11.0\n(Big Sur) and on Apple Silicon Macs (based on the ARM64 architecture).\nA new universal build variant, universal2, is now available to natively\nsupport both ARM64 and Intel 64 in one set of executables. Binaries\ncan also now be built on current versions of macOS to be deployed on a range\nof older macOS versions (tested to 10.9) while making some newer OS\nfunctions and options conditionally available based on the operating system\nversion in use at runtime (“weaklinking”).\n(Contributed by Ronald Oussoren and Lawrence D’Anna in bpo-41100.)", "code_blocks": []}, "notable-changes-in-python-3-9-2 - collections-abc": {"text": "collections.abc\n\ncollections.abc.Callable generic now flattens type parameters, similar\nto what typing.Callable currently does.  This means that\ncollections.abc.Callable[[int, str], str] will have __args__ of\n(int, str, str); previously this was ([int, str], str).  To allow this\nchange, types.GenericAlias can now be subclassed, and a subclass will\nbe returned when subscripting the collections.abc.Callable type.\nCode which accesses the arguments via typing.get_args() or __args__\nneed to account for this change.  A DeprecationWarning may be emitted for\ninvalid forms of parameterizing collections.abc.Callable which may have\npassed silently in Python 3.9.1.  This DeprecationWarning will\nbecome a TypeError in Python 3.10.\n(Contributed by Ken Jin in bpo-42195.)", "code_blocks": []}, "notable-changes-in-python-3-9-2 - urllib-parse": {"text": "urllib.parse\n\nEarlier Python versions allowed using both ; and & as\nquery parameter separators in urllib.parse.parse_qs() and\nurllib.parse.parse_qsl().  Due to security concerns, and to conform with\nnewer W3C recommendations, this has been changed to allow only a single\nseparator key, with & as the default.  This change also affects\ncgi.parse() and cgi.parse_multipart() as they use the affected\nfunctions internally. For more details, please see their respective\ndocumentation.\n(Contributed by Adam Goldschmidt, Senthil Kumaran and Ken Jin in bpo-42967.)", "code_blocks": []}, "notable-changes-in-python-3-9-3": {"text": "Notable changes in Python 3.9.3\n\nA security fix alters the ftplib.FTP behavior to not trust the\nIPv4 address sent from the remote server when setting up a passive data\nchannel.  We reuse the ftp server IP address instead.  For unusual code\nrequiring the old behavior, set a trust_server_pasv_ipv4_address\nattribute on your FTP instance to True.  (See bpo-43285)", "code_blocks": []}, "notable-changes-in-python-3-9-5 - id5": {"text": "urllib.parse\n\nThe presence of newline or tab characters in parts of a URL allows for some\nforms of attacks. Following the WHATWG specification that updates RFC 3986,\nASCII newline \\n, \\r and tab \\t characters are stripped from the\nURL by the parser in urllib.parse preventing such attacks. The removal\ncharacters are controlled by a new module level variable\nurllib.parse._UNSAFE_URL_BYTES_TO_REMOVE. (See bpo-43882)", "code_blocks": []}, "notable-security-feature-in-3-9-14": {"text": "Notable security feature in 3.9.14\n\nConverting between int and str in bases other than 2\n(binary), 4, 8 (octal), 16 (hexadecimal), or 32 such as base 10 (decimal)\nnow raises a ValueError if the number of digits in string form is\nabove a limit to avoid potential denial of service attacks due to the\nalgorithmic complexity. This is a mitigation for CVE-2020-10735.\nThis limit can be configured or disabled by environment variable, command\nline flag, or sys APIs. See the integer string conversion\nlength limitation documentation.  The default limit\nis 4300 digits in string form.", "code_blocks": []}, "notable-changes-in-3-9-17 - tarfile": {"text": "tarfile\n\n\nThe extraction methods in tarfile, and shutil.unpack_archive(),\nhave a new a filter argument that allows limiting tar features than may be\nsurprising or dangerous, such as creating files outside the destination\ndirectory.\nSee Extraction filters for details.\nIn Python 3.12, use without the filter argument will show a\nDeprecationWarning.\nIn Python 3.14, the default will switch to 'data'.\n(Contributed by Petr Viktorin in PEP 706.)", "code_blocks": []}, "notable-changes-in-3-9-20 - id6": {"text": "ipaddress\n\n\nFixed is_global and is_private behavior in IPv4Address,\nIPv6Address, IPv4Network and IPv6Network.", "code_blocks": []}, "notable-changes-in-3-9-20 - email": {"text": "email\n\n\nHeaders with embedded newlines are now quoted on output.\nThe generator will now refuse to serialize (write) headers\nthat are improperly folded or delimited, such that they would be parsed as\nmultiple headers or joined with adjacent data.\nIf you need to turn this safety feature off,\nset verify_generated_headers.\n(Contributed by Bas Bloemsaat and Petr Viktorin in gh-121650.)\n\nemail.utils.getaddresses() and email.utils.parseaddr() now return\n('', '') 2-tuples in more situations where invalid email addresses are\nencountered, instead of potentially inaccurate values.\nAn optional strict parameter was added to these two functions:\nuse strict=False to get the old behavior, accepting malformed inputs.\ngetattr(email.utils, 'supports_strict_parsing', False) can be used to\ncheck if the strict paramater is available.\n(Contributed by Thomas Dwyer and Victor Stinner for gh-102988 to improve\nthe CVE-2023-27043 fix.)", "code_blocks": []}}}
{"index": 12, "python_version": "3.10", "url": "https://docs.python.org/3.10/whatsnew/3.10.html", "sections": {"summary-release-highlights": {"text": "Summary – Release highlights\n\nNew syntax features:\n\nPEP 634, Structural Pattern Matching: Specification\nPEP 635, Structural Pattern Matching: Motivation and Rationale\nPEP 636, Structural Pattern Matching: Tutorial\nbpo-12782, Parenthesized context managers are now officially allowed.\n\nNew features in the standard library:\n\nPEP 618, Add Optional Length-Checking To zip.\n\nInterpreter improvements:\n\nPEP 626, Precise line numbers for debugging and other tools.\n\nNew typing features:\n\nPEP 604, Allow writing union types as X | Y\nPEP 612, Parameter Specification Variables\nPEP 613, Explicit Type Aliases\nPEP 647, User-Defined Type Guards\n\nImportant deprecations, removals or restrictions:\n\nPEP 644, Require OpenSSL 1.1.1 or newer\nPEP 632, Deprecate distutils module.\nPEP 623, Deprecate and prepare for the removal of the wstr member in PyUnicodeObject.\nPEP 624, Remove Py_UNICODE encoder APIs\nPEP 597, Add optional EncodingWarning", "code_blocks": []}, "new-features - parenthesized-context-managers": {"text": "Parenthesized context managers\n\nUsing enclosing parentheses for continuation across multiple lines\nin context managers is now supported. This allows formatting a long\ncollection of context managers in multiple lines in a similar way\nas it was previously possible with import statements. For instance,\nall these examples are now valid:\nwith (CtxManager() as example):\n    ...\n\nwith (\n    CtxManager1(),\n    CtxManager2()\n):\n    ...\n\nwith (CtxManager1() as example,\n      CtxManager2()):\n    ...\n\nwith (CtxManager1(),\n      CtxManager2() as example):\n    ...\n\nwith (\n    CtxManager1() as example1,\n    CtxManager2() as example2\n):\n    ...\n\n\nit is also possible to use a trailing comma at the end of the\nenclosed group:\nwith (\n    CtxManager1() as example1,\n    CtxManager2() as example2,\n    CtxManager3() as example3,\n):\n    ...\n\n\nThis new syntax uses the non LL(1) capacities of the new parser.\nCheck PEP 617 for more details.\n(Contributed by Guido van Rossum, Pablo Galindo and Lysandros Nikolaou\nin bpo-12782 and bpo-40334.)", "code_blocks": ["with (CtxManager() as example):\n    ...\n\nwith (\n    CtxManager1(),\n    CtxManager2()\n):\n    ...\n\nwith (CtxManager1() as example,\n      CtxManager2()):\n    ...\n\nwith (CtxManager1(),\n      CtxManager2() as example):\n    ...\n\nwith (\n    CtxManager1() as example1,\n    CtxManager2() as example2\n):\n    ...\n", "with (\n    CtxManager1() as example1,\n    CtxManager2() as example2,\n    CtxManager3() as example3,\n):\n    ...\n"]}, "new-features - better-error-messages": {"text": "Better error messages\n\n\nSyntaxErrors\n\nWhen parsing code that contains unclosed parentheses or brackets the interpreter\nnow includes the location of the unclosed bracket of parentheses instead of displaying\nSyntaxError: unexpected EOF while parsing or pointing to some incorrect location.\nFor instance, consider the following code (notice the unclosed ‘{‘):\nexpected = {9: 1, 18: 2, 19: 2, 27: 3, 28: 3, 29: 3, 36: 4, 37: 4,\n            38: 4, 39: 4, 45: 5, 46: 5, 47: 5, 48: 5, 49: 5, 54: 6,\nsome_other_code = foo()\n\n\nPrevious versions of the interpreter reported confusing places as the location of\nthe syntax error:\nFile \"example.py\", line 3\n    some_other_code = foo()\n                    ^\nSyntaxError: invalid syntax\n\n\nbut in Python 3.10 a more informative error is emitted:\nFile \"example.py\", line 1\n    expected = {9: 1, 18: 2, 19: 2, 27: 3, 28: 3, 29: 3, 36: 4, 37: 4,\n               ^\nSyntaxError: '{' was never closed\n\n\nIn a similar way, errors involving unclosed string literals (single and triple\nquoted) now point to the start of the string instead of reporting EOF/EOL.\nThese improvements are inspired by previous work in the PyPy interpreter.\n(Contributed by Pablo Galindo in bpo-42864 and Batuhan Taskaya in\nbpo-40176.)\nSyntaxError exceptions raised by the interpreter will now highlight the\nfull error range of the expression that constitutes the syntax error itself,\ninstead of just where the problem is detected. In this way, instead of displaying\n(before Python 3.10):\n>>> foo(x, z for z in range(10), t, w)\n  File \"<stdin>\", line 1\n    foo(x, z for z in range(10), t, w)\n           ^\nSyntaxError: Generator expression must be parenthesized\n\n\nnow Python 3.10 will display the exception as:\n>>> foo(x, z for z in range(10), t, w)\n  File \"<stdin>\", line 1\n    foo(x, z for z in range(10), t, w)\n           ^^^^^^^^^^^^^^^^^^^^\nSyntaxError: Generator expression must be parenthesized\n\n\nThis improvement was contributed by Pablo Galindo in bpo-43914.\nA considerable amount of new specialized messages for SyntaxError exceptions\nhave been incorporated. Some of the most notable ones are as follows:\n\nMissing : before blocks:\n\n>>> if rocket.position > event_horizon\n  File \"<stdin>\", line 1\n    if rocket.position > event_horizon\n                                      ^\nSyntaxError: expected ':'\n\n\n(Contributed by Pablo Galindo in bpo-42997.)\n\n\nUnparenthesised tuples in comprehensions targets:\n\n>>> {x,y for x,y in zip('abcd', '1234')}\n  File \"<stdin>\", line 1\n    {x,y for x,y in zip('abcd', '1234')}\n     ^\nSyntaxError: did you forget parentheses around the comprehension target?\n\n\n(Contributed by Pablo Galindo in bpo-43017.)\n\n\nMissing commas in collection literals and between expressions:\n\n>>> items = {\n... x: 1,\n... y: 2\n... z: 3,\n  File \"<stdin>\", line 3\n    y: 2\n       ^\nSyntaxError: invalid syntax. Perhaps you forgot a comma?\n\n\n(Contributed by Pablo Galindo in bpo-43822.)\n\n\nMultiple Exception types without parentheses:\n\n>>> try:\n...     build_dyson_sphere()\n... except NotEnoughScienceError, NotEnoughResourcesError:\n  File \"<stdin>\", line 3\n    except NotEnoughScienceError, NotEnoughResourcesError:\n           ^\nSyntaxError: multiple exception types must be parenthesized\n\n\n(Contributed by Pablo Galindo in bpo-43149.)\n\n\nMissing : and values in dictionary literals:\n\n>>> values = {\n... x: 1,\n... y: 2,\n... z:\n... }\n  File \"<stdin>\", line 4\n    z:\n     ^\nSyntaxError: expression expected after dictionary key and ':'\n\n>>> values = {x:1, y:2, z w:3}\n  File \"<stdin>\", line 1\n    values = {x:1, y:2, z w:3}\n                        ^\nSyntaxError: ':' expected after dictionary key\n\n\n(Contributed by Pablo Galindo in bpo-43823.)\n\n\ntry blocks without except or finally blocks:\n\n>>> try:\n...     x = 2\n... something = 3\n  File \"<stdin>\", line 3\n    something  = 3\n    ^^^^^^^^^\nSyntaxError: expected 'except' or 'finally' block\n\n\n(Contributed by Pablo Galindo in bpo-44305.)\n\n\nUsage of = instead of == in comparisons:\n\n>>> if rocket.position = event_horizon:\n  File \"<stdin>\", line 1\n    if rocket.position = event_horizon:\n                       ^\nSyntaxError: cannot assign to attribute here. Maybe you meant '==' instead of '='?\n\n\n(Contributed by Pablo Galindo in bpo-43797.)\n\n\nUsage of * in f-strings:\n\n>>> f\"Black holes {*all_black_holes} and revelations\"\n  File \"<stdin>\", line 1\n    (*all_black_holes)\n     ^\nSyntaxError: f-string: cannot use starred expression here\n\n\n(Contributed by Pablo Galindo in bpo-41064.)\n\n\n\n\n\nIndentationErrors\n\nMany IndentationError exceptions now have more context regarding what kind of block\nwas expecting an indentation, including the location of the statement:\n>>> def foo():\n...    if lel:\n...    x = 2\n  File \"<stdin>\", line 3\n    x = 2\n    ^\nIndentationError: expected an indented block after 'if' statement in line 2\n\n\n\n\nAttributeErrors\n\nWhen printing AttributeError, PyErr_Display() will offer\nsuggestions of similar attribute names in the object that the exception was\nraised from:\n>>> collections.namedtoplo\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nAttributeError: module 'collections' has no attribute 'namedtoplo'. Did you mean: namedtuple?\n\n\n(Contributed by Pablo Galindo in bpo-38530.)\n\n\nWarning\nNotice this won’t work if PyErr_Display() is not called to display the error\nwhich can happen if some other custom error display function is used. This is a common\nscenario in some REPLs like IPython.\n\n\n\n\nNameErrors\n\nWhen printing NameError raised by the interpreter, PyErr_Display()\nwill offer suggestions of similar variable names in the function that the exception\nwas raised from:\n>>> schwarzschild_black_hole = None\n>>> schwarschild_black_hole\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nNameError: name 'schwarschild_black_hole' is not defined. Did you mean: schwarzschild_black_hole?\n\n\n(Contributed by Pablo Galindo in bpo-38530.)\n\n\nWarning\nNotice this won’t work if PyErr_Display() is not called to display the error,\nwhich can happen if some other custom error display function is used. This is a common\nscenario in some REPLs like IPython.", "code_blocks": ["expected = {9: 1, 18: 2, 19: 2, 27: 3, 28: 3, 29: 3, 36: 4, 37: 4,\n            38: 4, 39: 4, 45: 5, 46: 5, 47: 5, 48: 5, 49: 5, 54: 6,\nsome_other_code = foo()\n", "File \"example.py\", line 3\n    some_other_code = foo()\n                    ^\nSyntaxError: invalid syntax\n", "File \"example.py\", line 1\n    expected = {9: 1, 18: 2, 19: 2, 27: 3, 28: 3, 29: 3, 36: 4, 37: 4,\n               ^\nSyntaxError: '{' was never closed\n", ">>> foo(x, z for z in range(10), t, w)\n  File \"<stdin>\", line 1\n    foo(x, z for z in range(10), t, w)\n           ^\nSyntaxError: Generator expression must be parenthesized\n", ">>> foo(x, z for z in range(10), t, w)\n  File \"<stdin>\", line 1\n    foo(x, z for z in range(10), t, w)\n           ^^^^^^^^^^^^^^^^^^^^\nSyntaxError: Generator expression must be parenthesized\n", ">>> if rocket.position > event_horizon\n  File \"<stdin>\", line 1\n    if rocket.position > event_horizon\n                                      ^\nSyntaxError: expected ':'\n", ">>> {x,y for x,y in zip('abcd', '1234')}\n  File \"<stdin>\", line 1\n    {x,y for x,y in zip('abcd', '1234')}\n     ^\nSyntaxError: did you forget parentheses around the comprehension target?\n", ">>> items = {\n... x: 1,\n... y: 2\n... z: 3,\n  File \"<stdin>\", line 3\n    y: 2\n       ^\nSyntaxError: invalid syntax. Perhaps you forgot a comma?\n", ">>> try:\n...     build_dyson_sphere()\n... except NotEnoughScienceError, NotEnoughResourcesError:\n  File \"<stdin>\", line 3\n    except NotEnoughScienceError, NotEnoughResourcesError:\n           ^\nSyntaxError: multiple exception types must be parenthesized\n", ">>> values = {\n... x: 1,\n... y: 2,\n... z:\n... }\n  File \"<stdin>\", line 4\n    z:\n     ^\nSyntaxError: expression expected after dictionary key and ':'\n\n>>> values = {x:1, y:2, z w:3}\n  File \"<stdin>\", line 1\n    values = {x:1, y:2, z w:3}\n                        ^\nSyntaxError: ':' expected after dictionary key\n", ">>> try:\n...     x = 2\n... something = 3\n  File \"<stdin>\", line 3\n    something  = 3\n    ^^^^^^^^^\nSyntaxError: expected 'except' or 'finally' block\n", ">>> if rocket.position = event_horizon:\n  File \"<stdin>\", line 1\n    if rocket.position = event_horizon:\n                       ^\nSyntaxError: cannot assign to attribute here. Maybe you meant '==' instead of '='?\n", ">>> f\"Black holes {*all_black_holes} and revelations\"\n  File \"<stdin>\", line 1\n    (*all_black_holes)\n     ^\nSyntaxError: f-string: cannot use starred expression here\n", ">>> def foo():\n...    if lel:\n...    x = 2\n  File \"<stdin>\", line 3\n    x = 2\n    ^\nIndentationError: expected an indented block after 'if' statement in line 2\n", ">>> collections.namedtoplo\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nAttributeError: module 'collections' has no attribute 'namedtoplo'. Did you mean: namedtuple?\n", ">>> schwarzschild_black_hole = None\n>>> schwarschild_black_hole\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nNameError: name 'schwarschild_black_hole' is not defined. Did you mean: schwarzschild_black_hole?\n"]}, "new-features - pep-626-precise-line-numbers-for-debugging-and-other-tools": {"text": "PEP 626: Precise line numbers for debugging and other tools\n\nPEP 626 brings more precise and reliable line numbers for debugging, profiling and coverage tools.\nTracing events, with the correct line number, are generated for all lines of code executed and only for lines of code that are executed.\nThe f_lineno attribute of frame objects will always contain the expected line number.\nThe co_lnotab attribute of code objects is deprecated and will be removed in 3.12.\nCode that needs to convert from offset to line number should use the new co_lines() method instead.", "code_blocks": []}, "new-features - pep-634-structural-pattern-matching": {"text": "PEP 634: Structural Pattern Matching\n\nStructural pattern matching has been added in the form of a match statement\nand case statements of patterns with associated actions. Patterns\nconsist of sequences, mappings, primitive data types as well as class instances.\nPattern matching enables programs to extract information from complex data types,\nbranch on the structure of data, and apply specific actions based on different\nforms of data.\n\nSyntax and operations\n\nThe generic syntax of pattern matching is:\nmatch subject:\n    case <pattern_1>:\n        <action_1>\n    case <pattern_2>:\n        <action_2>\n    case <pattern_3>:\n        <action_3>\n    case _:\n        <action_wildcard>\n\n\nA match statement takes an expression and compares its value to successive\npatterns given as one or more case blocks.  Specifically, pattern matching\noperates by:\n\n\nusing data with type and shape (the subject)\nevaluating the subject in the match statement\ncomparing the subject with each pattern in a case statement\nfrom top to bottom until a match is confirmed.\nexecuting the action associated with the pattern of the confirmed\nmatch\nIf an exact match is not confirmed, the last case, a wildcard _,\nif provided, will be used as the matching case. If an exact match is\nnot confirmed and a wildcard case does not exist, the entire match\nblock is a no-op.\n\n\n\n\nDeclarative approach\n\nReaders may be aware of pattern matching through the simple example of matching\na subject (data object) to a literal (pattern) with the switch statement found\nin C, Java or JavaScript (and many other languages). Often the switch statement\nis used for comparison of an object/expression with case statements containing\nliterals.\nMore powerful examples of pattern matching can be found in languages such as\nScala and Elixir. With structural pattern matching, the approach is “declarative” and\nexplicitly states the conditions (the patterns) for data to match.\nWhile an “imperative” series of instructions using nested “if” statements\ncould be used to accomplish something similar to structural pattern matching,\nit is less clear than the “declarative” approach. Instead the “declarative”\napproach states the conditions to meet for a match and is more readable through\nits explicit patterns. While structural pattern matching can be used in its\nsimplest form comparing a variable to a literal in a case statement, its\ntrue value for Python lies in its handling of the subject’s type and shape.\n\n\nSimple pattern: match to a literal\n\nLet’s look at this example as pattern matching in its simplest form: a value,\nthe subject, being matched to several literals, the patterns. In the example\nbelow, status is the subject of the match statement. The patterns are\neach of the case statements, where literals represent request status codes.\nThe associated action to the case is executed after a match:\ndef http_error(status):\n    match status:\n        case 400:\n            return \"Bad request\"\n        case 404:\n            return \"Not found\"\n        case 418:\n            return \"I'm a teapot\"\n        case _:\n            return \"Something's wrong with the internet\"\n\n\nIf the above function is passed a status of 418, “I’m a teapot” is returned.\nIf the above function is passed a status of 500, the case statement with\n_ will match as a wildcard, and “Something’s wrong with the internet” is\nreturned.\nNote the last block: the variable name, _, acts as a wildcard and insures\nthe subject will always match. The use of _ is optional.\nYou can combine several literals in a single pattern using | (“or”):\ncase 401 | 403 | 404:\n    return \"Not allowed\"\n\n\n\nBehavior without the wildcard\n\nIf we modify the above example by removing the last case block, the example\nbecomes:\ndef http_error(status):\n    match status:\n        case 400:\n            return \"Bad request\"\n        case 404:\n            return \"Not found\"\n        case 418:\n            return \"I'm a teapot\"\n\n\nWithout the use of _ in a case statement, a match may not exist. If no\nmatch exists, the behavior is a no-op. For example, if status of 500 is\npassed, a no-op occurs.\n\n\n\nPatterns with a literal and variable\n\nPatterns can look like unpacking assignments, and a pattern may be used to bind\nvariables. In this example, a data point can be unpacked to its x-coordinate\nand y-coordinate:\n# point is an (x, y) tuple\nmatch point:\n    case (0, 0):\n        print(\"Origin\")\n    case (0, y):\n        print(f\"Y={y}\")\n    case (x, 0):\n        print(f\"X={x}\")\n    case (x, y):\n        print(f\"X={x}, Y={y}\")\n    case _:\n        raise ValueError(\"Not a point\")\n\n\nThe first pattern has two literals, (0, 0), and may be thought of as an\nextension of the literal pattern shown above. The next two patterns combine a\nliteral and a variable, and the variable binds a value from the subject\n(point).  The fourth pattern captures two values, which makes it\nconceptually similar to the unpacking assignment (x, y) = point.\n\n\nPatterns and classes\n\nIf you are using classes to structure your data, you can use as a pattern\nthe class name followed by an argument list resembling a constructor. This\npattern has the ability to capture class attributes into variables:\nclass Point:\n    x: int\n    y: int\n\ndef location(point):\n    match point:\n        case Point(x=0, y=0):\n            print(\"Origin is the point's location.\")\n        case Point(x=0, y=y):\n            print(f\"Y={y} and the point is on the y-axis.\")\n        case Point(x=x, y=0):\n            print(f\"X={x} and the point is on the x-axis.\")\n        case Point():\n            print(\"The point is located somewhere else on the plane.\")\n        case _:\n            print(\"Not a point\")\n\n\n\nPatterns with positional parameters\n\nYou can use positional parameters with some builtin classes that provide an\nordering for their attributes (e.g. dataclasses). You can also define a specific\nposition for attributes in patterns by setting the __match_args__ special\nattribute in your classes. If it’s set to (“x”, “y”), the following patterns\nare all equivalent (and all bind the y attribute to the var variable):\nPoint(1, var)\nPoint(1, y=var)\nPoint(x=1, y=var)\nPoint(y=var, x=1)\n\n\n\n\n\nNested patterns\n\nPatterns can be arbitrarily nested.  For example, if our data is a short\nlist of points, it could be matched like this:\nmatch points:\n    case []:\n        print(\"No points in the list.\")\n    case [Point(0, 0)]:\n        print(\"The origin is the only point in the list.\")\n    case [Point(x, y)]:\n        print(f\"A single point {x}, {y} is in the list.\")\n    case [Point(0, y1), Point(0, y2)]:\n        print(f\"Two points on the Y axis at {y1}, {y2} are in the list.\")\n    case _:\n        print(\"Something else is found in the list.\")\n\n\n\n\nComplex patterns and the wildcard\n\nTo this point, the examples have used _ alone in the last case statement.\nA wildcard can be used in more complex patterns, such as ('error', code, _).\nFor example:\nmatch test_variable:\n    case ('warning', code, 40):\n        print(\"A warning has been received.\")\n    case ('error', code, _):\n        print(f\"An error {code} occurred.\")\n\n\nIn the above case, test_variable will match for (‘error’, code, 100) and\n(‘error’, code, 800).\n\n\nGuard\n\nWe can add an if clause to a pattern, known as a “guard”.  If the\nguard is false, match goes on to try the next case block.  Note\nthat value capture happens before the guard is evaluated:\nmatch point:\n    case Point(x, y) if x == y:\n        print(f\"The point is located on the diagonal Y=X at {x}.\")\n    case Point(x, y):\n        print(f\"Point is not on the diagonal.\")\n\n\n\n\nOther Key Features\n\nSeveral other key features:\n\nLike unpacking assignments, tuple and list patterns have exactly the\nsame meaning and actually match arbitrary sequences. Technically,\nthe subject must be a sequence.\nTherefore, an important exception is that patterns don’t match iterators.\nAlso, to prevent a common mistake, sequence patterns don’t match strings.\nSequence patterns support wildcards: [x, y, *rest] and (x, y,\n*rest) work similar to wildcards in unpacking assignments.  The\nname after * may also be _, so (x, y, *_) matches a sequence\nof at least two items without binding the remaining items.\nMapping patterns: {\"bandwidth\": b, \"latency\": l} captures the\n\"bandwidth\" and \"latency\" values from a dict.  Unlike sequence\npatterns, extra keys are ignored.  A wildcard **rest is also\nsupported.  (But **_ would be redundant, so is not allowed.)\nSubpatterns may be captured using the as keyword:\ncase (Point(x1, y1), Point(x2, y2) as p2): ...\n\n\nThis binds x1, y1, x2, y2 like you would expect without the as clause,\nand p2 to the entire second item of the subject.\n\nMost literals are compared by equality. However, the singletons True,\nFalse and None are compared by identity.\nNamed constants may be used in patterns.  These named constants must be\ndotted names to prevent the constant from being interpreted as a capture\nvariable:\nfrom enum import Enum\nclass Color(Enum):\n    RED = 0\n    GREEN = 1\n    BLUE = 2\n\nmatch color:\n    case Color.RED:\n        print(\"I see red!\")\n    case Color.GREEN:\n        print(\"Grass is green\")\n    case Color.BLUE:\n        print(\"I'm feeling the blues :(\")\n\n\n\n\nFor the full specification see PEP 634.  Motivation and rationale\nare in PEP 635, and a longer tutorial is in PEP 636.", "code_blocks": ["match subject:\n    case <pattern_1>:\n        <action_1>\n    case <pattern_2>:\n        <action_2>\n    case <pattern_3>:\n        <action_3>\n    case _:\n        <action_wildcard>\n", "def http_error(status):\n    match status:\n        case 400:\n            return \"Bad request\"\n        case 404:\n            return \"Not found\"\n        case 418:\n            return \"I'm a teapot\"\n        case _:\n            return \"Something's wrong with the internet\"\n", "case 401 | 403 | 404:\n    return \"Not allowed\"\n", "def http_error(status):\n    match status:\n        case 400:\n            return \"Bad request\"\n        case 404:\n            return \"Not found\"\n        case 418:\n            return \"I'm a teapot\"\n", "# point is an (x, y) tuple\nmatch point:\n    case (0, 0):\n        print(\"Origin\")\n    case (0, y):\n        print(f\"Y={y}\")\n    case (x, 0):\n        print(f\"X={x}\")\n    case (x, y):\n        print(f\"X={x}, Y={y}\")\n    case _:\n        raise ValueError(\"Not a point\")\n", "class Point:\n    x: int\n    y: int\n\ndef location(point):\n    match point:\n        case Point(x=0, y=0):\n            print(\"Origin is the point's location.\")\n        case Point(x=0, y=y):\n            print(f\"Y={y} and the point is on the y-axis.\")\n        case Point(x=x, y=0):\n            print(f\"X={x} and the point is on the x-axis.\")\n        case Point():\n            print(\"The point is located somewhere else on the plane.\")\n        case _:\n            print(\"Not a point\")\n", "Point(1, var)\nPoint(1, y=var)\nPoint(x=1, y=var)\nPoint(y=var, x=1)\n", "match points:\n    case []:\n        print(\"No points in the list.\")\n    case [Point(0, 0)]:\n        print(\"The origin is the only point in the list.\")\n    case [Point(x, y)]:\n        print(f\"A single point {x}, {y} is in the list.\")\n    case [Point(0, y1), Point(0, y2)]:\n        print(f\"Two points on the Y axis at {y1}, {y2} are in the list.\")\n    case _:\n        print(\"Something else is found in the list.\")\n", "match test_variable:\n    case ('warning', code, 40):\n        print(\"A warning has been received.\")\n    case ('error', code, _):\n        print(f\"An error {code} occurred.\")\n", "match point:\n    case Point(x, y) if x == y:\n        print(f\"The point is located on the diagonal Y=X at {x}.\")\n    case Point(x, y):\n        print(f\"Point is not on the diagonal.\")\n", "case (Point(x1, y1), Point(x2, y2) as p2): ...\n", "from enum import Enum\nclass Color(Enum):\n    RED = 0\n    GREEN = 1\n    BLUE = 2\n\nmatch color:\n    case Color.RED:\n        print(\"I see red!\")\n    case Color.GREEN:\n        print(\"Grass is green\")\n    case Color.BLUE:\n        print(\"I'm feeling the blues :(\")\n"]}, "new-features - optional-encodingwarning-and-encoding-locale-option": {"text": "Optional EncodingWarning and encoding=\"locale\" option\n\nThe default encoding of TextIOWrapper and open() is\nplatform and locale dependent. Since UTF-8 is used on most Unix\nplatforms, omitting encoding option when opening UTF-8 files\n(e.g. JSON, YAML, TOML, Markdown) is a very common bug. For example:\n# BUG: \"rb\" mode or encoding=\"utf-8\" should be used.\nwith open(\"data.json\") as f:\n    data = json.load(f)\n\n\nTo find this type of bug, an optional EncodingWarning is added.\nIt is emitted when sys.flags.warn_default_encoding\nis true and locale-specific default encoding is used.\n-X warn_default_encoding option and PYTHONWARNDEFAULTENCODING\nare added to enable the warning.\nSee Text Encoding for more information.", "code_blocks": ["# BUG: \"rb\" mode or encoding=\"utf-8\" should be used.\nwith open(\"data.json\") as f:\n    data = json.load(f)\n"]}, "new-features-related-to-type-hints - pep-604-new-type-union-operator": {"text": "PEP 604: New Type Union Operator\n\nA new type union operator was introduced which enables the syntax X | Y.\nThis provides a cleaner way of expressing ‘either type X or type Y’ instead of\nusing typing.Union, especially in type hints.\nIn previous versions of Python, to apply a type hint for functions accepting\narguments of multiple types, typing.Union was used:\ndef square(number: Union[int, float]) -> Union[int, float]:\n    return number ** 2\n\n\nType hints can now be written in a more succinct manner:\ndef square(number: int | float) -> int | float:\n    return number ** 2\n\n\nThis new syntax is also accepted as the second argument to isinstance()\nand issubclass():\n>>> isinstance(1, int | str)\nTrue\n\n\nSee Union Type and PEP 604 for more details.\n(Contributed by Maggie Moss and Philippe Prados in bpo-41428,\nwith additions by Yurii Karabas and Serhiy Storchaka in bpo-44490.)", "code_blocks": ["def square(number: Union[int, float]) -> Union[int, float]:\n    return number ** 2\n", "def square(number: int | float) -> int | float:\n    return number ** 2\n", ">>> isinstance(1, int | str)\nTrue\n"]}, "new-features-related-to-type-hints - pep-612-parameter-specification-variables": {"text": "PEP 612: Parameter Specification Variables\n\nTwo new options to improve the information provided to static type checkers for\nPEP 484‘s Callable have been added to the typing module.\nThe first is the parameter specification variable.  They are used to forward the\nparameter types of one callable to another callable – a pattern commonly\nfound in higher order functions and decorators.  Examples of usage can be found\nin typing.ParamSpec. Previously, there was no easy way to type annotate\ndependency of parameter types in such a precise manner.\nThe second option is the new Concatenate operator. It’s used in conjunction\nwith parameter specification variables to type annotate a higher order callable\nwhich adds or removes parameters of another callable.  Examples of usage can\nbe found in typing.Concatenate.\nSee typing.Callable, typing.ParamSpec,\ntyping.Concatenate, typing.ParamSpecArgs,\ntyping.ParamSpecKwargs, and PEP 612 for more details.\n(Contributed by Ken Jin in bpo-41559, with minor enhancements by Jelle\nZijlstra in bpo-43783.  PEP written by Mark Mendoza.)", "code_blocks": []}, "new-features-related-to-type-hints - pep-613-typealias": {"text": "PEP 613: TypeAlias\n\nPEP 484 introduced the concept of type aliases, only requiring them to be\ntop-level unannotated assignments. This simplicity sometimes made it difficult\nfor type checkers to distinguish between type aliases and ordinary assignments,\nespecially when forward references or invalid types were involved. Compare:\nStrCache = 'Cache[str]'  # a type alias\nLOG_PREFIX = 'LOG[DEBUG]'  # a module constant\n\n\nNow the typing module has a special value TypeAlias\nwhich lets you declare type aliases more explicitly:\nStrCache: TypeAlias = 'Cache[str]'  # a type alias\nLOG_PREFIX = 'LOG[DEBUG]'  # a module constant\n\n\nSee PEP 613 for more details.\n(Contributed by Mikhail Golubev in bpo-41923.)", "code_blocks": ["StrCache = 'Cache[str]'  # a type alias\nLOG_PREFIX = 'LOG[DEBUG]'  # a module constant\n", "StrCache: TypeAlias = 'Cache[str]'  # a type alias\nLOG_PREFIX = 'LOG[DEBUG]'  # a module constant\n"]}, "new-features-related-to-type-hints - pep-647-user-defined-type-guards": {"text": "PEP 647: User-Defined Type Guards\n\nTypeGuard has been added to the typing module to annotate\ntype guard functions and improve information provided to static type checkers\nduring type narrowing.  For more information, please see TypeGuard‘s\ndocumentation, and PEP 647.\n(Contributed by Ken Jin and Guido van Rossum in bpo-43766.\nPEP written by Eric Traut.)", "code_blocks": []}, "other-language-changes": {"text": "Other Language Changes\n\n\nThe int type has a new method int.bit_count(), returning the\nnumber of ones in the binary expansion of a given integer, also known\nas the population count. (Contributed by Niklas Fiekas in bpo-29882.)\nThe views returned by dict.keys(), dict.values() and\ndict.items() now all have a mapping attribute that gives a\ntypes.MappingProxyType object wrapping the original\ndictionary. (Contributed by Dennis Sweeney in bpo-40890.)\nPEP 618: The zip() function now has an optional strict flag, used\nto require that all the iterables have an equal length.\nBuiltin and extension functions that take integer arguments no longer accept\nDecimals, Fractions and other\nobjects that can be converted to integers only with a loss (e.g. that have\nthe __int__() method but do not have the\n__index__() method).\n(Contributed by Serhiy Storchaka in bpo-37999.)\nIf object.__ipow__() returns NotImplemented, the operator will\ncorrectly fall back to object.__pow__() and object.__rpow__() as expected.\n(Contributed by Alex Shkop in bpo-38302.)\nAssignment expressions can now be used unparenthesized within set literals\nand set comprehensions, as well as in sequence indexes (but not slices).\nFunctions have a new __builtins__ attribute which is used to look for\nbuiltin symbols when a function is executed, instead of looking into\n__globals__['__builtins__']. The attribute is initialized from\n__globals__[\"__builtins__\"] if it exists, else from the current builtins.\n(Contributed by Mark Shannon in bpo-42990.)\nTwo new builtin functions – aiter() and anext() have been added\nto provide asynchronous counterparts to iter() and next(),\nrespectively.\n(Contributed by Joshua Bronson, Daniel Pope, and Justin Wang in bpo-31861.)\nStatic methods (@staticmethod) and class methods\n(@classmethod) now inherit the method attributes\n(__module__, __name__, __qualname__, __doc__,\n__annotations__) and have a new __wrapped__ attribute.\nMoreover, static methods are now callable as regular functions.\n(Contributed by Victor Stinner in bpo-43682.)\nAnnotations for complex targets (everything beside simple name targets\ndefined by PEP 526) no longer cause any runtime effects with from __future__ import annotations.\n(Contributed by Batuhan Taskaya in bpo-42737.)\nClass and module objects now lazy-create empty annotations dicts on demand.\nThe annotations dicts are stored in the object’s __dict__ for\nbackwards compatibility.  This improves the best practices for working\nwith __annotations__; for more information, please see\nAnnotations Best Practices.\n(Contributed by Larry Hastings in bpo-43901.)\nAnnotations consist of yield, yield from, await or named expressions\nare now forbidden under from __future__ import annotations due to their side\neffects.\n(Contributed by Batuhan Taskaya in bpo-42725.)\nUsage of unbound variables, super() and other expressions that might\nalter the processing of symbol table as annotations are now rendered\neffectless under from __future__ import annotations.\n(Contributed by Batuhan Taskaya in bpo-42725.)\nHashes of NaN values of both float type and\ndecimal.Decimal type now depend on object identity. Formerly, they\nalways hashed to 0 even though NaN values are not equal to one another.\nThis caused potentially quadratic runtime behavior due to excessive hash\ncollisions when creating dictionaries and sets containing multiple NaNs.\n(Contributed by Raymond Hettinger in bpo-43475.)\nA SyntaxError (instead of a NameError) will be raised when deleting\nthe __debug__ constant.  (Contributed by Dong-hee Na in bpo-45000.)\nSyntaxError exceptions now have end_lineno and\nend_offset attributes.  They will be None if not determined.\n(Contributed by Pablo Galindo in bpo-43914.)", "code_blocks": []}, "new-modules": {"text": "New Modules\n\n\nNone yet.", "code_blocks": []}, "improved-modules - asyncio": {"text": "asyncio\n\nAdd missing connect_accepted_socket()\nmethod.\n(Contributed by Alex Grönholm in bpo-41332.)", "code_blocks": []}, "improved-modules - argparse": {"text": "argparse\n\nMisleading phrase “optional arguments” was replaced with “options” in argparse help. Some tests might require adaptation if they rely on exact output match.\n(Contributed by Raymond Hettinger in bpo-9694.)", "code_blocks": []}, "improved-modules - array": {"text": "array\n\nThe index() method of array.array now has\noptional start and stop parameters.\n(Contributed by Anders Lorentsen and Zackery Spytz in bpo-31956.)", "code_blocks": []}, "improved-modules - asynchat-asyncore-smtpd": {"text": "asynchat, asyncore, smtpd\n\nThese modules have been marked as deprecated in their module documentation\nsince Python 3.6.  An import-time DeprecationWarning has now been\nadded to all three of these modules.", "code_blocks": []}, "improved-modules - base64": {"text": "base64\n\nAdd base64.b32hexencode() and base64.b32hexdecode() to support the\nBase32 Encoding with Extended Hex Alphabet.", "code_blocks": []}, "improved-modules - bdb": {"text": "bdb\n\nAdd clearBreakpoints() to reset all set breakpoints.\n(Contributed by Irit Katriel in bpo-24160.)", "code_blocks": []}, "improved-modules - bisect": {"text": "bisect\n\nAdded the possibility of providing a key function to the APIs in the bisect\nmodule. (Contributed by Raymond Hettinger in bpo-4356.)", "code_blocks": []}, "improved-modules - codecs": {"text": "codecs\n\nAdd a codecs.unregister() function to unregister a codec search function.\n(Contributed by Hai Shi in bpo-41842.)", "code_blocks": []}, "improved-modules - collections-abc": {"text": "collections.abc\n\nThe __args__ of the parameterized generic for\ncollections.abc.Callable are now consistent with typing.Callable.\ncollections.abc.Callable generic now flattens type parameters, similar\nto what typing.Callable currently does.  This means that\ncollections.abc.Callable[[int, str], str] will have __args__ of\n(int, str, str); previously this was ([int, str], str).  To allow this\nchange, types.GenericAlias can now be subclassed, and a subclass will\nbe returned when subscripting the collections.abc.Callable type.  Note\nthat a TypeError may be raised for invalid forms of parameterizing\ncollections.abc.Callable which may have passed silently in Python 3.9.\n(Contributed by Ken Jin in bpo-42195.)", "code_blocks": []}, "improved-modules - contextlib": {"text": "contextlib\n\nAdd a contextlib.aclosing() context manager to safely close async generators\nand objects representing asynchronously released resources.\n(Contributed by Joongi Kim and John Belmonte in bpo-41229.)\nAdd asynchronous context manager support to contextlib.nullcontext().\n(Contributed by Tom Gringauz in bpo-41543.)\nAdd AsyncContextDecorator, for supporting usage of async context managers\nas decorators.", "code_blocks": []}, "improved-modules - curses": {"text": "curses\n\nThe extended color functions added in ncurses 6.1 will be used transparently\nby curses.color_content(), curses.init_color(),\ncurses.init_pair(), and curses.pair_content(). A new function,\ncurses.has_extended_color_support(), indicates whether extended color\nsupport is provided by the underlying ncurses library.\n(Contributed by Jeffrey Kintscher and Hans Petter Jansson in bpo-36982.)\nThe BUTTON5_* constants are now exposed in the curses module if\nthey are provided by the underlying curses library.\n(Contributed by Zackery Spytz in bpo-39273.)", "code_blocks": []}, "improved-modules - dataclasses": {"text": "dataclasses\n\n\n__slots__\n\nAdded slots parameter in dataclasses.dataclass() decorator.\n(Contributed by Yurii Karabas in bpo-42269)\n\n\nKeyword-only fields\n\ndataclasses now supports fields that are keyword-only in the\ngenerated __init__ method.  There are a number of ways of specifying\nkeyword-only fields.\nYou can say that every field is keyword-only:\nfrom dataclasses import dataclass\n\n@dataclass(kw_only=True)\nclass Birthday:\n    name: str\n    birthday: datetime.date\n\n\nBoth name and birthday are keyword-only parameters to the\ngenerated __init__ method.\nYou can specify keyword-only on a per-field basis:\nfrom dataclasses import dataclass\n\n@dataclass\nclass Birthday:\n    name: str\n    birthday: datetime.date = field(kw_only=True)\n\n\nHere only birthday is keyword-only.  If you set kw_only on\nindividual fields, be aware that there are rules about re-ordering\nfields due to keyword-only fields needing to follow non-keyword-only\nfields.  See the full dataclasses documentation for details.\nYou can also specify that all fields following a KW_ONLY marker are\nkeyword-only.  This will probably be the most common usage:\nfrom dataclasses import dataclass, KW_ONLY\n\n@dataclass\nclass Point:\n    x: float\n    y: float\n    _: KW_ONLY\n    z: float = 0.0\n    t: float = 0.0\n\n\nHere, z and t are keyword-only parameters, while x and\ny are not.\n(Contributed by Eric V. Smith in bpo-43532.)", "code_blocks": ["from dataclasses import dataclass\n\n@dataclass(kw_only=True)\nclass Birthday:\n    name: str\n    birthday: datetime.date\n", "from dataclasses import dataclass\n\n@dataclass\nclass Birthday:\n    name: str\n    birthday: datetime.date = field(kw_only=True)\n", "from dataclasses import dataclass, KW_ONLY\n\n@dataclass\nclass Point:\n    x: float\n    y: float\n    _: KW_ONLY\n    z: float = 0.0\n    t: float = 0.0\n"]}, "improved-modules - distutils": {"text": "distutils\n\nThe entire distutils package is deprecated, to be removed in Python\n3.12. Its functionality for specifying package builds has already been\ncompletely replaced by third-party packages setuptools and\npackaging, and most other commonly used APIs are available elsewhere\nin the standard library (such as platform, shutil,\nsubprocess or sysconfig). There are no plans to migrate\nany other functionality from distutils, and applications that are\nusing other functions should plan to make private copies of the code.\nRefer to PEP 632 for discussion.\nThe bdist_wininst command deprecated in Python 3.8 has been removed.\nThe bdist_wheel command is now recommended to distribute binary packages\non Windows.\n(Contributed by Victor Stinner in bpo-42802.)", "code_blocks": []}, "improved-modules - doctest": {"text": "doctest\n\nWhen a module does not define __loader__, fall back to __spec__.loader.\n(Contributed by Brett Cannon in bpo-42133.)", "code_blocks": []}, "improved-modules - encodings": {"text": "encodings\n\nencodings.normalize_encoding() now ignores non-ASCII characters.\n(Contributed by Hai Shi in bpo-39337.)", "code_blocks": []}, "improved-modules - fileinput": {"text": "fileinput\n\nAdd encoding and errors parameters in fileinput.input() and\nfileinput.FileInput.\n(Contributed by Inada Naoki in bpo-43712.)\nfileinput.hook_compressed() now returns TextIOWrapper object\nwhen mode is “r” and file is compressed, like uncompressed files.\n(Contributed by Inada Naoki in bpo-5758.)", "code_blocks": []}, "improved-modules - faulthandler": {"text": "faulthandler\n\nThe faulthandler module now detects if a fatal error occurs during a\ngarbage collector collection.\n(Contributed by Victor Stinner in bpo-44466.)", "code_blocks": []}, "improved-modules - gc": {"text": "gc\n\nAdd audit hooks for gc.get_objects(), gc.get_referrers() and\ngc.get_referents(). (Contributed by Pablo Galindo in bpo-43439.)", "code_blocks": []}, "improved-modules - glob": {"text": "glob\n\nAdd the root_dir and dir_fd parameters in glob() and\niglob() which allow to specify the root directory for searching.\n(Contributed by Serhiy Storchaka in bpo-38144.)", "code_blocks": []}, "improved-modules - hashlib": {"text": "hashlib\n\nThe hashlib module requires OpenSSL 1.1.1 or newer.\n(Contributed by Christian Heimes in PEP 644 and bpo-43669.)\nThe hashlib module has preliminary support for OpenSSL 3.0.0.\n(Contributed by Christian Heimes in bpo-38820 and other issues.)\nThe pure-Python fallback of pbkdf2_hmac() is deprecated. In\nthe future PBKDF2-HMAC will only be available when Python has been built with\nOpenSSL support.\n(Contributed by Christian Heimes in bpo-43880.)", "code_blocks": []}, "improved-modules - hmac": {"text": "hmac\n\nThe hmac module now uses OpenSSL’s HMAC implementation internally.\n(Contributed by Christian Heimes in bpo-40645.)", "code_blocks": []}, "improved-modules - idle-and-idlelib": {"text": "IDLE and idlelib\n\nMake IDLE invoke sys.excepthook() (when started without ‘-n’).\nUser hooks were previously ignored.  (Contributed by Ken Hilton in\nbpo-43008.)\nRearrange the settings dialog.  Split the General tab into Windows\nand Shell/Ed tabs.  Move help sources, which extend the Help menu, to the\nExtensions tab.  Make space for new options and shorten the dialog. The\nlatter makes the dialog better fit small screens.  (Contributed by Terry Jan\nReedy in bpo-40468.)  Move the indent space setting from the Font tab to\nthe new Windows tab.  (Contributed by Mark Roseman and Terry Jan Reedy in\nbpo-33962.)\nThe changes above were backported to a 3.9 maintenance release.\nAdd a Shell sidebar.  Move the primary prompt (‘>>>’) to the sidebar.\nAdd secondary prompts (’…’) to the sidebar.  Left click and optional\ndrag selects one or more lines of text, as with the editor\nline number sidebar.  Right click after selecting text lines displays\na context menu with ‘copy with prompts’.  This zips together prompts\nfrom the sidebar with lines from the selected text.  This option also\nappears on the context menu for the text.  (Contributed by Tal Einat\nin bpo-37903.)\nUse spaces instead of tabs to indent interactive code.  This makes\ninteractive code entries ‘look right’.  Making this feasible was a\nmajor motivation for adding the shell sidebar.  (Contributed by\nTerry Jan Reedy in bpo-37892.)\nHighlight the new soft keywords match,\ncase, and _ in\npattern-matching statements. However, this highlighting is not perfect\nand will be incorrect in some rare cases, including some _-s in\ncase patterns.  (Contributed by Tal Einat in bpo-44010.)\nNew in 3.10 maintenance releases.\nApply syntax highlighting to .pyi files. (Contributed by Alex\nWaygood and Terry Jan Reedy in bpo-45447.)\nInclude prompts when saving Shell with inputs and outputs.\n(Contributed by Terry Jan Reedy in gh-95191.)", "code_blocks": []}, "improved-modules - importlib-metadata": {"text": "importlib.metadata\n\nFeature parity with importlib_metadata 4.6\n(history).\nimportlib.metadata entry points\nnow provide a nicer experience\nfor selecting entry points by group and name through a new\nimportlib.metadata.EntryPoints class. See the Compatibility\nNote in the docs for more info on the deprecation and usage.\nAdded importlib.metadata.packages_distributions() for resolving\ntop-level Python modules and packages to their\nimportlib.metadata.Distribution.", "code_blocks": []}, "improved-modules - inspect": {"text": "inspect\n\nWhen a module does not define __loader__, fall back to __spec__.loader.\n(Contributed by Brett Cannon in bpo-42133.)\nAdd inspect.get_annotations(), which safely computes the annotations\ndefined on an object. It works around the quirks of accessing the annotations\non various types of objects, and makes very few assumptions about the object\nit examines. inspect.get_annotations() can also correctly un-stringize\nstringized annotations.  inspect.get_annotations() is now considered\nbest practice for accessing the annotations dict defined on any Python object;\nfor more information on best practices for working with annotations, please see\nAnnotations Best Practices.\nRelatedly, inspect.signature(),\ninspect.Signature.from_callable(), and inspect.Signature.from_function()\nnow call inspect.get_annotations() to retrieve annotations. This means\ninspect.signature() and inspect.Signature.from_callable() can\nalso now un-stringize stringized annotations.\n(Contributed by Larry Hastings in bpo-43817.)", "code_blocks": []}, "improved-modules - itertools": {"text": "itertools\n\nAdd itertools.pairwise().\n(Contributed by Raymond Hettinger in bpo-38200.)", "code_blocks": []}, "improved-modules - linecache": {"text": "linecache\n\nWhen a module does not define __loader__, fall back to __spec__.loader.\n(Contributed by Brett Cannon in bpo-42133.)", "code_blocks": []}, "improved-modules - os": {"text": "os\n\nAdd os.cpu_count() support for VxWorks RTOS.\n(Contributed by Peixing Xin in bpo-41440.)\nAdd a new function os.eventfd() and related helpers to wrap the\neventfd2 syscall on Linux.\n(Contributed by Christian Heimes in bpo-41001.)\nAdd os.splice() that allows to move data between two file\ndescriptors without copying between kernel address space and user\naddress space, where one of the file descriptors must refer to a\npipe. (Contributed by Pablo Galindo in bpo-41625.)\nAdd O_EVTONLY, O_FSYNC, O_SYMLINK\nand O_NOFOLLOW_ANY for macOS.\n(Contributed by Dong-hee Na in bpo-43106.)\nAs of 3.10.15, os.mkdir() and os.makedirs() on Windows now support\npassing a mode value of 0o700 to apply access control to the new\ndirectory. This implicitly affects tempfile.mkdtemp() and is a\nmitigation for CVE-2024-4030. Other values for mode continue to be\nignored.\n(Contributed by Steve Dower in gh-118486.)", "code_blocks": []}, "improved-modules - os-path": {"text": "os.path\n\nos.path.realpath() now accepts a strict keyword-only argument. When set\nto True, OSError is raised if a path doesn’t exist or a symlink loop\nis encountered.\n(Contributed by Barney Gale in bpo-43757.)", "code_blocks": []}, "improved-modules - pathlib": {"text": "pathlib\n\nAdd slice support to PurePath.parents.\n(Contributed by Joshua Cannon in bpo-35498.)\nAdd negative indexing support to PurePath.parents.\n(Contributed by Yaroslav Pankovych in bpo-21041.)\nAdd Path.hardlink_to method that\nsupersedes link_to(). The new method has the same argument\norder as symlink_to().\n(Contributed by Barney Gale in bpo-39950.)\npathlib.Path.stat() and chmod() now accept a\nfollow_symlinks keyword-only argument for consistency with corresponding\nfunctions in the os module.\n(Contributed by Barney Gale in bpo-39906.)", "code_blocks": []}, "improved-modules - platform": {"text": "platform\n\nAdd platform.freedesktop_os_release() to retrieve operation system\nidentification from freedesktop.org os-release standard file.\n(Contributed by Christian Heimes in bpo-28468.)", "code_blocks": []}, "improved-modules - pprint": {"text": "pprint\n\npprint.pprint() now accepts a new underscore_numbers keyword argument.\n(Contributed by sblondon in bpo-42914.)\npprint can now pretty-print dataclasses.dataclass instances.\n(Contributed by Lewis Gaul in bpo-43080.)", "code_blocks": []}, "improved-modules - py-compile": {"text": "py_compile\n\nAdd --quiet option to command-line interface of py_compile.\n(Contributed by Gregory Schevchenko in bpo-38731.)", "code_blocks": []}, "improved-modules - pyclbr": {"text": "pyclbr\n\nAdd an end_lineno attribute to the Function and Class\nobjects in the tree returned by pyclbr.readline() and\npyclbr.readline_ex().  It matches the existing (start) lineno.\n(Contributed by Aviral Srivastava in bpo-38307.)", "code_blocks": []}, "improved-modules - shelve": {"text": "shelve\n\nThe shelve module now uses pickle.DEFAULT_PROTOCOL by default\ninstead of pickle protocol 3 when creating shelves.\n(Contributed by Zackery Spytz in bpo-34204.)", "code_blocks": []}, "improved-modules - statistics": {"text": "statistics\n\nAdd covariance(), Pearson’s\ncorrelation(), and simple\nlinear_regression() functions.\n(Contributed by Tymoteusz Wołodźko in bpo-38490.)", "code_blocks": []}, "improved-modules - site": {"text": "site\n\nWhen a module does not define __loader__, fall back to __spec__.loader.\n(Contributed by Brett Cannon in bpo-42133.)", "code_blocks": []}, "improved-modules - socket": {"text": "socket\n\nThe exception socket.timeout is now an alias of TimeoutError.\n(Contributed by Christian Heimes in bpo-42413.)\nAdd option to create MPTCP sockets with IPPROTO_MPTCP\n(Contributed by Rui Cunha in bpo-43571.)\nAdd IP_RECVTOS option to receive the type of service (ToS) or DSCP/ECN fields\n(Contributed by Georg Sauthoff in bpo-44077.)", "code_blocks": []}, "improved-modules - ssl": {"text": "ssl\n\nThe ssl module requires OpenSSL 1.1.1 or newer.\n(Contributed by Christian Heimes in PEP 644 and bpo-43669.)\nThe ssl module has preliminary support for OpenSSL 3.0.0 and new option\nOP_IGNORE_UNEXPECTED_EOF.\n(Contributed by Christian Heimes in bpo-38820, bpo-43794,\nbpo-43788, bpo-43791, bpo-43799, bpo-43920,\nbpo-43789, and bpo-43811.)\nDeprecated function and use of deprecated constants now result in\na DeprecationWarning. ssl.SSLContext.options has\nOP_NO_SSLv2 and OP_NO_SSLv3 set by default and\ntherefore cannot warn about setting the flag again. The\ndeprecation section has a list of deprecated\nfeatures.\n(Contributed by Christian Heimes in bpo-43880.)\nThe ssl module now has more secure default settings. Ciphers without forward\nsecrecy or SHA-1 MAC are disabled by default. Security level 2 prohibits\nweak RSA, DH, and ECC keys with less than 112 bits of security.\nSSLContext defaults to minimum protocol version TLS 1.2.\nSettings are based on Hynek Schlawack’s research.\n(Contributed by Christian Heimes in bpo-43998.)\nThe deprecated protocols SSL 3.0, TLS 1.0, and TLS 1.1 are no longer\nofficially supported. Python does not block them actively. However\nOpenSSL build options, distro configurations, vendor patches, and cipher\nsuites may prevent a successful handshake.\nAdd a timeout parameter to the ssl.get_server_certificate() function.\n(Contributed by Zackery Spytz in bpo-31870.)\nThe ssl module uses heap-types and multi-phase initialization.\n(Contributed by Christian Heimes in bpo-42333.)\nA new verify flag VERIFY_X509_PARTIAL_CHAIN has been added.\n(Contributed by l0x in bpo-40849.)", "code_blocks": []}, "improved-modules - sqlite3": {"text": "sqlite3\n\nAdd audit events for connect/handle(),\nenable_load_extension(), and\nload_extension().\n(Contributed by Erlend E. Aasland in bpo-43762.)", "code_blocks": []}, "improved-modules - sys": {"text": "sys\n\nAdd sys.orig_argv attribute: the list of the original command line\narguments passed to the Python executable.\n(Contributed by Victor Stinner in bpo-23427.)\nAdd sys.stdlib_module_names, containing the list of the standard library\nmodule names.\n(Contributed by Victor Stinner in bpo-42955.)", "code_blocks": []}, "improved-modules - tempfile": {"text": "tempfile\n\nAs of 3.10.15 on Windows, the default mode 0o700 used by\ntempfile.mkdtemp() now limits access to the new directory due to\nchanges to os.mkdir(). This is a mitigation for CVE-2024-4030.\n(Contributed by Steve Dower in gh-118486.)", "code_blocks": []}, "improved-modules - thread": {"text": "_thread\n\n_thread.interrupt_main() now takes an optional signal number to\nsimulate (the default is still signal.SIGINT).\n(Contributed by Antoine Pitrou in bpo-43356.)", "code_blocks": []}, "improved-modules - threading": {"text": "threading\n\nAdd threading.gettrace() and threading.getprofile() to\nretrieve the functions set by threading.settrace() and\nthreading.setprofile() respectively.\n(Contributed by Mario Corchero in bpo-42251.)\nAdd threading.__excepthook__ to allow retrieving the original value\nof threading.excepthook() in case it is set to a broken or a different\nvalue.\n(Contributed by Mario Corchero in bpo-42308.)", "code_blocks": []}, "improved-modules - traceback": {"text": "traceback\n\nThe format_exception(),\nformat_exception_only(), and\nprint_exception() functions can now take an exception object\nas a positional-only argument.\n(Contributed by Zackery Spytz and Matthias Bussonnier in bpo-26389.)", "code_blocks": []}, "improved-modules - types": {"text": "types\n\nReintroduce the types.EllipsisType, types.NoneType\nand types.NotImplementedType classes, providing a new set\nof types readily interpretable by type checkers.\n(Contributed by Bas van Beek in bpo-41810.)", "code_blocks": []}, "improved-modules - typing": {"text": "typing\n\nFor major changes, see New Features Related to Type Hints.\nThe behavior of typing.Literal was changed to conform with PEP 586\nand to match the behavior of static type checkers specified in the PEP.\n\nLiteral now de-duplicates parameters.\nEquality comparisons between Literal objects are now order independent.\nLiteral comparisons now respect types.  For example,\nLiteral[0] == Literal[False] previously evaluated to True.  It is\nnow False.  To support this change, the internally used type cache now\nsupports differentiating types.\nLiteral objects will now raise a TypeError exception during\nequality comparisons if any of their parameters are not hashable.\nNote that declaring Literal with unhashable parameters will not throw\nan error:\n>>> from typing import Literal\n>>> Literal[{0}]\n>>> Literal[{0}] == Literal[{False}]\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: unhashable type: 'set'\n\n\n\n\n(Contributed by Yurii Karabas in bpo-42345.)\nAdd new function typing.is_typeddict() to introspect if an annotation\nis a typing.TypedDict.\n(Contributed by Patrick Reader in bpo-41792.)\nSubclasses of typing.Protocol which only have data variables declared\nwill now raise a TypeError when checked with isinstance unless they\nare decorated with runtime_checkable().  Previously, these checks\npassed silently.  Users should decorate their\nsubclasses with the runtime_checkable() decorator\nif they want runtime protocols.\n(Contributed by Yurii Karabas in bpo-38908.)\nImporting from the typing.io and typing.re submodules will now emit\nDeprecationWarning.  These submodules have been deprecated since\nPython 3.8 and will be removed in a future version of Python.  Anything\nbelonging to those submodules should be imported directly from\ntyping instead.\n(Contributed by Sebastian Rittau in bpo-38291.)", "code_blocks": [">>> from typing import Literal\n>>> Literal[{0}]\n>>> Literal[{0}] == Literal[{False}]\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: unhashable type: 'set'\n"]}, "improved-modules - unittest": {"text": "unittest\n\nAdd new method assertNoLogs() to complement the\nexisting assertLogs(). (Contributed by Kit Yan Choi\nin bpo-39385.)", "code_blocks": []}, "improved-modules - urllib-parse": {"text": "urllib.parse\n\nPython versions earlier than Python 3.10 allowed using both ; and & as\nquery parameter separators in urllib.parse.parse_qs() and\nurllib.parse.parse_qsl().  Due to security concerns, and to conform with\nnewer W3C recommendations, this has been changed to allow only a single\nseparator key, with & as the default.  This change also affects\ncgi.parse() and cgi.parse_multipart() as they use the affected\nfunctions internally.  For more details, please see their respective\ndocumentation.\n(Contributed by Adam Goldschmidt, Senthil Kumaran and Ken Jin in bpo-42967.)\nThe presence of newline or tab characters in parts of a URL allows for some\nforms of attacks. Following the WHATWG specification that updates RFC 3986,\nASCII newline \\n, \\r and tab \\t characters are stripped from the\nURL by the parser in urllib.parse preventing such attacks. The removal\ncharacters are controlled by a new module level variable\nurllib.parse._UNSAFE_URL_BYTES_TO_REMOVE. (See bpo-43882)", "code_blocks": []}, "improved-modules - xml": {"text": "xml\n\nAdd a LexicalHandler class to the\nxml.sax.handler module.\n(Contributed by Jonathan Gossage and Zackery Spytz in bpo-35018.)", "code_blocks": []}, "improved-modules - zipimport": {"text": "zipimport\n\nAdd methods related to PEP 451: find_spec(),\nzipimport.zipimporter.create_module(), and\nzipimport.zipimporter.exec_module().\n(Contributed by Brett Cannon in bpo-42131.)\nAdd invalidate_caches() method.\n(Contributed by Desmond Cheong in bpo-14678.)", "code_blocks": []}, "optimizations": {"text": "Optimizations\n\n\nConstructors str(), bytes() and bytearray() are now faster\n(around 30–40% for small objects).\n(Contributed by Serhiy Storchaka in bpo-41334.)\nThe runpy module now imports fewer modules.\nThe python3 -m module-name command startup time is 1.4x faster in\naverage. On Linux, python3 -I -m module-name imports 69 modules on Python\n3.9, whereas it only imports 51 modules (-18) on Python 3.10.\n(Contributed by Victor Stinner in bpo-41006 and bpo-41718.)\nThe LOAD_ATTR instruction now uses new “per opcode cache” mechanism.  It\nis about 36% faster now for regular attributes and 44% faster for slots.\n(Contributed by Pablo Galindo and Yury Selivanov in bpo-42093 and Guido\nvan Rossum in bpo-42927, based on ideas implemented originally in PyPy\nand MicroPython.)\nWhen building Python with --enable-optimizations now\n-fno-semantic-interposition is added to both the compile and link line.\nThis speeds builds of the Python interpreter created with --enable-shared\nwith gcc by up to 30%. See this article\nfor more details. (Contributed by Victor Stinner and Pablo Galindo in\nbpo-38980.)\nUse a new output buffer management code for bz2 / lzma /\nzlib modules, and add .readall() function to\n_compression.DecompressReader class. bz2 decompression is now 1.09x ~ 1.17x\nfaster, lzma decompression 1.20x ~ 1.32x faster, GzipFile.read(-1) 1.11x\n~ 1.18x faster. (Contributed by Ma Lin, reviewed by Gregory P. Smith, in bpo-41486)\nWhen using stringized annotations, annotations dicts for functions are no longer\ncreated when the function is created.  Instead, they are stored as a tuple of\nstrings, and the function object lazily converts this into the annotations dict\non demand.  This optimization cuts the CPU time needed to define an annotated\nfunction by half.\n(Contributed by Yurii Karabas and Inada Naoki in bpo-42202.)\nSubstring search functions such as str1 in str2 and str2.find(str1)\nnow sometimes use Crochemore & Perrin’s “Two-Way” string searching\nalgorithm to avoid quadratic behavior on long strings.  (Contributed\nby Dennis Sweeney in bpo-41972)\nAdd micro-optimizations to _PyType_Lookup() to improve type attribute cache lookup\nperformance in the common case of cache hits. This makes the interpreter 1.04 times faster\non average. (Contributed by Dino Viehland in bpo-43452.)\nThe following built-in functions now support the faster PEP 590 vectorcall calling convention:\nmap(), filter(), reversed(), bool() and float().\n(Contributed by Dong-hee Na and Jeroen Demeyer in bpo-43575, bpo-43287, bpo-41922, bpo-41873 and bpo-41870.)\nBZ2File performance is improved by removing internal RLock.\nThis makes BZ2File thread unsafe in the face of multiple simultaneous\nreaders or writers, just like its equivalent classes in gzip and\nlzma have always been.  (Contributed by Inada Naoki in bpo-43785.)", "code_blocks": []}, "deprecated": {"text": "Deprecated\n\n\nCurrently Python accepts numeric literals immediately followed by keywords,\nfor example 0in x, 1or x, 0if 1else 2.  It allows confusing\nand ambiguous expressions like [0x1for x in y] (which can be\ninterpreted as [0x1 for x in y] or [0x1f or x in y]).  Starting in\nthis release, a deprecation warning is raised if the numeric literal is\nimmediately followed by one of keywords and, else,\nfor, if, in, is and or.\nIn future releases it will be changed to syntax warning, and finally to\nsyntax error.\n(Contributed by Serhiy Storchaka in bpo-43833.)\nStarting in this release, there will be a concerted effort to begin\ncleaning up old import semantics that were kept for Python 2.7\ncompatibility. Specifically,\nfind_loader()/find_module()\n(superseded by find_spec()),\nload_module()\n(superseded by exec_module()),\nmodule_repr() (which the import system\ntakes care of for you), the __package__ attribute\n(superseded by __spec__.parent), the __loader__ attribute\n(superseded by __spec__.loader), and the __cached__ attribute\n(superseded by __spec__.cached) will slowly be removed (as well\nas other classes and methods in importlib).\nImportWarning and/or DeprecationWarning will be raised\nas appropriate to help identify code which needs updating during\nthis transition.\nThe entire distutils namespace is deprecated, to be removed in\nPython 3.12. Refer to the module changes\nsection for more information.\nNon-integer arguments to random.randrange() are deprecated.\nThe ValueError is deprecated in favor of a TypeError.\n(Contributed by Serhiy Storchaka and Raymond Hettinger in bpo-37319.)\nThe various load_module() methods of importlib have been\ndocumented as deprecated since Python 3.6, but will now also trigger\na DeprecationWarning. Use\nexec_module() instead.\n(Contributed by Brett Cannon in bpo-26131.)\nzimport.zipimporter.load_module() has been deprecated in\npreference for exec_module().\n(Contributed by Brett Cannon in bpo-26131.)\nThe use of load_module() by the import\nsystem now triggers an ImportWarning as\nexec_module() is preferred.\n(Contributed by Brett Cannon in bpo-26131.)\nThe use of importlib.abc.MetaPathFinder.find_module() and\nimportlib.abc.PathEntryFinder.find_module() by the import system now\ntrigger an ImportWarning as\nimportlib.abc.MetaPathFinder.find_spec() and\nimportlib.abc.PathEntryFinder.find_spec()\nare preferred, respectively. You can use\nimportlib.util.spec_from_loader() to help in porting.\n(Contributed by Brett Cannon in bpo-42134.)\nThe use of importlib.abc.PathEntryFinder.find_loader() by the import\nsystem now triggers an ImportWarning as\nimportlib.abc.PathEntryFinder.find_spec() is preferred. You can use\nimportlib.util.spec_from_loader() to help in porting.\n(Contributed by Brett Cannon in bpo-43672.)\nThe various implementations of\nimportlib.abc.MetaPathFinder.find_module() (\nimportlib.machinery.BuiltinImporter.find_module(),\nimportlib.machinery.FrozenImporter.find_module(),\nimportlib.machinery.WindowsRegistryFinder.find_module(),\nimportlib.machinery.PathFinder.find_module(),\nimportlib.abc.MetaPathFinder.find_module() ),\nimportlib.abc.PathEntryFinder.find_module() (\nimportlib.machinery.FileFinder.find_module() ), and\nimportlib.abc.PathEntryFinder.find_loader() (\nimportlib.machinery.FileFinder.find_loader() )\nnow raise DeprecationWarning and are slated for removal in\nPython 3.12 (previously they were documented as deprecated in Python 3.4).\n(Contributed by Brett Cannon in bpo-42135.)\nimportlib.abc.Finder is deprecated (including its sole method,\nfind_module()). Both\nimportlib.abc.MetaPathFinder and importlib.abc.PathEntryFinder\nno longer inherit from the class. Users should inherit from one of these two\nclasses as appropriate instead.\n(Contributed by Brett Cannon in bpo-42135.)\nThe deprecations of imp, importlib.find_loader(),\nimportlib.util.set_package_wrapper(),\nimportlib.util.set_loader_wrapper(),\nimportlib.util.module_for_loader(),\npkgutil.ImpImporter, and\npkgutil.ImpLoader have all been updated to list Python 3.12 as the\nslated version of removal (they began raising DeprecationWarning in\nprevious versions of Python).\n(Contributed by Brett Cannon in bpo-43720.)\nThe import system now uses the __spec__ attribute on modules before\nfalling back on module_repr() for a module’s\n__repr__() method. Removal of the use of module_repr() is scheduled\nfor Python 3.12.\n(Contributed by Brett Cannon in bpo-42137.)\nimportlib.abc.Loader.module_repr(),\nimportlib.machinery.FrozenLoader.module_repr(), and\nimportlib.machinery.BuiltinLoader.module_repr() are deprecated and\nslated for removal in Python 3.12.\n(Contributed by Brett Cannon in bpo-42136.)\nsqlite3.OptimizedUnicode has been undocumented and obsolete since Python\n3.3, when it was made an alias to str.  It is now deprecated,\nscheduled for removal in Python 3.12.\n(Contributed by Erlend E. Aasland in bpo-42264.)\nThe undocumented built-in function sqlite3.enable_shared_cache is now\ndeprecated, scheduled for removal in Python 3.12.  Its use is strongly\ndiscouraged by the SQLite3 documentation.  See the SQLite3 docs for more details.\nIf a shared cache must be used, open the database in URI mode using the\ncache=shared query parameter.\n(Contributed by Erlend E. Aasland in bpo-24464.)\nThe following threading methods are now deprecated:\n\nthreading.currentThread => threading.current_thread()\nthreading.activeCount => threading.active_count()\nthreading.Condition.notifyAll =>\nthreading.Condition.notify_all()\nthreading.Event.isSet => threading.Event.is_set()\nthreading.Thread.setName => threading.Thread.name\nthreading.thread.getName => threading.Thread.name\nthreading.Thread.isDaemon => threading.Thread.daemon\nthreading.Thread.setDaemon => threading.Thread.daemon\n\n(Contributed by Jelle Zijlstra in gh-87889.)\n\npathlib.Path.link_to() is deprecated and slated for removal in\nPython 3.12. Use pathlib.Path.hardlink_to() instead.\n(Contributed by Barney Gale in bpo-39950.)\ncgi.log() is deprecated and slated for removal in Python 3.12.\n(Contributed by Inada Naoki in bpo-41139.)\nThe following ssl features have been deprecated since Python 3.6,\nPython 3.7, or OpenSSL 1.1.0 and will be removed in 3.11:\n\nOP_NO_SSLv2, OP_NO_SSLv3, OP_NO_TLSv1,\nOP_NO_TLSv1_1, OP_NO_TLSv1_2, and\nOP_NO_TLSv1_3 are replaced by\nsslSSLContext.minimum_version and\nsslSSLContext.maximum_version.\nPROTOCOL_SSLv2, PROTOCOL_SSLv3,\nPROTOCOL_SSLv23, PROTOCOL_TLSv1,\nPROTOCOL_TLSv1_1, PROTOCOL_TLSv1_2, and\nPROTOCOL_TLS are deprecated in favor of\nPROTOCOL_TLS_CLIENT and PROTOCOL_TLS_SERVER\nwrap_socket() is replaced by ssl.SSLContext.wrap_socket()\nmatch_hostname()\nRAND_pseudo_bytes(), RAND_egd()\nNPN features like ssl.SSLSocket.selected_npn_protocol() and\nssl.SSLContext.set_npn_protocols() are replaced by ALPN.\n\n\nThe threading debug (PYTHONTHREADDEBUG environment variable) is\ndeprecated in Python 3.10 and will be removed in Python 3.12. This feature\nrequires a debug build of Python.\n(Contributed by Victor Stinner in bpo-44584.)\nImporting from the typing.io and typing.re submodules will now emit\nDeprecationWarning.  These submodules will be removed in a future version\nof Python.  Anything belonging to these submodules should be imported directly\nfrom typing instead.\n(Contributed by Sebastian Rittau in bpo-38291.)", "code_blocks": []}, "removed": {"text": "Removed\n\n\nRemoved special methods __int__, __float__, __floordiv__,\n__mod__, __divmod__, __rfloordiv__, __rmod__ and\n__rdivmod__ of the complex class.  They always raised\na TypeError.\n(Contributed by Serhiy Storchaka in bpo-41974.)\nThe ParserBase.error() method from the private and undocumented _markupbase\nmodule has been removed.  html.parser.HTMLParser is the only subclass of\nParserBase and its error() implementation was already removed in\nPython 3.5.\n(Contributed by Berker Peksag in bpo-31844.)\nRemoved the unicodedata.ucnhash_CAPI attribute which was an internal\nPyCapsule object. The related private _PyUnicode_Name_CAPI structure was\nmoved to the internal C API.\n(Contributed by Victor Stinner in bpo-42157.)\nRemoved the parser module, which was deprecated in 3.9 due to the\nswitch to the new PEG parser, as well as all the C source and header files\nthat were only being used by the old parser, including node.h, parser.h,\ngraminit.h and grammar.h.\nRemoved the Public C API functions PyParser_SimpleParseStringFlags,\nPyParser_SimpleParseStringFlagsFilename,\nPyParser_SimpleParseFileFlags and PyNode_Compile\nthat were deprecated in 3.9 due to the switch to the new PEG parser.\nRemoved the formatter module, which was deprecated in Python 3.4.\nIt is somewhat obsolete, little used, and not tested. It was originally\nscheduled to be removed in Python 3.6, but such removals were delayed until\nafter Python 2.7 EOL. Existing users should copy whatever classes they use\ninto their code.\n(Contributed by Dong-hee Na and Terry J. Reedy in bpo-42299.)\nRemoved the PyModule_GetWarningsModule() function that was useless\nnow due to the _warnings module was converted to a builtin module in 2.6.\n(Contributed by Hai Shi in bpo-42599.)\nRemove deprecated aliases to Collections Abstract Base Classes from\nthe collections module.\n(Contributed by Victor Stinner in bpo-37324.)\nThe loop parameter has been removed from most of asyncio‘s\nhigh-level API following deprecation\nin Python 3.8.  The motivation behind this change is multifold:\n\nThis simplifies the high-level API.\nThe functions in the high-level API have been implicitly getting the\ncurrent thread’s running event loop since Python 3.7.  There isn’t a need to\npass the event loop to the API in most normal use cases.\nEvent loop passing is error-prone especially when dealing with loops\nrunning in different threads.\n\nNote that the low-level API will still accept loop.\nSee Changes in the Python API for examples of how to replace existing code.\n(Contributed by Yurii Karabas, Andrew Svetlov, Yury Selivanov and Kyle Stanley\nin bpo-42392.)", "code_blocks": []}, "porting-to-python-3-10 - changes-in-the-python-syntax": {"text": "Changes in the Python syntax\n\n\nDeprecation warning is now emitted when compiling previously valid syntax\nif the numeric literal is immediately followed by a keyword (like in 0in x).\nIn future releases it will be changed to syntax warning, and finally to a\nsyntax error.  To get rid of the warning and make the code compatible with\nfuture releases just add a space between the numeric literal and the\nfollowing keyword.\n(Contributed by Serhiy Storchaka in bpo-43833.)", "code_blocks": []}, "porting-to-python-3-10 - changes-in-the-python-api": {"text": "Changes in the Python API\n\n\nThe etype parameters of the format_exception(),\nformat_exception_only(), and\nprint_exception() functions in the traceback module\nhave been renamed to exc.\n(Contributed by Zackery Spytz and Matthias Bussonnier in bpo-26389.)\natexit: At Python exit, if a callback registered with\natexit.register() fails, its exception is now logged. Previously, only\nsome exceptions were logged, and the last exception was always silently\nignored.\n(Contributed by Victor Stinner in bpo-42639.)\ncollections.abc.Callable generic now flattens type parameters, similar\nto what typing.Callable currently does.  This means that\ncollections.abc.Callable[[int, str], str] will have __args__ of\n(int, str, str); previously this was ([int, str], str).  Code which\naccesses the arguments via typing.get_args() or __args__ need to account\nfor this change.  Furthermore, TypeError may be raised for invalid forms\nof parameterizing collections.abc.Callable which may have passed\nsilently in Python 3.9.\n(Contributed by Ken Jin in bpo-42195.)\nsocket.htons() and socket.ntohs() now raise OverflowError\ninstead of DeprecationWarning if the given parameter will not fit in\na 16-bit unsigned integer.\n(Contributed by Erlend E. Aasland in bpo-42393.)\nThe loop parameter has been removed from most of asyncio‘s\nhigh-level API following deprecation\nin Python 3.8.\nA coroutine that currently looks like this:\nasync def foo(loop):\n    await asyncio.sleep(1, loop=loop)\n\n\nShould be replaced with this:\nasync def foo():\n    await asyncio.sleep(1)\n\n\nIf foo() was specifically designed not to run in the current thread’s\nrunning event loop (e.g. running in another thread’s event loop), consider\nusing asyncio.run_coroutine_threadsafe() instead.\n(Contributed by Yurii Karabas, Andrew Svetlov, Yury Selivanov and Kyle Stanley\nin bpo-42392.)\n\nThe types.FunctionType constructor now inherits the current builtins\nif the globals dictionary has no \"__builtins__\" key, rather than using\n{\"None\": None} as builtins: same behavior as eval() and\nexec() functions.  Defining a function with def function(...): ...\nin Python is not affected, globals cannot be overridden with this syntax: it\nalso inherits the current builtins.\n(Contributed by Victor Stinner in bpo-42990.)", "code_blocks": ["async def foo(loop):\n    await asyncio.sleep(1, loop=loop)\n", "async def foo():\n    await asyncio.sleep(1)\n"]}, "porting-to-python-3-10 - changes-in-the-c-api": {"text": "Changes in the C API\n\n\nThe C API functions PyParser_SimpleParseStringFlags,\nPyParser_SimpleParseStringFlagsFilename,\nPyParser_SimpleParseFileFlags, PyNode_Compile and the type\nused by these functions, struct _node, were removed due to the switch\nto the new PEG parser.\nSource should be now be compiled directly to a code object using, for\nexample, Py_CompileString(). The resulting code object can then be\nevaluated using, for example, PyEval_EvalCode().\nSpecifically:\n\nA call to PyParser_SimpleParseStringFlags followed by\nPyNode_Compile can be replaced by calling Py_CompileString().\nThere is no direct replacement for PyParser_SimpleParseFileFlags.\nTo compile code from a FILE * argument, you will need to read\nthe file in C and pass the resulting buffer to Py_CompileString().\nTo compile a file given a char * filename, explicitly open the file, read\nit and compile the result. One way to do this is using the io\nmodule with PyImport_ImportModule(), PyObject_CallMethod(),\nPyBytes_AsString() and Py_CompileString(),\nas sketched below. (Declarations and error handling are omitted.)\nio_module = Import_ImportModule(\"io\");\nfileobject = PyObject_CallMethod(io_module, \"open\", \"ss\", filename, \"rb\");\nsource_bytes_object = PyObject_CallMethod(fileobject, \"read\", \"\");\nresult = PyObject_CallMethod(fileobject, \"close\", \"\");\nsource_buf = PyBytes_AsString(source_bytes_object);\ncode = Py_CompileString(source_buf, filename, Py_file_input);\n\n\n\nFor FrameObject objects, the f_lasti member now represents a wordcode\noffset instead of a simple offset into the bytecode string. This means that this\nnumber needs to be multiplied by 2 to be used with APIs that expect a byte offset\ninstead (like PyCode_Addr2Line() for example). Notice as well that the\nf_lasti member of FrameObject objects is not considered stable: please\nuse PyFrame_GetLineNumber() instead.", "code_blocks": ["io_module = Import_ImportModule(\"io\");\nfileobject = PyObject_CallMethod(io_module, \"open\", \"ss\", filename, \"rb\");\nsource_bytes_object = PyObject_CallMethod(fileobject, \"read\", \"\");\nresult = PyObject_CallMethod(fileobject, \"close\", \"\");\nsource_buf = PyBytes_AsString(source_bytes_object);\ncode = Py_CompileString(source_buf, filename, Py_file_input);\n"]}, "cpython-bytecode-changes": {"text": "CPython bytecode changes\n\n\nThe MAKE_FUNCTION instruction now accepts either a dict or a tuple of\nstrings as the function’s annotations.\n(Contributed by Yurii Karabas and Inada Naoki in bpo-42202.)", "code_blocks": []}, "build-changes": {"text": "Build Changes\n\n\nPEP 644: Python now requires OpenSSL 1.1.1 or newer. OpenSSL 1.0.2 is no\nlonger supported.\n(Contributed by Christian Heimes in bpo-43669.)\nThe C99 functions snprintf() and vsnprintf() are now required\nto build Python.\n(Contributed by Victor Stinner in bpo-36020.)\nsqlite3 requires SQLite 3.7.15 or higher. (Contributed by Sergey Fedoseev\nand Erlend E. Aasland in bpo-40744 and bpo-40810.)\nThe atexit module must now always be built as a built-in module.\n(Contributed by Victor Stinner in bpo-42639.)\nAdd --disable-test-modules option to the configure script:\ndon’t build nor install test modules.\n(Contributed by Xavier de Gaye, Thomas Petazzoni and Peixing Xin in bpo-27640.)\nAdd --with-wheel-pkg-dir=PATH option\nto the ./configure script. If\nspecified, the ensurepip module looks for setuptools and pip\nwheel packages in this directory: if both are present, these wheel packages\nare used instead of ensurepip bundled wheel packages.\nSome Linux distribution packaging policies recommend against bundling\ndependencies. For example, Fedora installs wheel packages in the\n/usr/share/python-wheels/ directory and don’t install the\nensurepip._bundled package.\n(Contributed by Victor Stinner in bpo-42856.)\n\nAdd a new configure --without-static-libpython option to not build the libpythonMAJOR.MINOR.a\nstatic library and not install the python.o object file.\n(Contributed by Victor Stinner in bpo-43103.)\n\nThe configure script now uses the pkg-config utility, if available,\nto detect the location of Tcl/Tk headers and libraries.  As before, those\nlocations can be explicitly specified with the --with-tcltk-includes\nand --with-tcltk-libs configuration options.\n(Contributed by Manolis Stamatogiannakis in bpo-42603.)\nAdd --with-openssl-rpath option to configure script. The option\nsimplifies building Python with a custom OpenSSL installation, e.g.\n./configure --with-openssl=/path/to/openssl --with-openssl-rpath=auto.\n(Contributed by Christian Heimes in bpo-43466.)", "code_blocks": []}, "c-api-changes - pep-652-maintaining-the-stable-abi": {"text": "PEP 652: Maintaining the Stable ABI\n\nThe Stable ABI (Application Binary Interface) for extension modules or\nembedding Python is now explicitly defined.\nC API Stability describes C API and ABI stability guarantees along with best\npractices for using the Stable ABI.\n(Contributed by Petr Viktorin in PEP 652 and bpo-43795.)", "code_blocks": []}, "c-api-changes - id1": {"text": "New Features\n\n\nThe result of PyNumber_Index() now always has exact type int.\nPreviously, the result could have been an instance of a subclass of int.\n(Contributed by Serhiy Storchaka in bpo-40792.)\nAdd a new orig_argv member to the PyConfig\nstructure: the list of the original command line arguments passed to the\nPython executable.\n(Contributed by Victor Stinner in bpo-23427.)\nThe PyDateTime_DATE_GET_TZINFO() and\nPyDateTime_TIME_GET_TZINFO() macros have been added for accessing\nthe tzinfo attributes of datetime.datetime and\ndatetime.time objects.\n(Contributed by Zackery Spytz in bpo-30155.)\nAdd a PyCodec_Unregister() function to unregister a codec\nsearch function.\n(Contributed by Hai Shi in bpo-41842.)\nThe PyIter_Send() function was added to allow\nsending value into iterator without raising StopIteration exception.\n(Contributed by Vladimir Matveev in bpo-41756.)\nAdd PyUnicode_AsUTF8AndSize() to the limited C API.\n(Contributed by Alex Gaynor in bpo-41784.)\nAdd PyModule_AddObjectRef() function: similar to\nPyModule_AddObject() but don’t steal a reference to the value on\nsuccess.\n(Contributed by Victor Stinner in bpo-1635741.)\nAdd Py_NewRef() and Py_XNewRef() functions to increment the\nreference count of an object and return the object.\n(Contributed by Victor Stinner in bpo-42262.)\nThe PyType_FromSpecWithBases() and PyType_FromModuleAndSpec()\nfunctions now accept a single class as the bases argument.\n(Contributed by Serhiy Storchaka in bpo-42423.)\nThe PyType_FromModuleAndSpec() function now accepts NULL tp_doc\nslot.\n(Contributed by Hai Shi in bpo-41832.)\nThe PyType_GetSlot() function can accept\nstatic types.\n(Contributed by Hai Shi and Petr Viktorin in bpo-41073.)\nAdd a new PySet_CheckExact() function to the C-API to check if an\nobject is an instance of set but not an instance of a subtype.\n(Contributed by Pablo Galindo in bpo-43277.)\nAdd PyErr_SetInterruptEx() which allows passing a signal number\nto simulate.\n(Contributed by Antoine Pitrou in bpo-43356.)\nThe limited C API is now supported if Python is built in debug mode (if the Py_DEBUG macro is defined). In the limited C API,\nthe Py_INCREF() and Py_DECREF() functions are now implemented\nas opaque function\ncalls, rather than accessing directly the PyObject.ob_refcnt\nmember, if Python is built in debug mode and the Py_LIMITED_API macro\ntargets Python 3.10 or newer. It became possible to support the limited C API\nin debug mode because the PyObject structure is the same in release\nand debug mode since Python 3.8 (see bpo-36465).\nThe limited C API is still not supported in the --with-trace-refs\nspecial build (Py_TRACE_REFS macro).\n(Contributed by Victor Stinner in bpo-43688.)\n\nAdd the Py_Is(x, y) function to test if the x object is\nthe y object, the same as x is y in Python. Add also the\nPy_IsNone(), Py_IsTrue(), Py_IsFalse() functions to\ntest if an object is, respectively, the None singleton, the True\nsingleton or the False singleton.\n(Contributed by Victor Stinner in bpo-43753.)\nAdd new functions to control the garbage collector from C code:\nPyGC_Enable(),\nPyGC_Disable(),\nPyGC_IsEnabled().\nThese functions allow to activate, deactivate and query the state of the garbage collector from C code without\nhaving to import the gc module.\nAdd a new Py_TPFLAGS_DISALLOW_INSTANTIATION type flag to disallow\ncreating type instances.\n(Contributed by Victor Stinner in bpo-43916.)\nAdd a new Py_TPFLAGS_IMMUTABLETYPE type flag for creating immutable\ntype objects: type attributes cannot be set nor deleted.\n(Contributed by Victor Stinner and Erlend E. Aasland in bpo-43908.)", "code_blocks": []}, "c-api-changes - id2": {"text": "Porting to Python 3.10\n\n\nThe PY_SSIZE_T_CLEAN macro must now be defined to use\nPyArg_ParseTuple() and Py_BuildValue() formats which use\n#: es#, et#, s#, u#, y#, z#, U# and Z#.\nSee Parsing arguments and building values and PEP 353.\n(Contributed by Victor Stinner in bpo-40943.)\nSince Py_REFCNT() is changed to the inline static function,\nPy_REFCNT(obj) = new_refcnt must be replaced with Py_SET_REFCNT(obj, new_refcnt):\nsee Py_SET_REFCNT() (available since Python 3.9). For backward\ncompatibility, this macro can be used:\n#if PY_VERSION_HEX < 0x030900A4\n#  define Py_SET_REFCNT(obj, refcnt) ((Py_REFCNT(obj) = (refcnt)), (void)0)\n#endif\n\n\n(Contributed by Victor Stinner in bpo-39573.)\n\nCalling PyDict_GetItem() without GIL held had been allowed\nfor historical reason. It is no longer allowed.\n(Contributed by Victor Stinner in bpo-40839.)\nPyUnicode_FromUnicode(NULL, size) and PyUnicode_FromStringAndSize(NULL, size)\nraise DeprecationWarning now.  Use PyUnicode_New() to allocate\nUnicode object without initial data.\n(Contributed by Inada Naoki in bpo-36346.)\nThe private _PyUnicode_Name_CAPI structure of the PyCapsule API\nunicodedata.ucnhash_CAPI has been moved to the internal C API.\n(Contributed by Victor Stinner in bpo-42157.)\nPy_GetPath(), Py_GetPrefix(), Py_GetExecPrefix(),\nPy_GetProgramFullPath(), Py_GetPythonHome() and\nPy_GetProgramName() functions now return NULL if called before\nPy_Initialize() (before Python is initialized). Use the new\nPython Initialization Configuration API to get the Python Path Configuration.\n(Contributed by Victor Stinner in bpo-42260.)\nPyList_SET_ITEM(), PyTuple_SET_ITEM() and\nPyCell_SET() macros can no longer be used as l-value or r-value.\nFor example, x = PyList_SET_ITEM(a, b, c) and\nPyList_SET_ITEM(a, b, c) = x now fail with a compiler error. It prevents\nbugs like if (PyList_SET_ITEM (a, b, c) < 0) ... test.\n(Contributed by Zackery Spytz and Victor Stinner in bpo-30459.)\nThe non-limited API files odictobject.h, parser_interface.h,\npicklebufobject.h, pyarena.h, pyctype.h, pydebug.h,\npyfpe.h, and pytime.h have been moved to the Include/cpython\ndirectory. These files must not be included directly, as they are already\nincluded in Python.h; see Include Files. If they have\nbeen included directly, consider including Python.h instead.\n(Contributed by Nicholas Sim in bpo-35134.)\nUse the Py_TPFLAGS_IMMUTABLETYPE type flag to create immutable type\nobjects. Do not rely on Py_TPFLAGS_HEAPTYPE to decide if a type\nobject is mutable or not; check if Py_TPFLAGS_IMMUTABLETYPE is set\ninstead.\n(Contributed by Victor Stinner and Erlend E. Aasland in bpo-43908.)\nThe undocumented function Py_FrozenMain has been removed from the\nlimited API. The function is mainly useful for custom builds of Python.\n(Contributed by Petr Viktorin in bpo-26241.)", "code_blocks": ["#if PY_VERSION_HEX < 0x030900A4\n#  define Py_SET_REFCNT(obj, refcnt) ((Py_REFCNT(obj) = (refcnt)), (void)0)\n#endif\n"]}, "c-api-changes - id3": {"text": "Deprecated\n\n\nThe PyUnicode_InternImmortal() function is now deprecated\nand will be removed in Python 3.12: use PyUnicode_InternInPlace()\ninstead.\n(Contributed by Victor Stinner in bpo-41692.)", "code_blocks": []}, "c-api-changes - id4": {"text": "Removed\n\n\nRemoved Py_UNICODE_str* functions manipulating Py_UNICODE* strings.\n(Contributed by Inada Naoki in bpo-41123.)\n\n\nPy_UNICODE_strlen: use PyUnicode_GetLength() or\nPyUnicode_GET_LENGTH\nPy_UNICODE_strcat: use PyUnicode_CopyCharacters() or\nPyUnicode_FromFormat()\nPy_UNICODE_strcpy, Py_UNICODE_strncpy: use\nPyUnicode_CopyCharacters() or PyUnicode_Substring()\nPy_UNICODE_strcmp: use PyUnicode_Compare()\nPy_UNICODE_strncmp: use PyUnicode_Tailmatch()\nPy_UNICODE_strchr, Py_UNICODE_strrchr: use\nPyUnicode_FindChar()\n\n\n\nRemoved PyUnicode_GetMax(). Please migrate to new (PEP 393) APIs.\n(Contributed by Inada Naoki in bpo-41103.)\nRemoved PyLong_FromUnicode(). Please migrate to PyLong_FromUnicodeObject().\n(Contributed by Inada Naoki in bpo-41103.)\nRemoved PyUnicode_AsUnicodeCopy(). Please use PyUnicode_AsUCS4Copy() or\nPyUnicode_AsWideCharString()\n(Contributed by Inada Naoki in bpo-41103.)\nRemoved _Py_CheckRecursionLimit variable: it has been replaced by\nceval.recursion_limit of the PyInterpreterState structure.\n(Contributed by Victor Stinner in bpo-41834.)\nRemoved undocumented macros Py_ALLOW_RECURSION and\nPy_END_ALLOW_RECURSION and the recursion_critical field of the\nPyInterpreterState structure.\n(Contributed by Serhiy Storchaka in bpo-41936.)\nRemoved the undocumented PyOS_InitInterrupts() function. Initializing\nPython already implicitly installs signal handlers: see\nPyConfig.install_signal_handlers.\n(Contributed by Victor Stinner in bpo-41713.)\nRemove the PyAST_Validate() function. It is no longer possible to build a\nAST object (mod_ty type) with the public C API. The function was already\nexcluded from the limited C API (PEP 384).\n(Contributed by Victor Stinner in bpo-43244.)\nRemove the symtable.h header file and the undocumented functions:\n\nPyST_GetScope()\nPySymtable_Build()\nPySymtable_BuildObject()\nPySymtable_Free()\nPy_SymtableString()\nPy_SymtableStringObject()\n\nThe Py_SymtableString() function was part the stable ABI by mistake but\nit could not be used, because the symtable.h header file was excluded\nfrom the limited C API.\nUse Python symtable module instead.\n(Contributed by Victor Stinner in bpo-43244.)\n\nRemove PyOS_ReadlineFunctionPointer() from the limited C API headers\nand from python3.dll, the library that provides the stable ABI on\nWindows. Since the function takes a FILE* argument, its ABI stability\ncannot be guaranteed.\n(Contributed by Petr Viktorin in bpo-43868.)\nRemove ast.h, asdl.h, and Python-ast.h header files.\nThese functions were undocumented and excluded from the limited C API.\nMost names defined by these header files were not prefixed by Py and so\ncould create names conflicts. For example, Python-ast.h defined a\nYield macro which was conflict with the Yield name used by the\nWindows <winbase.h> header. Use the Python ast module instead.\n(Contributed by Victor Stinner in bpo-43244.)\nRemove the compiler and parser functions using struct _mod type, because\nthe public AST C API was removed:\n\nPyAST_Compile()\nPyAST_CompileEx()\nPyAST_CompileObject()\nPyFuture_FromAST()\nPyFuture_FromASTObject()\nPyParser_ASTFromFile()\nPyParser_ASTFromFileObject()\nPyParser_ASTFromFilename()\nPyParser_ASTFromString()\nPyParser_ASTFromStringObject()\n\nThese functions were undocumented and excluded from the limited C API.\n(Contributed by Victor Stinner in bpo-43244.)\n\nRemove the pyarena.h header file with functions:\n\nPyArena_New()\nPyArena_Free()\nPyArena_Malloc()\nPyArena_AddPyObject()\n\nThese functions were undocumented, excluded from the limited C API, and were\nonly used internally by the compiler.\n(Contributed by Victor Stinner in bpo-43244.)\n\nThe PyThreadState.use_tracing member has been removed to optimize Python.\n(Contributed by Mark Shannon in bpo-43760.)", "code_blocks": []}, "notable-security-feature-in-3-10-7": {"text": "Notable security feature in 3.10.7\n\nConverting between int and str in bases other than 2\n(binary), 4, 8 (octal), 16 (hexadecimal), or 32 such as base 10 (decimal)\nnow raises a ValueError if the number of digits in string form is\nabove a limit to avoid potential denial of service attacks due to the\nalgorithmic complexity. This is a mitigation for CVE-2020-10735.\nThis limit can be configured or disabled by environment variable, command\nline flag, or sys APIs. See the integer string conversion\nlength limitation documentation.  The default limit\nis 4300 digits in string form.", "code_blocks": []}, "notable-security-feature-in-3-10-8": {"text": "Notable security feature in 3.10.8\n\nThe deprecated mailcap module now refuses to inject unsafe text\n(filenames, MIME types, parameters) into shell commands. Instead of using such\ntext, it will warn and act as if a match was not found (or for test commands,\nas if the test failed).\n(Contributed by Petr Viktorin in gh-98966.)", "code_blocks": []}, "notable-changes-in-3-10-12 - tarfile": {"text": "tarfile\n\n\nThe extraction methods in tarfile, and shutil.unpack_archive(),\nhave a new a filter argument that allows limiting tar features than may be\nsurprising or dangerous, such as creating files outside the destination\ndirectory.\nSee Extraction filters for details.\nIn Python 3.12, use without the filter argument will show a\nDeprecationWarning.\nIn Python 3.14, the default will switch to 'data'.\n(Contributed by Petr Viktorin in PEP 706.)", "code_blocks": []}, "notable-changes-in-3-10-15 - ipaddress": {"text": "ipaddress\n\n\nFixed is_global and is_private behavior in IPv4Address,\nIPv6Address, IPv4Network and IPv6Network.", "code_blocks": []}, "notable-changes-in-3-10-15 - email": {"text": "email\n\n\nHeaders with embedded newlines are now quoted on output.\nThe generator will now refuse to serialize (write) headers\nthat are improperly folded or delimited, such that they would be parsed as\nmultiple headers or joined with adjacent data.\nIf you need to turn this safety feature off,\nset verify_generated_headers.\n(Contributed by Bas Bloemsaat and Petr Viktorin in gh-121650.)\n\nemail.utils.getaddresses() and email.utils.parseaddr() now return\n('', '') 2-tuples in more situations where invalid email addresses are\nencountered, instead of potentially inaccurate values.\nAn optional strict parameter was added to these two functions:\nuse strict=False to get the old behavior, accepting malformed inputs.\ngetattr(email.utils, 'supports_strict_parsing', False) can be used to\ncheck if the strict paramater is available.\n(Contributed by Thomas Dwyer and Victor Stinner for gh-102988 to improve\nthe CVE-2023-27043 fix.)", "code_blocks": []}}}
{"index": 13, "python_version": "3.11", "url": "https://docs.python.org/3.11/whatsnew/3.11.html", "sections": {"summary-release-highlights": {"text": "Summary – Release highlights\n\n\nPython 3.11 is between 10-60% faster than Python 3.10.\nOn average, we measured a 1.25x speedup on the standard benchmark suite.\nSee Faster CPython for details.\n\nNew syntax features:\n\nPEP 654: Exception Groups and except*\n\nNew built-in features:\n\nPEP 678: Exceptions can be enriched with notes\n\nNew standard library modules:\n\nPEP 680: tomllib —\nSupport for parsing TOML in the Standard Library\n\nInterpreter improvements:\n\nPEP 657: Fine-grained error locations in tracebacks\nNew -P command line option and PYTHONSAFEPATH environment\nvariable to disable automatically prepending potentially unsafe paths to sys.path\n\nNew typing features:\n\nPEP 646: Variadic generics\nPEP 655: Marking individual TypedDict items as required or not-required\nPEP 673: Self type\nPEP 675: Arbitrary literal string type\nPEP 681: Data class transforms\n\nImportant deprecations, removals and restrictions:\n\nPEP 594:\nMany legacy standard library modules have been deprecated and will be removed in Python 3.13\nPEP 624:\nPy_UNICODE encoder APIs have been removed\nPEP 670:\nMacros converted to static inline functions", "code_blocks": []}, "new-features - pep-657-fine-grained-error-locations-in-tracebacks": {"text": "PEP 657: Fine-grained error locations in tracebacks\n\nWhen printing tracebacks, the interpreter will now point to the exact expression\nthat caused the error, instead of just the line. For example:\nTraceback (most recent call last):\n  File \"distance.py\", line 11, in <module>\n    print(manhattan_distance(p1, p2))\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"distance.py\", line 6, in manhattan_distance\n    return abs(point_1.x - point_2.x) + abs(point_1.y - point_2.y)\n                           ^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'x'\n\n\nPrevious versions of the interpreter would point to just the line, making it\nambiguous which object was None. These enhanced errors can also be helpful\nwhen dealing with deeply nested dict objects and multiple function calls:\nTraceback (most recent call last):\n  File \"query.py\", line 37, in <module>\n    magic_arithmetic('foo')\n  File \"query.py\", line 18, in magic_arithmetic\n    return add_counts(x) / 25\n           ^^^^^^^^^^^^^\n  File \"query.py\", line 24, in add_counts\n    return 25 + query_user(user1) + query_user(user2)\n                ^^^^^^^^^^^^^^^^^\n  File \"query.py\", line 32, in query_user\n    return 1 + query_count(db, response['a']['b']['c']['user'], retry=True)\n                               ~~~~~~~~~~~~~~~~~~^^^^^\nTypeError: 'NoneType' object is not subscriptable\n\n\nAs well as complex arithmetic expressions:\nTraceback (most recent call last):\n  File \"calculation.py\", line 54, in <module>\n    result = (x / y / z) * (a / b / c)\n              ~~~~~~^~~\nZeroDivisionError: division by zero\n\n\nAdditionally, the information used by the enhanced traceback feature\nis made available via a general API, that can be used to correlate\nbytecode instructions with source code location.\nThis information can be retrieved using:\n\nThe codeobject.co_positions() method in Python.\nThe PyCode_Addr2Location() function in the C API.\n\nSee PEP 657 for more details. (Contributed by Pablo Galindo, Batuhan Taskaya\nand Ammar Askar in bpo-43950.)\n\nNote\nThis feature requires storing column positions in Code Objects,\nwhich may result in a small increase in interpreter memory usage\nand disk usage for compiled Python files.\nTo avoid storing the extra information\nand deactivate printing the extra traceback information,\nuse the -X no_debug_ranges command line option\nor the PYTHONNODEBUGRANGES environment variable.", "code_blocks": ["Traceback (most recent call last):\n  File \"distance.py\", line 11, in <module>\n    print(manhattan_distance(p1, p2))\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"distance.py\", line 6, in manhattan_distance\n    return abs(point_1.x - point_2.x) + abs(point_1.y - point_2.y)\n                           ^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'x'\n", "Traceback (most recent call last):\n  File \"query.py\", line 37, in <module>\n    magic_arithmetic('foo')\n  File \"query.py\", line 18, in magic_arithmetic\n    return add_counts(x) / 25\n           ^^^^^^^^^^^^^\n  File \"query.py\", line 24, in add_counts\n    return 25 + query_user(user1) + query_user(user2)\n                ^^^^^^^^^^^^^^^^^\n  File \"query.py\", line 32, in query_user\n    return 1 + query_count(db, response['a']['b']['c']['user'], retry=True)\n                               ~~~~~~~~~~~~~~~~~~^^^^^\nTypeError: 'NoneType' object is not subscriptable\n", "Traceback (most recent call last):\n  File \"calculation.py\", line 54, in <module>\n    result = (x / y / z) * (a / b / c)\n              ~~~~~~^~~\nZeroDivisionError: division by zero\n"]}, "new-features - pep-654-exception-groups-and-except": {"text": "PEP 654: Exception Groups and except*\n\nPEP 654 introduces language features that enable a program\nto raise and handle multiple unrelated exceptions simultaneously.\nThe builtin types ExceptionGroup and BaseExceptionGroup\nmake it possible to group exceptions and raise them together,\nand the new except* syntax generalizes\nexcept to match subgroups of exception groups.\nSee PEP 654 for more details.\n(Contributed by Irit Katriel in bpo-45292. PEP written by\nIrit Katriel, Yury Selivanov and Guido van Rossum.)", "code_blocks": []}, "new-features - pep-678-exceptions-can-be-enriched-with-notes": {"text": "PEP 678: Exceptions can be enriched with notes\n\nThe add_note() method is added to BaseException.\nIt can be used to enrich exceptions with context information\nthat is not available at the time when the exception is raised.\nThe added notes appear in the default traceback.\nSee PEP 678 for more details.\n(Contributed by Irit Katriel in bpo-45607.\nPEP written by Zac Hatfield-Dodds.)", "code_blocks": []}, "new-features - windows-py-exe-launcher-improvements": {"text": "Windows py.exe launcher improvements\n\nThe copy of the Python Launcher for Windows included with Python 3.11 has been significantly\nupdated. It now supports company/tag syntax as defined in PEP 514 using the\n-V:<company>/<tag> argument instead of the limited -<major>.<minor>.\nThis allows launching distributions other than PythonCore,\nthe one hosted on python.org.\nWhen using -V: selectors, either company or tag can be omitted, but all\ninstalls will be searched. For example, -V:OtherPython/ will select the\n“best” tag registered for OtherPython, while -V:3.11 or -V:/3.11\nwill select the “best” distribution with tag 3.11.\nWhen using the legacy -<major>, -<major>.<minor>,\n-<major>-<bitness> or -<major>.<minor>-<bitness> arguments,\nall existing behaviour should be preserved from past versions,\nand only releases from PythonCore will be selected.\nHowever, the -64 suffix now implies “not 32-bit” (not necessarily x86-64),\nas there are multiple supported 64-bit platforms.\n32-bit runtimes are detected by checking the runtime’s tag for a -32 suffix.\nAll releases of Python since 3.5 have included this in their 32-bit builds.", "code_blocks": []}, "new-features-related-to-type-hints - pep-646-variadic-generics": {"text": "PEP 646: Variadic generics\n\nPEP 484 previously introduced TypeVar, enabling creation\nof generics parameterised with a single type. PEP 646 adds\nTypeVarTuple, enabling parameterisation\nwith an arbitrary number of types. In other words,\na TypeVarTuple is a variadic type variable,\nenabling variadic generics.\nThis enables a wide variety of use cases.\nIn particular, it allows the type of array-like structures\nin numerical computing libraries such as NumPy and TensorFlow to be\nparameterised with the array shape. Static type checkers will now\nbe able to catch shape-related bugs in code that uses these libraries.\nSee PEP 646 for more details.\n(Contributed by Matthew Rahtz in bpo-43224, with contributions by\nSerhiy Storchaka and Jelle Zijlstra. PEP written by Mark Mendoza, Matthew\nRahtz, Pradeep Kumar Srinivasan, and Vincent Siles.)", "code_blocks": []}, "new-features-related-to-type-hints - pep-655-marking-individual-typeddict-items-as-required-or-not-required": {"text": "PEP 655: Marking individual TypedDict items as required or not-required\n\nRequired and NotRequired provide a\nstraightforward way to mark whether individual items in a\nTypedDict must be present. Previously, this was only possible\nusing inheritance.\nAll fields are still required by default,\nunless the total parameter is set to False,\nin which case all fields are still not-required by default.\nFor example, the following specifies a TypedDict\nwith one required and one not-required key:\nclass Movie(TypedDict):\n   title: str\n   year: NotRequired[int]\n\nm1: Movie = {\"title\": \"Black Panther\", \"year\": 2018}  # OK\nm2: Movie = {\"title\": \"Star Wars\"}  # OK (year is not required)\nm3: Movie = {\"year\": 2022}  # ERROR (missing required field title)\n\n\nThe following definition is equivalent:\nclass Movie(TypedDict, total=False):\n   title: Required[str]\n   year: int\n\n\nSee PEP 655 for more details.\n(Contributed by David Foster and Jelle Zijlstra in bpo-47087. PEP\nwritten by David Foster.)", "code_blocks": ["class Movie(TypedDict):\n   title: str\n   year: NotRequired[int]\n\nm1: Movie = {\"title\": \"Black Panther\", \"year\": 2018}  # OK\nm2: Movie = {\"title\": \"Star Wars\"}  # OK (year is not required)\nm3: Movie = {\"year\": 2022}  # ERROR (missing required field title)\n", "class Movie(TypedDict, total=False):\n   title: Required[str]\n   year: int\n"]}, "new-features-related-to-type-hints - pep-673-self-type": {"text": "PEP 673: Self type\n\nThe new Self annotation provides a simple and intuitive\nway to annotate methods that return an instance of their class. This\nbehaves the same as the TypeVar-based approach\nspecified in PEP 484,\nbut is more concise and easier to follow.\nCommon use cases include alternative constructors provided as\nclassmethods,\nand __enter__() methods that return self:\nclass MyLock:\n    def __enter__(self) -> Self:\n        self.lock()\n        return self\n\n    ...\n\nclass MyInt:\n    @classmethod\n    def fromhex(cls, s: str) -> Self:\n        return cls(int(s, 16))\n\n    ...\n\n\nSelf can also be used to annotate method parameters\nor attributes of the same type as their enclosing class.\nSee PEP 673 for more details.\n(Contributed by James Hilton-Balfe in bpo-46534. PEP written by\nPradeep Kumar Srinivasan and James Hilton-Balfe.)", "code_blocks": ["class MyLock:\n    def __enter__(self) -> Self:\n        self.lock()\n        return self\n\n    ...\n\nclass MyInt:\n    @classmethod\n    def fromhex(cls, s: str) -> Self:\n        return cls(int(s, 16))\n\n    ...\n"]}, "new-features-related-to-type-hints - pep-675-arbitrary-literal-string-type": {"text": "PEP 675: Arbitrary literal string type\n\nThe new LiteralString annotation may be used to indicate\nthat a function parameter can be of any literal string type. This allows\na function to accept arbitrary literal string types, as well as strings\ncreated from other literal strings. Type checkers can then\nenforce that sensitive functions, such as those that execute SQL\nstatements or shell commands, are called only with static arguments,\nproviding protection against injection attacks.\nFor example, a SQL query function could be annotated as follows:\ndef run_query(sql: LiteralString) -> ...\n    ...\n\ndef caller(\n    arbitrary_string: str,\n    query_string: LiteralString,\n    table_name: LiteralString,\n) -> None:\n    run_query(\"SELECT * FROM students\")       # ok\n    run_query(query_string)                   # ok\n    run_query(\"SELECT * FROM \" + table_name)  # ok\n    run_query(arbitrary_string)               # type checker error\n    run_query(                                # type checker error\n        f\"SELECT * FROM students WHERE name = {arbitrary_string}\"\n    )\n\n\nSee PEP 675 for more details.\n(Contributed by Jelle Zijlstra in bpo-47088. PEP written by Pradeep\nKumar Srinivasan and Graham Bleaney.)", "code_blocks": ["def run_query(sql: LiteralString) -> ...\n    ...\n\ndef caller(\n    arbitrary_string: str,\n    query_string: LiteralString,\n    table_name: LiteralString,\n) -> None:\n    run_query(\"SELECT * FROM students\")       # ok\n    run_query(query_string)                   # ok\n    run_query(\"SELECT * FROM \" + table_name)  # ok\n    run_query(arbitrary_string)               # type checker error\n    run_query(                                # type checker error\n        f\"SELECT * FROM students WHERE name = {arbitrary_string}\"\n    )\n"]}, "new-features-related-to-type-hints - pep-681-data-class-transforms": {"text": "PEP 681: Data class transforms\n\ndataclass_transform may be used to\ndecorate a class, metaclass, or a function that is itself a decorator.\nThe presence of @dataclass_transform() tells a static type checker that the\ndecorated object performs runtime “magic” that transforms a class,\ngiving it dataclass-like behaviors.\nFor example:\n# The create_model decorator is defined by a library.\n@typing.dataclass_transform()\ndef create_model(cls: Type[T]) -> Type[T]:\n    cls.__init__ = ...\n    cls.__eq__ = ...\n    cls.__ne__ = ...\n    return cls\n\n# The create_model decorator can now be used to create new model classes:\n@create_model\nclass CustomerModel:\n    id: int\n    name: str\n\nc = CustomerModel(id=327, name=\"Eric Idle\")\n\n\nSee PEP 681 for more details.\n(Contributed by Jelle Zijlstra in gh-91860. PEP written by\nErik De Bonte and Eric Traut.)", "code_blocks": ["# The create_model decorator is defined by a library.\n@typing.dataclass_transform()\ndef create_model(cls: Type[T]) -> Type[T]:\n    cls.__init__ = ...\n    cls.__eq__ = ...\n    cls.__ne__ = ...\n    return cls\n\n# The create_model decorator can now be used to create new model classes:\n@create_model\nclass CustomerModel:\n    id: int\n    name: str\n\nc = CustomerModel(id=327, name=\"Eric Idle\")\n"]}, "new-features-related-to-type-hints - pep-563-may-not-be-the-future": {"text": "PEP 563 may not be the future\n\nPEP 563 Postponed Evaluation of Annotations\n(the from __future__ import annotations future statement)\nthat was originally planned for release in Python 3.10\nhas been put on hold indefinitely.\nSee this message from the Steering Council\nfor more information.", "code_blocks": []}, "other-language-changes": {"text": "Other Language Changes\n\n\nStarred unpacking expressions can now be used in for statements.\n(See bpo-46725 for more details.)\nAsynchronous comprehensions are now allowed\ninside comprehensions in asynchronous functions.\nOuter comprehensions implicitly become asynchronous in this case.\n(Contributed by Serhiy Storchaka in bpo-33346.)\nA TypeError is now raised instead of an AttributeError in\nwith statements and contextlib.ExitStack.enter_context()\nfor objects that do not support the context manager protocol,\nand in async with statements and\ncontextlib.AsyncExitStack.enter_async_context()\nfor objects not supporting the asynchronous context manager protocol.\n(Contributed by Serhiy Storchaka in bpo-12022 and bpo-44471.)\nAdded object.__getstate__(), which provides the default\nimplementation of the __getstate__() method. copying\nand pickleing instances of subclasses of builtin types\nbytearray, set, frozenset,\ncollections.OrderedDict, collections.deque,\nweakref.WeakSet, and datetime.tzinfo now copies and\npickles instance attributes implemented as slots.\nThis change has an unintended side effect: It trips up a small minority\nof existing Python projects not expecting object.__getstate__() to\nexist. See the later comments on gh-70766 for discussions of what\nworkarounds such code may need.\n(Contributed by Serhiy Storchaka in bpo-26579.)\n\n\nAdded a -P command line option\nand a PYTHONSAFEPATH environment variable,\nwhich disable the automatic prepending to sys.path\nof the script’s directory when running a script,\nor the current directory when using -c and -m.\nThis ensures only stdlib and installed modules\nare picked up by import,\nand avoids unintentionally or maliciously shadowing modules\nwith those in a local (and typically user-writable) directory.\n(Contributed by Victor Stinner in gh-57684.)\nA \"z\" option was added to the Format Specification Mini-Language that\ncoerces negative to positive zero after rounding to the format precision.\nSee PEP 682 for more details.\n(Contributed by John Belmonte in gh-90153.)\nBytes are no longer accepted on sys.path.  Support broke sometime\nbetween Python 3.2 and 3.6, with no one noticing until after Python 3.10.0\nwas released. In addition, bringing back support would be problematic due to\ninteractions between -b and sys.path_importer_cache when\nthere is a mixture of str and bytes keys.\n(Contributed by Thomas Grainger in gh-91181.)", "code_blocks": []}, "other-cpython-implementation-changes": {"text": "Other CPython Implementation Changes\n\n\nThe special methods __complex__() for complex\nand __bytes__() for bytes are implemented to support\nthe typing.SupportsComplex and typing.SupportsBytes protocols.\n(Contributed by Mark Dickinson and Donghee Na in bpo-24234.)\nsiphash13 is added as a new internal hashing algorithm.\nIt has similar security properties as siphash24,\nbut it is slightly faster for long inputs.\nstr, bytes, and some other types\nnow use it as the default algorithm for hash().\nPEP 552 hash-based .pyc files\nnow use siphash13 too.\n(Contributed by Inada Naoki in bpo-29410.)\nWhen an active exception is re-raised by a raise statement with no parameters,\nthe traceback attached to this exception is now always sys.exc_info()[1].__traceback__.\nThis means that changes made to the traceback in the current except clause are\nreflected in the re-raised exception.\n(Contributed by Irit Katriel in bpo-45711.)\nThe interpreter state’s representation of handled exceptions\n(aka exc_info or _PyErr_StackItem)\nnow only has the exc_value field; exc_type and exc_traceback\nhave been removed, as they can be derived from exc_value.\n(Contributed by Irit Katriel in bpo-45711.)\nA new command line option, AppendPath,\nhas been added for the Windows installer.\nIt behaves similarly to PrependPath,\nbut appends the install and scripts directories instead of prepending them.\n(Contributed by Bastian Neuburger in bpo-44934.)\nThe PyConfig.module_search_paths_set field must now be set to 1 for\ninitialization to use PyConfig.module_search_paths to initialize\nsys.path. Otherwise, initialization will recalculate the path and replace\nany values added to module_search_paths.\nThe output of the --help option now fits in 50 lines/80 columns.\nInformation about Python environment variables\nand -X options is now available using the respective\n--help-env and --help-xoptions flags,\nand with the new --help-all.\n(Contributed by Éric Araujo in bpo-46142.)\nConverting between int and str in bases other than 2\n(binary), 4, 8 (octal), 16 (hexadecimal), or 32 such as base 10 (decimal)\nnow raises a ValueError if the number of digits in string form is\nabove a limit to avoid potential denial of service attacks due to the\nalgorithmic complexity. This is a mitigation for CVE-2020-10735.\nThis limit can be configured or disabled by environment variable, command\nline flag, or sys APIs. See the integer string conversion\nlength limitation documentation.  The default limit\nis 4300 digits in string form.", "code_blocks": []}, "new-modules": {"text": "New Modules\n\n\ntomllib: For parsing TOML.\nSee PEP 680 for more details.\n(Contributed by Taneli Hukkinen in bpo-40059.)\nwsgiref.types:\nWSGI-specific types for static type checking.\n(Contributed by Sebastian Rittau in bpo-42012.)", "code_blocks": []}, "improved-modules - asyncio": {"text": "asyncio\n\n\nAdded the TaskGroup class,\nan asynchronous context manager\nholding a group of tasks that will wait for all of them upon exit.\nFor new code this is recommended over using\ncreate_task() and gather() directly.\n(Contributed by Yury Selivanov and others in gh-90908.)\nAdded timeout(), an asynchronous context manager for\nsetting a timeout on asynchronous operations. For new code this is\nrecommended over using wait_for() directly.\n(Contributed by Andrew Svetlov in gh-90927.)\nAdded the Runner class, which exposes the machinery\nused by run().\n(Contributed by Andrew Svetlov in gh-91218.)\nAdded the Barrier class to the synchronization\nprimitives in the asyncio library, and the related\nBrokenBarrierError exception.\n(Contributed by Yves Duprat and Andrew Svetlov in gh-87518.)\nAdded keyword argument all_errors to asyncio.loop.create_connection()\nso that multiple connection errors can be raised as an ExceptionGroup.\nAdded the asyncio.StreamWriter.start_tls() method for\nupgrading existing stream-based connections to TLS.\n(Contributed by Ian Good in bpo-34975.)\nAdded raw datagram socket functions to the event loop:\nsock_sendto(),\nsock_recvfrom() and\nsock_recvfrom_into().\nThese have implementations in SelectorEventLoop and\nProactorEventLoop.\n(Contributed by Alex Grönholm in bpo-46805.)\nAdded cancelling() and\nuncancel() methods to Task.\nThese are primarily intended for internal use,\nnotably by TaskGroup.", "code_blocks": []}, "improved-modules - contextlib": {"text": "contextlib\n\n\nAdded non parallel-safe chdir() context manager to change\nthe current working directory and then restore it on exit. Simple wrapper\naround chdir(). (Contributed by Filipe Laíns in bpo-25625)", "code_blocks": []}, "improved-modules - dataclasses": {"text": "dataclasses\n\n\nChange field default mutability check, allowing only defaults which are\nhashable instead of any object which is not an instance of\ndict, list or set. (Contributed by Eric V. Smith in\nbpo-44674.)", "code_blocks": []}, "improved-modules - datetime": {"text": "datetime\n\n\nAdd datetime.UTC, a convenience alias for\ndatetime.timezone.utc. (Contributed by Kabir Kwatra in gh-91973.)\ndatetime.date.fromisoformat(), datetime.time.fromisoformat() and\ndatetime.datetime.fromisoformat() can now be used to parse most ISO 8601\nformats (barring only those that support fractional hours and minutes).\n(Contributed by Paul Ganssle in gh-80010.)", "code_blocks": []}, "improved-modules - enum": {"text": "enum\n\n\nRenamed EnumMeta to EnumType\n(EnumMeta kept as an alias).\nAdded StrEnum,\nwith members that can be used as (and must be) strings.\nAdded ReprEnum,\nwhich only modifies the __repr__() of members\nwhile returning their literal values (rather than names)\nfor __str__() and __format__()\n(used by str(), format() and f-strings).\nChanged Enum.__format__() (the default for\nformat(), str.format() and f-strings) to always produce\nthe same result as Enum.__str__():  for enums inheriting from\nReprEnum it will be the member’s value; for all other enums\nit will be the enum and member name (e.g. Color.RED).\nAdded a new boundary class parameter to Flag enums\nand the FlagBoundary enum with its options,\nto control how to handle out-of-range flag values.\nAdded the verify() enum decorator\nand the EnumCheck enum with its options,\nto check enum classes against several specific constraints.\nAdded the member() and nonmember() decorators,\nto ensure the decorated object is/is not converted to an enum member.\nAdded the property() decorator,\nwhich works like property() except for enums.\nUse this instead of types.DynamicClassAttribute().\nAdded the global_enum() enum decorator,\nwhich adjusts __repr__() and __str__()\nto show values as members of their module rather than the enum class.\nFor example, 're.ASCII' for the ASCII member\nof re.RegexFlag rather than 'RegexFlag.ASCII'.\nEnhanced Flag to support\nlen(), iteration and in/not in on its members.\nFor example, the following now works:\nlen(AFlag(3)) == 2 and list(AFlag(3)) == (AFlag.ONE, AFlag.TWO)\nChanged Enum and Flag\nso that members are now defined\nbefore __init_subclass__() is called;\ndir() now includes methods, etc., from mixed-in data types.\nChanged Flag\nto only consider primary values (power of two) canonical\nwhile composite values (3, 6, 10, etc.) are considered aliases;\ninverted flags are coerced to their positive equivalent.", "code_blocks": []}, "improved-modules - fcntl": {"text": "fcntl\n\n\nOn FreeBSD, the F_DUP2FD and F_DUP2FD_CLOEXEC flags respectively\nare supported, the former equals to dup2 usage while the latter set\nthe FD_CLOEXEC flag in addition.", "code_blocks": []}, "improved-modules - fractions": {"text": "fractions\n\n\nSupport PEP 515-style initialization of Fraction from\nstring.  (Contributed by Sergey B Kirpichev in bpo-44258.)\nFraction now implements an __int__ method, so\nthat an isinstance(some_fraction, typing.SupportsInt) check passes.\n(Contributed by Mark Dickinson in bpo-44547.)", "code_blocks": []}, "improved-modules - functools": {"text": "functools\n\n\nfunctools.singledispatch() now supports types.UnionType\nand typing.Union as annotations to the dispatch argument.:\n>>> from functools import singledispatch\n>>> @singledispatch\n... def fun(arg, verbose=False):\n...     if verbose:\n...         print(\"Let me just say,\", end=\" \")\n...     print(arg)\n...\n>>> @fun.register\n... def _(arg: int | float, verbose=False):\n...     if verbose:\n...         print(\"Strength in numbers, eh?\", end=\" \")\n...     print(arg)\n...\n>>> from typing import Union\n>>> @fun.register\n... def _(arg: Union[list, set], verbose=False):\n...     if verbose:\n...         print(\"Enumerate this:\")\n...     for i, elem in enumerate(arg):\n...         print(i, elem)\n...\n\n\n(Contributed by Yurii Karabas in bpo-46014.)", "code_blocks": [">>> from functools import singledispatch\n>>> @singledispatch\n... def fun(arg, verbose=False):\n...     if verbose:\n...         print(\"Let me just say,\", end=\" \")\n...     print(arg)\n...\n>>> @fun.register\n... def _(arg: int | float, verbose=False):\n...     if verbose:\n...         print(\"Strength in numbers, eh?\", end=\" \")\n...     print(arg)\n...\n>>> from typing import Union\n>>> @fun.register\n... def _(arg: Union[list, set], verbose=False):\n...     if verbose:\n...         print(\"Enumerate this:\")\n...     for i, elem in enumerate(arg):\n...         print(i, elem)\n...\n"]}, "improved-modules - gzip": {"text": "gzip\n\n\nThe gzip.compress() function is now faster when used with the\nmtime=0 argument as it delegates the compression entirely to a single\nzlib.compress() operation. There is one side effect of this change: The\ngzip file header contains an “OS” byte in its header. That was traditionally\nalways set to a value of 255 representing “unknown” by the gzip\nmodule. Now, when using compress() with mtime=0, it may be\nset to a different value by the underlying zlib C library Python was linked\nagainst.\n(See gh-112346 for details on the side effect.)", "code_blocks": []}, "improved-modules - hashlib": {"text": "hashlib\n\n\nhashlib.blake2b() and hashlib.blake2s() now prefer libb2\nover Python’s vendored copy.\n(Contributed by Christian Heimes in bpo-47095.)\nThe internal _sha3 module with SHA3 and SHAKE algorithms now uses\ntiny_sha3 instead of the Keccak Code Package to reduce code and binary\nsize. The hashlib module prefers optimized SHA3 and SHAKE\nimplementations from OpenSSL. The change affects only installations without\nOpenSSL support.\n(Contributed by Christian Heimes in bpo-47098.)\nAdd hashlib.file_digest(), a helper function for efficient hashing\nof files or file-like objects.\n(Contributed by Christian Heimes in gh-89313.)", "code_blocks": []}, "improved-modules - whatsnew311-idle": {"text": "IDLE and idlelib\n\n\nApply syntax highlighting to .pyi files. (Contributed by Alex\nWaygood and Terry Jan Reedy in bpo-45447.)\nInclude prompts when saving Shell with inputs and outputs.\n(Contributed by Terry Jan Reedy in gh-95191.)", "code_blocks": []}, "improved-modules - inspect": {"text": "inspect\n\n\nAdd getmembers_static() to return all members without\ntriggering dynamic lookup via the descriptor protocol. (Contributed by\nWeipeng Hong in bpo-30533.)\nAdd ismethodwrapper()\nfor checking if the type of an object is a MethodWrapperType.\n(Contributed by Hakan Çelik in bpo-29418.)\nChange the frame-related functions in the inspect module to return new\nFrameInfo and Traceback class instances\n(backwards compatible with the previous named tuple-like interfaces)\nthat includes the extended PEP 657 position information (end\nline number, column and end column). The affected functions are:\n\ninspect.getframeinfo()\ninspect.getouterframes()\ninspect.getinnerframes(),\ninspect.stack()\ninspect.trace()\n\n(Contributed by Pablo Galindo in gh-88116.)", "code_blocks": []}, "improved-modules - locale": {"text": "locale\n\n\nAdd locale.getencoding() to get the current locale encoding. It is similar to\nlocale.getpreferredencoding(False) but ignores the\nPython UTF-8 Mode.", "code_blocks": []}, "improved-modules - logging": {"text": "logging\n\n\nAdded getLevelNamesMapping()\nto return a mapping from logging level names (e.g. 'CRITICAL')\nto the values of their corresponding Logging Levels (e.g. 50, by default).\n(Contributed by Andrei Kulakovin in gh-88024.)\nAdded a createSocket() method\nto SysLogHandler, to match\nSocketHandler.createSocket().\nIt is called automatically during handler initialization\nand when emitting an event, if there is no active socket.\n(Contributed by Kirill Pinchuk in gh-88457.)", "code_blocks": []}, "improved-modules - math": {"text": "math\n\n\nAdd math.exp2(): return 2 raised to the power of x.\n(Contributed by Gideon Mitchell in bpo-45917.)\nAdd math.cbrt(): return the cube root of x.\n(Contributed by Ajith Ramachandran in bpo-44357.)\nThe behaviour of two math.pow() corner cases was changed, for\nconsistency with the IEEE 754 specification. The operations\nmath.pow(0.0, -math.inf) and math.pow(-0.0, -math.inf) now return\ninf. Previously they raised ValueError. (Contributed by Mark\nDickinson in bpo-44339.)\nThe math.nan value is now always available.\n(Contributed by Victor Stinner in bpo-46917.)", "code_blocks": []}, "improved-modules - operator": {"text": "operator\n\n\nA new function operator.call has been added, such that\noperator.call(obj, *args, **kwargs) == obj(*args, **kwargs).\n(Contributed by Antony Lee in bpo-44019.)", "code_blocks": []}, "improved-modules - os": {"text": "os\n\n\nOn Windows, os.urandom() now uses BCryptGenRandom(),\ninstead of CryptGenRandom() which is deprecated.\n(Contributed by Donghee Na in bpo-44611.)\nAs of 3.11.10, os.mkdir() and os.makedirs() on Windows\nnow support passing a mode value of 0o700 to apply access\ncontrol to the new directory. This implicitly affects\ntempfile.mkdtemp() and is a mitigation for CVE-2024-4030.\nOther values for mode continue to be ignored.\n(Contributed by Steve Dower in gh-118486.)", "code_blocks": []}, "improved-modules - pathlib": {"text": "pathlib\n\n\nglob() and rglob() return only\ndirectories if pattern ends with a pathname components separator:\nsep or altsep.\n(Contributed by Eisuke Kawasima in bpo-22276 and bpo-33392.)", "code_blocks": []}, "improved-modules - re": {"text": "re\n\n\nAtomic grouping ((?>...)) and possessive quantifiers (*+, ++,\n?+, {m,n}+) are now supported in regular expressions.\n(Contributed by Jeffrey C. Jacobs and Serhiy Storchaka in bpo-433030.)", "code_blocks": []}, "improved-modules - shutil": {"text": "shutil\n\n\nAdd optional parameter dir_fd in shutil.rmtree().\n(Contributed by Serhiy Storchaka in bpo-46245.)", "code_blocks": []}, "improved-modules - socket": {"text": "socket\n\n\nAdd CAN Socket support for NetBSD.\n(Contributed by Thomas Klausner in bpo-30512.)\ncreate_connection() has an option to raise, in case of\nfailure to connect, an ExceptionGroup containing all errors\ninstead of only raising the last error.\n(Contributed by Irit Katriel in bpo-29980.)", "code_blocks": []}, "improved-modules - sqlite3": {"text": "sqlite3\n\n\nYou can now disable the authorizer by passing None to\nset_authorizer().\n(Contributed by Erlend E. Aasland in bpo-44491.)\nCollation name create_collation() can now\ncontain any Unicode character.  Collation names with invalid characters\nnow raise UnicodeEncodeError instead of sqlite3.ProgrammingError.\n(Contributed by Erlend E. Aasland in bpo-44688.)\nsqlite3 exceptions now include the SQLite extended error code as\nsqlite_errorcode and the SQLite error name as\nsqlite_errorname.\n(Contributed by Aviv Palivoda, Daniel Shahaf, and Erlend E. Aasland in\nbpo-16379 and bpo-24139.)\nAdd setlimit() and\ngetlimit() to sqlite3.Connection for\nsetting and getting SQLite limits by connection basis.\n(Contributed by Erlend E. Aasland in bpo-45243.)\nsqlite3 now sets sqlite3.threadsafety based on the default\nthreading mode the underlying SQLite library has been compiled with.\n(Contributed by Erlend E. Aasland in bpo-45613.)\nsqlite3 C callbacks now use unraisable exceptions if callback\ntracebacks are enabled. Users can now register an\nunraisable hook handler to improve their debug\nexperience.\n(Contributed by Erlend E. Aasland in bpo-45828.)\nFetch across rollback no longer raises InterfaceError.\nInstead we leave it to the SQLite library to handle these cases.\n(Contributed by Erlend E. Aasland in bpo-44092.)\nAdd serialize() and\ndeserialize() to sqlite3.Connection for\nserializing and deserializing databases.\n(Contributed by Erlend E. Aasland in bpo-41930.)\nAdd create_window_function() to\nsqlite3.Connection for creating aggregate window functions.\n(Contributed by Erlend E. Aasland in bpo-34916.)\nAdd blobopen() to sqlite3.Connection.\nsqlite3.Blob allows incremental I/O operations on blobs.\n(Contributed by Aviv Palivoda and Erlend E. Aasland in bpo-24905.)", "code_blocks": []}, "improved-modules - string": {"text": "string\n\n\nAdd get_identifiers()\nand is_valid() to string.Template,\nwhich respectively return all valid placeholders,\nand whether any invalid placeholders are present.\n(Contributed by Ben Kehoe in gh-90465.)", "code_blocks": []}, "improved-modules - sys": {"text": "sys\n\n\nsys.exc_info() now derives the type and traceback fields\nfrom the value (the exception instance), so when an exception is\nmodified while it is being handled, the changes are reflected in\nthe results of subsequent calls to exc_info().\n(Contributed by Irit Katriel in bpo-45711.)\nAdd sys.exception() which returns the active exception instance\n(equivalent to sys.exc_info()[1]).\n(Contributed by Irit Katriel in bpo-46328.)\nAdd the sys.flags.safe_path flag.\n(Contributed by Victor Stinner in gh-57684.)", "code_blocks": []}, "improved-modules - sysconfig": {"text": "sysconfig\n\n\nThree new installation schemes\n(posix_venv, nt_venv and venv) were added and are used when Python\ncreates new virtual environments or when it is running from a virtual\nenvironment.\nThe first two schemes (posix_venv and nt_venv) are OS-specific\nfor non-Windows and Windows, the venv is essentially an alias to one of\nthem according to the OS Python runs on.\nThis is useful for downstream distributors who modify\nsysconfig.get_preferred_scheme().\nThird party code that creates new virtual environments should use the new\nvenv installation scheme to determine the paths, as does venv.\n(Contributed by Miro Hrončok in bpo-45413.)", "code_blocks": []}, "improved-modules - tempfile": {"text": "tempfile\n\n\nSpooledTemporaryFile objects now fully implement the methods\nof io.BufferedIOBase or io.TextIOBase\n(depending on file mode).\nThis lets them work correctly with APIs that expect file-like objects,\nsuch as compression modules.\n(Contributed by Carey Metcalfe in gh-70363.)\nAs of 3.11.10 on Windows, the default mode 0o700 used by\ntempfile.mkdtemp() now limits access to the new directory due to\nchanges to os.mkdir(). This is a mitigation for CVE-2024-4030.\n(Contributed by Steve Dower in gh-118486.)", "code_blocks": []}, "improved-modules - threading": {"text": "threading\n\n\nOn Unix, if the sem_clockwait() function is available in the C library\n(glibc 2.30 and newer), the threading.Lock.acquire() method now uses\nthe monotonic clock (time.CLOCK_MONOTONIC) for the timeout, rather\nthan using the system clock (time.CLOCK_REALTIME), to not be affected\nby system clock changes.\n(Contributed by Victor Stinner in bpo-41710.)", "code_blocks": []}, "improved-modules - time": {"text": "time\n\n\nOn Unix, time.sleep() now uses the clock_nanosleep() or\nnanosleep() function, if available, which has a resolution of 1 nanosecond\n(10-9 seconds), rather than using select() which has a resolution\nof 1 microsecond (10-6 seconds).\n(Contributed by Benjamin Szőke and Victor Stinner in bpo-21302.)\nOn Windows 8.1 and newer, time.sleep() now uses a waitable timer based\non high-resolution timers\nwhich has a resolution of 100 nanoseconds (10-7 seconds). Previously,\nit had a resolution of 1 millisecond (10-3 seconds).\n(Contributed by Benjamin Szőke, Donghee Na, Eryk Sun and Victor Stinner in bpo-21302 and bpo-45429.)", "code_blocks": []}, "improved-modules - tkinter": {"text": "tkinter\n\n\nAdded method info_patchlevel() which returns the exact version of\nthe Tcl library as a named tuple similar to sys.version_info.\n(Contributed by Serhiy Storchaka in gh-91827.)", "code_blocks": []}, "improved-modules - traceback": {"text": "traceback\n\n\nAdd traceback.StackSummary.format_frame_summary() to allow users\nto override which frames appear in the traceback, and how they are\nformatted.\n(Contributed by Ammar Askar in bpo-44569.)\nAdd traceback.TracebackException.print(), which prints the\nformatted TracebackException instance to a file.\n(Contributed by Irit Katriel in bpo-33809.)", "code_blocks": []}, "improved-modules - typing": {"text": "typing\n\nFor major changes, see New Features Related to Type Hints.\n\nAdd typing.assert_never() and typing.Never.\ntyping.assert_never() is useful for asking a type checker to confirm\nthat a line of code is not reachable. At runtime, it raises an\nAssertionError.\n(Contributed by Jelle Zijlstra in gh-90633.)\nAdd typing.reveal_type(). This is useful for asking a type checker\nwhat type it has inferred for a given expression. At runtime it prints\nthe type of the received value.\n(Contributed by Jelle Zijlstra in gh-90572.)\nAdd typing.assert_type(). This is useful for asking a type checker\nto confirm that the type it has inferred for a given expression matches\nthe given type. At runtime it simply returns the received value.\n(Contributed by Jelle Zijlstra in gh-90638.)\ntyping.TypedDict types can now be generic. (Contributed by\nSamodya Abeysiriwardane in gh-89026.)\nNamedTuple types can now be generic.\n(Contributed by Serhiy Storchaka in bpo-43923.)\nAllow subclassing of typing.Any. This is useful for avoiding\ntype checker errors related to highly dynamic class, such as mocks.\n(Contributed by Shantanu Jain in gh-91154.)\nThe typing.final() decorator now sets the __final__ attributed on\nthe decorated object.\n(Contributed by Jelle Zijlstra in gh-90500.)\nThe typing.get_overloads() function can be used for introspecting\nthe overloads of a function. typing.clear_overloads() can be used\nto clear all registered overloads of a function.\n(Contributed by Jelle Zijlstra in gh-89263.)\nThe __init__() method of Protocol subclasses\nis now preserved. (Contributed by Adrian Garcia Badarasco in gh-88970.)\nThe representation of empty tuple types (Tuple[()]) is simplified.\nThis affects introspection, e.g. get_args(Tuple[()]) now evaluates\nto () instead of ((),).\n(Contributed by Serhiy Storchaka in gh-91137.)\nLoosen runtime requirements for type annotations by removing the callable\ncheck in the private typing._type_check function. (Contributed by\nGregory Beauregard in gh-90802.)\ntyping.get_type_hints() now supports evaluating strings as forward\nreferences in PEP 585 generic aliases.\n(Contributed by Niklas Rosenstein in gh-85542.)\ntyping.get_type_hints() no longer adds Optional\nto parameters with None as a default. (Contributed by Nikita Sobolev\nin gh-90353.)\ntyping.get_type_hints() now supports evaluating bare stringified\nClassVar annotations. (Contributed by Gregory Beauregard\nin gh-90711.)\ntyping.no_type_check() no longer modifies external classes and functions.\nIt also now correctly marks classmethods as not to be type checked. (Contributed\nby Nikita Sobolev in gh-90729.)", "code_blocks": []}, "improved-modules - unicodedata": {"text": "unicodedata\n\n\nThe Unicode database has been updated to version 14.0.0.\n(Contributed by Benjamin Peterson in bpo-45190).", "code_blocks": []}, "improved-modules - unittest": {"text": "unittest\n\n\nAdded methods enterContext() and\nenterClassContext() of class\nTestCase, method\nenterAsyncContext() of\nclass IsolatedAsyncioTestCase and function\nunittest.enterModuleContext().\n(Contributed by Serhiy Storchaka in bpo-45046.)", "code_blocks": []}, "improved-modules - venv": {"text": "venv\n\n\nWhen new Python virtual environments are created, the venv\nsysconfig installation scheme is used\nto determine the paths inside the environment.\nWhen Python runs in a virtual environment, the same installation scheme\nis the default.\nThat means that downstream distributors can change the default sysconfig install\nscheme without changing behavior of virtual environments.\nThird party code that also creates new virtual environments should do the same.\n(Contributed by Miro Hrončok in bpo-45413.)", "code_blocks": []}, "improved-modules - warnings": {"text": "warnings\n\n\nwarnings.catch_warnings() now accepts arguments for warnings.simplefilter(),\nproviding a more concise way to locally ignore warnings or convert them to errors.\n(Contributed by Zac Hatfield-Dodds in bpo-47074.)", "code_blocks": []}, "improved-modules - zipfile": {"text": "zipfile\n\n\nAdded support for specifying member name encoding for reading metadata\nin a ZipFile’s directory and file headers.\n(Contributed by Stephen J. Turnbull and Serhiy Storchaka in bpo-28080.)\nAdded ZipFile.mkdir()\nfor creating new directories inside ZIP archives.\n(Contributed by Sam Ezeh in gh-49083.)\nAdded stem, suffix\nand suffixes to zipfile.Path.\n(Contributed by Miguel Brito in gh-88261.)", "code_blocks": []}, "optimizations": {"text": "Optimizations\n\nThis section covers specific optimizations independent of the\nFaster CPython project, which is covered in its own section.\n\nThe compiler now optimizes simple\nprintf-style % formatting on string literals\ncontaining only the format codes %s, %r and %a and makes it as\nfast as a corresponding f-string expression.\n(Contributed by Serhiy Storchaka in bpo-28307.)\nInteger division (//) is better tuned for optimization by compilers.\nIt is now around 20% faster on x86-64 when dividing an int\nby a value smaller than 2**30.\n(Contributed by Gregory P. Smith and Tim Peters in gh-90564.)\nsum() is now nearly 30% faster for integers smaller than 2**30.\n(Contributed by Stefan Behnel in gh-68264.)\nResizing lists is streamlined for the common case,\nspeeding up list.append() by ≈15%\nand simple list comprehensions by up to 20-30%\n(Contributed by Dennis Sweeney in gh-91165.)\nDictionaries don’t store hash values when all keys are Unicode objects,\ndecreasing dict size.\nFor example, sys.getsizeof(dict.fromkeys(\"abcdefg\"))\nis reduced from 352 bytes to 272 bytes (23% smaller) on 64-bit platforms.\n(Contributed by Inada Naoki in bpo-46845.)\nUsing asyncio.DatagramProtocol is now orders of magnitude faster\nwhen transferring large files over UDP,\nwith speeds over 100 times higher for a ≈60 MiB file.\n(Contributed by msoxzw in gh-91487.)\nmath functions comb() and perm() are now\n≈10 times faster for large arguments (with a larger speedup for larger k).\n(Contributed by Serhiy Storchaka in bpo-37295.)\nThe statistics functions mean(),\nvariance() and stdev() now consume\niterators in one pass rather than converting them to a list first.\nThis is twice as fast and can save substantial memory.\n(Contributed by Raymond Hettinger in gh-90415.)\nunicodedata.normalize()\nnow normalizes pure-ASCII strings in constant time.\n(Contributed by Donghee Na in bpo-44987.)", "code_blocks": []}, "faster-cpython - faster-startup": {"text": "Faster Startup\n\n\nFrozen imports / Static code objects\n\nPython caches bytecode in the __pycache__\ndirectory to speed up module loading.\nPreviously in 3.10, Python module execution looked like this:\nRead __pycache__ -> Unmarshal -> Heap allocated code object -> Evaluate\n\n\nIn Python 3.11, the core modules essential for Python startup are “frozen”.\nThis means that their Code Objects (and bytecode)\nare statically allocated by the interpreter.\nThis reduces the steps in module execution process to:\nStatically allocated code object -> Evaluate\n\n\nInterpreter startup is now 10-15% faster in Python 3.11. This has a big\nimpact for short-running programs using Python.\n(Contributed by Eric Snow, Guido van Rossum and Kumar Aditya in many issues.)", "code_blocks": ["Read __pycache__ -> Unmarshal -> Heap allocated code object -> Evaluate\n", "Statically allocated code object -> Evaluate\n"]}, "faster-cpython - faster-runtime": {"text": "Faster Runtime\n\n\nCheaper, lazy Python frames\n\nPython frames, holding execution information,\nare created whenever Python calls a Python function.\nThe following are new frame optimizations:\n\nStreamlined the frame creation process.\nAvoided memory allocation by generously re-using frame space on the C stack.\nStreamlined the internal frame struct to contain only essential information.\nFrames previously held extra debugging and memory management information.\n\nOld-style frame objects\nare now created only when requested by debuggers\nor by Python introspection functions such as sys._getframe() and\ninspect.currentframe(). For most user code, no frame objects are\ncreated at all. As a result, nearly all Python functions calls have sped\nup significantly. We measured a 3-7% speedup in pyperformance.\n(Contributed by Mark Shannon in bpo-44590.)\n\n\nInlined Python function calls\n\nDuring a Python function call, Python will call an evaluating C function to\ninterpret that function’s code. This effectively limits pure Python recursion to\nwhat’s safe for the C stack.\nIn 3.11, when CPython detects Python code calling another Python function,\nit sets up a new frame, and “jumps” to the new code inside the new frame. This\navoids calling the C interpreting function altogether.\nMost Python function calls now consume no C stack space, speeding them up.\nIn simple recursive functions like fibonacci or\nfactorial, we observed a 1.7x speedup. This also means recursive functions\ncan recurse significantly deeper\n(if the user increases the recursion limit with sys.setrecursionlimit()).\nWe measured a 1-3% improvement in pyperformance.\n(Contributed by Pablo Galindo and Mark Shannon in bpo-45256.)\n\n\nPEP 659: Specializing Adaptive Interpreter\n\nPEP 659 is one of the key parts of the Faster CPython project. The general\nidea is that while Python is a dynamic language, most code has regions where\nobjects and types rarely change. This concept is known as type stability.\nAt runtime, Python will try to look for common patterns and type stability\nin the executing code. Python will then replace the current operation with a\nmore specialized one. This specialized operation uses fast paths available only\nto those use cases/types, which generally outperform their generic\ncounterparts. This also brings in another concept called inline caching, where\nPython caches the results of expensive operations directly in the\nbytecode.\nThe specializer will also combine certain common instruction pairs into one\nsuperinstruction, reducing the overhead during execution.\nPython will only specialize\nwhen it sees code that is “hot” (executed multiple times). This prevents Python\nfrom wasting time on run-once code. Python can also de-specialize when code is\ntoo dynamic or when the use changes. Specialization is attempted periodically,\nand specialization attempts are not too expensive,\nallowing specialization to adapt to new circumstances.\n(PEP written by Mark Shannon, with ideas inspired by Stefan Brunthaler.\nSee PEP 659 for more information. Implementation by Mark Shannon and Brandt\nBucher, with additional help from Irit Katriel and Dennis Sweeney.)\n\n\nOperation\nForm\nSpecialization\nOperation speedup\n(up to)\nContributor(s)\n\n\n\nBinary\noperations\nx + x\nx - x\nx * x\n\nBinary add, multiply and subtract for common types\nsuch as int, float and str\ntake custom fast paths for their underlying types.\n10%\nMark Shannon,\nDonghee Na,\nBrandt Bucher,\nDennis Sweeney\n\nSubscript\na[i]\nSubscripting container types such as list,\ntuple and dict directly index\nthe underlying data structures.\nSubscripting custom __getitem__()\nis also inlined similar to Inlined Python function calls.\n\n10-25%\nIrit Katriel,\nMark Shannon\n\nStore\nsubscript\na[i] = z\nSimilar to subscripting specialization above.\n10-25%\nDennis Sweeney\n\nCalls\nf(arg)\nC(arg)\n\nCalls to common builtin (C) functions and types such\nas len() and str directly call their\nunderlying C version. This avoids going through the\ninternal calling convention.\n20%\nMark Shannon,\nKen Jin\n\nLoad\nglobal\nvariable\nprint\nlen\n\nThe object’s index in the globals/builtins namespace\nis cached. Loading globals and builtins require\nzero namespace lookups.\n[1]\nMark Shannon\n\nLoad\nattribute\no.attr\nSimilar to loading global variables. The attribute’s\nindex inside the class/object’s namespace is cached.\nIn most cases, attribute loading will require zero\nnamespace lookups.\n[2]\nMark Shannon\n\nLoad\nmethods for\ncall\no.meth()\nThe actual address of the method is cached. Method\nloading now has no namespace lookups – even for\nclasses with long inheritance chains.\n10-20%\nKen Jin,\nMark Shannon\n\nStore\nattribute\no.attr = z\nSimilar to load attribute optimization.\n2%\nin pyperformance\nMark Shannon\n\nUnpack\nSequence\n*seq\nSpecialized for common containers such as\nlist and tuple.\nAvoids internal calling convention.\n8%\nBrandt Bucher\n\n\n\n\n\n[1]\nA similar optimization already existed since Python 3.8.\n3.11 specializes for more forms and reduces some overhead.\n\n\n[2]\nA similar optimization already existed since Python 3.10.\n3.11 specializes for more forms. Furthermore, all attribute loads should\nbe sped up by bpo-45947.", "code_blocks": []}, "faster-cpython - misc": {"text": "Misc\n\n\nObjects now require less memory due to lazily created object namespaces.\nTheir namespace dictionaries now also share keys more freely.\n(Contributed Mark Shannon in bpo-45340 and bpo-40116.)\n“Zero-cost” exceptions are implemented, eliminating the cost\nof try statements when no exception is raised.\n(Contributed by Mark Shannon in bpo-40222.)\nA more concise representation of exceptions in the interpreter reduced the\ntime required for catching an exception by about 10%.\n(Contributed by Irit Katriel in bpo-45711.)\nre’s regular expression matching engine has been partially refactored,\nand now uses computed gotos (or “threaded code”) on supported platforms. As a\nresult, Python 3.11 executes the pyperformance regular expression benchmarks up to 10%\nfaster than Python 3.10.\n(Contributed by Brandt Bucher in gh-91404.)", "code_blocks": []}, "faster-cpython - faq": {"text": "FAQ\n\n\nHow should I write my code to utilize these speedups?\n\nWrite Pythonic code that follows common best practices;\nyou don’t have to change your code.\nThe Faster CPython project optimizes for common code patterns we observe.\n\n\nWill CPython 3.11 use more memory?\n\nMaybe not; we don’t expect memory use to exceed 20% higher than 3.10.\nThis is offset by memory optimizations for frame objects and object\ndictionaries as mentioned above.\n\n\nI don’t see any speedups in my workload. Why?\n\nCertain code won’t have noticeable benefits. If your code spends most of\nits time on I/O operations, or already does most of its\ncomputation in a C extension library like NumPy, there won’t be significant\nspeedups. This project currently benefits pure-Python workloads the most.\nFurthermore, the pyperformance figures are a geometric mean. Even within the\npyperformance benchmarks, certain benchmarks have slowed down slightly, while\nothers have sped up by nearly 2x!\n\n\nIs there a JIT compiler?\n\nNo. We’re still exploring other optimizations.", "code_blocks": []}, "faster-cpython - about": {"text": "About\n\nFaster CPython explores optimizations for CPython. The main team is\nfunded by Microsoft to work on this full-time. Pablo Galindo Salgado is also\nfunded by Bloomberg LP to work on the project part-time. Finally, many\ncontributors are volunteers from the community.", "code_blocks": []}, "cpython-bytecode-changes - new-opcodes": {"text": "New opcodes\n\n\nASYNC_GEN_WRAP, RETURN_GENERATOR and SEND,\nused in generators and co-routines.\nCOPY_FREE_VARS,\nwhich avoids needing special caller-side code for closures.\nJUMP_BACKWARD_NO_INTERRUPT,\nfor use in certain loops where handling interrupts is undesirable.\nMAKE_CELL, to create Cell Objects.\nCHECK_EG_MATCH  and  PREP_RERAISE_STAR,\nto handle the new exception groups and except*\nadded in PEP 654.\nPUSH_EXC_INFO, for use in exception handlers.\nRESUME, a no-op,\nfor internal tracing, debugging and optimization checks.", "code_blocks": []}, "cpython-bytecode-changes - replaced-opcodes": {"text": "Replaced opcodes\n\n\n\nReplaced Opcode(s)\nNew Opcode(s)\nNotes\n\n\n\n\nBINARY_*\nINPLACE_*\n\n\nBINARY_OP\nReplaced all numeric binary/in-place\nopcodes with a single opcode\n\n\nCALL_FUNCTION\nCALL_FUNCTION_KW\nCALL_METHOD\n\n\n\nCALL\nKW_NAMES\nPRECALL\nPUSH_NULL\n\n\nDecouples argument shifting for methods\nfrom handling of keyword arguments;\nallows better specialization of calls\n\n\nDUP_TOP\nDUP_TOP_TWO\nROT_TWO\nROT_THREE\nROT_FOUR\nROT_N\n\n\n\nCOPY\nSWAP\n\n\nStack manipulation instructions\n\n\nJUMP_IF_NOT_EXC_MATCH\n\n\n\nCHECK_EXC_MATCH\n\n\nNow performs check but doesn’t jump\n\n\nJUMP_ABSOLUTE\nPOP_JUMP_IF_FALSE\nPOP_JUMP_IF_TRUE\n\n\n\nJUMP_BACKWARD\nPOP_JUMP_BACKWARD_IF_*\nPOP_JUMP_FORWARD_IF_*\n\n\nSee [3];\nTRUE, FALSE,\nNONE and NOT_NONE variants\nfor each direction\n\n\nSETUP_WITH\nSETUP_ASYNC_WITH\n\n\nBEFORE_WITH\nwith block setup\n\n\n\n\n\n[3]\nAll jump opcodes are now relative, including the\nexisting JUMP_IF_TRUE_OR_POP and JUMP_IF_FALSE_OR_POP.\nThe argument is now an offset from the current instruction\nrather than an absolute location.", "code_blocks": []}, "cpython-bytecode-changes - changed-removed-opcodes": {"text": "Changed/removed opcodes\n\n\nChanged MATCH_CLASS and MATCH_KEYS\nto no longer push an additional boolean value to indicate success/failure.\nInstead, None is pushed on failure\nin place of the tuple of extracted values.\nChanged opcodes that work with exceptions to reflect them\nnow being represented as one item on the stack instead of three\n(see gh-89874).\nRemoved COPY_DICT_WITHOUT_KEYS, GEN_START,\nPOP_BLOCK, SETUP_FINALLY and YIELD_FROM.", "code_blocks": []}, "deprecated - language-builtins": {"text": "Language/Builtins\n\n\nChaining classmethod descriptors (introduced in bpo-19072)\nis now deprecated.  It can no longer be used to wrap other descriptors\nsuch as property.  The core design of this feature was flawed\nand caused a number of downstream problems.  To “pass-through” a\nclassmethod, consider using the __wrapped__ attribute\nthat was added in Python 3.10.\n(Contributed by Raymond Hettinger in gh-89519.)\nOctal escapes in string and bytes literals with values larger than 0o377\n(255 in decimal) now produce a DeprecationWarning.\nIn a future Python version, they will raise a SyntaxWarning and\neventually a SyntaxError.\n(Contributed by Serhiy Storchaka in gh-81548.)\nThe delegation of int() to __trunc__() is now deprecated.\nCalling int(a) when type(a) implements __trunc__() but not\n__int__() or __index__() now raises\na DeprecationWarning.\n(Contributed by Zackery Spytz in bpo-44977.)", "code_blocks": []}, "deprecated - modules": {"text": "Modules\n\n\nPEP 594 led to the deprecations of the following modules\nslated for removal in Python 3.13:\n\n\naifc\nchunk\nmsilib\npipes\ntelnetlib\n\naudioop\ncrypt\nnis\nsndhdr\nuu\n\ncgi\nimghdr\nnntplib\nspwd\nxdrlib\n\ncgitb\nmailcap\nossaudiodev\nsunau\n\n\n\n\n(Contributed by Brett Cannon in bpo-47061 and Victor Stinner in\ngh-68966.)\n\nThe asynchat, asyncore and  smtpd modules have been\ndeprecated since at least Python 3.6. Their documentation and deprecation\nwarnings have now been updated to note they will be removed in Python 3.12.\n(Contributed by Hugo van Kemenade in bpo-47022.)\nThe lib2to3 package and 2to3 tool\nare now deprecated and may not be able to parse Python 3.10 or newer.\nSee PEP 617, introducing the new PEG parser, for details.\n(Contributed by Victor Stinner in bpo-40360.)\nUndocumented modules sre_compile, sre_constants\nand sre_parse are now deprecated.\n(Contributed by Serhiy Storchaka in bpo-47152.)", "code_blocks": []}, "deprecated - standard-library": {"text": "Standard Library\n\n\nThe following have been deprecated in configparser since Python 3.2.\nTheir deprecation warnings have now been updated to note they will be removed\nin Python 3.12:\n\nthe configparser.SafeConfigParser class\nthe configparser.ParsingError.filename property\nthe configparser.RawConfigParser.readfp() method\n\n(Contributed by Hugo van Kemenade in bpo-45173.)\n\nconfigparser.LegacyInterpolation has been deprecated in the docstring\nsince Python 3.2, and is not listed in the configparser documentation.\nIt now emits a DeprecationWarning and will be removed\nin Python 3.13. Use configparser.BasicInterpolation or\nconfigparser.ExtendedInterpolation instead.\n(Contributed by Hugo van Kemenade in bpo-46607.)\nThe older set of importlib.resources functions were deprecated\nin favor of the replacements added in Python 3.9\nand will be removed in a future Python version,\ndue to not supporting resources located within package subdirectories:\n\nimportlib.resources.contents()\nimportlib.resources.is_resource()\nimportlib.resources.open_binary()\nimportlib.resources.open_text()\nimportlib.resources.read_binary()\nimportlib.resources.read_text()\nimportlib.resources.path()\n\n\nThe locale.getdefaultlocale() function is deprecated and will be\nremoved in Python 3.15. Use locale.setlocale(),\nlocale.getpreferredencoding(False) and\nlocale.getlocale() functions instead.\n(Contributed by Victor Stinner in gh-90817.)\nThe locale.resetlocale() function is deprecated and will be\nremoved in Python 3.13. Use locale.setlocale(locale.LC_ALL, \"\") instead.\n(Contributed by Victor Stinner in gh-90817.)\nStricter rules will now be applied for numerical group references\nand group names in regular expressions.\nOnly sequences of ASCII digits will now be accepted as a numerical reference,\nand the group name in bytes patterns and replacement strings\ncan only contain ASCII letters, digits and underscores.\nFor now, a deprecation warning is raised for syntax violating these rules.\n(Contributed by Serhiy Storchaka in gh-91760.)\nIn the re module, the re.template() function\nand the corresponding re.TEMPLATE and re.T flags\nare deprecated, as they were undocumented and lacked an obvious purpose.\nThey will be removed in Python 3.13.\n(Contributed by Serhiy Storchaka and Miro Hrončok in gh-92728.)\nturtle.settiltangle() has been deprecated since Python 3.1;\nit now emits a deprecation warning and will be removed in Python 3.13. Use\nturtle.tiltangle() instead (it was earlier incorrectly marked\nas deprecated, and its docstring is now corrected).\n(Contributed by Hugo van Kemenade in bpo-45837.)\ntyping.Text, which exists solely to provide compatibility support\nbetween Python 2 and Python 3 code, is now deprecated. Its removal is\ncurrently unplanned, but users are encouraged to use str instead\nwherever possible.\n(Contributed by Alex Waygood in gh-92332.)\nThe keyword argument syntax for constructing typing.TypedDict types\nis now deprecated. Support will be removed in Python 3.13. (Contributed by\nJingchen Ye in gh-90224.)\nwebbrowser.MacOSX is deprecated and will be removed in Python 3.13.\nIt is untested, undocumented, and not used by webbrowser itself.\n(Contributed by Donghee Na in bpo-42255.)\nThe behavior of returning a value from a TestCase and\nIsolatedAsyncioTestCase test methods (other than the\ndefault None value) is now deprecated.\nDeprecated the following not-formally-documented unittest functions,\nscheduled for removal in Python 3.13:\n\nunittest.findTestCases()\nunittest.makeSuite()\nunittest.getTestCaseNames()\n\nUse TestLoader methods instead:\n\nunittest.TestLoader.loadTestsFromModule()\nunittest.TestLoader.loadTestsFromTestCase()\nunittest.TestLoader.getTestCaseNames()\n\n(Contributed by Erlend E. Aasland in bpo-5846.)\n\nunittest.TestProgram.usageExit() is marked deprecated, to be removed\nin 3.13.\n(Contributed by Carlos Damázio in gh-67048.)", "code_blocks": []}, "pending-removal-in-python-3-12": {"text": "Pending Removal in Python 3.12\n\nThe following Python APIs have been deprecated in earlier Python releases,\nand will be removed in Python 3.12.\nC APIs pending removal are\nlisted separately.\n\nThe asynchat module\nThe asyncore module\nThe entire distutils package\nThe imp module\nThe typing.io namespace\nThe typing.re namespace\ncgi.log()\nimportlib.find_loader()\nimportlib.abc.Loader.module_repr()\nimportlib.abc.MetaPathFinder.find_module()\nimportlib.abc.PathEntryFinder.find_loader()\nimportlib.abc.PathEntryFinder.find_module()\nimportlib.machinery.BuiltinImporter.find_module()\nimportlib.machinery.BuiltinLoader.module_repr()\nimportlib.machinery.FileFinder.find_loader()\nimportlib.machinery.FileFinder.find_module()\nimportlib.machinery.FrozenImporter.find_module()\nimportlib.machinery.FrozenLoader.module_repr()\nimportlib.machinery.PathFinder.find_module()\nimportlib.machinery.WindowsRegistryFinder.find_module()\nimportlib.util.module_for_loader()\nimportlib.util.set_loader_wrapper()\nimportlib.util.set_package_wrapper()\npkgutil.ImpImporter\npkgutil.ImpLoader\npathlib.Path.link_to()\nsqlite3.enable_shared_cache()\nsqlite3.OptimizedUnicode()\nPYTHONTHREADDEBUG environment variable\nThe following deprecated aliases in unittest:\n\n\n\nDeprecated alias\nMethod Name\nDeprecated in\n\n\n\nfailUnless\nassertTrue()\n3.1\n\nfailIf\nassertFalse()\n3.1\n\nfailUnlessEqual\nassertEqual()\n3.1\n\nfailIfEqual\nassertNotEqual()\n3.1\n\nfailUnlessAlmostEqual\nassertAlmostEqual()\n3.1\n\nfailIfAlmostEqual\nassertNotAlmostEqual()\n3.1\n\nfailUnlessRaises\nassertRaises()\n3.1\n\nassert_\nassertTrue()\n3.2\n\nassertEquals\nassertEqual()\n3.2\n\nassertNotEquals\nassertNotEqual()\n3.2\n\nassertAlmostEquals\nassertAlmostEqual()\n3.2\n\nassertNotAlmostEquals\nassertNotAlmostEqual()\n3.2\n\nassertRegexpMatches\nassertRegex()\n3.2\n\nassertRaisesRegexp\nassertRaisesRegex()\n3.2\n\nassertNotRegexpMatches\nassertNotRegex()\n3.5", "code_blocks": []}, "removed": {"text": "Removed\n\nThis section lists Python APIs that have been removed in Python 3.11.\nRemoved C APIs are listed separately.\n\nRemoved the @asyncio.coroutine() decorator\nenabling legacy generator-based coroutines to be compatible with\nasync / await code.\nThe function has been deprecated since Python 3.8 and the removal was\ninitially scheduled for Python 3.10. Use async def instead.\n(Contributed by Illia Volochii in bpo-43216.)\nRemoved asyncio.coroutines.CoroWrapper used for wrapping legacy\ngenerator-based coroutine objects in the debug mode.\n(Contributed by Illia Volochii in bpo-43216.)\nDue to significant security concerns, the reuse_address parameter of\nasyncio.loop.create_datagram_endpoint(), disabled in Python 3.9, is\nnow entirely removed. This is because of the behavior of the socket option\nSO_REUSEADDR in UDP.\n(Contributed by Hugo van Kemenade in bpo-45129.)\nRemoved the binhex module, deprecated in Python 3.9.\nAlso removed the related, similarly-deprecated binascii functions:\n\nbinascii.a2b_hqx()\nbinascii.b2a_hqx()\nbinascii.rlecode_hqx()\nbinascii.rldecode_hqx()\n\nThe binascii.crc_hqx() function remains available.\n(Contributed by Victor Stinner in bpo-45085.)\n\nRemoved the distutils bdist_msi command deprecated in Python 3.9.\nUse bdist_wheel (wheel packages) instead.\n(Contributed by Hugo van Kemenade in bpo-45124.)\nRemoved the __getitem__() methods of\nxml.dom.pulldom.DOMEventStream, wsgiref.util.FileWrapper\nand fileinput.FileInput, deprecated since Python 3.9.\n(Contributed by Hugo van Kemenade in bpo-45132.)\nRemoved the deprecated gettext functions\nlgettext(), ldgettext(),\nlngettext() and ldngettext().\nAlso removed the bind_textdomain_codeset() function,\nthe NullTranslations.output_charset() and\nNullTranslations.set_output_charset() methods,\nand the codeset parameter of translation() and install(),\nsince they are only used for the l*gettext() functions.\n(Contributed by Donghee Na and Serhiy Storchaka in bpo-44235.)\nRemoved from the inspect module:\n\nThe getargspec() function, deprecated since Python 3.0;\nuse inspect.signature() or inspect.getfullargspec() instead.\nThe formatargspec() function, deprecated since Python 3.5;\nuse the inspect.signature() function\nor the inspect.Signature object directly.\nThe undocumented Signature.from_builtin()\nand Signature.from_function() methods, deprecated since Python 3.5;\nuse the Signature.from_callable()\nmethod instead.\n\n(Contributed by Hugo van Kemenade in bpo-45320.)\n\nRemoved the __class_getitem__() method\nfrom pathlib.PurePath,\nbecause it was not used and added by mistake in previous versions.\n(Contributed by Nikita Sobolev in bpo-46483.)\nRemoved the MailmanProxy class in the smtpd module,\nas it is unusable without the external mailman package.\n(Contributed by Donghee Na in bpo-35800.)\nRemoved the deprecated split() method of _tkinter.TkappType.\n(Contributed by Erlend E. Aasland in bpo-38371.)\nRemoved namespace package support from unittest discovery.\nIt was introduced in Python 3.4 but has been broken since Python 3.7.\n(Contributed by Inada Naoki in bpo-23882.)\nRemoved the undocumented private float.__set_format__() method,\npreviously known as float.__setformat__() in Python 3.7.\nIts docstring said: “You probably don’t want to use this function.\nIt exists mainly to be used in Python’s test suite.”\n(Contributed by Victor Stinner in bpo-46852.)\nThe --experimental-isolated-subinterpreters configure flag\n(and corresponding EXPERIMENTAL_ISOLATED_SUBINTERPRETERS macro)\nhave been removed.\nPynche\n— The Pythonically Natural Color and Hue Editor — has been moved out\nof Tools/scripts and is being developed independently from the Python source tree.", "code_blocks": []}, "porting-to-python-3-11": {"text": "Porting to Python 3.11\n\nThis section lists previously described changes and other bugfixes\nin the Python API that may require changes to your Python code.\nPorting notes for the C API are\nlisted separately.\n\nopen(), io.open(), codecs.open() and\nfileinput.FileInput no longer accept 'U' (“universal newline”)\nin the file mode. In Python 3, “universal newline” mode is used by default\nwhenever a file is opened in text mode,\nand the 'U' flag has been deprecated since Python 3.3.\nThe newline parameter\nto these functions controls how universal newlines work.\n(Contributed by Victor Stinner in bpo-37330.)\nast.AST node positions are now validated when provided to\ncompile() and other related functions. If invalid positions are detected,\na ValueError will be raised. (Contributed by Pablo Galindo in gh-93351)\nProhibited passing non-concurrent.futures.ThreadPoolExecutor\nexecutors to asyncio.loop.set_default_executor()\nfollowing a deprecation in Python 3.8.\n(Contributed by Illia Volochii in bpo-43234.)\ncalendar: The calendar.LocaleTextCalendar and\ncalendar.LocaleHTMLCalendar classes now use\nlocale.getlocale(), instead of using locale.getdefaultlocale(),\nif no locale is specified.\n(Contributed by Victor Stinner in bpo-46659.)\nThe pdb module now reads the .pdbrc configuration file with\nthe 'UTF-8' encoding.\n(Contributed by Srinivas Reddy Thatiparthy (శ్రీనివాస్  రెడ్డి తాటిపర్తి) in bpo-41137.)\nThe population parameter of random.sample() must be a sequence,\nand automatic conversion of sets to lists\nis no longer supported. Also, if the sample size\nis larger than the population size, a ValueError is raised.\n(Contributed by Raymond Hettinger in bpo-40465.)\nThe random optional parameter of random.shuffle() was removed.\nIt was previously an arbitrary random function to use for the shuffle;\nnow, random.random() (its previous default) will always be used.\nIn re Regular Expression Syntax, global inline flags (e.g. (?i))\ncan now only be used at the start of regular expressions.\nUsing them elsewhere has been deprecated since Python 3.6.\n(Contributed by Serhiy Storchaka in bpo-47066.)\nIn the re module, several long-standing bugs where fixed that,\nin rare cases, could cause capture groups to get the wrong result.\nTherefore, this could change the captured output in these cases.\n(Contributed by Ma Lin in bpo-35859.)", "code_blocks": []}, "build-changes": {"text": "Build Changes\n\n\nCPython now has PEP 11 Tier 3 support for\ncross compiling to the WebAssembly platforms\nEmscripten\n(wasm32-unknown-emscripten, i.e. Python in the browser)\nand WebAssembly System Interface (WASI)\n(wasm32-unknown-wasi).\nThe effort is inspired by previous work like Pyodide.\nThese platforms provide a limited subset of POSIX APIs; Python standard\nlibraries features and modules related to networking, processes, threading,\nsignals, mmap, and users/groups are not available or don’t work.\n(Emscripten contributed by Christian Heimes and Ethan Smith in gh-84461\nand WASI contributed by Christian Heimes in gh-90473;\nplatforms promoted in gh-95085)\nBuilding CPython now requires:\n\nA C11 compiler and standard library.\nOptional C11 features\nare not required.\n(Contributed by Victor Stinner in bpo-46656,\nbpo-45440 and bpo-46640.)\nSupport for IEEE 754\nfloating point numbers.\n(Contributed by Victor Stinner in bpo-46917.)\n\n\nThe Py_NO_NAN macro has been removed.\nSince CPython now requires IEEE 754 floats, NaN values are always available.\n(Contributed by Victor Stinner in bpo-46656.)\nThe tkinter package now requires Tcl/Tk\nversion 8.5.12 or newer.\n(Contributed by Serhiy Storchaka in bpo-46996.)\nBuild dependencies, compiler flags, and linker flags for most stdlib\nextension modules are now detected by configure. libffi, libnsl,\nlibsqlite3, zlib, bzip2, liblzma, libcrypt, Tcl/Tk, and uuid flags\nare detected by pkg-config (when available).\ntkinter now requires a pkg-config command\nto detect development settings for Tcl/Tk headers and libraries.\n(Contributed by Christian Heimes and Erlend Egeberg Aasland in\nbpo-45847, bpo-45747, and bpo-45763.)\nlibpython is no longer linked against libcrypt.\n(Contributed by Mike Gilbert in bpo-45433.)\nCPython can now be built with the\nThinLTO option\nvia passing thin to --with-lto, i.e. --with-lto=thin.\n(Contributed by Donghee Na and Brett Holman in bpo-44340.)\nFreelists for object structs can now be disabled. A new configure\noption --without-freelists can be used to disable all freelists\nexcept empty tuple singleton.\n(Contributed by Christian Heimes in bpo-45522.)\nModules/Setup and Modules/makesetup have been improved and tied up.\nExtension modules can now be built through makesetup. All except some\ntest modules can be linked statically into a main binary or library.\n(Contributed by Brett Cannon and Christian Heimes in bpo-45548,\nbpo-45570, bpo-45571, and bpo-43974.)\n\nNote\nUse the environment variables TCLTK_CFLAGS and\nTCLTK_LIBS to manually specify the location of Tcl/Tk headers\nand libraries. The configure options\n--with-tcltk-includes and --with-tcltk-libs\nhave been removed.\nOn RHEL 7 and CentOS 7 the development packages do not provide tcl.pc\nand tk.pc; use TCLTK_LIBS=\"-ltk8.5 -ltkstub8.5 -ltcl8.5\".\nThe directory Misc/rhel7 contains .pc files and instructions\non how to build Python with RHEL 7’s and CentOS 7’s Tcl/Tk and OpenSSL.\n\n\nCPython will now use 30-bit digits by default for the Python int\nimplementation. Previously, the default was to use 30-bit digits on platforms\nwith SIZEOF_VOID_P >= 8, and 15-bit digits otherwise. It’s still possible\nto explicitly request use of 15-bit digits via either the\n--enable-big-digits option to the configure script\nor (for Windows) the PYLONG_BITS_IN_DIGIT variable in PC/pyconfig.h,\nbut this option may be removed at some point in the future.\n(Contributed by Mark Dickinson in bpo-45569.)", "code_blocks": []}, "c-api-changes - whatsnew311-c-api-new-features": {"text": "New Features\n\n\nAdd a new PyType_GetName() function to get type’s short name.\n(Contributed by Hai Shi in bpo-42035.)\nAdd a new PyType_GetQualName() function to get type’s qualified name.\n(Contributed by Hai Shi in bpo-42035.)\nAdd new PyThreadState_EnterTracing() and\nPyThreadState_LeaveTracing() functions to the limited C API to\nsuspend and resume tracing and profiling.\n(Contributed by Victor Stinner in bpo-43760.)\nAdded the Py_Version constant which bears the same value as\nPY_VERSION_HEX.\n(Contributed by  Gabriele N. Tornetta in bpo-43931.)\nPy_buffer and APIs are now part of the limited API and the stable\nABI:\n\nPyObject_CheckBuffer()\nPyObject_GetBuffer()\nPyBuffer_GetPointer()\nPyBuffer_SizeFromFormat()\nPyBuffer_ToContiguous()\nPyBuffer_FromContiguous()\nPyObject_CopyData()\nPyBuffer_IsContiguous()\nPyBuffer_FillContiguousStrides()\nPyBuffer_FillInfo()\nPyBuffer_Release()\nPyMemoryView_FromBuffer()\nbf_getbuffer and\nbf_releasebuffer type slots\n\n(Contributed by Christian Heimes in bpo-45459.)\n\nAdded the PyType_GetModuleByDef() function, used to get the module\nin which a method was defined, in cases where this information is not\navailable directly (via PyCMethod).\n(Contributed by Petr Viktorin in bpo-46613.)\nAdd new functions to pack and unpack C double (serialize and deserialize):\nPyFloat_Pack2(), PyFloat_Pack4(), PyFloat_Pack8(),\nPyFloat_Unpack2(), PyFloat_Unpack4() and\nPyFloat_Unpack8().\n(Contributed by Victor Stinner in bpo-46906.)\nAdd new functions to get frame object attributes:\nPyFrame_GetBuiltins(), PyFrame_GetGenerator(),\nPyFrame_GetGlobals(), PyFrame_GetLasti().\nAdded two new functions to get and set the active exception instance:\nPyErr_GetHandledException() and PyErr_SetHandledException().\nThese are alternatives to PyErr_SetExcInfo() and\nPyErr_GetExcInfo() which work with the legacy 3-tuple\nrepresentation of exceptions.\n(Contributed by Irit Katriel in bpo-46343.)\nAdded the PyConfig.safe_path member.\n(Contributed by Victor Stinner in gh-57684.)", "code_blocks": []}, "c-api-changes - whatsnew311-c-api-porting": {"text": "Porting to Python 3.11\n\n\nSome macros have been converted to static inline functions to avoid\nmacro pitfalls.\nThe change should be mostly transparent to users,\nas the replacement functions will cast their arguments to the expected types\nto avoid compiler warnings due to static type checks.\nHowever, when the limited C API is set to >=3.11,\nthese casts are not done,\nand callers will need to cast arguments to their expected types.\nSee PEP 670 for more details.\n(Contributed by Victor Stinner and Erlend E. Aasland in gh-89653.)\nPyErr_SetExcInfo() no longer uses the type and traceback\narguments, the interpreter now derives those values from the exception\ninstance (the value argument). The function still steals references\nof all three arguments.\n(Contributed by Irit Katriel in bpo-45711.)\nPyErr_GetExcInfo() now derives the type and traceback\nfields of the result from the exception instance (the value field).\n(Contributed by Irit Katriel in bpo-45711.)\n_frozen has a new is_package field to indicate whether\nor not the frozen module is a package.  Previously, a negative value\nin the size field was the indicator.  Now only non-negative values\nbe used for size.\n(Contributed by Kumar Aditya in bpo-46608.)\n_PyFrameEvalFunction() now takes _PyInterpreterFrame*\nas its second parameter, instead of PyFrameObject*.\nSee PEP 523 for more details of how to use this function pointer type.\nPyCode_New() and PyCode_NewWithPosOnlyArgs() now take\nan additional exception_table argument.\nUsing these functions should be avoided, if at all possible.\nTo get a custom code object: create a code object using the compiler,\nthen get a modified version with the replace method.\nPyCodeObject no longer has the co_code, co_varnames,\nco_cellvars and co_freevars fields.  Instead, use\nPyCode_GetCode(), PyCode_GetVarnames(),\nPyCode_GetCellvars() and PyCode_GetFreevars() respectively\nto access them via the C API.\n(Contributed by Brandt Bucher in bpo-46841 and Ken Jin in gh-92154\nand gh-94936.)\nThe old trashcan macros (Py_TRASHCAN_SAFE_BEGIN/Py_TRASHCAN_SAFE_END)\nare now deprecated. They should be replaced by the new macros\nPy_TRASHCAN_BEGIN and Py_TRASHCAN_END.\nA tp_dealloc function that has the old macros, such as:\nstatic void\nmytype_dealloc(mytype *p)\n{\n    PyObject_GC_UnTrack(p);\n    Py_TRASHCAN_SAFE_BEGIN(p);\n    ...\n    Py_TRASHCAN_SAFE_END\n}\n\n\nshould migrate to the new macros as follows:\nstatic void\nmytype_dealloc(mytype *p)\n{\n    PyObject_GC_UnTrack(p);\n    Py_TRASHCAN_BEGIN(p, mytype_dealloc)\n    ...\n    Py_TRASHCAN_END\n}\n\n\nNote that Py_TRASHCAN_BEGIN has a second argument which\nshould be the deallocation function it is in.\nTo support older Python versions in the same codebase, you\ncan define the following macros and use them throughout\nthe code (credit: these were copied from the mypy codebase):\n#if PY_VERSION_HEX >= 0x03080000\n#  define CPy_TRASHCAN_BEGIN(op, dealloc) Py_TRASHCAN_BEGIN(op, dealloc)\n#  define CPy_TRASHCAN_END(op) Py_TRASHCAN_END\n#else\n#  define CPy_TRASHCAN_BEGIN(op, dealloc) Py_TRASHCAN_SAFE_BEGIN(op)\n#  define CPy_TRASHCAN_END(op) Py_TRASHCAN_SAFE_END(op)\n#endif\n\n\n\nThe PyType_Ready() function now raises an error if a type is defined\nwith the Py_TPFLAGS_HAVE_GC flag set but has no traverse function\n(PyTypeObject.tp_traverse).\n(Contributed by Victor Stinner in bpo-44263.)\nHeap types with the Py_TPFLAGS_IMMUTABLETYPE flag can now inherit\nthe PEP 590 vectorcall protocol.  Previously, this was only possible for\nstatic types.\n(Contributed by Erlend E. Aasland in bpo-43908)\nSince Py_TYPE() is changed to a inline static function,\nPy_TYPE(obj) = new_type must be replaced with\nPy_SET_TYPE(obj, new_type): see the Py_SET_TYPE() function\n(available since Python 3.9). For backward compatibility, this macro can be\nused:\n#if PY_VERSION_HEX < 0x030900A4 && !defined(Py_SET_TYPE)\nstatic inline void _Py_SET_TYPE(PyObject *ob, PyTypeObject *type)\n{ ob->ob_type = type; }\n#define Py_SET_TYPE(ob, type) _Py_SET_TYPE((PyObject*)(ob), type)\n#endif\n\n\n(Contributed by Victor Stinner in bpo-39573.)\n\nSince Py_SIZE() is changed to a inline static function,\nPy_SIZE(obj) = new_size must be replaced with\nPy_SET_SIZE(obj, new_size): see the Py_SET_SIZE() function\n(available since Python 3.9). For backward compatibility, this macro can be\nused:\n#if PY_VERSION_HEX < 0x030900A4 && !defined(Py_SET_SIZE)\nstatic inline void _Py_SET_SIZE(PyVarObject *ob, Py_ssize_t size)\n{ ob->ob_size = size; }\n#define Py_SET_SIZE(ob, size) _Py_SET_SIZE((PyVarObject*)(ob), size)\n#endif\n\n\n(Contributed by Victor Stinner in bpo-39573.)\n\n<Python.h> no longer includes the header files <stdlib.h>,\n<stdio.h>, <errno.h> and <string.h> when the Py_LIMITED_API\nmacro is set to 0x030b0000 (Python 3.11) or higher. C extensions should\nexplicitly include the header files after #include <Python.h>.\n(Contributed by Victor Stinner in bpo-45434.)\nThe non-limited API files cellobject.h, classobject.h, code.h, context.h,\nfuncobject.h, genobject.h and longintrepr.h have been moved to\nthe Include/cpython directory. Moreover, the eval.h header file was\nremoved. These files must not be included directly, as they are already\nincluded in Python.h: Include Files. If they have\nbeen included directly, consider including Python.h instead.\n(Contributed by Victor Stinner in bpo-35134.)\nThe PyUnicode_CHECK_INTERNED() macro has been excluded from the\nlimited C API. It was never usable there, because it used internal structures\nwhich are not available in the limited C API.\n(Contributed by Victor Stinner in bpo-46007.)\nThe following frame functions and type are now directly available with\n#include <Python.h>, it’s no longer needed to add\n#include <frameobject.h>:\n\nPyFrame_Check()\nPyFrame_GetBack()\nPyFrame_GetBuiltins()\nPyFrame_GetGenerator()\nPyFrame_GetGlobals()\nPyFrame_GetLasti()\nPyFrame_GetLocals()\nPyFrame_Type\n\n(Contributed by Victor Stinner in gh-93937.)\n\n\n\nThe PyFrameObject structure members have been removed from the\npublic C API.\nWhile the documentation notes that the PyFrameObject fields are\nsubject to change at any time, they have been stable for a long time and were\nused in several popular extensions.\nIn Python 3.11, the frame struct was reorganized to allow performance\noptimizations. Some fields were removed entirely, as they were details of the\nold implementation.\nPyFrameObject fields:\n\nf_back: use PyFrame_GetBack().\nf_blockstack: removed.\nf_builtins: use PyFrame_GetBuiltins().\nf_code: use PyFrame_GetCode().\nf_gen: use PyFrame_GetGenerator().\nf_globals: use PyFrame_GetGlobals().\nf_iblock: removed.\nf_lasti: use PyFrame_GetLasti().\nCode using f_lasti with PyCode_Addr2Line() should use\nPyFrame_GetLineNumber() instead; it may be faster.\nf_lineno: use PyFrame_GetLineNumber()\nf_locals: use PyFrame_GetLocals().\nf_stackdepth: removed.\nf_state: no public API (renamed to f_frame.f_state).\nf_trace: no public API.\nf_trace_lines: use PyObject_GetAttrString((PyObject*)frame, \"f_trace_lines\").\nf_trace_opcodes: use PyObject_GetAttrString((PyObject*)frame, \"f_trace_opcodes\").\nf_localsplus: no public API (renamed to f_frame.localsplus).\nf_valuestack: removed.\n\nThe Python frame object is now created lazily. A side effect is that the\nf_back member must not be accessed directly,\nsince its value is now also\ncomputed lazily. The PyFrame_GetBack() function must be called\ninstead.\nDebuggers that accessed the f_locals directly must call\nPyFrame_GetLocals() instead. They no longer need to call\nPyFrame_FastToLocalsWithError() or PyFrame_LocalsToFast(),\nin fact they should not call those functions. The necessary updating of the\nframe is now managed by the virtual machine.\nCode defining PyFrame_GetCode() on Python 3.8 and older:\n#if PY_VERSION_HEX < 0x030900B1\nstatic inline PyCodeObject* PyFrame_GetCode(PyFrameObject *frame)\n{\n    Py_INCREF(frame->f_code);\n    return frame->f_code;\n}\n#endif\n\n\nCode defining PyFrame_GetBack() on Python 3.8 and older:\n#if PY_VERSION_HEX < 0x030900B1\nstatic inline PyFrameObject* PyFrame_GetBack(PyFrameObject *frame)\n{\n    Py_XINCREF(frame->f_back);\n    return frame->f_back;\n}\n#endif\n\n\nOr use the pythoncapi_compat project to get these two\nfunctions on older Python versions.\n\nChanges of the PyThreadState structure members:\n\nframe: removed, use PyThreadState_GetFrame() (function added\nto Python 3.9 by bpo-40429).\nWarning: the function returns a strong reference, need to call\nPy_XDECREF().\ntracing: changed, use PyThreadState_EnterTracing()\nand PyThreadState_LeaveTracing()\n(functions added to Python 3.11 by bpo-43760).\nrecursion_depth: removed,\nuse (tstate->recursion_limit - tstate->recursion_remaining) instead.\nstackcheck_counter: removed.\n\nCode defining PyThreadState_GetFrame() on Python 3.8 and older:\n#if PY_VERSION_HEX < 0x030900B1\nstatic inline PyFrameObject* PyThreadState_GetFrame(PyThreadState *tstate)\n{\n    Py_XINCREF(tstate->frame);\n    return tstate->frame;\n}\n#endif\n\n\nCode defining PyThreadState_EnterTracing() and\nPyThreadState_LeaveTracing() on Python 3.10 and older:\n#if PY_VERSION_HEX < 0x030B00A2\nstatic inline void PyThreadState_EnterTracing(PyThreadState *tstate)\n{\n    tstate->tracing++;\n#if PY_VERSION_HEX >= 0x030A00A1\n    tstate->cframe->use_tracing = 0;\n#else\n    tstate->use_tracing = 0;\n#endif\n}\n\nstatic inline void PyThreadState_LeaveTracing(PyThreadState *tstate)\n{\n    int use_tracing = (tstate->c_tracefunc != NULL || tstate->c_profilefunc != NULL);\n    tstate->tracing--;\n#if PY_VERSION_HEX >= 0x030A00A1\n    tstate->cframe->use_tracing = use_tracing;\n#else\n    tstate->use_tracing = use_tracing;\n#endif\n}\n#endif\n\n\nOr use the pythoncapi-compat project to get these functions\non old Python functions.\n\nDistributors are encouraged to build Python with the optimized Blake2\nlibrary libb2.\nThe PyConfig.module_search_paths_set field must now be set to 1 for\ninitialization to use PyConfig.module_search_paths to initialize\nsys.path. Otherwise, initialization will recalculate the path and replace\nany values added to module_search_paths.\nPyConfig_Read() no longer calculates the initial search path, and will not\nfill any values into PyConfig.module_search_paths. To calculate default\npaths and then modify them, finish initialization and use PySys_GetObject()\nto retrieve sys.path as a Python list object and modify it directly.", "code_blocks": ["static void\nmytype_dealloc(mytype *p)\n{\n    PyObject_GC_UnTrack(p);\n    Py_TRASHCAN_SAFE_BEGIN(p);\n    ...\n    Py_TRASHCAN_SAFE_END\n}\n", "static void\nmytype_dealloc(mytype *p)\n{\n    PyObject_GC_UnTrack(p);\n    Py_TRASHCAN_BEGIN(p, mytype_dealloc)\n    ...\n    Py_TRASHCAN_END\n}\n", "#if PY_VERSION_HEX >= 0x03080000\n#  define CPy_TRASHCAN_BEGIN(op, dealloc) Py_TRASHCAN_BEGIN(op, dealloc)\n#  define CPy_TRASHCAN_END(op) Py_TRASHCAN_END\n#else\n#  define CPy_TRASHCAN_BEGIN(op, dealloc) Py_TRASHCAN_SAFE_BEGIN(op)\n#  define CPy_TRASHCAN_END(op) Py_TRASHCAN_SAFE_END(op)\n#endif\n", "#if PY_VERSION_HEX < 0x030900A4 && !defined(Py_SET_TYPE)\nstatic inline void _Py_SET_TYPE(PyObject *ob, PyTypeObject *type)\n{ ob->ob_type = type; }\n#define Py_SET_TYPE(ob, type) _Py_SET_TYPE((PyObject*)(ob), type)\n#endif\n", "#if PY_VERSION_HEX < 0x030900A4 && !defined(Py_SET_SIZE)\nstatic inline void _Py_SET_SIZE(PyVarObject *ob, Py_ssize_t size)\n{ ob->ob_size = size; }\n#define Py_SET_SIZE(ob, size) _Py_SET_SIZE((PyVarObject*)(ob), size)\n#endif\n", "#if PY_VERSION_HEX < 0x030900B1\nstatic inline PyCodeObject* PyFrame_GetCode(PyFrameObject *frame)\n{\n    Py_INCREF(frame->f_code);\n    return frame->f_code;\n}\n#endif\n", "#if PY_VERSION_HEX < 0x030900B1\nstatic inline PyFrameObject* PyFrame_GetBack(PyFrameObject *frame)\n{\n    Py_XINCREF(frame->f_back);\n    return frame->f_back;\n}\n#endif\n", "#if PY_VERSION_HEX < 0x030900B1\nstatic inline PyFrameObject* PyThreadState_GetFrame(PyThreadState *tstate)\n{\n    Py_XINCREF(tstate->frame);\n    return tstate->frame;\n}\n#endif\n", "#if PY_VERSION_HEX < 0x030B00A2\nstatic inline void PyThreadState_EnterTracing(PyThreadState *tstate)\n{\n    tstate->tracing++;\n#if PY_VERSION_HEX >= 0x030A00A1\n    tstate->cframe->use_tracing = 0;\n#else\n    tstate->use_tracing = 0;\n#endif\n}\n\nstatic inline void PyThreadState_LeaveTracing(PyThreadState *tstate)\n{\n    int use_tracing = (tstate->c_tracefunc != NULL || tstate->c_profilefunc != NULL);\n    tstate->tracing--;\n#if PY_VERSION_HEX >= 0x030A00A1\n    tstate->cframe->use_tracing = use_tracing;\n#else\n    tstate->use_tracing = use_tracing;\n#endif\n}\n#endif\n"]}, "c-api-changes - whatsnew311-c-api-deprecated": {"text": "Deprecated\n\n\nDeprecate the following functions to configure the Python initialization:\n\nPySys_AddWarnOptionUnicode()\nPySys_AddWarnOption()\nPySys_AddXOption()\nPySys_HasWarnOptions()\nPySys_SetArgvEx()\nPySys_SetArgv()\nPySys_SetPath()\nPy_SetPath()\nPy_SetProgramName()\nPy_SetPythonHome()\nPy_SetStandardStreamEncoding()\n_Py_SetProgramFullPath()\n\nUse the new PyConfig API of the Python Initialization Configuration instead (PEP 587).\n(Contributed by Victor Stinner in gh-88279.)\n\nDeprecate the ob_shash member of the PyBytesObject. Use PyObject_Hash() instead.\n(Contributed by Inada Naoki in bpo-46864.)", "code_blocks": []}, "c-api-changes - whatsnew311-c-api-pending-removal": {"text": "Pending Removal in Python 3.12\n\nThe following C APIs have been deprecated in earlier Python releases,\nand will be removed in Python 3.12.\n\nPyUnicode_AS_DATA()\nPyUnicode_AS_UNICODE()\nPyUnicode_AsUnicodeAndSize()\nPyUnicode_AsUnicode()\nPyUnicode_FromUnicode()\nPyUnicode_GET_DATA_SIZE()\nPyUnicode_GET_SIZE()\nPyUnicode_GetSize()\nPyUnicode_IS_COMPACT()\nPyUnicode_IS_READY()\nPyUnicode_READY()\nPyUnicode_WSTR_LENGTH()\n_PyUnicode_AsUnicode()\nPyUnicode_WCHAR_KIND\nPyUnicodeObject\nPyUnicode_InternImmortal()", "code_blocks": []}, "c-api-changes - whatsnew311-c-api-removed": {"text": "Removed\n\n\nPyFrame_BlockSetup() and PyFrame_BlockPop() have been\nremoved.\n(Contributed by Mark Shannon in bpo-40222.)\nRemove the following math macros using the errno variable:\n\nPy_ADJUST_ERANGE1()\nPy_ADJUST_ERANGE2()\nPy_OVERFLOWED()\nPy_SET_ERANGE_IF_OVERFLOW()\nPy_SET_ERRNO_ON_MATH_ERROR()\n\n(Contributed by Victor Stinner in bpo-45412.)\n\nRemove Py_UNICODE_COPY() and Py_UNICODE_FILL() macros, deprecated\nsince Python 3.3. Use PyUnicode_CopyCharacters() or memcpy()\n(wchar_t* string), and PyUnicode_Fill() functions instead.\n(Contributed by Victor Stinner in bpo-41123.)\nRemove the pystrhex.h header file. It only contains private functions.\nC extensions should only include the main <Python.h> header file.\n(Contributed by Victor Stinner in bpo-45434.)\nRemove the Py_FORCE_DOUBLE() macro. It was used by the\nPy_IS_INFINITY() macro.\n(Contributed by Victor Stinner in bpo-45440.)\nThe following items are no longer available when Py_LIMITED_API\nis defined:\n\nPyMarshal_WriteLongToFile()\nPyMarshal_WriteObjectToFile()\nPyMarshal_ReadObjectFromString()\nPyMarshal_WriteObjectToString()\nthe Py_MARSHAL_VERSION macro\n\nThese are not part of the limited API.\n(Contributed by Victor Stinner in bpo-45474.)\n\nExclude PyWeakref_GET_OBJECT() from the limited C API. It never\nworked since the PyWeakReference structure is opaque in the\nlimited C API.\n(Contributed by Victor Stinner in bpo-35134.)\nRemove the PyHeapType_GET_MEMBERS() macro. It was exposed in the\npublic C API by mistake, it must only be used by Python internally.\nUse the PyTypeObject.tp_members member instead.\n(Contributed by Victor Stinner in bpo-40170.)\nRemove the HAVE_PY_SET_53BIT_PRECISION macro (moved to the internal C\nAPI).\n(Contributed by Victor Stinner in bpo-45412.)\n\n\nRemove the Py_UNICODE encoder APIs,\nas they have been deprecated since Python 3.3,\nare little used\nand are inefficient relative to the recommended alternatives.\nThe removed functions are:\n\nPyUnicode_Encode()\nPyUnicode_EncodeASCII()\nPyUnicode_EncodeLatin1()\nPyUnicode_EncodeUTF7()\nPyUnicode_EncodeUTF8()\nPyUnicode_EncodeUTF16()\nPyUnicode_EncodeUTF32()\nPyUnicode_EncodeUnicodeEscape()\nPyUnicode_EncodeRawUnicodeEscape()\nPyUnicode_EncodeCharmap()\nPyUnicode_TranslateCharmap()\nPyUnicode_EncodeDecimal()\nPyUnicode_TransformDecimalToASCII()\n\nSee PEP 624 for details and\nmigration guidance.\n(Contributed by Inada Naoki in bpo-44029.)", "code_blocks": []}, "notable-changes-in-3-11-4 - tarfile": {"text": "tarfile\n\n\nThe extraction methods in tarfile, and shutil.unpack_archive(),\nhave a new a filter argument that allows limiting tar features than may be\nsurprising or dangerous, such as creating files outside the destination\ndirectory.\nSee Extraction filters for details.\nIn Python 3.12, use without the filter argument will show a\nDeprecationWarning.\nIn Python 3.14, the default will switch to 'data'.\n(Contributed by Petr Viktorin in PEP 706.)", "code_blocks": []}, "notable-changes-in-3-11-5 - openssl": {"text": "OpenSSL\n\n\nWindows builds and macOS installers from python.org now use OpenSSL 3.0.", "code_blocks": []}, "notable-changes-in-3-11-10 - ipaddress": {"text": "ipaddress\n\n\nFixed is_global and is_private behavior in IPv4Address,\nIPv6Address, IPv4Network and IPv6Network.", "code_blocks": []}, "notable-changes-in-3-11-10 - email": {"text": "email\n\n\nHeaders with embedded newlines are now quoted on output.\nThe generator will now refuse to serialize (write) headers\nthat are improperly folded or delimited, such that they would be parsed as\nmultiple headers or joined with adjacent data.\nIf you need to turn this safety feature off,\nset verify_generated_headers.\n(Contributed by Bas Bloemsaat and Petr Viktorin in gh-121650.)\n\nemail.utils.getaddresses() and email.utils.parseaddr() now return\n('', '') 2-tuples in more situations where invalid email addresses are\nencountered, instead of potentially inaccurate values.\nAn optional strict parameter was added to these two functions:\nuse strict=False to get the old behavior, accepting malformed inputs.\ngetattr(email.utils, 'supports_strict_parsing', False) can be used to\ncheck if the strict paramater is available.\n(Contributed by Thomas Dwyer and Victor Stinner for gh-102988 to improve\nthe CVE-2023-27043 fix.)", "code_blocks": []}}}
{"index": 14, "python_version": "3.12", "url": "https://docs.python.org/3.12/whatsnew/3.12.html", "sections": {"summary-release-highlights": {"text": "Summary – Release highlights\n\nPython 3.12 is the latest stable release of the Python programming language,\nwith a mix of changes to the language and the standard library.\nThe library changes focus on cleaning up deprecated APIs, usability, and correctness.\nOf note, the distutils package has been removed from the standard library.\nFilesystem support in os and pathlib has seen a number of improvements,\nand several modules have better performance.\nThe language changes focus on usability,\nas f-strings have had many limitations removed\nand ‘Did you mean …’ suggestions continue to improve.\nThe new type parameter syntax\nand type statement improve ergonomics for using generic types and type aliases with static type checkers.\nThis article doesn’t attempt to provide a complete specification of all new features,\nbut instead gives a convenient overview.\nFor full details, you should refer to the documentation,\nsuch as the  Library Reference\nand Language Reference.\nIf you want to understand the complete implementation and design rationale for a change,\nrefer to the PEP for a particular new feature;\nbut note that PEPs usually are not kept up-to-date\nonce a feature has been fully implemented.\n\nNew syntax features:\n\nPEP 695, type parameter syntax and the type statement\n\nNew grammar features:\n\nPEP 701, f-strings in the grammar\n\nInterpreter improvements:\n\nPEP 684, a unique per-interpreter GIL\nPEP 669, low impact monitoring\nImproved ‘Did you mean …’ suggestions\nfor NameError, ImportError, and SyntaxError exceptions\n\nPython data model improvements:\n\nPEP 688, using the buffer protocol from Python\n\nSignificant improvements in the standard library:\n\nThe pathlib.Path class now supports subclassing\nThe os module received several improvements for Windows support\nA command-line interface has been added to the\nsqlite3 module\nisinstance() checks against runtime-checkable protocols enjoy a speed up of between two and 20 times\nThe asyncio package has had a number of performance improvements,\nwith some benchmarks showing a 75% speed up.\nA command-line interface has been added to the\nuuid module\nDue to the changes in PEP 701,\nproducing tokens via the tokenize module is up to 64% faster.\n\nSecurity improvements:\n\nReplace the builtin hashlib implementations of\nSHA1, SHA3, SHA2-384, SHA2-512, and MD5 with formally verified code from the\nHACL* project.\nThese builtin implementations remain as fallbacks that are only used when\nOpenSSL does not provide them.\n\nC API improvements:\n\nPEP 697, unstable C API tier\nPEP 683, immortal objects\n\nCPython implementation improvements:\n\nPEP 709, comprehension inlining\nCPython support for the Linux perf profiler\nImplement stack overflow protection on supported platforms\n\nNew typing features:\n\nPEP 692, using TypedDict to\nannotate **kwargs\nPEP 698, typing.override() decorator\n\nImportant deprecations, removals or restrictions:\n\nPEP 623: Remove wstr from Unicode objects in Python’s C API,\nreducing the size of every str object by at least 8 bytes.\nPEP 632: Remove the distutils package.\nSee the migration guide\nfor advice replacing the APIs it provided.\nThe third-party Setuptools\npackage continues to provide distutils,\nif you still require it in Python 3.12 and beyond.\ngh-95299: Do not pre-install setuptools in virtual environments\ncreated with venv.\nThis means that distutils, setuptools, pkg_resources,\nand easy_install will no longer available by default; to access these\nrun pip install setuptools in the activated\nvirtual environment.\nThe asynchat, asyncore, and imp modules have been\nremoved, along with several unittest.TestCase\nmethod aliases.", "code_blocks": []}, "new-features - pep-695-type-parameter-syntax": {"text": "PEP 695: Type Parameter Syntax\n\nGeneric classes and functions under PEP 484 were declared using a verbose syntax\nthat left the scope of type parameters unclear and required explicit declarations of\nvariance.\nPEP 695 introduces a new, more compact and explicit way to create\ngeneric classes and functions:\ndef max[T](args: Iterable[T]) -> T:\n    ...\n\nclass list[T]:\n    def __getitem__(self, index: int, /) -> T:\n        ...\n\n    def append(self, element: T) -> None:\n        ...\n\n\nIn addition, the PEP introduces a new way to declare type aliases\nusing the type statement, which creates an instance of\nTypeAliasType:\ntype Point = tuple[float, float]\n\n\nType aliases can also be generic:\ntype Point[T] = tuple[T, T]\n\n\nThe new syntax allows declaring TypeVarTuple\nand ParamSpec parameters, as well as TypeVar\nparameters with bounds or constraints:\ntype IntFunc[**P] = Callable[P, int]  # ParamSpec\ntype LabeledTuple[*Ts] = tuple[str, *Ts]  # TypeVarTuple\ntype HashableSequence[T: Hashable] = Sequence[T]  # TypeVar with bound\ntype IntOrStrSequence[T: (int, str)] = Sequence[T]  # TypeVar with constraints\n\n\nThe value of type aliases and the bound and constraints of type variables\ncreated through this syntax are evaluated only on demand (see\nlazy evaluation). This means type aliases are able to\nrefer to other types defined later in the file.\nType parameters declared through a type parameter list are visible within the\nscope of the declaration and any nested scopes, but not in the outer scope. For\nexample, they can be used in the type annotations for the methods of a generic\nclass or in the class body. However, they cannot be used in the module scope after\nthe class is defined. See Type parameter lists for a detailed description of the\nruntime semantics of type parameters.\nIn order to support these scoping semantics, a new kind of scope is introduced,\nthe annotation scope. Annotation scopes behave for the\nmost part like function scopes, but interact differently with enclosing class scopes.\nIn Python 3.13, annotations will also be evaluated in\nannotation scopes.\nSee PEP 695 for more details.\n(PEP written by Eric Traut. Implementation by Jelle Zijlstra, Eric Traut,\nand others in gh-103764.)", "code_blocks": ["def max[T](args: Iterable[T]) -> T:\n    ...\n\nclass list[T]:\n    def __getitem__(self, index: int, /) -> T:\n        ...\n\n    def append(self, element: T) -> None:\n        ...\n", "type Point = tuple[float, float]\n", "type Point[T] = tuple[T, T]\n", "type IntFunc[**P] = Callable[P, int]  # ParamSpec\ntype LabeledTuple[*Ts] = tuple[str, *Ts]  # TypeVarTuple\ntype HashableSequence[T: Hashable] = Sequence[T]  # TypeVar with bound\ntype IntOrStrSequence[T: (int, str)] = Sequence[T]  # TypeVar with constraints\n"]}, "new-features - pep-701-syntactic-formalization-of-f-strings": {"text": "PEP 701: Syntactic formalization of f-strings\n\nPEP 701 lifts some restrictions on the usage of f-strings.\nExpression components inside f-strings can now be any valid Python expression,\nincluding strings reusing the same quote as the containing f-string,\nmulti-line expressions, comments, backslashes, and unicode escape sequences.\nLet’s cover these in detail:\n\nQuote reuse: in Python 3.11, reusing the same quotes as the enclosing f-string\nraises a SyntaxError, forcing the user to either use other available\nquotes (like using double quotes or triple quotes if the f-string uses single\nquotes). In Python 3.12, you can now do things like this:\n>>> songs = ['Take me back to Eden', 'Alkaline', 'Ascensionism']\n>>> f\"This is the playlist: {\", \".join(songs)}\"\n'This is the playlist: Take me back to Eden, Alkaline, Ascensionism'\n\n\nNote that before this change there was no explicit limit in how f-strings can\nbe nested, but the fact that string quotes cannot be reused inside the\nexpression component of f-strings made it impossible to nest f-strings\narbitrarily. In fact, this is the most nested f-string that could be written:\n>>> f\"\"\"{f'''{f'{f\"{1+1}\"}'}'''}\"\"\"\n'2'\n\n\nAs now f-strings can contain any valid Python expression inside expression\ncomponents, it is now possible to nest f-strings arbitrarily:\n>>> f\"{f\"{f\"{f\"{f\"{f\"{1+1}\"}\"}\"}\"}\"}\"\n'2'\n\n\n\nMulti-line expressions and comments: In Python 3.11, f-string expressions\nmust be defined in a single line, even if the expression within the f-string\ncould normally span multiple lines\n(like literal lists being defined over multiple lines),\nmaking them harder to read. In Python 3.12 you can now define f-strings\nspanning multiple lines, and add inline comments:\n>>> f\"This is the playlist: {\", \".join([\n...     'Take me back to Eden',  # My, my, those eyes like fire\n...     'Alkaline',              # Not acid nor alkaline\n...     'Ascensionism'           # Take to the broken skies at last\n... ])}\"\n'This is the playlist: Take me back to Eden, Alkaline, Ascensionism'\n\n\n\nBackslashes and unicode characters: before Python 3.12 f-string expressions\ncouldn’t contain any \\ character. This also affected unicode escape\nsequences (such as \\N{snowman}) as these contain\nthe \\N part that previously could not be part of expression components of\nf-strings. Now, you can define expressions like this:\n>>> print(f\"This is the playlist: {\"\\n\".join(songs)}\")\nThis is the playlist: Take me back to Eden\nAlkaline\nAscensionism\n>>> print(f\"This is the playlist: {\"\\N{BLACK HEART SUIT}\".join(songs)}\")\nThis is the playlist: Take me back to Eden♥Alkaline♥Ascensionism\n\n\n\n\nSee PEP 701 for more details.\nAs a positive side-effect of how this feature has been implemented (by parsing f-strings\nwith the PEG parser), now error messages for f-strings are more precise\nand include the exact location of the error. For example, in Python 3.11, the following\nf-string raises a SyntaxError:\n>>> my_string = f\"{x z y}\" + f\"{1 + 1}\"\n  File \"<stdin>\", line 1\n    (x z y)\n     ^^^\nSyntaxError: f-string: invalid syntax. Perhaps you forgot a comma?\n\n\nbut the error message doesn’t include the exact location of the error within the line and\nalso has the expression artificially surrounded by parentheses. In Python 3.12, as f-strings\nare parsed with the PEG parser, error messages can be more precise and show the entire line:\n>>> my_string = f\"{x z y}\" + f\"{1 + 1}\"\n  File \"<stdin>\", line 1\n    my_string = f\"{x z y}\" + f\"{1 + 1}\"\n                   ^^^\nSyntaxError: invalid syntax. Perhaps you forgot a comma?\n\n\n(Contributed by Pablo Galindo, Batuhan Taskaya, Lysandros Nikolaou, Cristián\nMaureira-Fredes and Marta Gómez in gh-102856. PEP written by Pablo Galindo,\nBatuhan Taskaya, Lysandros Nikolaou and Marta Gómez).", "code_blocks": [">>> songs = ['Take me back to Eden', 'Alkaline', 'Ascensionism']\n>>> f\"This is the playlist: {\", \".join(songs)}\"\n'This is the playlist: Take me back to Eden, Alkaline, Ascensionism'\n", ">>> f\"\"\"{f'''{f'{f\"{1+1}\"}'}'''}\"\"\"\n'2'\n", ">>> f\"{f\"{f\"{f\"{f\"{f\"{1+1}\"}\"}\"}\"}\"}\"\n'2'\n", ">>> f\"This is the playlist: {\", \".join([\n...     'Take me back to Eden',  # My, my, those eyes like fire\n...     'Alkaline',              # Not acid nor alkaline\n...     'Ascensionism'           # Take to the broken skies at last\n... ])}\"\n'This is the playlist: Take me back to Eden, Alkaline, Ascensionism'\n", ">>> print(f\"This is the playlist: {\"\\n\".join(songs)}\")\nThis is the playlist: Take me back to Eden\nAlkaline\nAscensionism\n>>> print(f\"This is the playlist: {\"\\N{BLACK HEART SUIT}\".join(songs)}\")\nThis is the playlist: Take me back to Eden♥Alkaline♥Ascensionism\n", ">>> my_string = f\"{x z y}\" + f\"{1 + 1}\"\n  File \"<stdin>\", line 1\n    (x z y)\n     ^^^\nSyntaxError: f-string: invalid syntax. Perhaps you forgot a comma?\n", ">>> my_string = f\"{x z y}\" + f\"{1 + 1}\"\n  File \"<stdin>\", line 1\n    my_string = f\"{x z y}\" + f\"{1 + 1}\"\n                   ^^^\nSyntaxError: invalid syntax. Perhaps you forgot a comma?\n"]}, "new-features - pep-684-a-per-interpreter-gil": {"text": "PEP 684: A Per-Interpreter GIL\n\nPEP 684 introduces a per-interpreter GIL,\nso that sub-interpreters may now be created with a unique GIL per interpreter.\nThis allows Python programs to take full advantage of multiple CPU\ncores. This is currently only available through the C-API,\nthough a Python API is anticipated for 3.13.\nUse the new Py_NewInterpreterFromConfig() function to\ncreate an interpreter with its own GIL:\nPyInterpreterConfig config = {\n    .check_multi_interp_extensions = 1,\n    .gil = PyInterpreterConfig_OWN_GIL,\n};\nPyThreadState *tstate = NULL;\nPyStatus status = Py_NewInterpreterFromConfig(&tstate, &config);\nif (PyStatus_Exception(status)) {\n    return -1;\n}\n/* The new interpreter is now active in the current thread. */\n\n\nFor further examples how to use the C-API for sub-interpreters with a\nper-interpreter GIL, see Modules/_xxsubinterpretersmodule.c.\n(Contributed by Eric Snow in gh-104210, etc.)", "code_blocks": ["PyInterpreterConfig config = {\n    .check_multi_interp_extensions = 1,\n    .gil = PyInterpreterConfig_OWN_GIL,\n};\nPyThreadState *tstate = NULL;\nPyStatus status = Py_NewInterpreterFromConfig(&tstate, &config);\nif (PyStatus_Exception(status)) {\n    return -1;\n}\n/* The new interpreter is now active in the current thread. */\n"]}, "new-features - pep-669-low-impact-monitoring-for-cpython": {"text": "PEP 669: Low impact monitoring for CPython\n\nPEP 669 defines a new API for profilers,\ndebuggers, and other tools to monitor events in CPython.\nIt covers a wide range of events, including calls,\nreturns, lines, exceptions, jumps, and more.\nThis means that you only pay for what you use, providing support\nfor near-zero overhead debuggers and coverage tools.\nSee  sys.monitoring for details.\n(Contributed by Mark Shannon in gh-103082.)", "code_blocks": []}, "new-features - pep-688-making-the-buffer-protocol-accessible-in-python": {"text": "PEP 688: Making the buffer protocol accessible in Python\n\nPEP 688 introduces a way to use the buffer protocol\nfrom Python code. Classes that implement the __buffer__() method\nare now usable as buffer types.\nThe new collections.abc.Buffer ABC provides a standard\nway to represent buffer objects, for example in type annotations.\nThe new inspect.BufferFlags enum represents the flags that\ncan be used to customize buffer creation.\n(Contributed by Jelle Zijlstra in gh-102500.)", "code_blocks": []}, "new-features - pep-709-comprehension-inlining": {"text": "PEP 709: Comprehension inlining\n\nDictionary, list, and set comprehensions are now inlined, rather than creating a\nnew single-use function object for each execution of the comprehension. This\nspeeds up execution of a comprehension by up to two times.\nSee PEP 709 for further details.\nComprehension iteration variables remain isolated and don’t overwrite a\nvariable of the same name in the outer scope, nor are they visible after the\ncomprehension. Inlining does result in a few visible behavior changes:\n\nThere is no longer a separate frame for the comprehension in tracebacks,\nand tracing/profiling no longer shows the comprehension as a function call.\nThe symtable module will no longer produce child symbol tables for each\ncomprehension; instead, the comprehension’s locals will be included in the\nparent function’s symbol table.\nCalling locals() inside a comprehension now includes variables\nfrom outside the comprehension, and no longer includes the synthetic .0\nvariable for the comprehension “argument”.\nA comprehension iterating directly over locals() (e.g. [k for k in\nlocals()]) may see “RuntimeError: dictionary changed size during iteration”\nwhen run under tracing (e.g. code coverage measurement). This is the same\nbehavior already seen in e.g. for k in locals():. To avoid the error, first\ncreate a list of keys to iterate over: keys = list(locals()); [k for k in\nkeys].\n\n(Contributed by Carl Meyer and Vladimir Matveev in PEP 709.)", "code_blocks": []}, "new-features - improved-error-messages": {"text": "Improved Error Messages\n\n\nModules from the standard library are now potentially suggested as part of\nthe error messages displayed by the interpreter when a NameError is\nraised to the top level. (Contributed by Pablo Galindo in gh-98254.)\n>>> sys.version_info\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nNameError: name 'sys' is not defined. Did you forget to import 'sys'?\n\n\n\nImprove the error suggestion for NameError exceptions for instances.\nNow if a NameError is raised in a method and the instance has an\nattribute that’s exactly equal to the name in the exception, the suggestion\nwill include self.<NAME> instead of the closest match in the method\nscope. (Contributed by Pablo Galindo in gh-99139.)\n>>> class A:\n...    def __init__(self):\n...        self.blech = 1\n...\n...    def foo(self):\n...        somethin = blech\n...\n>>> A().foo()\nTraceback (most recent call last):\n  File \"<stdin>\", line 1\n    somethin = blech\n               ^^^^^\nNameError: name 'blech' is not defined. Did you mean: 'self.blech'?\n\n\n\nImprove the SyntaxError error message when the user types import x\nfrom y instead of from y import x. (Contributed by Pablo Galindo in gh-98931.)\n>>> import a.y.z from b.y.z\nTraceback (most recent call last):\n  File \"<stdin>\", line 1\n    import a.y.z from b.y.z\n    ^^^^^^^^^^^^^^^^^^^^^^^\nSyntaxError: Did you mean to use 'from ... import ...' instead?\n\n\n\nImportError exceptions raised from failed from <module> import\n<name> statements now include suggestions for the value of <name> based on the\navailable names in <module>. (Contributed by Pablo Galindo in gh-91058.)\n>>> from collections import chainmap\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nImportError: cannot import name 'chainmap' from 'collections'. Did you mean: 'ChainMap'?", "code_blocks": [">>> sys.version_info\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nNameError: name 'sys' is not defined. Did you forget to import 'sys'?\n", ">>> class A:\n...    def __init__(self):\n...        self.blech = 1\n...\n...    def foo(self):\n...        somethin = blech\n...\n>>> A().foo()\nTraceback (most recent call last):\n  File \"<stdin>\", line 1\n    somethin = blech\n               ^^^^^\nNameError: name 'blech' is not defined. Did you mean: 'self.blech'?\n", ">>> import a.y.z from b.y.z\nTraceback (most recent call last):\n  File \"<stdin>\", line 1\n    import a.y.z from b.y.z\n    ^^^^^^^^^^^^^^^^^^^^^^^\nSyntaxError: Did you mean to use 'from ... import ...' instead?\n", ">>> from collections import chainmap\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nImportError: cannot import name 'chainmap' from 'collections'. Did you mean: 'ChainMap'?\n"]}, "new-features-related-to-type-hints - pep-692-using-typeddict-for-more-precise-kwargs-typing": {"text": "PEP 692: Using TypedDict for more precise **kwargs typing\n\nTyping **kwargs in a function signature as introduced by PEP 484 allowed\nfor valid annotations only in cases where all of the **kwargs were of the\nsame type.\nPEP 692 specifies a more precise way of typing **kwargs by relying on\ntyped dictionaries:\nfrom typing import TypedDict, Unpack\n\nclass Movie(TypedDict):\n  name: str\n  year: int\n\ndef foo(**kwargs: Unpack[Movie]): ...\n\n\nSee PEP 692 for more details.\n(Contributed by Franek Magiera in gh-103629.)", "code_blocks": ["from typing import TypedDict, Unpack\n\nclass Movie(TypedDict):\n  name: str\n  year: int\n\ndef foo(**kwargs: Unpack[Movie]): ...\n"]}, "new-features-related-to-type-hints - pep-698-override-decorator-for-static-typing": {"text": "PEP 698: Override Decorator for Static Typing\n\nA new decorator typing.override() has been added to the typing\nmodule. It indicates to type checkers that the method is intended to override\na method in a superclass. This allows type checkers to catch mistakes where\na method that is intended to override something in a base class\ndoes not in fact do so.\nExample:\nfrom typing import override\n\nclass Base:\n  def get_color(self) -> str:\n    return \"blue\"\n\nclass GoodChild(Base):\n  @override  # ok: overrides Base.get_color\n  def get_color(self) -> str:\n    return \"yellow\"\n\nclass BadChild(Base):\n  @override  # type checker error: does not override Base.get_color\n  def get_colour(self) -> str:\n    return \"red\"\n\n\nSee PEP 698 for more details.\n(Contributed by Steven Troxler in gh-101561.)", "code_blocks": ["from typing import override\n\nclass Base:\n  def get_color(self) -> str:\n    return \"blue\"\n\nclass GoodChild(Base):\n  @override  # ok: overrides Base.get_color\n  def get_color(self) -> str:\n    return \"yellow\"\n\nclass BadChild(Base):\n  @override  # type checker error: does not override Base.get_color\n  def get_colour(self) -> str:\n    return \"red\"\n"]}, "other-language-changes": {"text": "Other Language Changes\n\n\nThe parser now raises SyntaxError when parsing source code containing\nnull bytes. (Contributed by Pablo Galindo in gh-96670.)\nA backslash-character pair that is not a valid escape sequence now generates\na SyntaxWarning, instead of DeprecationWarning.\nFor example, re.compile(\"\\d+\\.\\d+\") now emits a SyntaxWarning\n(\"\\d\" is an invalid escape sequence, use raw strings for regular\nexpression: re.compile(r\"\\d+\\.\\d+\")).\nIn a future Python version, SyntaxError will eventually be raised,\ninstead of SyntaxWarning.\n(Contributed by Victor Stinner in gh-98401.)\nOctal escapes with value larger than 0o377 (ex: \"\\477\"), deprecated\nin Python 3.11, now produce a SyntaxWarning, instead of\nDeprecationWarning.\nIn a future Python version they will be eventually a SyntaxError.\n(Contributed by Victor Stinner in gh-98401.)\nVariables used in the target part of comprehensions that are not stored to\ncan now be used in assignment expressions (:=).\nFor example, in [(b := 1) for a, b.prop in some_iter], the assignment to\nb is now allowed. Note that assigning to variables stored to in the target\npart of comprehensions (like a) is still disallowed, as per PEP 572.\n(Contributed by Nikita Sobolev in gh-100581.)\nExceptions raised in a class or type’s __set_name__ method are no longer\nwrapped by a RuntimeError. Context information is added to the\nexception as a PEP 678 note. (Contributed by Irit Katriel in gh-77757.)\nWhen a try-except* construct handles the entire ExceptionGroup\nand raises one other exception, that exception is no longer wrapped in an\nExceptionGroup. Also changed in version 3.11.4. (Contributed by Irit\nKatriel in gh-103590.)\nThe Garbage Collector now runs only on the eval breaker mechanism of the\nPython bytecode evaluation loop instead of object allocations. The GC can\nalso run when PyErr_CheckSignals() is called so C extensions that\nneed to run for a long time without executing any Python code also have a\nchance to execute the GC periodically. (Contributed by Pablo Galindo in\ngh-97922.)\nAll builtin and extension callables expecting boolean parameters now accept\narguments of any type instead of just bool and int.\n(Contributed by Serhiy Storchaka in gh-60203.)\nmemoryview now supports the half-float type (the “e” format code).\n(Contributed by Donghee Na and Antoine Pitrou in gh-90751.)\nslice objects are now hashable, allowing them to be used as dict keys and\nset items. (Contributed by Will Bradshaw, Furkan Onder, and Raymond Hettinger in gh-101264.)\nsum() now uses Neumaier summation to improve accuracy and commutativity\nwhen summing floats or mixed ints and floats.\n(Contributed by Raymond Hettinger in gh-100425.)\nast.parse() now raises SyntaxError instead of ValueError\nwhen parsing source code containing null bytes. (Contributed by Pablo Galindo\nin gh-96670.)\nThe extraction methods in tarfile, and shutil.unpack_archive(),\nhave a new a filter argument that allows limiting tar features than may be\nsurprising or dangerous, such as creating files outside the destination\ndirectory.\nSee tarfile extraction filters for details.\nIn Python 3.14, the default will switch to 'data'.\n(Contributed by Petr Viktorin in PEP 706.)\ntypes.MappingProxyType instances are now hashable if the underlying\nmapping is hashable.\n(Contributed by Serhiy Storchaka in gh-87995.)\nAdd support for the perf profiler through the new\nenvironment variable PYTHONPERFSUPPORT\nand command-line option -X perf,\nas well as the new sys.activate_stack_trampoline(),\nsys.deactivate_stack_trampoline(),\nand sys.is_stack_trampoline_active() functions.\n(Design by Pablo Galindo. Contributed by Pablo Galindo and Christian Heimes\nwith contributions from Gregory P. Smith [Google] and Mark Shannon\nin gh-96123.)", "code_blocks": []}, "new-modules": {"text": "New Modules\n\n\nNone.", "code_blocks": []}, "improved-modules - array": {"text": "array\n\n\nThe array.array class now supports subscripting, making it a\ngeneric type. (Contributed by Jelle Zijlstra in gh-98658.)", "code_blocks": []}, "improved-modules - asyncio": {"text": "asyncio\n\n\nThe performance of writing to sockets in asyncio has been\nsignificantly improved. asyncio now avoids unnecessary copying when\nwriting to sockets and uses sendmsg() if the platform\nsupports it. (Contributed by Kumar Aditya in gh-91166.)\nAdd asyncio.eager_task_factory() and asyncio.create_eager_task_factory()\nfunctions to allow opting an event loop in to eager task execution,\nmaking some use-cases 2x to 5x faster.\n(Contributed by Jacob Bower & Itamar Oren in gh-102853, gh-104140, and gh-104138)\nOn Linux, asyncio uses asyncio.PidfdChildWatcher by default\nif os.pidfd_open() is available and functional instead of\nasyncio.ThreadedChildWatcher.\n(Contributed by Kumar Aditya in gh-98024.)\nThe event loop now uses the best available child watcher for each platform\n(asyncio.PidfdChildWatcher if supported and\nasyncio.ThreadedChildWatcher otherwise), so manually\nconfiguring a child watcher is not recommended.\n(Contributed by Kumar Aditya in gh-94597.)\nAdd loop_factory parameter to asyncio.run() to allow specifying\na custom event loop factory.\n(Contributed by Kumar Aditya in gh-99388.)\nAdd C implementation of asyncio.current_task() for 4x-6x speedup.\n(Contributed by Itamar Oren and Pranav Thulasiram Bhat in gh-100344.)\nasyncio.iscoroutine() now returns False for generators as\nasyncio does not support legacy generator-based coroutines.\n(Contributed by Kumar Aditya in gh-102748.)\nasyncio.wait() and asyncio.as_completed() now accepts generators\nyielding tasks.\n(Contributed by Kumar Aditya in gh-78530.)", "code_blocks": []}, "improved-modules - calendar": {"text": "calendar\n\n\nAdd enums calendar.Month and calendar.Day\ndefining months of the year and days of the week.\n(Contributed by Prince Roshan in gh-103636.)", "code_blocks": []}, "improved-modules - csv": {"text": "csv\n\n\nAdd csv.QUOTE_NOTNULL and csv.QUOTE_STRINGS flags to\nprovide finer grained control of None and empty strings by\ncsv.writer objects.", "code_blocks": []}, "improved-modules - dis": {"text": "dis\n\n\nPseudo instruction opcodes (which are used by the compiler but\ndo not appear in executable bytecode) are now exposed in the\ndis module.\nHAVE_ARGUMENT is still relevant to real opcodes,\nbut it is not useful for pseudo instructions. Use the new\ndis.hasarg collection instead.\n(Contributed by Irit Katriel in gh-94216.)\nAdd the dis.hasexc collection to signify instructions that set\nan exception handler. (Contributed by Irit Katriel in gh-94216.)", "code_blocks": []}, "improved-modules - fractions": {"text": "fractions\n\n\nObjects of type fractions.Fraction now support float-style\nformatting. (Contributed by Mark Dickinson in gh-100161.)", "code_blocks": []}, "improved-modules - importlib-resources": {"text": "importlib.resources\n\n\nimportlib.resources.as_file() now supports resource directories.\n(Contributed by Jason R. Coombs in gh-97930.)\nRename first parameter of importlib.resources.files() to anchor.\n(Contributed by Jason R. Coombs in gh-100598.)", "code_blocks": []}, "improved-modules - inspect": {"text": "inspect\n\n\nAdd inspect.markcoroutinefunction() to mark sync functions that return\na coroutine for use with inspect.iscoroutinefunction().\n(Contributed by Carlton Gibson in gh-99247.)\nAdd inspect.getasyncgenstate() and inspect.getasyncgenlocals()\nfor determining the current state of asynchronous generators.\n(Contributed by Thomas Krennwallner in gh-79940.)\nThe performance of inspect.getattr_static() has been considerably\nimproved. Most calls to the function should be at least 2x faster than they\nwere in Python 3.11. (Contributed by Alex Waygood in gh-103193.)", "code_blocks": []}, "improved-modules - itertools": {"text": "itertools\n\n\nAdd itertools.batched() for collecting into even-sized\ntuples where the last batch may be shorter than the rest.\n(Contributed by Raymond Hettinger in gh-98363.)", "code_blocks": []}, "improved-modules - math": {"text": "math\n\n\nAdd math.sumprod() for computing a sum of products.\n(Contributed by Raymond Hettinger in gh-100485.)\nExtend math.nextafter() to include a steps argument\nfor moving up or down multiple steps at a time. (Contributed by\nMatthias Goergens, Mark Dickinson, and Raymond Hettinger in gh-94906.)", "code_blocks": []}, "improved-modules - os": {"text": "os\n\n\nAdd os.PIDFD_NONBLOCK to open a file descriptor\nfor a process with os.pidfd_open() in non-blocking mode.\n(Contributed by Kumar Aditya in gh-93312.)\nos.DirEntry now includes an os.DirEntry.is_junction()\nmethod to check if the entry is a junction.\n(Contributed by Charles Machalow in gh-99547.)\nAdd os.listdrives(), os.listvolumes() and os.listmounts()\nfunctions on Windows for enumerating drives, volumes and mount points.\n(Contributed by Steve Dower in gh-102519.)\nos.stat() and os.lstat() are now more accurate on Windows.\nThe st_birthtime field will now be filled with the creation time\nof the file, and st_ctime is deprecated but still contains the\ncreation time (but in the future will return the last metadata change,\nfor consistency with other platforms). st_dev may be up to 64 bits\nand st_ino up to 128 bits depending on your file system, and\nst_rdev is always set to zero rather than incorrect values.\nBoth functions may be significantly faster on newer releases of\nWindows. (Contributed by Steve Dower in gh-99726.)\nAs of 3.12.4, os.mkdir() and os.makedirs() on Windows\nnow support passing a mode value of 0o700 to apply access\ncontrol to the new directory. This implicitly affects\ntempfile.mkdtemp() and is a mitigation for CVE-2024-4030.\nOther values for mode continue to be ignored.\n(Contributed by Steve Dower in gh-118486.)", "code_blocks": []}, "improved-modules - os-path": {"text": "os.path\n\n\nAdd os.path.isjunction() to check if a given path is a junction.\n(Contributed by Charles Machalow in gh-99547.)\nAdd os.path.splitroot() to split a path into a triad\n(drive, root, tail). (Contributed by Barney Gale in gh-101000.)", "code_blocks": []}, "improved-modules - pathlib": {"text": "pathlib\n\n\nAdd support for subclassing pathlib.PurePath and\npathlib.Path, plus their Posix- and Windows-specific variants.\nSubclasses may override the pathlib.PurePath.with_segments() method\nto pass information between path instances.\nAdd pathlib.Path.walk() for walking the directory trees and generating\nall file or directory names within them, similar to os.walk().\n(Contributed by Stanislav Zmiev in gh-90385.)\nAdd walk_up optional parameter to pathlib.PurePath.relative_to()\nto allow the insertion of .. entries in the result; this behavior is\nmore consistent with os.path.relpath().\n(Contributed by Domenico Ragusa in gh-84538.)\nAdd pathlib.Path.is_junction() as a proxy to os.path.isjunction().\n(Contributed by Charles Machalow in gh-99547.)\nAdd case_sensitive optional parameter to pathlib.Path.glob(),\npathlib.Path.rglob() and pathlib.PurePath.match() for matching\nthe path’s case sensitivity, allowing for more precise control over the matching process.", "code_blocks": []}, "improved-modules - pdb": {"text": "pdb\n\n\nAdd convenience variables to hold values temporarily for debug session\nand provide quick access to values like the current frame or the return\nvalue.\n(Contributed by Tian Gao in gh-103693.)", "code_blocks": []}, "improved-modules - random": {"text": "random\n\n\nAdd random.binomialvariate().\n(Contributed by Raymond Hettinger in gh-81620.)\nAdd a default of lambd=1.0 to random.expovariate().\n(Contributed by Raymond Hettinger in gh-100234.)", "code_blocks": []}, "improved-modules - shutil": {"text": "shutil\n\n\nshutil.make_archive() now passes the root_dir argument to custom\narchivers which support it.\nIn this case it no longer temporarily changes the current working directory\nof the process to root_dir to perform archiving.\n(Contributed by Serhiy Storchaka in gh-74696.)\nshutil.rmtree() now accepts a new argument onexc which is an\nerror handler like onerror but which expects an exception instance\nrather than a (typ, val, tb) triplet. onerror is deprecated.\n(Contributed by Irit Katriel in gh-102828.)\nshutil.which() now consults the PATHEXT environment variable to\nfind matches within PATH on Windows even when the given cmd includes\na directory component.\n(Contributed by Charles Machalow in gh-103179.)\nshutil.which() will call NeedCurrentDirectoryForExePathW when\nquerying for executables on Windows to determine if the current working\ndirectory should be prepended to the search path.\n(Contributed by Charles Machalow in gh-103179.)\nshutil.which() will return a path matching the cmd with a component\nfrom PATHEXT prior to a direct match elsewhere in the search path on\nWindows.\n(Contributed by Charles Machalow in gh-103179.)", "code_blocks": []}, "improved-modules - sqlite3": {"text": "sqlite3\n\n\nAdd a command-line interface.\n(Contributed by Erlend E. Aasland in gh-77617.)\nAdd the sqlite3.Connection.autocommit attribute\nto sqlite3.Connection\nand the autocommit parameter to sqlite3.connect()\nto control PEP 249-compliant\ntransaction handling.\n(Contributed by Erlend E. Aasland in gh-83638.)\nAdd entrypoint keyword-only parameter to\nsqlite3.Connection.load_extension(),\nfor overriding the SQLite extension entry point.\n(Contributed by Erlend E. Aasland in gh-103015.)\nAdd sqlite3.Connection.getconfig() and\nsqlite3.Connection.setconfig() to sqlite3.Connection\nto make configuration changes to a database connection.\n(Contributed by Erlend E. Aasland in gh-103489.)", "code_blocks": []}, "improved-modules - statistics": {"text": "statistics\n\n\nExtend statistics.correlation() to include as a ranked method\nfor computing the Spearman correlation of ranked data.\n(Contributed by Raymond Hettinger in gh-95861.)", "code_blocks": []}, "improved-modules - sys": {"text": "sys\n\n\nAdd the sys.monitoring namespace to expose the new PEP 669 monitoring API.\n(Contributed by Mark Shannon in gh-103082.)\nAdd sys.activate_stack_trampoline() and\nsys.deactivate_stack_trampoline() for activating and deactivating\nstack profiler trampolines,\nand sys.is_stack_trampoline_active() for querying if stack profiler\ntrampolines are active.\n(Contributed by Pablo Galindo and Christian Heimes\nwith contributions from Gregory P. Smith [Google] and Mark Shannon\nin gh-96123.)\nAdd sys.last_exc which holds the last unhandled exception that\nwas raised (for post-mortem debugging use cases). Deprecate the\nthree fields that have the same information in its legacy form:\nsys.last_type, sys.last_value and sys.last_traceback.\n(Contributed by Irit Katriel in gh-102778.)\nsys._current_exceptions() now returns a mapping from thread-id to an\nexception instance, rather than to a (typ, exc, tb) tuple.\n(Contributed by Irit Katriel in gh-103176.)\nsys.setrecursionlimit() and sys.getrecursionlimit().\nThe recursion limit now applies only to Python code. Builtin functions do\nnot use the recursion limit, but are protected by a different mechanism\nthat prevents recursion from causing a virtual machine crash.", "code_blocks": []}, "improved-modules - tempfile": {"text": "tempfile\n\n\nThe tempfile.NamedTemporaryFile function has a new optional parameter\ndelete_on_close (Contributed by Evgeny Zorin in gh-58451.)\ntempfile.mkdtemp() now always returns an absolute path, even if the\nargument provided to the dir parameter is a relative path.\nAs of 3.12.4 on Windows, the default mode 0o700 used by\ntempfile.mkdtemp() now limits access to the new directory due to\nchanges to os.mkdir(). This is a mitigation for CVE-2024-4030.\n(Contributed by Steve Dower in gh-118486.)", "code_blocks": []}, "improved-modules - threading": {"text": "threading\n\n\nAdd threading.settrace_all_threads() and\nthreading.setprofile_all_threads() that allow to set tracing and\nprofiling functions in all running threads in addition to the calling one.\n(Contributed by Pablo Galindo in gh-93503.)", "code_blocks": []}, "improved-modules - tkinter": {"text": "tkinter\n\n\ntkinter.Canvas.coords() now flattens its arguments.\nIt now accepts not only coordinates as separate arguments\n(x1, y1, x2, y2, ...) and a sequence of coordinates\n([x1, y1, x2, y2, ...]), but also coordinates grouped in pairs\n((x1, y1), (x2, y2), ... and [(x1, y1), (x2, y2), ...]),\nlike create_*() methods.\n(Contributed by Serhiy Storchaka in gh-94473.)", "code_blocks": []}, "improved-modules - tokenize": {"text": "tokenize\n\n\nThe tokenize module includes the changes introduced in PEP 701.\n(Contributed by Marta Gómez Macías and Pablo Galindo in gh-102856.)\nSee Porting to Python 3.12 for more information on the\nchanges to the tokenize module.", "code_blocks": []}, "improved-modules - types": {"text": "types\n\n\nAdd types.get_original_bases() to allow for further introspection of\nUser-defined generic types when subclassed. (Contributed by\nJames Hilton-Balfe and Alex Waygood in gh-101827.)", "code_blocks": []}, "improved-modules - typing": {"text": "typing\n\n\nisinstance() checks against\nruntime-checkable protocols now use\ninspect.getattr_static() rather than hasattr() to lookup whether\nattributes exist. This means that descriptors and __getattr__()\nmethods are no longer unexpectedly evaluated during isinstance() checks\nagainst runtime-checkable protocols. However, it may also mean that some\nobjects which used to be considered instances of a runtime-checkable protocol\nmay no longer be considered instances of that protocol on Python 3.12+, and\nvice versa. Most users are unlikely to be affected by this change.\n(Contributed by Alex Waygood in gh-102433.)\nThe members of a runtime-checkable protocol are now considered “frozen” at\nruntime as soon as the class has been created. Monkey-patching attributes\nonto a runtime-checkable protocol will still work, but will have no impact on\nisinstance() checks comparing objects to the protocol. For example:\n>>> from typing import Protocol, runtime_checkable\n>>> @runtime_checkable\n... class HasX(Protocol):\n...     x = 1\n...\n>>> class Foo: ...\n...\n>>> f = Foo()\n>>> isinstance(f, HasX)\nFalse\n>>> f.x = 1\n>>> isinstance(f, HasX)\nTrue\n>>> HasX.y = 2\n>>> isinstance(f, HasX)  # unchanged, even though HasX now also has a \"y\" attribute\nTrue\n\n\nThis change was made in order to speed up isinstance() checks against\nruntime-checkable protocols.\n\nThe performance profile of isinstance() checks against\nruntime-checkable protocols has changed\nsignificantly. Most isinstance() checks against protocols with only a few\nmembers should be at least 2x faster than in 3.11, and some may be 20x\nfaster or more. However, isinstance() checks against protocols with many\nmembers may be slower than in Python 3.11. (Contributed by Alex\nWaygood in gh-74690 and gh-103193.)\nAll typing.TypedDict and typing.NamedTuple classes now have the\n__orig_bases__ attribute. (Contributed by Adrian Garcia Badaracco in\ngh-103699.)\nAdd frozen_default parameter to typing.dataclass_transform().\n(Contributed by Erik De Bonte in gh-99957.)", "code_blocks": [">>> from typing import Protocol, runtime_checkable\n>>> @runtime_checkable\n... class HasX(Protocol):\n...     x = 1\n...\n>>> class Foo: ...\n...\n>>> f = Foo()\n>>> isinstance(f, HasX)\nFalse\n>>> f.x = 1\n>>> isinstance(f, HasX)\nTrue\n>>> HasX.y = 2\n>>> isinstance(f, HasX)  # unchanged, even though HasX now also has a \"y\" attribute\nTrue\n"]}, "improved-modules - unicodedata": {"text": "unicodedata\n\n\nThe Unicode database has been updated to version 15.0.0. (Contributed by\nBenjamin Peterson in gh-96734).", "code_blocks": []}, "improved-modules - unittest": {"text": "unittest\n\nAdd a --durations command line option, showing the N slowest test cases:\npython3 -m unittest --durations=3 lib.tests.test_threading\n.....\nSlowest test durations\n----------------------------------------------------------------------\n1.210s     test_timeout (Lib.test.test_threading.BarrierTests)\n1.003s     test_default_timeout (Lib.test.test_threading.BarrierTests)\n0.518s     test_timeout (Lib.test.test_threading.EventTests)\n\n(0.000 durations hidden.  Use -v to show these durations.)\n----------------------------------------------------------------------\nRan 158 tests in 9.869s\n\nOK (skipped=3)\n\n\n(Contributed by Giampaolo Rodola in gh-48330)", "code_blocks": ["python3 -m unittest --durations=3 lib.tests.test_threading\n.....\nSlowest test durations\n----------------------------------------------------------------------\n1.210s     test_timeout (Lib.test.test_threading.BarrierTests)\n1.003s     test_default_timeout (Lib.test.test_threading.BarrierTests)\n0.518s     test_timeout (Lib.test.test_threading.EventTests)\n\n(0.000 durations hidden.  Use -v to show these durations.)\n----------------------------------------------------------------------\nRan 158 tests in 9.869s\n\nOK (skipped=3)\n"]}, "improved-modules - uuid": {"text": "uuid\n\n\nAdd a command-line interface.\n(Contributed by Adam Chhina in gh-88597.)", "code_blocks": []}, "optimizations": {"text": "Optimizations\n\n\nRemove wstr and wstr_length members from Unicode objects.\nIt reduces object size by 8 or 16 bytes on 64bit platform. (PEP 623)\n(Contributed by Inada Naoki in gh-92536.)\nAdd experimental support for using the BOLT binary optimizer in the build\nprocess, which improves performance by 1-5%.\n(Contributed by Kevin Modzelewski in gh-90536 and tuned by Donghee Na in gh-101525)\nSpeed up the regular expression substitution (functions re.sub() and\nre.subn() and corresponding re.Pattern methods) for\nreplacement strings containing group references by 2–3 times.\n(Contributed by Serhiy Storchaka in gh-91524.)\nSpeed up asyncio.Task creation by deferring expensive string formatting.\n(Contributed by Itamar Oren in gh-103793.)\nThe tokenize.tokenize() and tokenize.generate_tokens() functions are\nup to 64% faster as a side effect of the changes required to cover PEP 701 in\nthe tokenize module. (Contributed by Marta Gómez Macías and Pablo Galindo\nin gh-102856.)\nSpeed up super() method calls and attribute loads via the\nnew LOAD_SUPER_ATTR instruction. (Contributed by Carl Meyer and\nVladimir Matveev in gh-103497.)", "code_blocks": []}, "cpython-bytecode-changes": {"text": "CPython bytecode changes\n\n\nRemove the LOAD_METHOD instruction. It has been merged into\nLOAD_ATTR. LOAD_ATTR will now behave like the old\nLOAD_METHOD instruction if the low bit of its oparg is set.\n(Contributed by Ken Jin in gh-93429.)\nRemove the JUMP_IF_FALSE_OR_POP and JUMP_IF_TRUE_OR_POP\ninstructions. (Contributed by Irit Katriel in gh-102859.)\nRemove the PRECALL instruction. (Contributed by Mark Shannon in\ngh-92925.)\nAdd the BINARY_SLICE and STORE_SLICE instructions.\n(Contributed by Mark Shannon in gh-94163.)\nAdd the CALL_INTRINSIC_1 instructions.\n(Contributed by Mark Shannon in gh-99005.)\nAdd the CALL_INTRINSIC_2 instruction.\n(Contributed by Irit Katriel in gh-101799.)\nAdd the CLEANUP_THROW instruction.\n(Contributed by Brandt Bucher in gh-90997.)\nAdd the END_SEND instruction.\n(Contributed by Mark Shannon in gh-103082.)\nAdd the LOAD_FAST_AND_CLEAR instruction as part of the\nimplementation of PEP 709. (Contributed by Carl Meyer in gh-101441.)\nAdd the LOAD_FAST_CHECK instruction.\n(Contributed by Dennis Sweeney in gh-93143.)\nAdd the LOAD_FROM_DICT_OR_DEREF, LOAD_FROM_DICT_OR_GLOBALS,\nand LOAD_LOCALS opcodes as part of the implementation of PEP 695.\nRemove the LOAD_CLASSDEREF opcode, which can be replaced with\nLOAD_LOCALS plus LOAD_FROM_DICT_OR_DEREF. (Contributed\nby Jelle Zijlstra in gh-103764.)\nAdd the LOAD_SUPER_ATTR instruction. (Contributed by Carl Meyer and\nVladimir Matveev in gh-103497.)\nAdd the RETURN_CONST instruction. (Contributed by Wenyang Wang in gh-101632.)", "code_blocks": []}, "demos-and-tools": {"text": "Demos and Tools\n\n\nRemove the Tools/demo/ directory which contained old demo scripts. A copy\ncan be found in the old-demos project.\n(Contributed by Victor Stinner in gh-97681.)\nRemove outdated example scripts of the Tools/scripts/ directory.\nA copy can be found in the old-demos project.\n(Contributed by Victor Stinner in gh-97669.)", "code_blocks": []}, "deprecated - pending-removal-in-python-3-13": {"text": "Pending Removal in Python 3.13\n\nModules (see PEP 594):\n\naifc\naudioop\ncgi\ncgitb\nchunk\ncrypt\nimghdr\nmailcap\nmsilib\nnis\nnntplib\nossaudiodev\npipes\nsndhdr\nspwd\nsunau\ntelnetlib\nuu\nxdrlib\n\nOther modules:\n\nlib2to3, and the 2to3 program (gh-84540)\n\nAPIs:\n\nconfigparser.LegacyInterpolation (gh-90765)\nlocale.resetlocale() (gh-90817)\nturtle.RawTurtle.settiltangle() (gh-50096)\nunittest.findTestCases() (gh-50096)\nunittest.getTestCaseNames() (gh-50096)\nunittest.makeSuite() (gh-50096)\nunittest.TestProgram.usageExit() (gh-67048)\nwebbrowser.MacOSX (gh-86421)\nclassmethod descriptor chaining (gh-89519)\nimportlib.resources deprecated methods:\n\ncontents()\nis_resource()\nopen_binary()\nopen_text()\npath()\nread_binary()\nread_text()\n\nUse importlib.resources.files() instead.  Refer to importlib-resources: Migrating from Legacy (gh-106531)", "code_blocks": []}, "deprecated - pending-removal-in-python-3-14": {"text": "Pending Removal in Python 3.14\n\n\nargparse: The type, choices, and metavar parameters\nof argparse.BooleanOptionalAction are deprecated\nand will be removed in 3.14.\n(Contributed by Nikita Sobolev in gh-92248.)\nast: The following features have been deprecated in documentation\nsince Python 3.8, now cause a DeprecationWarning to be emitted at\nruntime when they are accessed or used, and will be removed in Python 3.14:\n\nast.Num\nast.Str\nast.Bytes\nast.NameConstant\nast.Ellipsis\n\nUse ast.Constant instead.\n(Contributed by Serhiy Storchaka in gh-90953.)\n\nasyncio:\n\nThe child watcher classes MultiLoopChildWatcher,\nFastChildWatcher, AbstractChildWatcher\nand SafeChildWatcher are deprecated and\nwill be removed in Python 3.14.\n(Contributed by Kumar Aditya in gh-94597.)\nasyncio.set_child_watcher(), asyncio.get_child_watcher(),\nasyncio.AbstractEventLoopPolicy.set_child_watcher() and\nasyncio.AbstractEventLoopPolicy.get_child_watcher() are deprecated\nand will be removed in Python 3.14.\n(Contributed by Kumar Aditya in gh-94597.)\nThe get_event_loop() method of the\ndefault event loop policy now emits a DeprecationWarning if there\nis no current event loop set and it decides to create one.\n(Contributed by Serhiy Storchaka and Guido van Rossum in gh-100160.)\n\n\ncollections.abc: Deprecated ByteString.\nPrefer Sequence or Buffer.\nFor use in typing, prefer a union, like bytes | bytearray,\nor collections.abc.Buffer.\n(Contributed by Shantanu Jain in gh-91896.)\nemail: Deprecated the isdst parameter in email.utils.localtime().\n(Contributed by Alan Williams in gh-72346.)\nimportlib: __package__ and __cached__ will cease to be set or\ntaken into consideration by the import system (gh-97879).\nimportlib.abc deprecated classes:\n\nimportlib.abc.ResourceReader\nimportlib.abc.Traversable\nimportlib.abc.TraversableResources\n\nUse importlib.resources.abc classes instead:\n\nimportlib.resources.abc.Traversable\nimportlib.resources.abc.TraversableResources\n\n(Contributed by Jason R. Coombs and Hugo van Kemenade in gh-93963.)\n\nitertools had undocumented, inefficient, historically buggy,\nand inconsistent support for copy, deepcopy, and pickle operations.\nThis will be removed in 3.14 for a significant reduction in code\nvolume and maintenance burden.\n(Contributed by Raymond Hettinger in gh-101588.)\nmultiprocessing: The default start method will change to a safer one on\nLinux, BSDs, and other non-macOS POSIX platforms where 'fork' is currently\nthe default (gh-84559). Adding a runtime warning about this was deemed too\ndisruptive as the majority of code is not expected to care. Use the\nget_context() or\nset_start_method() APIs to explicitly specify when\nyour code requires 'fork'.  See Contexts and start methods.\npathlib: is_relative_to() and\nrelative_to(): passing additional arguments is\ndeprecated.\npkgutil: find_loader() and get_loader()\nnow raise DeprecationWarning;\nuse importlib.util.find_spec() instead.\n(Contributed by Nikita Sobolev in gh-97850.)\npty:\n\nmaster_open(): use pty.openpty().\nslave_open(): use pty.openpty().\n\n\nsqlite3:\n\nversion and version_info.\nexecute() and executemany()\nif named placeholders are used and\nparameters is a sequence instead of a dict.\ndate and datetime adapter, date and timestamp converter:\nsee the sqlite3 documentation for suggested replacement recipes.\n\n\ntypes.CodeType: Accessing co_lnotab was\ndeprecated in PEP 626\nsince 3.10 and was planned to be removed in 3.12,\nbut it only got a proper DeprecationWarning in 3.12.\nMay be removed in 3.14.\n(Contributed by Nikita Sobolev in gh-101866.)\ntyping: ByteString, deprecated since Python 3.9,\nnow causes a DeprecationWarning to be emitted when it is used.\nurllib:\nurllib.parse.Quoter is deprecated: it was not intended to be a\npublic API.\n(Contributed by Gregory P. Smith in gh-88168.)", "code_blocks": []}, "deprecated - pending-removal-in-python-3-15": {"text": "Pending Removal in Python 3.15\n\n\nhttp.server.CGIHTTPRequestHandler will be removed along with its\nrelated --cgi flag to python -m http.server.  It was obsolete and\nrarely used.  No direct replacement exists.  Anything is better than CGI\nto interface a web server with a request handler.\nlocale: locale.getdefaultlocale() was deprecated in Python 3.11\nand originally planned for removal in Python 3.13 (gh-90817),\nbut removal has been postponed to Python 3.15.\nUse locale.setlocale(), locale.getencoding() and\nlocale.getlocale() instead.\n(Contributed by Hugo van Kemenade in gh-111187.)\npathlib:\npathlib.PurePath.is_reserved() is deprecated and scheduled for\nremoval in Python 3.15. From Python 3.13 onwards, use os.path.isreserved\nto detect reserved paths on Windows.\nplatform:\njava_ver() is deprecated and will be removed in 3.15.\nIt was largely untested, had a confusing API,\nand was only useful for Jython support.\n(Contributed by Nikita Sobolev in gh-116349.)\nthreading:\nPassing any arguments to threading.RLock() is now deprecated.\nC version allows any numbers of args and kwargs,\nbut they are just ignored. Python version does not allow any arguments.\nAll arguments will be removed from threading.RLock() in Python 3.15.\n(Contributed by Nikita Sobolev in gh-102029.)\ntyping.NamedTuple:\n\nThe undocumented keyword argument syntax for creating NamedTuple classes\n(NT = NamedTuple(\"NT\", x=int)) is deprecated, and will be disallowed in\n3.15. Use the class-based syntax or the functional syntax instead.\nWhen using the functional syntax to create a NamedTuple class, failing to\npass a value to the fields parameter (NT = NamedTuple(\"NT\")) is\ndeprecated. Passing None to the fields parameter\n(NT = NamedTuple(\"NT\", None)) is also deprecated. Both will be\ndisallowed in Python 3.15. To create a NamedTuple class with 0 fields, use\nclass NT(NamedTuple): pass or NT = NamedTuple(\"NT\", []).\n\n\ntyping.TypedDict: When using the functional syntax to create a\nTypedDict class, failing to pass a value to the fields parameter (TD =\nTypedDict(\"TD\")) is deprecated. Passing None to the fields parameter\n(TD = TypedDict(\"TD\", None)) is also deprecated. Both will be disallowed\nin Python 3.15. To create a TypedDict class with 0 fields, use class\nTD(TypedDict): pass or TD = TypedDict(\"TD\", {}).\nwave: Deprecate the getmark(), setmark() and getmarkers()\nmethods of the wave.Wave_read and wave.Wave_write classes.\nThey will be removed in Python 3.15.\n(Contributed by Victor Stinner in gh-105096.)", "code_blocks": []}, "deprecated - pending-removal-in-python-3-16": {"text": "Pending Removal in Python 3.16\n\n\narray:\narray.array 'u' type (wchar_t):\nuse the 'w' type instead (Py_UCS4).\nbuiltins:\n~bool, bitwise inversion on bool.\nsymtable:\nDeprecate symtable.Class.get_methods() due to the lack of interest.\n(Contributed by Bénédikt Tran in gh-119698.)", "code_blocks": []}, "deprecated - pending-removal-in-future-versions": {"text": "Pending Removal in Future Versions\n\nThe following APIs will be removed in the future,\nalthough there is currently no date scheduled for their removal.\n\nargparse: Nesting argument groups and nesting mutually exclusive\ngroups are deprecated.\narray’s 'u' format code (gh-57281)\nbuiltins:\n\nbool(NotImplemented).\nGenerators: throw(type, exc, tb) and athrow(type, exc, tb)\nsignature is deprecated: use throw(exc) and athrow(exc) instead,\nthe single argument signature.\nCurrently Python accepts numeric literals immediately followed by keywords,\nfor example 0in x, 1or x, 0if 1else 2.  It allows confusing and\nambiguous expressions like [0x1for x in y] (which can be interpreted as\n[0x1 for x in y] or [0x1f or x in y]).  A syntax warning is raised\nif the numeric literal is immediately followed by one of keywords\nand, else, for, if,\nin, is and or.  In a future release it\nwill be changed to a syntax error. (gh-87999)\nSupport for __index__() and __int__() method returning non-int type:\nthese methods will be required to return an instance of a strict subclass of\nint.\nSupport for __float__() method returning a strict subclass of\nfloat: these methods will be required to return an instance of\nfloat.\nSupport for __complex__() method returning a strict subclass of\ncomplex: these methods will be required to return an instance of\ncomplex.\nDelegation of int() to __trunc__() method.\nPassing a complex number as the real or imag argument in the\ncomplex() constructor is now deprecated; it should only be passed\nas a single positional argument.\n(Contributed by Serhiy Storchaka in gh-109218.)\n\n\ncalendar: calendar.January and calendar.February constants are\ndeprecated and replaced by calendar.JANUARY and\ncalendar.FEBRUARY.\n(Contributed by Prince Roshan in gh-103636.)\ncodeobject.co_lnotab: use the codeobject.co_lines() method\ninstead.\ndatetime:\n\nutcnow():\nuse datetime.datetime.now(tz=datetime.UTC).\nutcfromtimestamp():\nuse datetime.datetime.fromtimestamp(timestamp, tz=datetime.UTC).\n\n\ngettext: Plural value must be an integer.\nimportlib:\n\nload_module() method: use exec_module() instead.\ncache_from_source() debug_override parameter is\ndeprecated: use the optimization parameter instead.\n\n\nimportlib.metadata:\n\nEntryPoints tuple interface.\nImplicit None on return values.\n\n\nmailbox: Use of StringIO input and text mode is deprecated, use\nBytesIO and binary mode instead.\nos: Calling os.register_at_fork() in multi-threaded process.\npydoc.ErrorDuringImport: A tuple value for exc_info parameter is\ndeprecated, use an exception instance.\nre: More strict rules are now applied for numerical group references\nand group names in regular expressions.  Only sequence of ASCII digits is now\naccepted as a numerical reference.  The group name in bytes patterns and\nreplacement strings can now only contain ASCII letters and digits and\nunderscore.\n(Contributed by Serhiy Storchaka in gh-91760.)\nsre_compile, sre_constants and sre_parse modules.\nshutil: rmtree()’s onerror parameter is deprecated in\nPython 3.12; use the onexc parameter instead.\nssl options and protocols:\n\nssl.SSLContext without protocol argument is deprecated.\nssl.SSLContext: set_npn_protocols() and\nselected_npn_protocol() are deprecated: use ALPN\ninstead.\nssl.OP_NO_SSL* options\nssl.OP_NO_TLS* options\nssl.PROTOCOL_SSLv3\nssl.PROTOCOL_TLS\nssl.PROTOCOL_TLSv1\nssl.PROTOCOL_TLSv1_1\nssl.PROTOCOL_TLSv1_2\nssl.TLSVersion.SSLv3\nssl.TLSVersion.TLSv1\nssl.TLSVersion.TLSv1_1\n\n\nsysconfig.is_python_build() check_home parameter is deprecated and\nignored.\nthreading methods:\n\nthreading.Condition.notifyAll(): use notify_all().\nthreading.Event.isSet(): use is_set().\nthreading.Thread.isDaemon(), threading.Thread.setDaemon():\nuse threading.Thread.daemon attribute.\nthreading.Thread.getName(), threading.Thread.setName():\nuse threading.Thread.name attribute.\nthreading.currentThread(): use threading.current_thread().\nthreading.activeCount(): use threading.active_count().\n\n\ntyping.Text (gh-92332).\nunittest.IsolatedAsyncioTestCase: it is deprecated to return a value\nthat is not None from a test case.\nurllib.parse deprecated functions: urlparse() instead\n\nsplitattr()\nsplithost()\nsplitnport()\nsplitpasswd()\nsplitport()\nsplitquery()\nsplittag()\nsplittype()\nsplituser()\nsplitvalue()\nto_bytes()\n\n\nurllib.request: URLopener and\nFancyURLopener style of invoking requests is\ndeprecated. Use newer urlopen() functions and methods.\nwsgiref: SimpleHandler.stdout.write() should not do partial\nwrites.\nxml.etree.ElementTree: Testing the truth value of an\nElement is deprecated. In a future release it\nwill always return True. Prefer explicit len(elem) or\nelem is not None tests instead.\nzipimport.zipimporter.load_module() is deprecated:\nuse exec_module() instead.", "code_blocks": []}, "removed - asynchat-and-asyncore": {"text": "asynchat and asyncore\n\n\nThese two modules have been removed\naccording to the schedule in PEP 594,\nhaving been deprecated in Python 3.6.\nUse asyncio instead.\n(Contributed by Nikita Sobolev in gh-96580.)", "code_blocks": []}, "removed - configparser": {"text": "configparser\n\n\nSeveral names deprecated in the configparser way back in 3.2 have\nbeen removed per gh-89336:\n\nconfigparser.ParsingError no longer has a filename attribute\nor argument. Use the source attribute and argument instead.\nconfigparser no longer has a SafeConfigParser class. Use the\nshorter ConfigParser name instead.\nconfigparser.ConfigParser no longer has a readfp method.\nUse read_file() instead.", "code_blocks": []}, "removed - distutils": {"text": "distutils\n\n\nRemove the distutils package. It was deprecated in Python 3.10 by\nPEP 632 “Deprecate distutils module”. For projects still using\ndistutils and cannot be updated to something else, the setuptools\nproject can be installed: it still provides distutils.\n(Contributed by Victor Stinner in gh-92584.)", "code_blocks": []}, "removed - ensurepip": {"text": "ensurepip\n\n\nRemove the bundled setuptools wheel from ensurepip,\nand stop installing setuptools in environments created by venv.\npip (>= 22.1) does not require setuptools to be installed in the\nenvironment. setuptools-based (and distutils-based) packages\ncan still be used with pip install, since pip will provide\nsetuptools in the build environment it uses for building a\npackage.\neasy_install, pkg_resources, setuptools and distutils\nare no longer provided by default in environments created with\nvenv or bootstrapped with ensurepip, since they are part of\nthe setuptools package. For projects relying on these at runtime,\nthe setuptools project should be declared as a dependency and\ninstalled separately (typically, using pip).\n(Contributed by Pradyun Gedam in gh-95299.)", "code_blocks": []}, "removed - enum": {"text": "enum\n\n\nRemove enum’s EnumMeta.__getattr__, which is no longer needed for\nenum attribute access.\n(Contributed by Ethan Furman in gh-95083.)", "code_blocks": []}, "removed - ftplib": {"text": "ftplib\n\n\nRemove ftplib’s FTP_TLS.ssl_version class attribute: use the\ncontext parameter instead.\n(Contributed by Victor Stinner in gh-94172.)", "code_blocks": []}, "removed - gzip": {"text": "gzip\n\n\nRemove the filename attribute of gzip’s gzip.GzipFile,\ndeprecated since Python 2.6, use the name attribute\ninstead. In write mode, the filename attribute added '.gz' file\nextension if it was not present.\n(Contributed by Victor Stinner in gh-94196.)", "code_blocks": []}, "removed - hashlib": {"text": "hashlib\n\n\nRemove the pure Python implementation of hashlib’s\nhashlib.pbkdf2_hmac(), deprecated in Python 3.10. Python 3.10 and\nnewer requires OpenSSL 1.1.1 (PEP 644): this OpenSSL version provides\na C implementation of pbkdf2_hmac() which is faster.\n(Contributed by Victor Stinner in gh-94199.)", "code_blocks": []}, "removed - importlib": {"text": "importlib\n\n\nMany previously deprecated cleanups in importlib have now been\ncompleted:\n\nReferences to, and support for module_repr() has been removed.\n(Contributed by Barry Warsaw in gh-97850.)\nimportlib.util.set_package, importlib.util.set_loader and\nimportlib.util.module_for_loader have all been removed. (Contributed by\nBrett Cannon and Nikita Sobolev in gh-65961 and gh-97850.)\nSupport for find_loader() and find_module() APIs have been\nremoved.  (Contributed by Barry Warsaw in gh-98040.)\nimportlib.abc.Finder, pkgutil.ImpImporter, and pkgutil.ImpLoader\nhave been removed.  (Contributed by Barry Warsaw in gh-98040.)", "code_blocks": []}, "removed - imp": {"text": "imp\n\n\nThe imp module has been removed.  (Contributed by Barry Warsaw in\ngh-98040.)\nTo migrate, consult the following correspondence table:\n\n\n\nimp\nimportlib\n\n\n\nimp.NullImporter\nInsert None into sys.path_importer_cache\n\nimp.cache_from_source()\nimportlib.util.cache_from_source()\n\nimp.find_module()\nimportlib.util.find_spec()\n\nimp.get_magic()\nimportlib.util.MAGIC_NUMBER\n\nimp.get_suffixes()\nimportlib.machinery.SOURCE_SUFFIXES, importlib.machinery.EXTENSION_SUFFIXES, and importlib.machinery.BYTECODE_SUFFIXES\n\nimp.get_tag()\nsys.implementation.cache_tag\n\nimp.load_module()\nimportlib.import_module()\n\nimp.new_module(name)\ntypes.ModuleType(name)\n\nimp.reload()\nimportlib.reload()\n\nimp.source_from_cache()\nimportlib.util.source_from_cache()\n\nimp.load_source()\nSee below\n\n\n\n\nReplace imp.load_source() with:\nimport importlib.util\nimport importlib.machinery\n\ndef load_source(modname, filename):\n    loader = importlib.machinery.SourceFileLoader(modname, filename)\n    spec = importlib.util.spec_from_file_location(modname, filename, loader=loader)\n    module = importlib.util.module_from_spec(spec)\n    # The module is always executed and not cached in sys.modules.\n    # Uncomment the following line to cache the module.\n    # sys.modules[module.__name__] = module\n    loader.exec_module(module)\n    return module\n\n\n\nRemove imp functions and attributes with no replacements:\n\nUndocumented functions:\n\nimp.init_builtin()\nimp.load_compiled()\nimp.load_dynamic()\nimp.load_package()\n\n\nimp.lock_held(), imp.acquire_lock(), imp.release_lock():\nthe locking scheme has changed in Python 3.3 to per-module locks.\nimp.find_module() constants: SEARCH_ERROR, PY_SOURCE,\nPY_COMPILED, C_EXTENSION, PY_RESOURCE, PKG_DIRECTORY,\nC_BUILTIN, PY_FROZEN, PY_CODERESOURCE, IMP_HOOK.", "code_blocks": ["import importlib.util\nimport importlib.machinery\n\ndef load_source(modname, filename):\n    loader = importlib.machinery.SourceFileLoader(modname, filename)\n    spec = importlib.util.spec_from_file_location(modname, filename, loader=loader)\n    module = importlib.util.module_from_spec(spec)\n    # The module is always executed and not cached in sys.modules.\n    # Uncomment the following line to cache the module.\n    # sys.modules[module.__name__] = module\n    loader.exec_module(module)\n    return module\n"]}, "removed - io": {"text": "io\n\n\nRemove io’s io.OpenWrapper and _pyio.OpenWrapper, deprecated in Python\n3.10: just use open() instead. The open() (io.open())\nfunction is a built-in function. Since Python 3.10, _pyio.open() is\nalso a static method.\n(Contributed by Victor Stinner in gh-94169.)", "code_blocks": []}, "removed - locale": {"text": "locale\n\n\nRemove locale’s locale.format() function, deprecated in Python 3.7:\nuse locale.format_string() instead.\n(Contributed by Victor Stinner in gh-94226.)", "code_blocks": []}, "removed - smtpd": {"text": "smtpd\n\n\nThe smtpd module has been removed according to the schedule in PEP 594,\nhaving been deprecated in Python 3.4.7 and 3.5.4.\nUse the aiosmtpd PyPI module or any other\nasyncio-based server instead.\n(Contributed by Oleg Iarygin in gh-93243.)", "code_blocks": []}, "removed - id2": {"text": "sqlite3\n\n\nThe following undocumented sqlite3 features, deprecated in Python\n3.10, are now removed:\n\nsqlite3.enable_shared_cache()\nsqlite3.OptimizedUnicode\n\nIf a shared cache must be used, open the database in URI mode using the\ncache=shared query parameter.\nThe sqlite3.OptimizedUnicode text factory has been an alias for\nstr since Python 3.3. Code that previously set the text factory to\nOptimizedUnicode can either use str explicitly, or rely on the\ndefault value which is also str.\n(Contributed by Erlend E. Aasland in gh-92548.)", "code_blocks": []}, "removed - ssl": {"text": "ssl\n\n\nRemove ssl’s ssl.RAND_pseudo_bytes() function, deprecated in Python 3.6:\nuse os.urandom() or ssl.RAND_bytes() instead.\n(Contributed by Victor Stinner in gh-94199.)\nRemove the ssl.match_hostname() function.\nIt was deprecated in Python 3.7. OpenSSL performs\nhostname matching since Python 3.7, Python no longer uses the\nssl.match_hostname() function.\n(Contributed by Victor Stinner in gh-94199.)\nRemove the ssl.wrap_socket() function, deprecated in Python 3.7:\ninstead, create a ssl.SSLContext object and call its\nssl.SSLContext.wrap_socket method. Any package that still uses\nssl.wrap_socket() is broken and insecure. The function neither sends a\nSNI TLS extension nor validates the server hostname. Code is subject to CWE-295\n(Improper Certificate Validation).\n(Contributed by Victor Stinner in gh-94199.)", "code_blocks": []}, "removed - id3": {"text": "unittest\n\n\nRemove many long-deprecated unittest features:\n\nA number of TestCase method aliases:\n\n\nDeprecated alias\nMethod Name\nDeprecated in\n\n\n\nfailUnless\nassertTrue()\n3.1\n\nfailIf\nassertFalse()\n3.1\n\nfailUnlessEqual\nassertEqual()\n3.1\n\nfailIfEqual\nassertNotEqual()\n3.1\n\nfailUnlessAlmostEqual\nassertAlmostEqual()\n3.1\n\nfailIfAlmostEqual\nassertNotAlmostEqual()\n3.1\n\nfailUnlessRaises\nassertRaises()\n3.1\n\nassert_\nassertTrue()\n3.2\n\nassertEquals\nassertEqual()\n3.2\n\nassertNotEquals\nassertNotEqual()\n3.2\n\nassertAlmostEquals\nassertAlmostEqual()\n3.2\n\nassertNotAlmostEquals\nassertNotAlmostEqual()\n3.2\n\nassertRegexpMatches\nassertRegex()\n3.2\n\nassertRaisesRegexp\nassertRaisesRegex()\n3.2\n\nassertNotRegexpMatches\nassertNotRegex()\n3.5\n\n\n\nYou can use https://github.com/isidentical/teyit to automatically modernise\nyour unit tests.\n\nUndocumented and broken TestCase method\nassertDictContainsSubset (deprecated in Python 3.2).\nUndocumented TestLoader.loadTestsFromModule parameter use_load_tests\n(deprecated and ignored since Python 3.5).\nAn alias of the TextTestResult class:\n_TextTestResult (deprecated in Python 3.2).\n\n(Contributed by Serhiy Storchaka in gh-89325.)", "code_blocks": []}, "removed - webbrowser": {"text": "webbrowser\n\n\nRemove support for obsolete browsers from webbrowser.\nThe removed browsers include: Grail, Mosaic, Netscape, Galeon, Skipstone,\nIceape, Firebird, and Firefox versions 35 and below (gh-102871).", "code_blocks": []}, "removed - xml-etree-elementtree": {"text": "xml.etree.ElementTree\n\n\nRemove the ElementTree.Element.copy() method of the\npure Python implementation, deprecated in Python 3.10, use the\ncopy.copy() function instead.  The C implementation of xml.etree.ElementTree\nhas no copy() method, only a __copy__() method.\n(Contributed by Victor Stinner in gh-94383.)", "code_blocks": []}, "removed - zipimport": {"text": "zipimport\n\n\nRemove zipimport’s find_loader() and find_module() methods,\ndeprecated in Python 3.10: use the find_spec() method instead.  See\nPEP 451 for the rationale.\n(Contributed by Victor Stinner in gh-94379.)", "code_blocks": []}, "removed - others": {"text": "Others\n\n\nRemove the suspicious rule from the documentation Makefile and\nDoc/tools/rstlint.py, both in favor of sphinx-lint.\n(Contributed by Julien Palard in gh-98179.)\nRemove the keyfile and certfile parameters from the\nftplib, imaplib, poplib and smtplib modules,\nand the key_file, cert_file and check_hostname parameters from the\nhttp.client module,\nall deprecated since Python 3.6. Use the context parameter\n(ssl_context in imaplib) instead.\n(Contributed by Victor Stinner in gh-94172.)\nRemove Jython compatibility hacks from several stdlib modules and tests.\n(Contributed by Nikita Sobolev in gh-99482.)\nRemove _use_broken_old_ctypes_structure_semantics_ flag\nfrom ctypes module.\n(Contributed by Nikita Sobolev in gh-99285.)", "code_blocks": []}, "porting-to-python-3-12 - changes-in-the-python-api": {"text": "Changes in the Python API\n\n\nMore strict rules are now applied for numerical group references and\ngroup names in regular expressions.\nOnly sequence of ASCII digits is now accepted as a numerical reference.\nThe group name in bytes patterns and replacement strings can now only\ncontain ASCII letters and digits and underscore.\n(Contributed by Serhiy Storchaka in gh-91760.)\nRemove randrange() functionality deprecated since Python 3.10.  Formerly,\nrandrange(10.0) losslessly converted to randrange(10). Now, it raises a\nTypeError. Also, the exception raised for non-integer values such as\nrandrange(10.5) or randrange('10') has been changed from ValueError to\nTypeError.  This also prevents bugs where randrange(1e25) would silently\nselect from a larger range than randrange(10**25).\n(Originally suggested by Serhiy Storchaka gh-86388.)\nargparse.ArgumentParser changed encoding and error handler\nfor reading arguments from file (e.g. fromfile_prefix_chars option)\nfrom default text encoding (e.g. locale.getpreferredencoding(False))\nto filesystem encoding and error handler.\nArgument files should be encoded in UTF-8 instead of ANSI Codepage on Windows.\nRemove the asyncore-based smtpd module deprecated in Python 3.4.7\nand 3.5.4.  A recommended replacement is the\nasyncio-based aiosmtpd PyPI module.\nshlex.split(): Passing None for s argument now raises an\nexception, rather than reading sys.stdin. The feature was deprecated\nin Python 3.9.\n(Contributed by Victor Stinner in gh-94352.)\nThe os module no longer accepts bytes-like paths, like\nbytearray and memoryview types: only the exact\nbytes type is accepted for bytes strings.\n(Contributed by Victor Stinner in gh-98393.)\nsyslog.openlog() and syslog.closelog() now fail if used in subinterpreters.\nsyslog.syslog() may still be used in subinterpreters,\nbut now only if syslog.openlog() has already been called in the main interpreter.\nThese new restrictions do not apply to the main interpreter,\nso only a very small set of users might be affected.\nThis change helps with interpreter isolation.  Furthermore, syslog is a wrapper\naround process-global resources, which are best managed from the main interpreter.\n(Contributed by Donghee Na in gh-99127.)\nThe undocumented locking behavior of cached_property()\nis removed, because it locked across all instances of the class, leading to high\nlock contention. This means that a cached property getter function could now run\nmore than once for a single instance, if two threads race. For most simple\ncached properties (e.g. those that are idempotent and simply calculate a value\nbased on other attributes of the instance) this will be fine.  If\nsynchronization is needed, implement locking within the cached property getter\nfunction or around multi-threaded access points.\nsys._current_exceptions() now returns a mapping from thread-id to an\nexception instance, rather than to a (typ, exc, tb) tuple.\n(Contributed by Irit Katriel in gh-103176.)\nWhen extracting tar files using tarfile or\nshutil.unpack_archive(), pass the filter argument to limit features\nthat may be surprising or dangerous.\nSee Extraction filters for details.\nThe output of the tokenize.tokenize() and tokenize.generate_tokens()\nfunctions is now changed due to the changes introduced in PEP 701. This\nmeans that STRING tokens are not emitted any more for f-strings and the\ntokens described in PEP 701 are now produced instead: FSTRING_START,\nFSTRING_MIDDLE and FSTRING_END are now emitted for f-string “string”\nparts in addition to the appropriate tokens for the tokenization in the\nexpression components. For example for the f-string f\"start {1+1} end\"\nthe old version of the tokenizer emitted:\n1,0-1,18:           STRING         'f\"start {1+1} end\"'\n\n\nwhile the new version emits:\n1,0-1,2:            FSTRING_START  'f\"'\n1,2-1,8:            FSTRING_MIDDLE 'start '\n1,8-1,9:            OP             '{'\n1,9-1,10:           NUMBER         '1'\n1,10-1,11:          OP             '+'\n1,11-1,12:          NUMBER         '1'\n1,12-1,13:          OP             '}'\n1,13-1,17:          FSTRING_MIDDLE ' end'\n1,17-1,18:          FSTRING_END    '\"'\n\n\nAdditionally, there may be some minor behavioral changes as a consequence of the\nchanges required to support PEP 701. Some of these changes include:\n\nThe type attribute of the tokens emitted when tokenizing some invalid Python\ncharacters such as ! has changed from ERRORTOKEN to OP.\nIncomplete single-line strings now also raise tokenize.TokenError as incomplete\nmultiline strings do.\nSome incomplete or invalid Python code now raises tokenize.TokenError instead of\nreturning arbitrary ERRORTOKEN tokens when tokenizing it.\nMixing tabs and spaces as indentation in the same file is not supported anymore and will\nraise a TabError.\n\n\nThe threading module now expects the _thread module to have\nan _is_main_interpreter attribute.  It is a function with no\narguments that returns True if the current interpreter is the\nmain interpreter.\nAny library or application that provides a custom _thread module\nshould provide _is_main_interpreter().\n(See gh-112826.)", "code_blocks": ["1,0-1,18:           STRING         'f\"start {1+1} end\"'\n", "1,0-1,2:            FSTRING_START  'f\"'\n1,2-1,8:            FSTRING_MIDDLE 'start '\n1,8-1,9:            OP             '{'\n1,9-1,10:           NUMBER         '1'\n1,10-1,11:          OP             '+'\n1,11-1,12:          NUMBER         '1'\n1,12-1,13:          OP             '}'\n1,13-1,17:          FSTRING_MIDDLE ' end'\n1,17-1,18:          FSTRING_END    '\"'\n"]}, "build-changes": {"text": "Build Changes\n\n\nPython no longer uses setup.py to build shared C extension modules.\nBuild parameters like headers and libraries are detected in configure\nscript. Extensions are built by Makefile. Most extensions use\npkg-config and fall back to manual detection.\n(Contributed by Christian Heimes in gh-93939.)\nva_start() with two parameters, like va_start(args, format),\nis now required to build Python.\nva_start() is no longer called with a single parameter.\n(Contributed by Kumar Aditya in gh-93207.)\nCPython now uses the ThinLTO option as the default link time optimization policy\nif the Clang compiler accepts the flag.\n(Contributed by Donghee Na in gh-89536.)\nAdd COMPILEALL_OPTS variable in Makefile to override compileall\noptions (default: -j0) in make install. Also merged the 3\ncompileall commands into a single command to build .pyc files for all\noptimization levels (0, 1, 2) at once.\n(Contributed by Victor Stinner in gh-99289.)\nAdd platform triplets for 64-bit LoongArch:\n\nloongarch64-linux-gnusf\nloongarch64-linux-gnuf32\nloongarch64-linux-gnu\n\n(Contributed by Zhang Na in gh-90656.)\n\nPYTHON_FOR_REGEN now require Python 3.10 or newer.\nAutoconf 2.71 and aclocal 1.16.4 is now required to regenerate\n!configure.\n(Contributed by Christian Heimes in gh-89886.)\nWindows builds and macOS installers from python.org now use OpenSSL 3.0.", "code_blocks": []}, "c-api-changes - id4": {"text": "New Features\n\n\nPEP 697: Introduce the Unstable C API tier,\nintended for low-level tools like debuggers and JIT compilers.\nThis API may change in each minor release of CPython without deprecation\nwarnings.\nIts contents are marked by the PyUnstable_ prefix in names.\nCode object constructors:\n\nPyUnstable_Code_New() (renamed from PyCode_New)\nPyUnstable_Code_NewWithPosOnlyArgs() (renamed from PyCode_NewWithPosOnlyArgs)\n\nExtra storage for code objects (PEP 523):\n\nPyUnstable_Eval_RequestCodeExtraIndex() (renamed from _PyEval_RequestCodeExtraIndex)\nPyUnstable_Code_GetExtra() (renamed from _PyCode_GetExtra)\nPyUnstable_Code_SetExtra() (renamed from _PyCode_SetExtra)\n\nThe original names will continue to be available until the respective\nAPI changes.\n(Contributed by Petr Viktorin in gh-101101.)\n\nPEP 697: Add an API for extending types whose instance memory layout is\nopaque:\n\nPyType_Spec.basicsize can be zero or negative to specify\ninheriting or extending the base class size.\nPyObject_GetTypeData() and PyType_GetTypeDataSize()\nadded to allow access to subclass-specific instance data.\nPy_TPFLAGS_ITEMS_AT_END and PyObject_GetItemData()\nadded to allow safely extending certain variable-sized types, including\nPyType_Type.\nPy_RELATIVE_OFFSET added to allow defining\nmembers in terms of a subclass-specific struct.\n\n(Contributed by Petr Viktorin in gh-103509.)\n\nAdd the new limited C API function PyType_FromMetaclass(),\nwhich generalizes the existing PyType_FromModuleAndSpec() using\nan additional metaclass argument.\n(Contributed by Wenzel Jakob in gh-93012.)\nAPI for creating objects that can be called using\nthe vectorcall protocol was added to the\nLimited API:\n\nPy_TPFLAGS_HAVE_VECTORCALL\nPyVectorcall_NARGS()\nPyVectorcall_Call()\nvectorcallfunc\n\nThe Py_TPFLAGS_HAVE_VECTORCALL flag is now removed from a class\nwhen the class’s __call__() method is reassigned.\nThis makes vectorcall safe to use with mutable types (i.e. heap types\nwithout the immutable flag, Py_TPFLAGS_IMMUTABLETYPE).\nMutable types that do not override tp_call now\ninherit the Py_TPFLAGS_HAVE_VECTORCALL flag.\n(Contributed by Petr Viktorin in gh-93274.)\nThe Py_TPFLAGS_MANAGED_DICT and Py_TPFLAGS_MANAGED_WEAKREF\nflags have been added. This allows extensions classes to support object\n__dict__ and weakrefs with less bookkeeping,\nusing less memory and with faster access.\n\nAPI for performing calls using\nthe vectorcall protocol was added to the\nLimited API:\n\nPyObject_Vectorcall()\nPyObject_VectorcallMethod()\nPY_VECTORCALL_ARGUMENTS_OFFSET\n\nThis means that both the incoming and outgoing ends of the vector call\nprotocol are now available in the Limited API. (Contributed\nby Wenzel Jakob in gh-98586.)\n\nAdd two new public functions,\nPyEval_SetProfileAllThreads() and\nPyEval_SetTraceAllThreads(), that allow to set tracing and profiling\nfunctions in all running threads in addition to the calling one. (Contributed\nby Pablo Galindo in gh-93503.)\nAdd new function PyFunction_SetVectorcall() to the C API\nwhich sets the vectorcall field of a given PyFunctionObject.\n(Contributed by Andrew Frost in gh-92257.)\nThe C API now permits registering callbacks via PyDict_AddWatcher(),\nPyDict_Watch() and related APIs to be called whenever a dictionary\nis modified. This is intended for use by optimizing interpreters, JIT\ncompilers, or debuggers.\n(Contributed by Carl Meyer in gh-91052.)\nAdd PyType_AddWatcher() and PyType_Watch() API to register\ncallbacks to receive notification on changes to a type.\n(Contributed by Carl Meyer in gh-91051.)\nAdd PyCode_AddWatcher() and PyCode_ClearWatcher()\nAPIs to register callbacks to receive notification on creation and\ndestruction of code objects.\n(Contributed by Itamar Oren in gh-91054.)\nAdd PyFrame_GetVar() and PyFrame_GetVarString() functions to\nget a frame variable by its name.\n(Contributed by Victor Stinner in gh-91248.)\nAdd PyErr_GetRaisedException() and PyErr_SetRaisedException()\nfor saving and restoring the current exception.\nThese functions return and accept a single exception object,\nrather than the triple arguments of the now-deprecated\nPyErr_Fetch() and PyErr_Restore().\nThis is less error prone and a bit more efficient.\n(Contributed by Mark Shannon in gh-101578.)\nAdd _PyErr_ChainExceptions1, which takes an exception instance,\nto replace the legacy-API _PyErr_ChainExceptions, which is now\ndeprecated. (Contributed by Mark Shannon in gh-101578.)\nAdd PyException_GetArgs() and PyException_SetArgs()\nas convenience functions for retrieving and modifying\nthe args passed to the exception’s constructor.\n(Contributed by Mark Shannon in gh-101578.)\nAdd PyErr_DisplayException(), which takes an exception instance,\nto replace the legacy-api PyErr_Display(). (Contributed by\nIrit Katriel in gh-102755).\n\n\nPEP 683: Introduce Immortal Objects, which allows objects\nto bypass reference counts, and related changes to the C-API:\n\n\n_Py_IMMORTAL_REFCNT: The reference count that defines an objectas immortal.\n\n\n\n_Py_IsImmortal Checks if an object has the immortal reference count.\n\nPyObject_HEAD_INIT This will now initialize reference count to_Py_IMMORTAL_REFCNT when used with Py_BUILD_CORE.\n\n\n\n\nSSTATE_INTERNED_IMMORTAL An identifier for interned unicode objectsthat are immortal.\n\n\n\n\nSSTATE_INTERNED_IMMORTAL_STATIC An identifier for interned unicodeobjects that are immortal and static\n\n\n\n\nsys.getunicodeinternedsize This returns the total number of unicodeobjects that have been interned. This is now needed for refleak.py to\ncorrectly track reference counts and allocated blocks\n\n\n\n\n(Contributed by Eddie Elizondo in gh-84436.)\n\nPEP 684: Add the new Py_NewInterpreterFromConfig()\nfunction and PyInterpreterConfig, which may be used\nto create sub-interpreters with their own GILs.\n(See PEP 684: A Per-Interpreter GIL for more info.)\n(Contributed by Eric Snow in gh-104110.)\nIn the limited C API version 3.12, Py_INCREF() and\nPy_DECREF() functions are now implemented as opaque function calls to\nhide implementation details.\n(Contributed by Victor Stinner in gh-105387.)", "code_blocks": []}, "c-api-changes - id5": {"text": "Porting to Python 3.12\n\n\nLegacy Unicode APIs based on Py_UNICODE* representation has been removed.\nPlease migrate to APIs based on UTF-8 or wchar_t*.\nArgument parsing functions like PyArg_ParseTuple() doesn’t support\nPy_UNICODE* based format (e.g. u, Z) anymore. Please migrate\nto other formats for Unicode like s, z, es, and U.\ntp_weaklist for all static builtin types is always NULL.\nThis is an internal-only field on PyTypeObject\nbut we’re pointing out the change in case someone happens to be\naccessing the field directly anyway.  To avoid breakage, consider\nusing the existing public C-API instead, or, if necessary, the\n(internal-only) _PyObject_GET_WEAKREFS_LISTPTR() macro.\nThis internal-only PyTypeObject.tp_subclasses may now not be\na valid object pointer.  Its type was changed to void* to\nreflect this.  We mention this in case someone happens to be accessing the\ninternal-only field directly.\nTo get a list of subclasses, call the Python method\n__subclasses__() (using PyObject_CallMethod(),\nfor example).\n\nAdd support of more formatting options (left aligning, octals, uppercase\nhexadecimals, intmax_t, ptrdiff_t, wchar_t C\nstrings, variable width and precision) in PyUnicode_FromFormat() and\nPyUnicode_FromFormatV().\n(Contributed by Serhiy Storchaka in gh-98836.)\nAn unrecognized format character in PyUnicode_FromFormat() and\nPyUnicode_FromFormatV() now sets a SystemError.\nIn previous versions it caused all the rest of the format string to be\ncopied as-is to the result string, and any extra arguments discarded.\n(Contributed by Serhiy Storchaka in gh-95781.)\nFix wrong sign placement in PyUnicode_FromFormat() and\nPyUnicode_FromFormatV().\n(Contributed by Philip Georgi in gh-95504.)\nExtension classes wanting to add a __dict__ or weak reference slot\nshould use Py_TPFLAGS_MANAGED_DICT and\nPy_TPFLAGS_MANAGED_WEAKREF instead of tp_dictoffset and\ntp_weaklistoffset, respectively.\nThe use of tp_dictoffset and tp_weaklistoffset is still\nsupported, but does not fully support multiple inheritance\n(gh-95589), and performance may be worse.\nClasses declaring Py_TPFLAGS_MANAGED_DICT should call\n_PyObject_VisitManagedDict() and _PyObject_ClearManagedDict()\nto traverse and clear their instance’s dictionaries.\nTo clear weakrefs, call PyObject_ClearWeakRefs(), as before.\nThe PyUnicode_FSDecoder() function no longer accepts bytes-like\npaths, like bytearray and memoryview types: only the exact\nbytes type is accepted for bytes strings.\n(Contributed by Victor Stinner in gh-98393.)\nThe Py_CLEAR, Py_SETREF and Py_XSETREF\nmacros now only evaluate their arguments once. If an argument has side\neffects, these side effects are no longer duplicated.\n(Contributed by Victor Stinner in gh-98724.)\nThe interpreter’s error indicator is now always normalized. This means\nthat PyErr_SetObject(), PyErr_SetString() and the other\nfunctions that set the error indicator now normalize the exception\nbefore storing it. (Contributed by Mark Shannon in gh-101578.)\n_Py_RefTotal is no longer authoritative and only kept around\nfor ABI compatibility.  Note that it is an internal global and only\navailable on debug builds.  If you happen to be using it then you’ll\nneed to start using _Py_GetGlobalRefTotal().\nThe following functions now select an appropriate metaclass for the newly\ncreated type:\n\nPyType_FromSpec()\nPyType_FromSpecWithBases()\nPyType_FromModuleAndSpec()\n\nCreating classes whose metaclass overrides tp_new\nis deprecated, and in Python 3.14+ it will be disallowed.\nNote that these functions ignore tp_new of the metaclass, possibly\nallowing incomplete initialization.\nNote that PyType_FromMetaclass() (added in Python 3.12)\nalready disallows creating classes whose metaclass overrides tp_new\n(__new__() in Python).\nSince tp_new overrides almost everything PyType_From* functions do,\nthe two are incompatible with each other.\nThe existing behavior – ignoring the metaclass for several steps\nof type creation – is unsafe in general, since (meta)classes assume that\ntp_new was called.\nThere is no simple general workaround. One of the following may work for you:\n\nIf you control the metaclass, avoid using tp_new in it:\n\nIf initialization can be skipped, it can be done in\ntp_init instead.\nIf the metaclass doesn’t need to be instantiated from Python,\nset its tp_new to NULL using\nthe Py_TPFLAGS_DISALLOW_INSTANTIATION flag.\nThis makes it acceptable for PyType_From* functions.\n\n\nAvoid PyType_From* functions: if you don’t need C-specific features\n(slots or setting the instance size), create types by calling\nthe metaclass.\nIf you know the tp_new can be skipped safely, filter the deprecation\nwarning out using warnings.catch_warnings() from Python.\n\n\nPyOS_InputHook and PyOS_ReadlineFunctionPointer are no\nlonger called in subinterpreters. This is\nbecause clients generally rely on process-wide global state (since these\ncallbacks have no way of recovering extension module state).\nThis also avoids situations where extensions may find themselves running in a\nsubinterpreter that they don’t support (or haven’t yet been loaded in). See\ngh-104668 for more info.\n\nPyLongObject has had its internals changed for better performance.\nAlthough the internals of PyLongObject are private, they are used\nby some extension modules.\nThe internal fields should no longer be accessed directly, instead the API\nfunctions beginning PyLong_... should be used instead.\nTwo new unstable API functions are provided for efficient access to the\nvalue of PyLongObjects which fit into a single machine word:\n\nPyUnstable_Long_IsCompact()\nPyUnstable_Long_CompactValue()\n\n\nCustom allocators, set via PyMem_SetAllocator(), are now\nrequired to be thread-safe, regardless of memory domain.  Allocators\nthat don’t have their own state, including “hooks”, are not affected.\nIf your custom allocator is not already thread-safe and you need\nguidance then please create a new GitHub issue\nand CC @ericsnowcurrently.", "code_blocks": []}, "c-api-changes - id6": {"text": "Deprecated\n\n\nIn accordance with PEP 699, the ma_version_tag field in PyDictObject\nis deprecated for extension modules. Accessing this field will generate a compiler\nwarning at compile time. This field will be removed in Python 3.14.\n(Contributed by Ramvikrams and Kumar Aditya in gh-101193. PEP by Ken Jin.)\nDeprecate global configuration variable:\n\nPy_DebugFlag: use PyConfig.parser_debug\nPy_VerboseFlag: use PyConfig.verbose\nPy_QuietFlag: use PyConfig.quiet\nPy_InteractiveFlag: use PyConfig.interactive\nPy_InspectFlag: use PyConfig.inspect\nPy_OptimizeFlag: use PyConfig.optimization_level\nPy_NoSiteFlag: use PyConfig.site_import\nPy_BytesWarningFlag: use PyConfig.bytes_warning\nPy_FrozenFlag: use PyConfig.pathconfig_warnings\nPy_IgnoreEnvironmentFlag: use PyConfig.use_environment\nPy_DontWriteBytecodeFlag: use PyConfig.write_bytecode\nPy_NoUserSiteDirectory: use PyConfig.user_site_directory\nPy_UnbufferedStdioFlag: use PyConfig.buffered_stdio\nPy_HashRandomizationFlag: use PyConfig.use_hash_seed\nand PyConfig.hash_seed\nPy_IsolatedFlag: use PyConfig.isolated\nPy_LegacyWindowsFSEncodingFlag: use PyPreConfig.legacy_windows_fs_encoding\nPy_LegacyWindowsStdioFlag: use PyConfig.legacy_windows_stdio\nPy_FileSystemDefaultEncoding: use PyConfig.filesystem_encoding\nPy_HasFileSystemDefaultEncoding: use PyConfig.filesystem_encoding\nPy_FileSystemDefaultEncodeErrors: use PyConfig.filesystem_errors\nPy_UTF8Mode: use PyPreConfig.utf8_mode (see Py_PreInitialize())\n\nThe Py_InitializeFromConfig() API should be used with\nPyConfig instead.\n(Contributed by Victor Stinner in gh-77782.)\n\nCreating immutable types with mutable\nbases is deprecated and will be disabled in Python 3.14. (gh-95388)\nThe structmember.h header is deprecated, though it continues to be\navailable and there are no plans to remove it.\nIts contents are now available just by including Python.h,\nwith a Py prefix added if it was missing:\n\nPyMemberDef, PyMember_GetOne() and\nPyMember_SetOne()\nType macros like Py_T_INT, Py_T_DOUBLE, etc.\n(previously T_INT, T_DOUBLE, etc.)\nThe flags Py_READONLY (previously READONLY) and\nPy_AUDIT_READ (previously all uppercase)\n\nSeveral items are not exposed from Python.h:\n\nT_OBJECT (use Py_T_OBJECT_EX)\nT_NONE (previously undocumented, and pretty quirky)\nThe macro WRITE_RESTRICTED which does nothing.\nThe macros RESTRICTED and READ_RESTRICTED, equivalents of\nPy_AUDIT_READ.\nIn some configurations, <stddef.h> is not included from Python.h.\nIt should be included manually when using offsetof().\n\nThe deprecated header continues to provide its original\ncontents under the original names.\nYour old code can stay unchanged, unless the extra include and non-namespaced\nmacros bother you greatly.\n(Contributed in gh-47146 by Petr Viktorin, based on\nearlier work by Alexander Belopolsky and Matthias Braun.)\n\nPyErr_Fetch() and PyErr_Restore() are deprecated.\nUse PyErr_GetRaisedException() and\nPyErr_SetRaisedException() instead.\n(Contributed by Mark Shannon in gh-101578.)\nPyErr_Display() is deprecated. Use PyErr_DisplayException()\ninstead. (Contributed by Irit Katriel in gh-102755).\n_PyErr_ChainExceptions is deprecated. Use _PyErr_ChainExceptions1\ninstead. (Contributed by Irit Katriel in gh-102192.)\nUsing PyType_FromSpec(), PyType_FromSpecWithBases()\nor PyType_FromModuleAndSpec() to create a class whose metaclass\noverrides tp_new is deprecated.\nCall the metaclass instead.\n\n\nPending Removal in Python 3.14\n\n\nThe ma_version_tag field in PyDictObject for extension modules\n(PEP 699; gh-101193).\nCreating immutable types with mutable\nbases (gh-95388).\nFunctions to configure Python’s initialization, deprecated in Python 3.11:\n\nPySys_SetArgvEx():\nSet PyConfig.argv instead.\nPySys_SetArgv():\nSet PyConfig.argv instead.\nPy_SetProgramName():\nSet PyConfig.program_name instead.\nPy_SetPythonHome():\nSet PyConfig.home instead.\n\nThe Py_InitializeFromConfig() API should be used with\nPyConfig instead.\n\nGlobal configuration variables:\n\nPy_DebugFlag:\nUse PyConfig.parser_debug instead.\nPy_VerboseFlag:\nUse PyConfig.verbose instead.\nPy_QuietFlag:\nUse PyConfig.quiet instead.\nPy_InteractiveFlag:\nUse PyConfig.interactive instead.\nPy_InspectFlag:\nUse PyConfig.inspect instead.\nPy_OptimizeFlag:\nUse PyConfig.optimization_level instead.\nPy_NoSiteFlag:\nUse PyConfig.site_import instead.\nPy_BytesWarningFlag:\nUse PyConfig.bytes_warning instead.\nPy_FrozenFlag:\nUse PyConfig.pathconfig_warnings instead.\nPy_IgnoreEnvironmentFlag:\nUse PyConfig.use_environment instead.\nPy_DontWriteBytecodeFlag:\nUse PyConfig.write_bytecode instead.\nPy_NoUserSiteDirectory:\nUse PyConfig.user_site_directory instead.\nPy_UnbufferedStdioFlag:\nUse PyConfig.buffered_stdio instead.\nPy_HashRandomizationFlag:\nUse PyConfig.use_hash_seed\nand PyConfig.hash_seed instead.\nPy_IsolatedFlag:\nUse PyConfig.isolated instead.\nPy_LegacyWindowsFSEncodingFlag:\nUse PyPreConfig.legacy_windows_fs_encoding instead.\nPy_LegacyWindowsStdioFlag:\nUse PyConfig.legacy_windows_stdio instead.\nPy_FileSystemDefaultEncoding:\nUse PyConfig.filesystem_encoding instead.\nPy_HasFileSystemDefaultEncoding:\nUse PyConfig.filesystem_encoding instead.\nPy_FileSystemDefaultEncodeErrors:\nUse PyConfig.filesystem_errors instead.\nPy_UTF8Mode:\nUse PyPreConfig.utf8_mode instead.\n(see Py_PreInitialize())\n\nThe Py_InitializeFromConfig() API should be used with\nPyConfig instead.\n\n\n\n\nPending Removal in Python 3.15\n\n\nThe bundled copy of libmpdecimal.\nThe PyImport_ImportModuleNoBlock():\nUse PyImport_ImportModule() instead.\nPyWeakref_GetObject() and PyWeakref_GET_OBJECT():\nUse PyWeakref_GetRef() instead.\nPy_UNICODE type and the Py_UNICODE_WIDE macro:\nUse wchar_t instead.\nPython initialization functions:\n\nPySys_ResetWarnOptions():\nClear sys.warnoptions and warnings.filters instead.\nPy_GetExecPrefix():\nGet sys.exec_prefix instead.\nPy_GetPath():\nGet sys.path instead.\nPy_GetPrefix():\nGet sys.prefix instead.\nPy_GetProgramFullPath():\nGet sys.executable instead.\nPy_GetProgramName():\nGet sys.executable instead.\nPy_GetPythonHome():\nGet PyConfig.home\nor the PYTHONHOME environment variable instead.\n\n\n\n\n\nPending Removal in Future Versions\n\nThe following APIs are deprecated and will be removed,\nalthough there is currently no date scheduled for their removal.\n\nPy_TPFLAGS_HAVE_FINALIZE:\nUnneeded since Python 3.8.\nPyErr_Fetch():\nUse PyErr_GetRaisedException() instead.\nPyErr_NormalizeException():\nUse PyErr_GetRaisedException() instead.\nPyErr_Restore():\nUse PyErr_SetRaisedException() instead.\nPyModule_GetFilename():\nUse PyModule_GetFilenameObject() instead.\nPyOS_AfterFork():\nUse PyOS_AfterFork_Child() instead.\nPySlice_GetIndicesEx():\nUse PySlice_Unpack() and PySlice_AdjustIndices() instead.\nPyUnicode_AsDecodedObject():\nUse PyCodec_Decode() instead.\nPyUnicode_AsDecodedUnicode():\nUse PyCodec_Decode() instead.\nPyUnicode_AsEncodedObject():\nUse PyCodec_Encode() instead.\nPyUnicode_AsEncodedUnicode():\nUse PyCodec_Encode() instead.\nPyUnicode_READY():\nUnneeded since Python 3.12\nPyErr_Display():\nUse PyErr_DisplayException() instead.\n_PyErr_ChainExceptions():\nUse _PyErr_ChainExceptions1() instead.\nPyBytesObject.ob_shash member:\ncall PyObject_Hash() instead.\nPyDictObject.ma_version_tag member.\nThread Local Storage (TLS) API:\n\nPyThread_create_key():\nUse PyThread_tss_alloc() instead.\nPyThread_delete_key():\nUse PyThread_tss_free() instead.\nPyThread_set_key_value():\nUse PyThread_tss_set() instead.\nPyThread_get_key_value():\nUse PyThread_tss_get() instead.\nPyThread_delete_key_value():\nUse PyThread_tss_delete() instead.\nPyThread_ReInitTLS():\nUnneeded since Python 3.7.", "code_blocks": []}, "c-api-changes - id10": {"text": "Removed\n\n\nRemove the token.h header file. There was never any public tokenizer C\nAPI. The token.h header file was only designed to be used by Python\ninternals.\n(Contributed by Victor Stinner in gh-92651.)\nLegacy Unicode APIs have been removed. See PEP 623 for detail.\n\nPyUnicode_WCHAR_KIND\nPyUnicode_AS_UNICODE()\nPyUnicode_AsUnicode()\nPyUnicode_AsUnicodeAndSize()\nPyUnicode_AS_DATA()\nPyUnicode_FromUnicode()\nPyUnicode_GET_SIZE()\nPyUnicode_GetSize()\nPyUnicode_GET_DATA_SIZE()\n\n\nRemove the PyUnicode_InternImmortal() function macro.\n(Contributed by Victor Stinner in gh-85858.)", "code_blocks": []}, "notable-changes-in-3-12-4 - ipaddress": {"text": "ipaddress\n\n\nFixed is_global and is_private behavior in IPv4Address,\nIPv6Address, IPv4Network and IPv6Network.", "code_blocks": []}, "notable-changes-in-3-12-5 - email": {"text": "email\n\n\nHeaders with embedded newlines are now quoted on output.\nThe generator will now refuse to serialize (write) headers\nthat are improperly folded or delimited, such that they would be parsed as\nmultiple headers or joined with adjacent data.\nIf you need to turn this safety feature off,\nset verify_generated_headers.\n(Contributed by Bas Bloemsaat and Petr Viktorin in gh-121650.)", "code_blocks": []}, "notable-changes-in-3-12-6 - id11": {"text": "email\n\n\nemail.utils.getaddresses() and email.utils.parseaddr() now return\n('', '') 2-tuples in more situations where invalid email addresses are\nencountered, instead of potentially inaccurate values.\nAn optional strict parameter was added to these two functions:\nuse strict=False to get the old behavior, accepting malformed inputs.\ngetattr(email.utils, 'supports_strict_parsing', False) can be used to\ncheck if the strict paramater is available.\n(Contributed by Thomas Dwyer and Victor Stinner for gh-102988 to improve\nthe CVE-2023-27043 fix.)", "code_blocks": []}}}
{"index": 15, "python_version": "3.13", "url": "https://docs.python.org/3.13/whatsnew/3.13.html", "sections": {"summary-release-highlights": {"text": "Summary – Release Highlights\n\nPython 3.13 will be the latest stable release of the Python programming\nlanguage, with a mix of changes to the language, the implementation\nand the standard library.\nThe biggest changes include a new interactive interpreter,\nexperimental support for running in a free-threaded mode (PEP 703),\nand a Just-In-Time compiler (PEP 744).\nError messages continue to improve, with tracebacks now highlighted in color\nby default. The locals() builtin now has defined semantics for changing the returned mapping,\nand type parameters now support default values.\nThe library changes contain removal of deprecated APIs and modules,\nas well as the usual improvements in user-friendliness and correctness.\nSeveral legacy standard library modules have now been removed following their deprecation in Python 3.11 (PEP 594).\nThis article doesn’t attempt to provide a complete specification\nof all new features, but instead gives a convenient overview.\nFor full details refer to the documentation,\nsuch as the Library Reference\nand Language Reference.\nTo understand the complete implementation and design rationale for a change,\nrefer to the PEP for a particular new feature;\nbut note that PEPs usually are not kept up-to-date\nonce a feature has been fully implemented.\nSee Porting to Python 3.13 for guidance on upgrading from\nearlier versions of Python.\n\nInterpreter improvements:\n\nA greatly improved interactive interpreter and\nimproved error messages.\nPEP 667: The locals() builtin now has\ndefined semantics when mutating the\nreturned mapping. Python debuggers and similar tools may now more reliably\nupdate local variables in optimized scopes even during concurrent code\nexecution.\nPEP 703: CPython 3.13 has experimental support for running with the\nglobal interpreter lock disabled. See Free-threaded CPython for more details.\nPEP 744: A basic JIT compiler was added.\nIt is currently disabled by default (though we may turn it on later).\nPerformance improvements are modest – we expect to improve this\nover the next few releases.\nColor support in the new interactive interpreter,\nas well as in tracebacks\nand doctest output.\nThis can be disabled through the PYTHON_COLORS and NO_COLOR\nenvironment variables.\n\nPython data model improvements:\n\n__static_attributes__ stores the names of attributes accessed\nthrough self.X in any function in a class body.\n__firstlineno__ records the first line number of a class\ndefinition.\n\nSignificant improvements in the standard library:\n\nAdd a new PythonFinalizationError exception, raised when an operation\nis blocked during finalization.\nThe argparse module now supports deprecating command-line options,\npositional arguments, and subcommands.\nThe new functions base64.z85encode() and base64.z85decode()\nsupport encoding and decoding Z85 data.\nThe copy module now has a copy.replace() function,\nwith support for many builtin types and any class defining\nthe __replace__() method.\nThe new dbm.sqlite3 module is now the default dbm backend.\nThe os module has a suite of new functions\nfor working with Linux’s timer notification file descriptors.\nThe random module now has a command-line interface.\n\nSecurity improvements:\n\nssl.create_default_context() sets ssl.VERIFY_X509_PARTIAL_CHAIN\nand ssl.VERIFY_X509_STRICT as default flags.\n\nC API improvements:\n\nThe Py_mod_gil slot is now used to indicate that\nan extension module supports running with the GIL disabled.\nThe PyTime C API has been added,\nproviding access to system clocks.\nPyMutex is a new lightweight mutex that occupies a single byte.\nThere is a new suite of functions\nfor generating PEP 669 monitoring events in the C API.\n\nNew typing features:\n\nPEP 696: Type parameters (typing.TypeVar, typing.ParamSpec,\nand typing.TypeVarTuple) now support defaults.\nPEP 702: The new warnings.deprecated() decorator adds support\nfor marking deprecations in the type system and at runtime.\nPEP 705: typing.ReadOnly can be used to mark an item of a\ntyping.TypedDict as read-only for type checkers.\nPEP 742: typing.TypeIs provides more intuitive\ntype narrowing behavior, as an alternative to typing.TypeGuard.\n\nPlatform support:\n\nPEP 730: Apple’s iOS is now an officially supported platform, at tier 3.\nPEP 738: Android is now an officially supported platform, at tier 3.\nwasm32-wasi is now supported as a tier 2 platform.\nwasm32-emscripten is no longer an officially supported platform.\n\nImportant removals:\n\nPEP 594: The remaining 19 “dead batteries”\n(legacy stdlib modules) have been removed from the standard library:\naifc, audioop, cgi, cgitb, chunk,\ncrypt, imghdr, mailcap, msilib, nis,\nnntplib, ossaudiodev, pipes, sndhdr,\nspwd, sunau, telnetlib, uu and xdrlib.\nRemove the 2to3 tool and lib2to3 module\n(deprecated in Python 3.11).\nRemove the tkinter.tix module (deprecated in Python 3.6).\nRemove the locale.resetlocale() function.\nRemove the typing.io and typing.re namespaces.\nRemove chained classmethod descriptors.\n\nRelease schedule changes:\nPEP 602 (“Annual Release Cycle for Python”) has been updated\nto extend the full support (‘bugfix’) period for new releases to two years.\nThis updated policy means that:\n\nPython 3.9–3.12 have one and a half years of full support,\nfollowed by three and a half years of security fixes.\nPython 3.13 and later have two years of full support,\nfollowed by three years of security fixes.", "code_blocks": []}, "new-features - a-better-interactive-interpreter": {"text": "A better interactive interpreter\n\nPython now uses a new interactive shell by default, based on code\nfrom the PyPy project.\nWhen the user starts the REPL from an interactive terminal,\nthe following new features are now supported:\n\nMultiline editing with history preservation.\nDirect support for REPL-specific commands like help, exit,\nand quit, without the need to call them as functions.\nPrompts and tracebacks with color enabled by default.\nInteractive help browsing using F1 with a separate command\nhistory.\nHistory browsing using F2 that skips output as well as the\n>>> and … prompts.\n“Paste mode” with F3 that makes pasting larger blocks of code\neasier (press F3 again to return to the regular prompt).\n\nTo disable the new interactive shell,\nset the PYTHON_BASIC_REPL environment variable.\nFor more on interactive mode, see Interactive Mode.\n(Contributed by Pablo Galindo Salgado, Łukasz Langa, and\nLysandros Nikolaou in gh-111201 based on code from the PyPy project.\nWindows support contributed by Dino Viehland and Anthony Shaw.)", "code_blocks": []}, "new-features - improved-error-messages": {"text": "Improved error messages\n\n\nThe interpreter now uses color by default when displaying tracebacks in the\nterminal. This feature can be controlled\nvia the new PYTHON_COLORS environment variable as well as\nthe canonical NO_COLOR and FORCE_COLOR environment variables.\n(Contributed by Pablo Galindo Salgado in gh-112730.)\n\n\nA common mistake is to write a script with the same name as a\nstandard library module. When this results in errors, we now\ndisplay a more helpful error message:\n$ python random.py\nTraceback (most recent call last):\n  File \"/home/me/random.py\", line 1, in <module>\n    import random\n  File \"/home/me/random.py\", line 3, in <module>\n    print(random.randint(5))\n          ^^^^^^^^^^^^^^\nAttributeError: module 'random' has no attribute 'randint' (consider renaming '/home/me/random.py' since it has the same name as the standard library module named 'random' and the import system gives it precedence)\n\n\nSimilarly, if a script has the same name as a third-party\nmodule that it attempts to import and this results in errors,\nwe also display a more helpful error message:\n$ python numpy.py\nTraceback (most recent call last):\n  File \"/home/me/numpy.py\", line 1, in <module>\n    import numpy as np\n  File \"/home/me/numpy.py\", line 3, in <module>\n    np.array([1, 2, 3])\n    ^^^^^^^^\nAttributeError: module 'numpy' has no attribute 'array' (consider renaming '/home/me/numpy.py' if it has the same name as a third-party module you intended to import)\n\n\n(Contributed by Shantanu Jain in gh-95754.)\n\nThe error message now tries to suggest the correct keyword argument\nwhen an incorrect keyword argument is passed to a function.\n>>> \"Better error messages!\".split(max_split=1)\nTraceback (most recent call last):\n  File \"<python-input-0>\", line 1, in <module>\n    \"Better error messages!\".split(max_split=1)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^\nTypeError: split() got an unexpected keyword argument 'max_split'. Did you mean 'maxsplit'?\n\n\n(Contributed by Pablo Galindo Salgado and Shantanu Jain in gh-107944.)", "code_blocks": ["$ python random.py\nTraceback (most recent call last):\n  File \"/home/me/random.py\", line 1, in <module>\n    import random\n  File \"/home/me/random.py\", line 3, in <module>\n    print(random.randint(5))\n          ^^^^^^^^^^^^^^\nAttributeError: module 'random' has no attribute 'randint' (consider renaming '/home/me/random.py' since it has the same name as the standard library module named 'random' and the import system gives it precedence)\n", "$ python numpy.py\nTraceback (most recent call last):\n  File \"/home/me/numpy.py\", line 1, in <module>\n    import numpy as np\n  File \"/home/me/numpy.py\", line 3, in <module>\n    np.array([1, 2, 3])\n    ^^^^^^^^\nAttributeError: module 'numpy' has no attribute 'array' (consider renaming '/home/me/numpy.py' if it has the same name as a third-party module you intended to import)\n", ">>> \"Better error messages!\".split(max_split=1)\nTraceback (most recent call last):\n  File \"<python-input-0>\", line 1, in <module>\n    \"Better error messages!\".split(max_split=1)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^\nTypeError: split() got an unexpected keyword argument 'max_split'. Did you mean 'maxsplit'?\n"]}, "new-features - free-threaded-cpython": {"text": "Free-threaded CPython\n\nCPython now has experimental support for running in a free-threaded mode,\nwith the global interpreter lock (GIL) disabled.\nThis is an experimental feature and therefore is not enabled by default.\nThe free-threaded mode requires a different executable,\nusually called python3.13t or python3.13t.exe.\nPre-built binaries marked as free-threaded can be installed as part of\nthe official Windows\nand macOS installers,\nor CPython can be built from source with the --disable-gil option.\nFree-threaded execution allows for full utilization of the available\nprocessing power by running threads in parallel on available CPU cores.\nWhile not all software will benefit from this automatically, programs\ndesigned with threading in mind will run faster on multi-core hardware.\nThe free-threaded mode is experimental and work is ongoing to improve it:\nexpect some bugs and a substantial single-threaded performance hit.\nFree-threaded builds of CPython support optionally running with the GIL\nenabled at runtime using the environment variable PYTHON_GIL or\nthe command-line option -X gil=1.\nTo check if the current interpreter supports free-threading, python -VV\nand sys.version contain “experimental free-threading build”.\nThe new sys._is_gil_enabled() function can be used to check whether\nthe GIL is actually disabled in the running process.\nC-API extension modules need to be built specifically for the free-threaded\nbuild. Extensions that support running with the GIL disabled should\nuse the Py_mod_gil slot. Extensions using single-phase init should\nuse PyUnstable_Module_SetGIL() to indicate whether they support\nrunning with the GIL disabled. Importing C extensions that don’t use these\nmechanisms will cause the GIL to be enabled, unless the GIL was explicitly\ndisabled with the PYTHON_GIL environment variable or the\n-X gil=0 option.\npip 24.1 or newer is required to install packages with C extensions in the\nfree-threaded build.\nThis work was made possible thanks to many individuals and\norganizations, including the large community of contributors to Python\nand third-party projects to test and enable free-threading support.\nNotable contributors include:\nSam Gross, Ken Jin, Donghee Na, Itamar Oren, Matt Page, Brett Simmers,\nDino Viehland, Carl Meyer, Nathan Goldbaum, Ralf Gommers,\nLysandros Nikolaou, and many others.\nMany of these contributors are employed by Meta, which has\nprovided significant engineering resources to support this project.\n\nSee also\nPEP 703 “Making the Global Interpreter Lock Optional in CPython”\ncontains rationale and information surrounding this work.\nPorting Extension Modules to Support Free-Threading: A community-maintained\nporting guide for extension authors.", "code_blocks": []}, "new-features - an-experimental-just-in-time-jit-compiler": {"text": "An experimental just-in-time (JIT) compiler\n\nWhen CPython is configured and built using\nthe --enable-experimental-jit option,\na just-in-time (JIT) compiler is added which may speed up some Python programs.\nOn Windows, use PCbuild/build.bat --experimental-jit to enable the JIT\nor --experimental-jit-interpreter to enable the Tier 2 interpreter.\nBuild requirements and further supporting information are contained at\nTools/jit/README.md.\nThe --enable-experimental-jit option takes these (optional) values,\ndefaulting to yes if --enable-experimental-jit is present\nwithout the optional value.\n\nno: Disable the entire Tier 2 and JIT pipeline.\nyes: Enable the JIT.\nTo disable the JIT at runtime, pass the environment variable PYTHON_JIT=0.\nyes-off: Build the JIT but disable it by default.\nTo enable the JIT at runtime, pass the environment variable PYTHON_JIT=1.\ninterpreter: Enable the Tier 2 interpreter but disable the JIT.\nThe interpreter can be disabled by running with PYTHON_JIT=0.\n\nThe internal architecture is roughly as follows:\n\nWe start with specialized Tier 1 bytecode.\nSee What’s new in 3.11 for details.\nWhen the Tier 1 bytecode gets hot enough, it gets translated\nto a new purely internal intermediate representation (IR),\ncalled the Tier 2 IR, and sometimes referred to as micro-ops (“uops”).\nThe Tier 2 IR uses the same stack-based virtual machine as Tier 1,\nbut the instruction format is better suited to translation to machine code.\nWe have several optimization passes for Tier 2 IR, which are applied\nbefore it is interpreted or translated to machine code.\nThere is a Tier 2 interpreter, but it is mostly intended for debugging\nthe earlier stages of the optimization pipeline.\nThe Tier 2 interpreter can be enabled by configuring Python\nwith --enable-experimental-jit=interpreter.\nWhen the JIT is enabled, the optimized\nTier 2 IR is translated to machine code, which is then executed.\nThe machine code translation process uses a technique called\ncopy-and-patch. It has no runtime dependencies, but there is a new\nbuild-time dependency on LLVM.\n\n\nSee also\nPEP 744\n\n(JIT by Brandt Bucher, inspired by a paper by Haoran Xu and Fredrik Kjolstad.\nTier 2 IR by Mark Shannon and Guido van Rossum.\nTier 2 optimizer by Ken Jin.)", "code_blocks": []}, "new-features - defined-mutation-semantics-for-locals": {"text": "Defined mutation semantics for locals()\n\nHistorically, the expected result of mutating the return value of\nlocals() has been left to individual Python implementations to define.\nStarting from Python 3.13, PEP 667 standardises\nthe historical behavior of CPython for most code execution scopes,\nbut changes optimized scopes\n(functions, generators, coroutines, comprehensions, and generator expressions)\nto explicitly return independent snapshots of the currently assigned local\nvariables, including locally referenced nonlocal variables captured in closures.\nThis change to the semantics of locals() in optimized scopes also\naffects the default behavior of code execution functions that implicitly\ntarget locals() if no explicit namespace is provided\n(such as exec() and eval()).\nIn previous versions, whether or not changes could be accessed by calling\nlocals() after calling the code execution function was\nimplementation-dependent. In CPython specifically, such code would typically\nappear to work as desired, but could sometimes fail in optimized scopes based\non other code (including debuggers and code execution tracing tools)\npotentially resetting the shared snapshot in that scope.\nNow, the code will always run against an independent snapshot of\nthe local variables in optimized scopes, and hence the changes will never\nbe visible in subsequent calls to locals().\nTo access the changes made in these cases, an explicit namespace reference\nmust now be passed to the relevant function.\nAlternatively, it may make sense to update affected code to use a higher level\ncode execution API that returns the resulting code execution namespace\n(e.g. runpy.run_path() when executing Python files from disk).\nTo ensure debuggers and similar tools can reliably update local variables in\nscopes affected by this change, FrameType.f_locals now\nreturns a write-through proxy to the frame’s local and locally referenced\nnonlocal variables in these scopes, rather than returning an inconsistently\nupdated shared dict instance with undefined runtime semantics.\nSee PEP 667 for more details, including related C API changes\nand deprecations. Porting notes are also provided below for the affected\nPython APIs and C APIs.\n(PEP and implementation contributed by Mark Shannon and Tian Gao in\ngh-74929. Documentation updates provided by Guido van Rossum and\nAlyssa Coghlan.)", "code_blocks": []}, "new-features - support-for-mobile-platforms": {"text": "Support for mobile platforms\n\nPEP 730: iOS is now a PEP 11 supported platform, with the\narm64-apple-ios and arm64-apple-ios-simulator targets at tier 3\n(iPhone and iPad devices released after 2013 and the Xcode iOS simulator\nrunning on Apple silicon hardware, respectively).\nx86_64-apple-ios-simulator\n(the Xcode iOS simulator running on older x86_64 hardware)\nis not a tier 3 supported platform, but will have best-effort support.\n(PEP written and implementation contributed by Russell Keith-Magee in\ngh-114099.)\nPEP 738: Android is now a PEP 11 supported platform, with the\naarch64-linux-android and x86_64-linux-android targets at tier 3.\nThe 32-bit targets arm-linux-androideabi and i686-linux-android\nare not tier 3 supported platforms, but will have best-effort support.\n(PEP written and implementation contributed by Malcolm Smith in\ngh-116622.)\n\nSee also\nPEP 730, PEP 738", "code_blocks": []}, "new-features - incremental-garbage-collection": {"text": "Incremental garbage collection\n\nThe cycle garbage collector is now incremental.\nThis means that maximum pause times are reduced\nby an order of magnitude or more for larger heaps.\nThere are now only two generations: young and old.\nWhen gc.collect() is not called directly, the\nGC is invoked a little less frequently. When invoked, it\ncollects the young generation and an increment of the\nold generation, instead of collecting one or more generations.\nThe behavior of gc.collect() changes slightly:\n\ngc.collect(1): Performs an increment of garbage collection,\nrather than collecting generation 1.\nOther calls to gc.collect() are unchanged.\n\n(Contributed by Mark Shannon in gh-108362.)", "code_blocks": []}, "other-language-changes": {"text": "Other Language Changes\n\n\nThe compiler now strips common leading whitespace\nfrom every line in a docstring.\nThis reduces the size of the bytecode cache\n(such as .pyc files), with reductions in file size of around 5%,\nfor example in sqlalchemy.orm.session from SQLAlchemy 2.0.\nThis change affects tools that use docstrings, such as doctest.\n>>> def spam():\n...     \"\"\"\n...         This is a docstring with\n...           leading whitespace.\n...\n...         It even has multiple paragraphs!\n...     \"\"\"\n...\n>>> spam.__doc__\n'\\nThis is a docstring with\\n  leading whitespace.\\n\\nIt even has multiple paragraphs!\\n'\n\n\n(Contributed by Inada Naoki in gh-81283.)\n\nAnnotation scopes within class scopes\ncan now contain lambdas and comprehensions.\nComprehensions that are located within class scopes\nare not inlined into their parent scope.\nclass C[T]:\n    type Alias = lambda: T\n\n\n(Contributed by Jelle Zijlstra in gh-109118 and gh-118160.)\n\nFuture statements are no longer triggered by\nrelative imports of the __future__ module,\nmeaning that statements of the form from .__future__ import ...\nare now simply standard relative imports, with no special features activated.\n(Contributed by Jeremiah Gabriel Pascual in gh-118216.)\nglobal declarations are now permitted in except blocks\nwhen that global is used in the else block.\nPreviously this raised an erroneous SyntaxError.\n(Contributed by Irit Katriel in gh-111123.)\nAdd PYTHON_FROZEN_MODULES, a new environment variable that\ndetermines whether frozen modules are ignored by the import machinery,\nequivalent to the -X frozen_modules command-line option.\n(Contributed by Yilei Yang in gh-111374.)\nAdd support for the perf profiler working\nwithout frame pointers through\nthe new environment variable PYTHON_PERF_JIT_SUPPORT\nand command-line option -X perf_jit.\n(Contributed by Pablo Galindo in gh-118518.)\nThe location of a .python_history file can be changed via the\nnew PYTHON_HISTORY environment variable.\n(Contributed by Levi Sabah, Zackery Spytz and Hugo van Kemenade\nin gh-73965.)\nClasses have a new __static_attributes__ attribute.\nThis is populated by the compiler with a tuple of the class’s attribute names\nwhich are assigned through self.<name> from any function in its body.\n(Contributed by Irit Katriel in gh-115775.)\nThe compiler now creates a __firstlineno__ attribute on classes\nwith the line number of the first line of the class definition.\n(Contributed by Serhiy Storchaka in gh-118465.)\nThe exec() and eval() builtins now accept\nthe globals and locals arguments as keywords.\n(Contributed by Raphael Gaschignard in gh-105879)\nThe compile() builtin now accepts a new flag,\nast.PyCF_OPTIMIZED_AST, which is similar to ast.PyCF_ONLY_AST\nexcept that the returned AST is optimized according to\nthe value of the optimize argument.\n(Contributed by Irit Katriel in gh-108113).\nAdd a __name__ attribute on property objects.\n(Contributed by Eugene Toder in gh-101860.)\nAdd PythonFinalizationError, a new exception derived from\nRuntimeError and used to signal when operations are blocked\nduring finalization.\nThe following callables now raise PythonFinalizationError,\ninstead of RuntimeError:\n\n_thread.start_new_thread()\nos.fork()\nos.forkpty()\nsubprocess.Popen\n\n(Contributed by Victor Stinner in gh-114570.)\n\nAllow the count argument of str.replace() to be a keyword.\n(Contributed by Hugo van Kemenade in gh-106487.)\nMany functions now emit a warning if a boolean value is passed as\na file descriptor argument.\nThis can help catch some errors earlier.\n(Contributed by Serhiy Storchaka in gh-82626.)\nAdded name and mode attributes\nfor compressed and archived file-like objects in\nthe bz2, lzma, tarfile, and zipfile modules.\n(Contributed by Serhiy Storchaka in gh-115961.)", "code_blocks": [">>> def spam():\n...     \"\"\"\n...         This is a docstring with\n...           leading whitespace.\n...\n...         It even has multiple paragraphs!\n...     \"\"\"\n...\n>>> spam.__doc__\n'\\nThis is a docstring with\\n  leading whitespace.\\n\\nIt even has multiple paragraphs!\\n'\n", "class C[T]:\n    type Alias = lambda: T\n"]}, "new-modules": {"text": "New Modules\n\n\ndbm.sqlite3: An SQLite backend for dbm.\n(Contributed by Raymond Hettinger and Erlend E. Aasland in gh-100414.)", "code_blocks": []}, "improved-modules - argparse": {"text": "argparse\n\n\nAdd the deprecated parameter to the\nadd_argument()\nand add_parser() methods, to enable deprecating\ncommand-line options, positional arguments, and subcommands.\n(Contributed by Serhiy Storchaka in gh-83648.)", "code_blocks": []}, "improved-modules - array": {"text": "array\n\n\nAdd the 'w' type code (Py_UCS4) for Unicode characters.\nIt should be used instead of the deprecated 'u' type code.\n(Contributed by Inada Naoki in gh-80480.)\nRegister array.array as a MutableSequence\nby implementing the clear() method.\n(Contributed by Mike Zimin in gh-114894.)", "code_blocks": []}, "improved-modules - ast": {"text": "ast\n\n\nThe constructors of node types in the ast module are now\nstricter in the arguments they accept,\nwith more intuitive behavior when arguments are omitted.\nIf an optional field on an AST node is not included as an argument when\nconstructing an instance, the field will now be set to None. Similarly,\nif a list field is omitted, that field will now be set to an empty list,\nand if an expr_context field is omitted, it defaults to\nLoad().\n(Previously, in all cases, the attribute would be missing on the newly\nconstructed AST node instance.)\nIn all other cases, where a required argument is omitted,\nthe node constructor will emit a DeprecationWarning.\nThis will raise an exception in Python 3.15.\nSimilarly, passing a keyword argument to the constructor\nthat does not map to a field on the AST node is now deprecated,\nand will raise an exception in Python 3.15.\nThese changes do not apply to user-defined subclasses of ast.AST\nunless the class opts in to the new behavior\nby defining the AST._field_types mapping.\n(Contributed by Jelle Zijlstra in gh-105858, gh-117486, and gh-118851.)\n\nast.parse() now accepts an optional argument optimize\nwhich is passed on to compile().\nThis makes it possible to obtain an optimized AST.\n(Contributed by Irit Katriel in gh-108113.)", "code_blocks": []}, "improved-modules - asyncio": {"text": "asyncio\n\n\nasyncio.as_completed() now returns an object that is both an\nasynchronous iterator and a plain iterator\nof awaitables.\nThe awaitables yielded by asynchronous iteration include original task\nor future objects that were passed in,\nmaking it easier to associate results with the tasks being completed.\n(Contributed by Justin Arthur in gh-77714.)\nasyncio.loop.create_unix_server() will now automatically remove\nthe Unix socket when the server is closed.\n(Contributed by Pierre Ossman in gh-111246.)\nDatagramTransport.sendto() will now send zero-length\ndatagrams if called with an empty bytes object.\nThe transport flow control also now accounts for the datagram header\nwhen calculating the buffer size.\n(Contributed by Jamie Phan in gh-115199.)\nAdd Queue.shutdown\nand QueueShutDown to manage queue termination.\n(Contributed by Laurie Opperman and Yves Duprat in gh-104228.)\nAdd the Server.close_clients() and Server.abort_clients()\nmethods, which more forcefully close an asyncio server.\n(Contributed by Pierre Ossman in gh-113538.)\nAccept a tuple of separators in StreamReader.readuntil(),\nstopping when any one of them is encountered.\n(Contributed by Bruce Merry in gh-81322.)\nImprove the behavior of TaskGroup when\nan external cancellation collides with an internal cancellation.\nFor example, when two task groups are nested\nand both experience an exception in a child task simultaneously,\nit was possible that the outer task group would hang,\nbecause its internal cancellation was swallowed by the inner task group.\nIn the case where a task group is cancelled externally\nand also must raise an ExceptionGroup,\nit will now call the parent task’s cancel() method.\nThis ensures that a CancelledError will be raised\nat the next await, so the cancellation is not lost.\nAn added benefit of these changes is that task groups now preserve\nthe cancellation count (cancelling()).\nIn order to handle some corner cases, uncancel() may now\nreset the undocumented _must_cancel flag\nwhen the cancellation count reaches zero.\n(Inspired by an issue reported by Arthur Tacca in gh-116720.)\n\nWhen TaskGroup.create_task() is called on an inactive\nTaskGroup, the given coroutine will be closed (which\nprevents a RuntimeWarning about the given coroutine being\nnever awaited).\n(Contributed by Arthur Tacca and Jason Zhang in gh-115957.)", "code_blocks": []}, "improved-modules - base64": {"text": "base64\n\n\nAdd z85encode() and z85decode() functions\nfor encoding bytes as Z85 data\nand decoding Z85-encoded data to bytes.\n(Contributed by Matan Perelman in gh-75299.)", "code_blocks": []}, "improved-modules - compileall": {"text": "compileall\n\n\nThe default number of worker threads and processes is now selected using\nos.process_cpu_count() instead of os.cpu_count().\n(Contributed by Victor Stinner in gh-109649.)", "code_blocks": []}, "improved-modules - concurrent-futures": {"text": "concurrent.futures\n\n\nThe default number of worker threads and processes is now selected using\nos.process_cpu_count() instead of os.cpu_count().\n(Contributed by Victor Stinner in gh-109649.)", "code_blocks": []}, "improved-modules - configparser": {"text": "configparser\n\n\nConfigParser now has support for unnamed sections,\nwhich allows for top-level key-value pairs.\nThis can be enabled with the new allow_unnamed_section parameter.\n(Contributed by Pedro Sousa Lacerda in gh-66449.)", "code_blocks": []}, "improved-modules - copy": {"text": "copy\n\n\nThe new replace() function and the replace protocol make creating modified copies of objects much simpler.\nThis is especially useful when working with immutable objects.\nThe following types support the replace() function\nand implement the replace protocol:\n\ncollections.namedtuple()\ndataclasses.dataclass\ndatetime.datetime, datetime.date, datetime.time\ninspect.Signature, inspect.Parameter\ntypes.SimpleNamespace\ncode objects\n\nAny user-defined class can also support copy.replace() by defining\nthe __replace__() method.\n(Contributed by Serhiy Storchaka in gh-108751.)", "code_blocks": []}, "improved-modules - dbm": {"text": "dbm\n\n\nAdd dbm.sqlite3, a new module which implements an SQLite backend,\nand make it the default dbm backend.\n(Contributed by Raymond Hettinger and Erlend E. Aasland in gh-100414.)\nAllow removing all items from the database through\nthe new gdbm.clear() and ndbm.clear() methods.\n(Contributed by Donghee Na in gh-107122.)", "code_blocks": []}, "improved-modules - dis": {"text": "dis\n\n\nChange the output of dis module functions to show logical\nlabels for jump targets and exception handlers, rather than offsets.\nThe offsets can be added with the new\n-O command-line option\nor the show_offsets argument.\n(Contributed by Irit Katriel in gh-112137.)\nget_instructions() no longer represents cache entries\nas separate instructions.\nInstead, it returns them as part of the Instruction,\nin the new cache_info field.\nThe show_caches argument to get_instructions() is deprecated\nand no longer has any effect.\n(Contributed by Irit Katriel in gh-112962.)", "code_blocks": []}, "improved-modules - doctest": {"text": "doctest\n\n\ndoctest output is now colored by default.\nThis can be controlled via the new PYTHON_COLORS environment\nvariable as well as the canonical NO_COLOR\nand FORCE_COLOR environment variables.\nSee also Controlling color.\n(Contributed by Hugo van Kemenade in gh-117225.)\nThe DocTestRunner.run() method now counts the number of skipped tests.\nAdd the DocTestRunner.skips and TestResults.skipped attributes.\n(Contributed by Victor Stinner in gh-108794.)", "code_blocks": []}, "improved-modules - email": {"text": "email\n\n\nHeaders with embedded newlines are now quoted on output.\nThe generator will now refuse to serialize (write) headers\nthat are improperly folded or delimited, such that they would be parsed as\nmultiple headers or joined with adjacent data.\nIf you need to turn this safety feature off,\nset verify_generated_headers.\n(Contributed by Bas Bloemsaat and Petr Viktorin in gh-121650.)\ngetaddresses() and parseaddr() now\nreturn ('', '') pairs in more situations where invalid email addresses\nare encountered instead of potentially inaccurate values.\nThe two functions have a new optional strict parameter (default True).\nTo get the old behavior (accepting malformed input), use strict=False.\ngetattr(email.utils, 'supports_strict_parsing', False) can be used\nto check if the strict parameter is available.\n(Contributed by Thomas Dwyer and Victor Stinner for gh-102988 to improve\nthe CVE-2023-27043 fix.)", "code_blocks": []}, "improved-modules - fractions": {"text": "fractions\n\n\nFraction objects now support the standard\nformat specification mini-language rules\nfor fill, alignment, sign handling, minimum width, and grouping.\n(Contributed by Mark Dickinson in gh-111320.)", "code_blocks": []}, "improved-modules - gc": {"text": "gc\n\nThe cyclic garbage collector is now incremental,\nwhich changes the meaning of the results of\nget_threshold() and set_threshold()\nas well as get_count() and get_stats().\n\nFor backwards compatibility, get_threshold() continues to return\na three-item tuple.\nThe first value is the threshold for young collections, as before;\nthe second value determines the rate at which the old collection is scanned\n(the default is 10, and higher values mean that the old collection\nis scanned more slowly).\nThe third value is meaningless and is always zero.\nset_threshold() ignores any items after the second.\nget_count() and get_stats() continue to return\nthe same format of results.\nThe only difference is that instead of the results referring to\nthe young, aging and old generations,\nthe results refer to the young generation\nand the aging and collecting spaces of the old generation.\n\nIn summary, code that attempted to manipulate the behavior of the cycle GC\nmay not work exactly as intended, but it is very unlikely to be harmful.\nAll other code will work just fine.", "code_blocks": []}, "improved-modules - glob": {"text": "glob\n\n\nAdd translate(), a function to convert a path specification\nwith shell-style wildcards to a regular expression.\n(Contributed by Barney Gale in gh-72904.)", "code_blocks": []}, "improved-modules - importlib": {"text": "importlib\n\n\nThe following functions in importlib.resources now allow accessing\na directory (or tree) of resources, using multiple positional arguments\n(the encoding and errors arguments in the text-reading functions\nare now keyword-only):\n\nis_resource()\nopen_binary()\nopen_text()\npath()\nread_binary()\nread_text()\n\nThese functions are no longer deprecated and are not scheduled for removal.\n(Contributed by Petr Viktorin in gh-106532.)\n\ncontents() remains deprecated in favor of\nthe fully-featured Traversable API.\nHowever, there is now no plan to remove it.\n(Contributed by Petr Viktorin in gh-106532.)", "code_blocks": []}, "improved-modules - io": {"text": "io\n\n\nThe IOBase finalizer now logs any errors raised by\nthe close() method with sys.unraisablehook.\nPreviously, errors were ignored silently by default,\nand only logged in Python Development Mode\nor when using a Python debug build.\n(Contributed by Victor Stinner in gh-62948.)", "code_blocks": []}, "improved-modules - ipaddress": {"text": "ipaddress\n\n\nAdd the IPv4Address.ipv6_mapped property,\nwhich returns the IPv4-mapped IPv6 address.\n(Contributed by Charles Machalow in gh-109466.)\nFix is_global and is_private behavior in\nIPv4Address, IPv6Address,\nIPv4Network, and IPv6Network.\n(Contributed by Jakub Stasiak in gh-113171.)", "code_blocks": []}, "improved-modules - itertools": {"text": "itertools\n\n\nbatched() has a new strict parameter,\nwhich raises a ValueError if the final batch is shorter\nthan the specified batch size.\n(Contributed by Raymond Hettinger in gh-113202.)", "code_blocks": []}, "improved-modules - marshal": {"text": "marshal\n\n\nAdd the allow_code parameter in module functions.\nPassing allow_code=False prevents serialization and de-serialization\nof code objects which are incompatible between Python versions.\n(Contributed by Serhiy Storchaka in gh-113626.)", "code_blocks": []}, "improved-modules - math": {"text": "math\n\n\nThe new function fma() performs fused multiply-add operations.\nThis computes x * y + z with only a single round,\nand so avoids any intermediate loss of precision.\nIt wraps the fma() function provided by C99,\nand follows the specification of the IEEE 754 “fusedMultiplyAdd” operation\nfor special cases.\n(Contributed by Mark Dickinson and Victor Stinner in gh-73468.)", "code_blocks": []}, "improved-modules - mimetypes": {"text": "mimetypes\n\n\nAdd the guess_file_type() function to guess a MIME type\nfrom a filesystem path.\nUsing paths with guess_type() is now soft deprecated.\n(Contributed by Serhiy Storchaka in gh-66543.)", "code_blocks": []}, "improved-modules - mmap": {"text": "mmap\n\n\nmmap is now protected from crashing on Windows when the\nmapped memory is inaccessible due to file system errors or access violations.\n(Contributed by Jannis Weigend in gh-118209.)\nmmap has a new seekable() method\nthat can be used when a seekable file-like object is required.\nThe seek() method now returns the new absolute position.\n(Contributed by Donghee Na and Sylvie Liberman in gh-111835.)\nThe new UNIX-only trackfd parameter for mmap controls\nfile descriptor duplication;\nif false, the file descriptor specified by fileno will not be duplicated.\n(Contributed by Zackery Spytz and Petr Viktorin in gh-78502.)", "code_blocks": []}, "improved-modules - multiprocessing": {"text": "multiprocessing\n\n\nThe default number of worker threads and processes is now selected using\nos.process_cpu_count() instead of os.cpu_count().\n(Contributed by Victor Stinner in gh-109649.)", "code_blocks": []}, "improved-modules - os": {"text": "os\n\n\nAdd process_cpu_count() function to get the number\nof logical CPU cores usable by the calling thread of the current process.\n(Contributed by Victor Stinner in gh-109649.)\ncpu_count() and process_cpu_count() can be overridden\nthrough the new environment variable PYTHON_CPU_COUNT\nor the new command-line option -X cpu_count.\nThis option is useful for users who need to limit CPU resources\nof a container system without having to modify application code\nor the container itself.\n(Contributed by Donghee Na in gh-109595.)\nAdd a low level interface to Linux’s\ntimer file descriptors\nvia timerfd_create(),\ntimerfd_settime(), timerfd_settime_ns(),\ntimerfd_gettime(), timerfd_gettime_ns(),\nTFD_NONBLOCK, TFD_CLOEXEC,\nTFD_TIMER_ABSTIME, and TFD_TIMER_CANCEL_ON_SET\n(Contributed by Masaru Tsuchiyama in gh-108277.)\nlchmod() and the follow_symlinks argument of chmod()\nare both now available on Windows.\nNote that the default value of follow_symlinks\nin lchmod() is False on Windows.\n(Contributed by Serhiy Storchaka in gh-59616.)\nfchmod() and support for file descriptors in chmod()\nare both now available on Windows.\n(Contributed by Serhiy Storchaka in gh-113191.)\nOn Windows, mkdir() and makedirs() now support passing\na mode value of 0o700 to apply access control to the new directory.\nThis implicitly affects tempfile.mkdtemp()\nand is a mitigation for CVE-2024-4030.\nOther values for mode continue to be ignored.\n(Contributed by Steve Dower in gh-118486.)\nposix_spawn() now accepts None for the env argument,\nwhich makes the newly spawned process use the current process environment.\n(Contributed by Jakub Kulik in gh-113119.)\nposix_spawn() can now use the POSIX_SPAWN_CLOSEFROM\nattribute in the file_actions parameter on platforms that support\nposix_spawn_file_actions_addclosefrom_np().\n(Contributed by Jakub Kulik in gh-113117.)", "code_blocks": []}, "improved-modules - os-path": {"text": "os.path\n\n\nAdd isreserved() to check if a path is reserved\non the current system.\nThis function is only available on Windows.\n(Contributed by Barney Gale in gh-88569.)\nOn Windows, isabs() no longer considers paths\nstarting with exactly one slash (\\ or /) to be absolute.\n(Contributed by Barney Gale and Jon Foster in gh-44626.)\nrealpath() now resolves MS-DOS style file names\neven if the file is not accessible.\n(Contributed by Moonsik Park in gh-82367.)", "code_blocks": []}, "improved-modules - pathlib": {"text": "pathlib\n\n\nAdd UnsupportedOperation, which is raised instead of\nNotImplementedError when a path operation isn’t supported.\n(Contributed by Barney Gale in gh-89812.)\nAdd a new constructor for creating Path objects\nfrom ‘file’ URIs (file:///), Path.from_uri().\n(Contributed by Barney Gale in gh-107465.)\nAdd PurePath.full_match() for matching paths with\nshell-style wildcards, including the recursive wildcard “**”.\n(Contributed by Barney Gale in gh-73435.)\nAdd the PurePath.parser class attribute to store the\nimplementation of os.path used\nfor low-level path parsing and joining.\nThis will be either posixpath or ntpath.\nAdd recurse_symlinks keyword-only argument to\nPath.glob() and rglob().\n(Contributed by Barney Gale in gh-77609.)\nPath.glob() and rglob()\nnow return files and directories when given a pattern that ends with “**”.\nPreviously, only directories were returned.\n(Contributed by Barney Gale in gh-70303.)\nAdd the follow_symlinks keyword-only argument to\nPath.is_file,\nPath.is_dir,\nPath.owner(), and Path.group().\n(Contributed by Barney Gale in gh-105793 and Kamil Turek in gh-107962.)", "code_blocks": []}, "improved-modules - pdb": {"text": "pdb\n\n\nbreakpoint() and set_trace() now enter the debugger immediately\nrather than on the next line of code to be executed. This change prevents the\ndebugger from breaking outside of the context when breakpoint() is positioned\nat the end of the context.\n(Contributed by Tian Gao in gh-118579.)\nsys.path[0] is no longer replaced by the directory of the script\nbeing debugged when sys.flags.safe_path is set.\n(Contributed by Tian Gao and Christian Walther in gh-111762.)\nzipapp is now supported as a debugging target.\n(Contributed by Tian Gao in gh-118501.)\nAdd ability to move between chained exceptions during\npost-mortem debugging in pm() using\nthe new exceptions [exc_number] command for Pdb.\n(Contributed by Matthias Bussonnier in gh-106676.)\nExpressions and statements whose prefix is a pdb command are now correctly\nidentified and executed.\n(Contributed by Tian Gao in gh-108464.)", "code_blocks": []}, "improved-modules - queue": {"text": "queue\n\n\nAdd Queue.shutdown and ShutDown\nto manage queue termination.\n(Contributed by Laurie Opperman and Yves Duprat in gh-104750.)", "code_blocks": []}, "improved-modules - random": {"text": "random\n\n\nAdd a command-line interface.\n(Contributed by Hugo van Kemenade in gh-118131.)", "code_blocks": []}, "improved-modules - re": {"text": "re\n\n\nRename re.error to PatternError for improved clarity.\nre.error is kept for backward compatibility.", "code_blocks": []}, "improved-modules - shutil": {"text": "shutil\n\n\nSupport the dir_fd and follow_symlinks keyword arguments\nin chown().\n(Contributed by Berker Peksag and Tahia K in gh-62308)", "code_blocks": []}, "improved-modules - site": {"text": "site\n\n\n.pth files are now decoded using UTF-8 first,\nand then with the locale encoding if UTF-8 decoding fails.\n(Contributed by Inada Naoki in gh-117802.)", "code_blocks": []}, "improved-modules - sqlite3": {"text": "sqlite3\n\n\nA ResourceWarning is now emitted if a Connection\nobject is not closed explicitly.\n(Contributed by Erlend E. Aasland in gh-105539.)\nAdd the filter keyword-only parameter to Connection.iterdump()\nfor filtering database objects to dump.\n(Contributed by Mariusz Felisiak in gh-91602.)", "code_blocks": []}, "improved-modules - ssl": {"text": "ssl\n\n\nThe create_default_context() API now includes\nVERIFY_X509_PARTIAL_CHAIN and VERIFY_X509_STRICT\nin its default flags.\n\nNote\nVERIFY_X509_STRICT may reject pre-RFC 5280\nor malformed certificates that the underlying OpenSSL implementation\nmight otherwise accept.\nWhilst disabling this is not recommended, you can do so using:\nimport ssl\n\nctx = ssl.create_default_context()\nctx.verify_flags &= ~ssl.VERIFY_X509_STRICT\n\n\n\n(Contributed by William Woodruff in gh-112389.)", "code_blocks": ["import ssl\n\nctx = ssl.create_default_context()\nctx.verify_flags &= ~ssl.VERIFY_X509_STRICT\n"]}, "improved-modules - statistics": {"text": "statistics\n\n\nAdd kde() for kernel density estimation.\nThis makes it possible to estimate a continuous probability density function\nfrom a fixed number of discrete samples.\n(Contributed by Raymond Hettinger in gh-115863.)\nAdd kde_random() for sampling from an\nestimated probability density function created by kde().\n(Contributed by Raymond Hettinger in gh-115863.)", "code_blocks": []}, "improved-modules - subprocess": {"text": "subprocess\n\n\nThe subprocess module now uses the posix_spawn() function in\nmore situations.\nNotably, when close_fds is True (the default),\nposix_spawn() will be used when the C library provides\nposix_spawn_file_actions_addclosefrom_np(),\nwhich includes recent versions of Linux, FreeBSD, and Solaris.\nOn Linux, this should perform similarly to the existing\nLinux vfork() based code.\nA private control knob subprocess._USE_POSIX_SPAWN can\nbe set to False if you need to force subprocess\nto never use posix_spawn().\nPlease report your reason and platform details in\nthe issue tracker if you set this\nso that we can improve our API selection logic for everyone.\n(Contributed by Jakub Kulik in gh-113117.)", "code_blocks": []}, "improved-modules - sys": {"text": "sys\n\n\nAdd the _is_interned() function to test if a string was interned.\nThis function is not guaranteed to exist in all implementations of Python.\n(Contributed by Serhiy Storchaka in gh-78573.)", "code_blocks": []}, "improved-modules - tempfile": {"text": "tempfile\n\n\nOn Windows, the default mode 0o700 used by tempfile.mkdtemp() now\nlimits access to the new directory due to changes to os.mkdir().\nThis is a mitigation for CVE-2024-4030.\n(Contributed by Steve Dower in gh-118486.)", "code_blocks": []}, "improved-modules - time": {"text": "time\n\n\nOn Windows, monotonic() now uses the\nQueryPerformanceCounter() clock for a resolution of 1 microsecond,\ninstead of the GetTickCount64() clock which has\na resolution of 15.6 milliseconds.\n(Contributed by Victor Stinner in gh-88494.)\nOn Windows, time() now uses the\nGetSystemTimePreciseAsFileTime() clock for a resolution of 1 microsecond,\ninstead of the GetSystemTimeAsFileTime() clock which has\na resolution of 15.6 milliseconds.\n(Contributed by Victor Stinner in gh-63207.)", "code_blocks": []}, "improved-modules - tkinter": {"text": "tkinter\n\n\nAdd tkinter widget methods:\ntk_busy_hold(), tk_busy_configure(),\ntk_busy_cget(), tk_busy_forget(),\ntk_busy_current(), and tk_busy_status().\n(Contributed by Miguel, klappnase and Serhiy Storchaka in gh-72684.)\nThe tkinter widget method wm_attributes() now accepts\nthe attribute name without the minus prefix to get window attributes,\nfor example w.wm_attributes('alpha')\nand allows specifying attributes and values to set as keyword arguments,\nfor example w.wm_attributes(alpha=0.5).\n(Contributed by Serhiy Storchaka in gh-43457.)\nwm_attributes() can now return attributes as a dict,\nby using the new optional keyword-only parameter return_python_dict.\n(Contributed by Serhiy Storchaka in gh-43457.)\nText.count() can now return a simple int\nwhen the new optional keyword-only parameter return_ints is used.\nOtherwise, the single count is returned as a 1-tuple or None.\n(Contributed by Serhiy Storchaka in gh-97928.)\nSupport the “vsapi” element type in\nthe element_create() method of\ntkinter.ttk.Style.\n(Contributed by Serhiy Storchaka in gh-68166.)\nAdd the after_info() method for Tkinter widgets.\n(Contributed by Cheryl Sabella in gh-77020.)\nAdd a new copy_replace() method to PhotoImage\nto copy a region from one image to another,\npossibly with pixel zooming, subsampling, or both.\n(Contributed by Serhiy Storchaka in gh-118225.)\nAdd from_coords parameter to the PhotoImage methods\ncopy(), zoom() and subsample().\nAdd zoom and subsample parameters to the PhotoImage method\ncopy().\n(Contributed by Serhiy Storchaka in gh-118225.)\nAdd the PhotoImage methods\nread() to read an image from a file\nand data() to get the image data.\nAdd background and grayscale parameters to the write() method.\n(Contributed by Serhiy Storchaka in gh-118271.)", "code_blocks": []}, "improved-modules - traceback": {"text": "traceback\n\n\nAdd the exc_type_str attribute\nto TracebackException,\nwhich holds a string display of the exc_type.\nDeprecate the exc_type attribute,\nwhich holds the type object itself.\nAdd parameter save_exc_type (default True)\nto indicate whether exc_type should be saved.\n(Contributed by Irit Katriel in gh-112332.)\nAdd a new show_group keyword-only parameter to\nTracebackException.format_exception_only() to (recursively) format\nthe nested exceptions of a BaseExceptionGroup instance.\n(Contributed by Irit Katriel in gh-105292.)", "code_blocks": []}, "improved-modules - types": {"text": "types\n\n\nSimpleNamespace can now take a single positional argument\nto initialise the namespace’s arguments.\nThis argument must either be a mapping or an iterable of key-value pairs.\n(Contributed by Serhiy Storchaka in gh-108191.)", "code_blocks": []}, "improved-modules - typing": {"text": "typing\n\n\nPEP 705: Add ReadOnly, a special typing construct\nto mark a TypedDict item as read-only for type checkers.\nPEP 742: Add TypeIs, a typing construct\nthat can be used to instruct a type checker how to narrow a type.\nAdd NoDefault, a sentinel object used to represent\nthe defaults of some parameters in the typing module.\n(Contributed by Jelle Zijlstra in gh-116126.)\nAdd get_protocol_members() to return the set of members\ndefining a typing.Protocol.\n(Contributed by Jelle Zijlstra in gh-104873.)\nAdd is_protocol() to check whether a class\nis a Protocol.\n(Contributed by Jelle Zijlstra in gh-104873.)\nClassVar can now be nested in Final,\nand vice versa.\n(Contributed by Mehdi Drissi in gh-89547.)", "code_blocks": []}, "improved-modules - unicodedata": {"text": "unicodedata\n\n\nUpdate the Unicode database to version 15.1.0.\n(Contributed by James Gerity in gh-109559.)", "code_blocks": []}, "improved-modules - venv": {"text": "venv\n\n\nAdd support for creating source control management (SCM) ignore files\nin a virtual environment’s directory.\nBy default, Git is supported.\nThis is implemented as opt-in via the API,\nwhich can be extended to support other SCMs\n(EnvBuilder and create()),\nand opt-out via the CLI, using --without-scm-ignore-files.\n(Contributed by Brett Cannon in gh-108125.)", "code_blocks": []}, "improved-modules - warnings": {"text": "warnings\n\n\nPEP 702: The new warnings.deprecated() decorator provides a way to\ncommunicate deprecations to a static type checker\nand to warn on usage of deprecated classes and functions.\nA DeprecationWarning may also be emitted when\na decorated function or class is used at runtime.\n(Contributed by Jelle Zijlstra in gh-104003.)", "code_blocks": []}, "improved-modules - xml": {"text": "xml\n\n\nAllow controlling Expat >=2.6.0 reparse deferral (CVE-2023-52425)\nby adding five new methods:\n\nxml.etree.ElementTree.XMLParser.flush()\nxml.etree.ElementTree.XMLPullParser.flush()\nxml.parsers.expat.xmlparser.GetReparseDeferralEnabled()\nxml.parsers.expat.xmlparser.SetReparseDeferralEnabled()\nxml.sax.expatreader.ExpatParser.flush()\n\n(Contributed by Sebastian Pipping in gh-115623.)\n\nAdd the close() method for the iterator returned by\niterparse() for explicit cleanup.\n(Contributed by Serhiy Storchaka in gh-69893.)", "code_blocks": []}, "improved-modules - zipimport": {"text": "zipimport\n\n\nAdd support for ZIP64 format files.\nEverybody loves huge data, right?\n(Contributed by Tim Hatch in gh-94146.)", "code_blocks": []}, "optimizations": {"text": "Optimizations\n\n\nThe new incremental garbage collector\nmeans that maximum pause times are reduced\nby an order of magnitude or more for larger heaps.\n(Contributed by Mark Shannon in gh-108362.)\nSeveral standard library modules have had\ntheir import times significantly improved.\nFor example, the import time of the typing module\nhas been reduced by around a third by removing dependencies\non re and contextlib.\nOther modules to enjoy import-time speedups include\nemail.utils, enum, functools,\nimportlib.metadata, and threading.\n(Contributed by Alex Waygood, Shantanu Jain, Adam Turner, Daniel Hollas,\nand others in gh-109653.)\ntextwrap.indent() is now around 30% faster than before for large input.\n(Contributed by Inada Naoki in gh-107369.)\nThe subprocess module now uses the posix_spawn() function in\nmore situations, including when close_fds is True (the default)\non many modern platforms.\nThis should provide a notable performance increase\nwhen launching processes on FreeBSD and Solaris.\nSee the subprocess section above for details.\n(Contributed by Jakub Kulik in gh-113117.)", "code_blocks": []}, "removed-modules-and-apis - pep-594-remove-dead-batteries-from-the-standard-library": {"text": "PEP 594: Remove “dead batteries” from the standard library\n\nPEP 594 proposed removing 19 modules from the standard library,\ncolloquially referred to as ‘dead batteries’ due to their\nhistoric, obsolete, or insecure status.\nAll of the following modules were deprecated in Python 3.11,\nand are now removed:\n\naifc\naudioop\nchunk\ncgi and cgitb\n\ncgi.FieldStorage can typically be replaced with\nurllib.parse.parse_qsl() for GET and HEAD requests,\nand the email.message module or the multipart library\nfor POST and PUT requests.\ncgi.parse() can be replaced by calling\nurllib.parse.parse_qs() directly on the desired query string,\nunless the input is multipart/form-data,\nwhich should be replaced as described below for cgi.parse_multipart().\ncgi.parse_header() can be replaced with the functionality\nin the email package, which implements the same MIME RFCs.\nFor example, with email.message.EmailMessage:\nfrom email.message import EmailMessage\n\nmsg = EmailMessage()\nmsg['content-type'] = 'application/json; charset=\"utf8\"'\nmain, params = msg.get_content_type(), msg['content-type'].params\n\n\n\ncgi.parse_multipart() can be replaced with the functionality\nin the email package, which implements the same MIME RFCs,\nor with the multipart library.\nFor example, the email.message.EmailMessage\nand email.message.Message classes.\n\n\ncrypt and the private _crypt extension.\nThe hashlib module may be an appropriate replacement\nwhen simply hashing a value is required.\nOtherwise, various third-party libraries on PyPI are available:\n\nbcrypt:\nModern password hashing for your software and your servers.\npasslib:\nComprehensive password hashing framework supporting over 30 schemes.\nargon2-cffi:\nThe secure Argon2 password hashing algorithm.\nlegacycrypt:\nctypes wrapper to the POSIX crypt library call\nand associated functionality.\ncrypt_r:\nFork of the crypt module,\nwrapper to the crypt_r(3) library call\nand associated functionality.\n\n\nimghdr:\nThe filetype, puremagic, or python-magic libraries\nshould be used as replacements.\nFor example, the puremagic.what() function can be used\nto replace the imghdr.what() function for all file formats\nthat were supported by imghdr.\nmailcap:\nUse the mimetypes module instead.\nmsilib\nnis\nnntplib:\nUse the nntplib library from PyPI instead.\nossaudiodev:\nFor audio playback, use the pygame library from PyPI instead.\npipes:\nUse the subprocess module instead.\nsndhdr:\nThe filetype, puremagic, or python-magic libraries\nshould be used as replacements.\nspwd:\nUse the python-pam library from PyPI instead.\nsunau\ntelnetlib,\nUse the telnetlib3 or Exscript libraries from PyPI instead.\nuu:\nUse the base64 module instead, as a modern alternative.\nxdrlib\n\n(Contributed by Victor Stinner and Zachary Ware in gh-104773 and gh-104780.)", "code_blocks": ["from email.message import EmailMessage\n\nmsg = EmailMessage()\nmsg['content-type'] = 'application/json; charset=\"utf8\"'\nmain, params = msg.get_content_type(), msg['content-type'].params\n"]}, "removed-modules-and-apis - to3": {"text": "2to3\n\n\nRemove the 2to3 program and the lib2to3 module,\npreviously deprecated in Python 3.11.\n(Contributed by Victor Stinner in gh-104780.)", "code_blocks": []}, "removed-modules-and-apis - builtins": {"text": "builtins\n\n\nRemove support for chained classmethod descriptors\n(introduced in gh-63272).\nThese can no longer be used to wrap other descriptors,\nsuch as property.\nThe core design of this feature was flawed and led to several problems.\nTo “pass-through” a classmethod, consider using\nthe __wrapped__ attribute that was added in Python 3.10.\n(Contributed by Raymond Hettinger in gh-89519.)\nRaise a RuntimeError when calling frame.clear()\non a suspended frame (as has always been the case for an executing frame).\n(Contributed by Irit Katriel in gh-79932.)", "code_blocks": []}, "removed-modules-and-apis - id3": {"text": "configparser\n\n\nRemove the undocumented LegacyInterpolation class,\ndeprecated in the docstring since Python 3.2,\nand at runtime since Python 3.11.\n(Contributed by Hugo van Kemenade in gh-104886.)", "code_blocks": []}, "removed-modules-and-apis - importlib-metadata": {"text": "importlib.metadata\n\n\nRemove deprecated subscript (__getitem__()) access for\nEntryPoint objects.\n(Contributed by Jason R. Coombs in gh-113175.)", "code_blocks": []}, "removed-modules-and-apis - locale": {"text": "locale\n\n\nRemove the locale.resetlocale() function, deprecated in Python 3.11.\nUse locale.setlocale(locale.LC_ALL, \"\") instead.\n(Contributed by Victor Stinner in gh-104783.)", "code_blocks": []}, "removed-modules-and-apis - opcode": {"text": "opcode\n\n\nMove opcode.ENABLE_SPECIALIZATION to _opcode.ENABLE_SPECIALIZATION.\nThis field was added in 3.12, it was never documented,\nand is not intended for external use.\n(Contributed by Irit Katriel in gh-105481.)\nRemove opcode.is_pseudo(), opcode.MIN_PSEUDO_OPCODE,\nand opcode.MAX_PSEUDO_OPCODE, which were added in Python 3.12,\nbut were neither documented nor exposed through dis,\nand were not intended to be used externally.\n(Contributed by Irit Katriel in gh-105481.)", "code_blocks": []}, "removed-modules-and-apis - id4": {"text": "pathlib\n\n\nRemove the ability to use Path objects as context managers.\nThis functionality was deprecated and has had no effect since Python 3.9.\n(Contributed by Barney Gale in gh-83863.)", "code_blocks": []}, "removed-modules-and-apis - id5": {"text": "re\n\n\nRemove the undocumented, deprecated, and broken\nre.template() function and re.TEMPLATE / re.T flag.\n(Contributed by Serhiy Storchaka and Nikita Sobolev in gh-105687.)", "code_blocks": []}, "removed-modules-and-apis - tkinter-tix": {"text": "tkinter.tix\n\n\nRemove the tkinter.tix module, deprecated in Python 3.6.\nThe third-party Tix library which the module wrapped is unmaintained.\n(Contributed by Zachary Ware in gh-75552.)", "code_blocks": []}, "removed-modules-and-apis - turtle": {"text": "turtle\n\n\nRemove the RawTurtle.settiltangle() method,\ndeprecated in the documentation since Python 3.1\nand at runtime since Python 3.11.\n(Contributed by Hugo van Kemenade in gh-104876.)", "code_blocks": []}, "removed-modules-and-apis - id6": {"text": "typing\n\n\nRemove the typing.io and typing.re namespaces,\ndeprecated since Python 3.8.\nThe items in those namespaces can be imported directly\nfrom the typing module.\n(Contributed by Sebastian Rittau in gh-92871.)\nRemove the keyword-argument method of creating\nTypedDict types, deprecated in Python 3.11.\n(Contributed by Tomas Roun in gh-104786.)", "code_blocks": []}, "removed-modules-and-apis - unittest": {"text": "unittest\n\n\nRemove the following unittest functions, deprecated in Python 3.11:\n\nunittest.findTestCases()\nunittest.makeSuite()\nunittest.getTestCaseNames()\n\nUse TestLoader methods instead:\n\nloadTestsFromModule()\nloadTestsFromTestCase()\ngetTestCaseNames()\n\n(Contributed by Hugo van Kemenade in gh-104835.)\n\nRemove the untested and undocumented TestProgram.usageExit()\nmethod, deprecated in Python 3.11.\n(Contributed by Hugo van Kemenade in gh-104992.)", "code_blocks": []}, "removed-modules-and-apis - urllib": {"text": "urllib\n\n\nRemove the cafile, capath, and cadefault parameters of the\nurllib.request.urlopen() function, deprecated in Python 3.6.\nUse the context parameter instead with an SSLContext instance.\nThe ssl.SSLContext.load_cert_chain() function\ncan be used to load specific certificates,\nor let ssl.create_default_context() select\nthe operating system’s trusted certificate authority (CA) certificates.\n(Contributed by Victor Stinner in gh-105382.)", "code_blocks": []}, "removed-modules-and-apis - webbrowser": {"text": "webbrowser\n\n\nRemove the untested and undocumented MacOSX class,\ndeprecated in Python 3.11.\nUse the MacOSXOSAScript class (introduced in Python 3.2) instead.\n(Contributed by Hugo van Kemenade in gh-104804.)\nRemove the deprecated MacOSXOSAScript._name attribute.\nUse the MacOSXOSAScript.name\nattribute instead.\n(Contributed by Nikita Sobolev in gh-105546.)", "code_blocks": []}, "new-deprecations - pending-removal-in-python-3-14": {"text": "Pending Removal in Python 3.14\n\n\nargparse: The type, choices, and metavar parameters\nof argparse.BooleanOptionalAction are deprecated\nand will be removed in 3.14.\n(Contributed by Nikita Sobolev in gh-92248.)\nast: The following features have been deprecated in documentation\nsince Python 3.8, now cause a DeprecationWarning to be emitted at\nruntime when they are accessed or used, and will be removed in Python 3.14:\n\nast.Num\nast.Str\nast.Bytes\nast.NameConstant\nast.Ellipsis\n\nUse ast.Constant instead.\n(Contributed by Serhiy Storchaka in gh-90953.)\n\nasyncio:\n\nThe child watcher classes MultiLoopChildWatcher,\nFastChildWatcher, AbstractChildWatcher\nand SafeChildWatcher are deprecated and\nwill be removed in Python 3.14.\n(Contributed by Kumar Aditya in gh-94597.)\nasyncio.set_child_watcher(), asyncio.get_child_watcher(),\nasyncio.AbstractEventLoopPolicy.set_child_watcher() and\nasyncio.AbstractEventLoopPolicy.get_child_watcher() are deprecated\nand will be removed in Python 3.14.\n(Contributed by Kumar Aditya in gh-94597.)\nThe get_event_loop() method of the\ndefault event loop policy now emits a DeprecationWarning if there\nis no current event loop set and it decides to create one.\n(Contributed by Serhiy Storchaka and Guido van Rossum in gh-100160.)\n\n\ncollections.abc: Deprecated ByteString.\nPrefer Sequence or Buffer.\nFor use in typing, prefer a union, like bytes | bytearray,\nor collections.abc.Buffer.\n(Contributed by Shantanu Jain in gh-91896.)\nemail: Deprecated the isdst parameter in email.utils.localtime().\n(Contributed by Alan Williams in gh-72346.)\nimportlib: __package__ and __cached__ will cease to be set or\ntaken into consideration by the import system (gh-97879).\nimportlib.abc deprecated classes:\n\nimportlib.abc.ResourceReader\nimportlib.abc.Traversable\nimportlib.abc.TraversableResources\n\nUse importlib.resources.abc classes instead:\n\nimportlib.resources.abc.Traversable\nimportlib.resources.abc.TraversableResources\n\n(Contributed by Jason R. Coombs and Hugo van Kemenade in gh-93963.)\n\nitertools had undocumented, inefficient, historically buggy,\nand inconsistent support for copy, deepcopy, and pickle operations.\nThis will be removed in 3.14 for a significant reduction in code\nvolume and maintenance burden.\n(Contributed by Raymond Hettinger in gh-101588.)\nmultiprocessing: The default start method will change to a safer one on\nLinux, BSDs, and other non-macOS POSIX platforms where 'fork' is currently\nthe default (gh-84559). Adding a runtime warning about this was deemed too\ndisruptive as the majority of code is not expected to care. Use the\nget_context() or\nset_start_method() APIs to explicitly specify when\nyour code requires 'fork'.  See Contexts and start methods.\npathlib: is_relative_to() and\nrelative_to(): passing additional arguments is\ndeprecated.\npkgutil: find_loader() and get_loader()\nnow raise DeprecationWarning;\nuse importlib.util.find_spec() instead.\n(Contributed by Nikita Sobolev in gh-97850.)\npty:\n\nmaster_open(): use pty.openpty().\nslave_open(): use pty.openpty().\n\n\nsqlite3:\n\nversion and version_info.\nexecute() and executemany()\nif named placeholders are used and\nparameters is a sequence instead of a dict.\ndate and datetime adapter, date and timestamp converter:\nsee the sqlite3 documentation for suggested replacement recipes.\n\n\ntypes.CodeType: Accessing co_lnotab was\ndeprecated in PEP 626\nsince 3.10 and was planned to be removed in 3.12,\nbut it only got a proper DeprecationWarning in 3.12.\nMay be removed in 3.14.\n(Contributed by Nikita Sobolev in gh-101866.)\ntyping: ByteString, deprecated since Python 3.9,\nnow causes a DeprecationWarning to be emitted when it is used.\nurllib:\nurllib.parse.Quoter is deprecated: it was not intended to be a\npublic API.\n(Contributed by Gregory P. Smith in gh-88168.)", "code_blocks": []}, "new-deprecations - pending-removal-in-python-3-15": {"text": "Pending Removal in Python 3.15\n\n\nctypes:\n\nThe undocumented ctypes.SetPointerType() function\nhas been deprecated since Python 3.13.\n\n\nhttp.server:\n\nThe obsolete and rarely used CGIHTTPRequestHandler\nhas been deprecated since Python 3.13.\nNo direct replacement exists.\nAnything is better than CGI to interface\na web server with a request handler.\nThe --cgi flag to the python -m http.server\ncommand-line interface has been deprecated since Python 3.13.\n\n\nlocale:\n\nThe getdefaultlocale() function\nhas been deprecated since Python 3.11.\nIts removal was originally planned for Python 3.13 (gh-90817),\nbut has been postponed to Python 3.15.\nUse getlocale(), setlocale(),\nand getencoding() instead.\n(Contributed by Hugo van Kemenade in gh-111187.)\n\n\npathlib:\n\nPurePath.is_reserved()\nhas been deprecated since Python 3.13.\nUse os.path.isreserved() to detect reserved paths on Windows.\n\n\nplatform:\n\njava_ver() has been deprecated since Python 3.13.\nThis function is only useful for Jython support, has a confusing API,\nand is largely untested.\n\n\nthreading:\n\nRLock() will take no arguments in Python 3.15.\nPassing any arguments has been deprecated since Python 3.14,\nas the  Python version does not permit any arguments,\nbut the C version allows any number of positional or keyword arguments,\nignoring every argument.\n\n\ntyping:\n\nThe undocumented keyword argument syntax for creating\nNamedTuple classes\n(e.g. Point = NamedTuple(\"Point\", x=int, y=int))\nhas been deprecated since Python 3.13.\nUse the class-based syntax or the functional syntax instead.\nThe typing.no_type_check_decorator() decorator function\nhas been deprecated since Python 3.13.\nAfter eight years in the typing module,\nit has yet to be supported by any major type checker.\n\n\nwave:\n\nThe getmark(), setmark(),\nand getmarkers() methods of\nthe Wave_read and Wave_write classes\nhave been deprecated since Python 3.13.", "code_blocks": []}, "new-deprecations - pending-removal-in-python-3-16": {"text": "Pending Removal in Python 3.16\n\n\nbuiltins:\n\nBitwise inversion on boolean types, ~True or ~False\nhas been deprecated since Python 3.12,\nas it produces surprising and unintuitive results (-2 and -1).\nUse not x instead for the logical negation of a Boolean.\nIn the rare case that you need the bitwise inversion of\nthe underlying integer, convert to int explicitly (~int(x)).\n\n\narray:\n\nThe 'u' format code (wchar_t)\nhas been deprecated in documentation since Python 3.3\nand at runtime since Python 3.13.\nUse the 'w' format code (Py_UCS4)\nfor Unicode characters instead.\n\n\nshutil:\n\nThe ExecError exception\nhas been deprecated since Python 3.14.\nIt has not been used by any function in shutil since Python 3.4,\nand is now an alias of RuntimeError.\n\n\nsymtable:\n\nThe Class.get_methods method\nhas been deprecated since Python 3.14.\n\n\nsys:\n\nThe _enablelegacywindowsfsencoding() function\nhas been deprecated since Python 3.13.\nUse the PYTHONLEGACYWINDOWSFSENCODING environment variable instead.\n\n\ntarfile:\n\nThe undocumented and unused TarFile.tarfile attribute\nhas been deprecated since Python 3.13.", "code_blocks": []}, "new-deprecations - pending-removal-in-future-versions": {"text": "Pending Removal in Future Versions\n\nThe following APIs will be removed in the future,\nalthough there is currently no date scheduled for their removal.\n\nargparse: Nesting argument groups and nesting mutually exclusive\ngroups are deprecated.\narray’s 'u' format code (gh-57281)\nbuiltins:\n\nbool(NotImplemented).\nGenerators: throw(type, exc, tb) and athrow(type, exc, tb)\nsignature is deprecated: use throw(exc) and athrow(exc) instead,\nthe single argument signature.\nCurrently Python accepts numeric literals immediately followed by keywords,\nfor example 0in x, 1or x, 0if 1else 2.  It allows confusing and\nambiguous expressions like [0x1for x in y] (which can be interpreted as\n[0x1 for x in y] or [0x1f or x in y]).  A syntax warning is raised\nif the numeric literal is immediately followed by one of keywords\nand, else, for, if,\nin, is and or.  In a future release it\nwill be changed to a syntax error. (gh-87999)\nSupport for __index__() and __int__() method returning non-int type:\nthese methods will be required to return an instance of a strict subclass of\nint.\nSupport for __float__() method returning a strict subclass of\nfloat: these methods will be required to return an instance of\nfloat.\nSupport for __complex__() method returning a strict subclass of\ncomplex: these methods will be required to return an instance of\ncomplex.\nDelegation of int() to __trunc__() method.\nPassing a complex number as the real or imag argument in the\ncomplex() constructor is now deprecated; it should only be passed\nas a single positional argument.\n(Contributed by Serhiy Storchaka in gh-109218.)\n\n\ncalendar: calendar.January and calendar.February constants are\ndeprecated and replaced by calendar.JANUARY and\ncalendar.FEBRUARY.\n(Contributed by Prince Roshan in gh-103636.)\ncodeobject.co_lnotab: use the codeobject.co_lines() method\ninstead.\ndatetime:\n\nutcnow():\nuse datetime.datetime.now(tz=datetime.UTC).\nutcfromtimestamp():\nuse datetime.datetime.fromtimestamp(timestamp, tz=datetime.UTC).\n\n\ngettext: Plural value must be an integer.\nimportlib:\n\nload_module() method: use exec_module() instead.\ncache_from_source() debug_override parameter is\ndeprecated: use the optimization parameter instead.\n\n\nimportlib.metadata:\n\nEntryPoints tuple interface.\nImplicit None on return values.\n\n\nlogging: the warn() method has been deprecated\nsince Python 3.3, use warning() instead.\nmailbox: Use of StringIO input and text mode is deprecated, use\nBytesIO and binary mode instead.\nos: Calling os.register_at_fork() in multi-threaded process.\npydoc.ErrorDuringImport: A tuple value for exc_info parameter is\ndeprecated, use an exception instance.\nre: More strict rules are now applied for numerical group references\nand group names in regular expressions.  Only sequence of ASCII digits is now\naccepted as a numerical reference.  The group name in bytes patterns and\nreplacement strings can now only contain ASCII letters and digits and\nunderscore.\n(Contributed by Serhiy Storchaka in gh-91760.)\nsre_compile, sre_constants and sre_parse modules.\nshutil: rmtree()’s onerror parameter is deprecated in\nPython 3.12; use the onexc parameter instead.\nssl options and protocols:\n\nssl.SSLContext without protocol argument is deprecated.\nssl.SSLContext: set_npn_protocols() and\nselected_npn_protocol() are deprecated: use ALPN\ninstead.\nssl.OP_NO_SSL* options\nssl.OP_NO_TLS* options\nssl.PROTOCOL_SSLv3\nssl.PROTOCOL_TLS\nssl.PROTOCOL_TLSv1\nssl.PROTOCOL_TLSv1_1\nssl.PROTOCOL_TLSv1_2\nssl.TLSVersion.SSLv3\nssl.TLSVersion.TLSv1\nssl.TLSVersion.TLSv1_1\n\n\nsysconfig.is_python_build() check_home parameter is deprecated and\nignored.\nthreading methods:\n\nthreading.Condition.notifyAll(): use notify_all().\nthreading.Event.isSet(): use is_set().\nthreading.Thread.isDaemon(), threading.Thread.setDaemon():\nuse threading.Thread.daemon attribute.\nthreading.Thread.getName(), threading.Thread.setName():\nuse threading.Thread.name attribute.\nthreading.currentThread(): use threading.current_thread().\nthreading.activeCount(): use threading.active_count().\n\n\ntyping.Text (gh-92332).\nunittest.IsolatedAsyncioTestCase: it is deprecated to return a value\nthat is not None from a test case.\nurllib.parse deprecated functions: urlparse() instead\n\nsplitattr()\nsplithost()\nsplitnport()\nsplitpasswd()\nsplitport()\nsplitquery()\nsplittag()\nsplittype()\nsplituser()\nsplitvalue()\nto_bytes()\n\n\nurllib.request: URLopener and\nFancyURLopener style of invoking requests is\ndeprecated. Use newer urlopen() functions and methods.\nwsgiref: SimpleHandler.stdout.write() should not do partial\nwrites.\nxml.etree.ElementTree: Testing the truth value of an\nElement is deprecated. In a future release it\nwill always return True. Prefer explicit len(elem) or\nelem is not None tests instead.\nzipimport.zipimporter.load_module() is deprecated:\nuse exec_module() instead.", "code_blocks": []}, "cpython-bytecode-changes": {"text": "CPython Bytecode Changes\n\n\nThe oparg of YIELD_VALUE is now\n1 if the yield is part of a yield-from or await, and 0 otherwise.\nThe oparg of RESUME was changed to add a bit indicating\nif the except-depth is 1, which is needed to optimize closing of generators.\n(Contributed by Irit Katriel in gh-111354.)", "code_blocks": []}, "c-api-changes - id7": {"text": "New Features\n\n\nAdd the PyMonitoring C API\nfor generating PEP 669 monitoring events:\n\nPyMonitoringState\nPyMonitoring_FirePyStartEvent()\nPyMonitoring_FirePyResumeEvent()\nPyMonitoring_FirePyReturnEvent()\nPyMonitoring_FirePyYieldEvent()\nPyMonitoring_FireCallEvent()\nPyMonitoring_FireLineEvent()\nPyMonitoring_FireJumpEvent()\nPyMonitoring_FireBranchEvent()\nPyMonitoring_FireCReturnEvent()\nPyMonitoring_FirePyThrowEvent()\nPyMonitoring_FireRaiseEvent()\nPyMonitoring_FireCRaiseEvent()\nPyMonitoring_FireReraiseEvent()\nPyMonitoring_FireExceptionHandledEvent()\nPyMonitoring_FirePyUnwindEvent()\nPyMonitoring_FireStopIterationEvent()\nPyMonitoring_EnterScope()\nPyMonitoring_ExitScope()\n\n(Contributed by Irit Katriel in gh-111997).\n\nAdd PyMutex, a lightweight mutex that occupies a single byte,\nand the new PyMutex_Lock() and PyMutex_Unlock() functions.\nPyMutex_Lock() will release the GIL (if currently held)\nif the operation needs to block.\n(Contributed by Sam Gross in gh-108724.)\nAdd the PyTime C API to provide access to system clocks:\n\nPyTime_t.\nPyTime_MIN and PyTime_MAX.\nPyTime_AsSecondsDouble().\nPyTime_Monotonic().\nPyTime_MonotonicRaw().\nPyTime_PerfCounter().\nPyTime_PerfCounterRaw().\nPyTime_Time().\nPyTime_TimeRaw().\n\n(Contributed by Victor Stinner and Petr Viktorin in gh-110850.)\n\nAdd the PyDict_ContainsString() function\nwith the same behavior as PyDict_Contains(),\nbut key is specified as a const char* UTF-8 encoded bytes string,\nrather than a PyObject*.\n(Contributed by Victor Stinner in gh-108314.)\nAdd the PyDict_GetItemRef() and PyDict_GetItemStringRef()\nfunctions,\nwhich behave similarly to PyDict_GetItemWithError(),\nbut return a  strong reference instead of a borrowed reference.\nMoreover, these functions return -1 on error,\nremoving the need to check PyErr_Occurred().\n(Contributed by Victor Stinner in gh-106004.)\nAdd the PyDict_SetDefaultRef() function,\nwhich behaves similarly to PyDict_SetDefault(),\nbut returns a strong reference instead of a borrowed reference.\nThis function returns -1 on error,\n0 on insertion,\nand 1 if the key was already present in the dictionary.\n(Contributed by Sam Gross in gh-112066.)\nAdd the PyDict_Pop() and PyDict_PopString() functions\nto remove a key from a dictionary and optionally return the removed value.\nThis is similar to dict.pop(),\nthough there is no default value,\nand KeyError is not raised for missing keys.\n(Contributed by Stefan Behnel and Victor Stinner in gh-111262.)\nAdd the PyMapping_GetOptionalItem()\nand PyMapping_GetOptionalItemString() functions\nas alternatives to PyObject_GetItem()\nand PyMapping_GetItemString() respectively.\nThe new functions do not raise KeyError\nif the requested key is missing from the mapping.\nThese variants are more convenient and faster\nif a missing key should not be treated as a failure.\n(Contributed by Serhiy Storchaka in gh-106307.)\nAdd the PyObject_GetOptionalAttr()\nand PyObject_GetOptionalAttrString() functions\nas alternatives to  PyObject_GetAttr()\nand PyObject_GetAttrString() respectively.\nThe new functions do not raise AttributeError\nif the requested attribute is not found on the object.\nThese variants are more convenient and faster\nif the missing attribute should not be treated as a failure.\n(Contributed by Serhiy Storchaka in gh-106521.)\nAdd the PyErr_FormatUnraisable() function\nas an extension to PyErr_WriteUnraisable()\nthat allows customizing the warning message.\n(Contributed by Serhiy Storchaka in gh-108082.)\nAdd new functions that return a strong reference instead of\na borrowed reference for frame locals, globals, and builtins,\nas part of PEP 667:\n\nPyEval_GetFrameBuiltins() replaces PyEval_GetBuiltins()\nPyEval_GetFrameGlobals() replaces PyEval_GetGlobals()\nPyEval_GetFrameLocals() replaces PyEval_GetLocals()\n\n(Contributed by Mark Shannon and Tian Gao in gh-74929.)\n\nAdd the Py_GetConstant() and Py_GetConstantBorrowed()\nfunctions to get strong\nor borrowed references to constants.\nFor example, Py_GetConstant(Py_CONSTANT_ZERO) returns a strong reference\nto the constant zero.\n(Contributed by Victor  Stinner in gh-115754.)\nAdd the PyImport_AddModuleRef() function\nas a replacement for PyImport_AddModule()\nthat returns a strong reference instead of a borrowed reference.\n(Contributed by Victor Stinner in gh-105922.)\nAdd the Py_IsFinalizing() function to check\nwhether the main Python interpreter is\nshutting down.\n(Contributed by Victor Stinner in gh-108014.)\nAdd the PyList_GetItemRef() function\nas a replacement for PyList_GetItem()\nthat returns a strong reference instead of a borrowed reference.\n(Contributed by Sam Gross in gh-114329.)\nAdd the PyList_Extend() and PyList_Clear() functions,\nmirroring the Python list.extend() and list.clear() methods.\n(Contributed by Victor Stinner in gh-111138.)\nAdd the PyLong_AsInt() function.\nIt behaves similarly to PyLong_AsLong(),\nbut stores the result in a C int instead of a C long.\n(Contributed by Victor Stinner in gh-108014.)\nAdd the PyLong_AsNativeBytes(), PyLong_FromNativeBytes(),\nand PyLong_FromUnsignedNativeBytes() functions\nto simplify converting between native integer types\nand Python int objects.\n(Contributed by Steve Dower in gh-111140.)\nAdd PyModule_Add() function, which is similar to\nPyModule_AddObjectRef() and PyModule_AddObject(),\nbut always steals a reference to the value.\n(Contributed by Serhiy Storchaka in gh-86493.)\nAdd the PyObject_GenericHash() function\nthat implements the default hashing function of a Python object.\n(Contributed by Serhiy Storchaka in gh-113024.)\nAdd the Py_HashPointer() function to hash a raw pointer.\n(Contributed by Victor Stinner in gh-111545.)\nAdd the PyObject_VisitManagedDict() and\nPyObject_ClearManagedDict() functions.\nwhich must be called by the traverse and clear functions of a type using\nthe Py_TPFLAGS_MANAGED_DICT flag.\nThe pythoncapi-compat project can be used to\nuse these functions with Python 3.11 and 3.12.\n(Contributed by Victor Stinner in gh-107073.)\nAdd the PyRefTracer_SetTracer()\nand PyRefTracer_GetTracer() functions,\nwhich enable tracking object creation and destruction\nin the same way that the tracemalloc module does.\n(Contributed by Pablo Galindo in gh-93502.)\nAdd the PySys_AuditTuple() function\nas an alternative to PySys_Audit()\nthat takes event arguments as a Python tuple object.\n(Contributed by Victor Stinner in gh-85283.)\nAdd the PyThreadState_GetUnchecked() function\nas an alternative to PyThreadState_Get()\nthat doesn’t kill the process with a fatal error if it is NULL.\nThe caller is responsible for checking if the result is NULL.\n(Contributed by Victor Stinner in gh-108867.)\nAdd the PyType_GetFullyQualifiedName() function\nto get the type’s fully qualified name.\nThe module name is prepended if type.__module__ is\na string and is not equal to either 'builtins' or '__main__'.\n(Contributed by Victor Stinner in gh-111696.)\nAdd the PyType_GetModuleName() function\nto get the type’s module name. This is equivalent to getting the\ntype.__module__ attribute.\n(Contributed by Eric Snow and Victor Stinner in gh-111696.)\nAdd the PyUnicode_EqualToUTF8AndSize()\nand PyUnicode_EqualToUTF8() functions\nto compare a Unicode object with a const char* UTF-8 encoded string\nand 1 if they are equal or 0 otherwise.\nThese functions do not raise exceptions.\n(Contributed by Serhiy Storchaka in gh-110289.)\nAdd the PyWeakref_GetRef() function\nas an alternative to  PyWeakref_GetObject()\nthat returns a strong reference\nor NULL if the referent is no longer live.\n(Contributed by Victor Stinner in gh-105927.)\nAdd fixed variants of functions which silently ignore errors:\n\nPyObject_HasAttrWithError() replaces PyObject_HasAttr().\nPyObject_HasAttrStringWithError()\nreplaces PyObject_HasAttrString().\nPyMapping_HasKeyWithError() replaces PyMapping_HasKey().\nPyMapping_HasKeyStringWithError()\nreplaces PyMapping_HasKeyString().\n\nThe new functions return -1 for errors\nand the standard 1 for true and 0 for false.\n(Contributed by Serhiy Storchaka in gh-108511.)", "code_blocks": []}, "c-api-changes - changed-c-apis": {"text": "Changed C APIs\n\n\nThe keywords parameter of PyArg_ParseTupleAndKeywords()\nand PyArg_VaParseTupleAndKeywords()\nnow has type char *const* in C\nand const char *const* in C++,\ninstead of char**.\nIn C++, this makes these functions compatible with arguments\nof type const char *const*, const char**,\nor char *const* without an explicit type cast.\nIn C, the functions only support arguments of type char *const*.\nThis can be overridden with the PY_CXX_CONST macro.\n(Contributed by Serhiy Storchaka in gh-65210.)\nPyArg_ParseTupleAndKeywords() now supports\nnon-ASCII keyword parameter names.\n(Contributed by Serhiy Storchaka in gh-110815.)\nThe PyCode_GetFirstFree() function is now unstable API\nand is now named PyUnstable_Code_GetFirstFree().\n(Contributed by Bogdan Romanyuk in gh-115781.)\nThe PyDict_GetItem(), PyDict_GetItemString(),\nPyMapping_HasKey(), PyMapping_HasKeyString(),\nPyObject_HasAttr(), PyObject_HasAttrString(),\nand PySys_GetObject() functions,\neach of which clears all errors which occurred when calling them\nnow reports these errors using sys.unraisablehook().\nYou may replace them with other functions as recommended in the documentation.\n(Contributed by Serhiy Storchaka in gh-106672.)\nAdd support for the %T, %#T, %N and %#N formats\nto PyUnicode_FromFormat():\n\n%T: Get the fully qualified name of an object type\n%#T: As above, but use a colon as the separator\n%N: Get the fully qualified name of a type\n%#N: As above, but use a colon as the separator\n\nSee PEP 737 for more information.\n(Contributed by Victor Stinner in gh-111696.)\n\nYou no longer have to define the PY_SSIZE_T_CLEAN macro before\nincluding Python.h when using # formats in\nformat codes.\nAPIs accepting the format codes always use Py_ssize_t for # formats.\n(Contributed by Inada Naoki in gh-104922.)\nIf Python is built in debug mode\nor with assertions,\nPyTuple_SET_ITEM() and PyList_SET_ITEM()\nnow check the index argument with an assertion.\n(Contributed by Victor Stinner in gh-106168.)", "code_blocks": []}, "c-api-changes - limited-c-api-changes": {"text": "Limited C API Changes\n\n\nThe following functions are now included in the Limited C API:\n\nPyMem_RawMalloc()\nPyMem_RawCalloc()\nPyMem_RawRealloc()\nPyMem_RawFree()\nPySys_Audit()\nPySys_AuditTuple()\nPyType_GetModuleByDef()\n\n(Contributed by Victor Stinner in gh-85283, gh-85283, and gh-116936.)\n\nPython built with --with-trace-refs (tracing references)\nnow supports the Limited API.\n(Contributed by Victor Stinner in gh-108634.)", "code_blocks": []}, "c-api-changes - removed-c-apis": {"text": "Removed C APIs\n\n\nRemove several functions, macros, variables, etc\nwith names prefixed by _Py or _PY (which are considered private).\nIf your project is affected  by one of these removals\nand you believe that the removed API should remain available,\nplease open a new issue to request a public C API\nand add cc: @vstinner to the issue to notify Victor Stinner.\n(Contributed by Victor Stinner in gh-106320.)\nRemove old buffer protocols deprecated in Python 3.0.\nUse Buffer Protocol instead.\n\nPyObject_CheckReadBuffer():\nUse PyObject_CheckBuffer() to test\nwhether the object supports the buffer protocol.\nNote that PyObject_CheckBuffer() doesn’t guarantee\nthat PyObject_GetBuffer() will succeed.\nTo test if the object is actually readable,\nsee the next example of PyObject_GetBuffer().\nPyObject_AsCharBuffer(), PyObject_AsReadBuffer():\nUse PyObject_GetBuffer() and PyBuffer_Release() instead:\nPy_buffer view;\nif (PyObject_GetBuffer(obj, &view, PyBUF_SIMPLE) < 0) {\n    return NULL;\n}\n// Use `view.buf` and `view.len` to read from the buffer.\n// You may need to cast buf as `(const char*)view.buf`.\nPyBuffer_Release(&view);\n\n\n\nPyObject_AsWriteBuffer():\nUse PyObject_GetBuffer() and PyBuffer_Release() instead:\nPy_buffer view;\nif (PyObject_GetBuffer(obj, &view, PyBUF_WRITABLE) < 0) {\n    return NULL;\n}\n// Use `view.buf` and `view.len` to write to the buffer.\nPyBuffer_Release(&view);\n\n\n\n\n(Contributed by Inada Naoki in gh-85275.)\n\nRemove various functions deprecated in Python 3.9:\n\nPyEval_CallObject(), PyEval_CallObjectWithKeywords():\nUse PyObject_CallNoArgs() or PyObject_Call() instead.\n\nWarning\nIn PyObject_Call(), positional arguments must be a tuple\nand must not be NULL,\nand keyword arguments must be a dict or NULL,\nwhereas the removed functions checked argument types\nand accepted NULL positional and keyword arguments.\nTo replace PyEval_CallObjectWithKeywords(func, NULL, kwargs) with\nPyObject_Call(),\npass an empty tuple as positional arguments using\nPyTuple_New(0).\n\n\nPyEval_CallFunction():\nUse PyObject_CallFunction() instead.\nPyEval_CallMethod():\nUse PyObject_CallMethod() instead.\nPyCFunction_Call():\nUse PyObject_Call() instead.\n\n(Contributed by Victor Stinner in gh-105107.)\n\nRemove the following old functions to configure the Python initialization,\ndeprecated in Python 3.11:\n\nPySys_AddWarnOptionUnicode():\nUse PyConfig.warnoptions instead.\nPySys_AddWarnOption():\nUse PyConfig.warnoptions instead.\nPySys_AddXOption():\nUse PyConfig.xoptions instead.\nPySys_HasWarnOptions():\nUse PyConfig.xoptions instead.\nPySys_SetPath():\nSet PyConfig.module_search_paths instead.\nPy_SetPath():\nSet PyConfig.module_search_paths instead.\nPy_SetStandardStreamEncoding():\nSet PyConfig.stdio_encoding instead,\nand set also maybe PyConfig.legacy_windows_stdio (on Windows).\n_Py_SetProgramFullPath():\nSet PyConfig.executable instead.\n\nUse the new PyConfig API of the Python Initialization\nConfiguration instead (PEP 587), added to Python 3.8.\n(Contributed by Victor Stinner in gh-105145.)\n\nRemove PyEval_AcquireLock() and PyEval_ReleaseLock() functions,\ndeprecated in Python 3.2.\nThey didn’t update the current thread state.\nThey can be replaced with:\n\nPyEval_SaveThread() and PyEval_RestoreThread();\nlow-level PyEval_AcquireThread() and PyEval_RestoreThread();\nor PyGILState_Ensure() and PyGILState_Release().\n\n(Contributed by Victor Stinner in gh-105182.)\n\nRemove the PyEval_ThreadsInitialized() function,\ndeprecated in Python 3.9.\nSince Python 3.7, Py_Initialize() always creates the GIL:\ncalling PyEval_InitThreads() does nothing and\nPyEval_ThreadsInitialized() always returns non-zero.\n(Contributed by Victor Stinner in gh-105182.)\nRemove the _PyInterpreterState_Get() alias to\nPyInterpreterState_Get()\nwhich was kept for backward compatibility with Python 3.8.\nThe pythoncapi-compat project can be used to get\nPyInterpreterState_Get() on Python 3.8 and older.\n(Contributed by Victor Stinner in gh-106320.)\nRemove the private _PyObject_FastCall() function:\nuse PyObject_Vectorcall() which is available since Python 3.8\n(PEP 590).\n(Contributed by Victor Stinner in gh-106023.)\nRemove the cpython/pytime.h header file,\nwhich only contained private functions.\n(Contributed by Victor Stinner in gh-106316.)\nRemove the undocumented PY_TIMEOUT_MAX constant from the limited C API.\n(Contributed by Victor Stinner in gh-110014.)\nRemove the old trashcan macros Py_TRASHCAN_SAFE_BEGIN\nand Py_TRASHCAN_SAFE_END.\nReplace both with the new macros Py_TRASHCAN_BEGIN\nand Py_TRASHCAN_END.\n(Contributed by Irit Katriel in gh-105111.)", "code_blocks": ["Py_buffer view;\nif (PyObject_GetBuffer(obj, &view, PyBUF_SIMPLE) < 0) {\n    return NULL;\n}\n// Use `view.buf` and `view.len` to read from the buffer.\n// You may need to cast buf as `(const char*)view.buf`.\nPyBuffer_Release(&view);\n", "Py_buffer view;\nif (PyObject_GetBuffer(obj, &view, PyBUF_WRITABLE) < 0) {\n    return NULL;\n}\n// Use `view.buf` and `view.len` to write to the buffer.\nPyBuffer_Release(&view);\n"]}, "c-api-changes - deprecated-c-apis": {"text": "Deprecated C APIs\n\n\nDeprecate old Python initialization functions:\n\nPySys_ResetWarnOptions():\nClear sys.warnoptions and warnings.filters instead.\nPy_GetExecPrefix():\nGet sys.exec_prefix instead.\nPy_GetPath():\nGet sys.path instead.\nPy_GetPrefix():\nGet sys.prefix instead.\nPy_GetProgramFullPath():\nGet sys.executable instead.\nPy_GetProgramName():\nGet sys.executable instead.\nPy_GetPythonHome():\nGet PyConfig.home\nor the PYTHONHOME environment variable instead.\n\n(Contributed by Victor Stinner in gh-105145.)\n\nSoft deprecate the\nPyEval_GetBuiltins(), PyEval_GetGlobals(),\nand PyEval_GetLocals() functions,\nwhich return a borrowed reference.\n(Soft deprecated as part of PEP 667.)\nDeprecate the PyImport_ImportModuleNoBlock() function,\nwhich is just an alias to PyImport_ImportModule() since Python 3.3.\n(Contributed by Victor Stinner in gh-105396.)\nSoft deprecate the\nPyModule_AddObject() function.\nIt should be replaced with PyModule_Add()\nor PyModule_AddObjectRef().\n(Contributed by Serhiy Storchaka in gh-86493.)\nDeprecate the old Py_UNICODE and PY_UNICODE_TYPE types\nand the Py_UNICODE_WIDE define.\nUse the wchar_t type directly instead.\nSince Python 3.3, Py_UNICODE and PY_UNICODE_TYPE\nare just aliases to wchar_t.\n(Contributed by Victor Stinner in gh-105156.)\nDeprecate the PyWeakref_GetObject() and\nPyWeakref_GET_OBJECT() functions,\nwhich return a borrowed reference.\nReplace them with the new PyWeakref_GetRef() function,\nwhich returns a strong reference.\nThe pythoncapi-compat project can be used to get\nPyWeakref_GetRef() on Python 3.12 and older.\n(Contributed by Victor Stinner in gh-105927.)\n\n\nPending Removal in Python 3.14\n\n\nThe ma_version_tag field in PyDictObject for extension modules\n(PEP 699; gh-101193).\nCreating immutable types with mutable\nbases (gh-95388).\nFunctions to configure Python’s initialization, deprecated in Python 3.11:\n\nPySys_SetArgvEx():\nSet PyConfig.argv instead.\nPySys_SetArgv():\nSet PyConfig.argv instead.\nPy_SetProgramName():\nSet PyConfig.program_name instead.\nPy_SetPythonHome():\nSet PyConfig.home instead.\n\nThe Py_InitializeFromConfig() API should be used with\nPyConfig instead.\n\nGlobal configuration variables:\n\nPy_DebugFlag:\nUse PyConfig.parser_debug instead.\nPy_VerboseFlag:\nUse PyConfig.verbose instead.\nPy_QuietFlag:\nUse PyConfig.quiet instead.\nPy_InteractiveFlag:\nUse PyConfig.interactive instead.\nPy_InspectFlag:\nUse PyConfig.inspect instead.\nPy_OptimizeFlag:\nUse PyConfig.optimization_level instead.\nPy_NoSiteFlag:\nUse PyConfig.site_import instead.\nPy_BytesWarningFlag:\nUse PyConfig.bytes_warning instead.\nPy_FrozenFlag:\nUse PyConfig.pathconfig_warnings instead.\nPy_IgnoreEnvironmentFlag:\nUse PyConfig.use_environment instead.\nPy_DontWriteBytecodeFlag:\nUse PyConfig.write_bytecode instead.\nPy_NoUserSiteDirectory:\nUse PyConfig.user_site_directory instead.\nPy_UnbufferedStdioFlag:\nUse PyConfig.buffered_stdio instead.\nPy_HashRandomizationFlag:\nUse PyConfig.use_hash_seed\nand PyConfig.hash_seed instead.\nPy_IsolatedFlag:\nUse PyConfig.isolated instead.\nPy_LegacyWindowsFSEncodingFlag:\nUse PyPreConfig.legacy_windows_fs_encoding instead.\nPy_LegacyWindowsStdioFlag:\nUse PyConfig.legacy_windows_stdio instead.\nPy_FileSystemDefaultEncoding:\nUse PyConfig.filesystem_encoding instead.\nPy_HasFileSystemDefaultEncoding:\nUse PyConfig.filesystem_encoding instead.\nPy_FileSystemDefaultEncodeErrors:\nUse PyConfig.filesystem_errors instead.\nPy_UTF8Mode:\nUse PyPreConfig.utf8_mode instead.\n(see Py_PreInitialize())\n\nThe Py_InitializeFromConfig() API should be used with\nPyConfig instead.\n\n\n\n\nPending Removal in Python 3.15\n\n\nThe bundled copy of libmpdecimal.\nThe PyImport_ImportModuleNoBlock():\nUse PyImport_ImportModule() instead.\nPyWeakref_GetObject() and PyWeakref_GET_OBJECT():\nUse PyWeakref_GetRef() instead.\nPy_UNICODE type and the Py_UNICODE_WIDE macro:\nUse wchar_t instead.\nPython initialization functions:\n\nPySys_ResetWarnOptions():\nClear sys.warnoptions and warnings.filters instead.\nPy_GetExecPrefix():\nGet sys.exec_prefix instead.\nPy_GetPath():\nGet sys.path instead.\nPy_GetPrefix():\nGet sys.prefix instead.\nPy_GetProgramFullPath():\nGet sys.executable instead.\nPy_GetProgramName():\nGet sys.executable instead.\nPy_GetPythonHome():\nGet PyConfig.home\nor the PYTHONHOME environment variable instead.\n\n\n\n\n\nPending Removal in Future Versions\n\nThe following APIs are deprecated and will be removed,\nalthough there is currently no date scheduled for their removal.\n\nPy_TPFLAGS_HAVE_FINALIZE:\nUnneeded since Python 3.8.\nPyErr_Fetch():\nUse PyErr_GetRaisedException() instead.\nPyErr_NormalizeException():\nUse PyErr_GetRaisedException() instead.\nPyErr_Restore():\nUse PyErr_SetRaisedException() instead.\nPyModule_GetFilename():\nUse PyModule_GetFilenameObject() instead.\nPyOS_AfterFork():\nUse PyOS_AfterFork_Child() instead.\nPySlice_GetIndicesEx():\nUse PySlice_Unpack() and PySlice_AdjustIndices() instead.\nPyUnicode_AsDecodedObject():\nUse PyCodec_Decode() instead.\nPyUnicode_AsDecodedUnicode():\nUse PyCodec_Decode() instead.\nPyUnicode_AsEncodedObject():\nUse PyCodec_Encode() instead.\nPyUnicode_AsEncodedUnicode():\nUse PyCodec_Encode() instead.\nPyUnicode_READY():\nUnneeded since Python 3.12\nPyErr_Display():\nUse PyErr_DisplayException() instead.\n_PyErr_ChainExceptions():\nUse _PyErr_ChainExceptions1() instead.\nPyBytesObject.ob_shash member:\ncall PyObject_Hash() instead.\nPyDictObject.ma_version_tag member.\nThread Local Storage (TLS) API:\n\nPyThread_create_key():\nUse PyThread_tss_alloc() instead.\nPyThread_delete_key():\nUse PyThread_tss_free() instead.\nPyThread_set_key_value():\nUse PyThread_tss_set() instead.\nPyThread_get_key_value():\nUse PyThread_tss_get() instead.\nPyThread_delete_key_value():\nUse PyThread_tss_delete() instead.\nPyThread_ReInitTLS():\nUnneeded since Python 3.7.", "code_blocks": []}, "build-changes": {"text": "Build Changes\n\n\narm64-apple-ios and arm64-apple-ios-simulator are both\nnow PEP 11 tier 3 platforms.\n(PEP 730 written\nand implementation contributed by Russell Keith-Magee in gh-114099.)\naarch64-linux-android and x86_64-linux-android are both\nnow PEP 11 tier 3 platforms.\n(PEP 738 written\nand implementation contributed by Malcolm Smith in gh-116622.)\nwasm32-wasi is now a PEP 11 tier 2 platform.\n(Contributed by Brett Cannon in gh-115192.)\nwasm32-emscripten is no longer a PEP 11 supported platform.\n(Contributed by Brett Cannon in gh-115192.)\nBuilding CPython now requires a compiler with support for the C11 atomic\nlibrary, GCC built-in atomic functions, or MSVC interlocked intrinsics.\nAutoconf 2.71 and aclocal 1.16.4 are now required to regenerate\nthe configure script.\n(Contributed by Christian Heimes in gh-89886.)\nSQLite 3.15.2 or newer is required to build\nthe sqlite3 extension module.\n(Contributed by Erlend Aasland in gh-105875.)\nCPython now bundles the mimalloc library by default.\nIt is licensed under the MIT license;\nsee mimalloc license.\nThe bundled mimalloc has custom changes, see gh-113141 for details.\n(Contributed by Dino Viehland in gh-109914.)\n\nThe configure option --with-system-libmpdec\nnow defaults to yes.\nThe bundled copy of libmpdecimal will be removed in Python 3.15.\nPython built with configure --with-trace-refs\n(tracing references) is now ABI compatible with the Python release build\nand debug build.\n(Contributed by Victor Stinner in gh-108634.)\nOn POSIX systems, the pkg-config (.pc) filenames now include the ABI\nflags.  For example, the free-threaded build generates python-3.13t.pc\nand the debug build generates python-3.13d.pc.\nThe errno, fcntl, grp, md5, pwd, resource,\ntermios, winsound,\n_ctypes_test, _multiprocessing.posixshmem, _scproxy, _stat,\n_statistics, _testconsole, _testimportmultiple and _uuid\nC extensions are now built with the limited C API.\n(Contributed by Victor Stinner in gh-85283.)", "code_blocks": []}, "porting-to-python-3-13 - changes-in-the-python-api": {"text": "Changes in the Python API\n\n\nPEP 667 introduces several changes\nto the semantics of locals() and f_locals:\n\nCalling locals() in an optimized scope now produces an\nindependent snapshot on each call, and hence no longer implicitly updates\npreviously returned references. Obtaining the legacy CPython behavior now\nrequires explicit calls to update the initially returned dictionary with the\nresults of subsequent calls to locals(). Code execution functions that\nimplicitly target locals() (such as exec and eval) must be\npassed an explicit namespace to access their results in an optimized scope.\n(Changed as part of PEP 667.)\nCalling locals() from a comprehension at module or class scope\n(including via exec or eval) once more behaves as if the comprehension\nwere running as an independent nested function (i.e. the local variables from\nthe containing scope are not included). In Python 3.12, this had changed\nto include the local variables from the containing scope when implementing\nPEP 709. (Changed as part of PEP 667.)\nAccessing FrameType.f_locals in an\noptimized scope now returns a write-through proxy rather than a\nsnapshot that gets updated at ill-specified times. If a snapshot is desired,\nit must be created explicitly with dict or the proxy’s .copy() method.\n(Changed as part of PEP 667.)\n\n\nfunctools.partial now emits a FutureWarning\nwhen used as a method.\nThe behavior will change in future Python versions.\nWrap it in staticmethod() if you want to preserve the old behavior.\n(Contributed by Serhiy Storchaka in gh-121027.)\nThe garbage collector is now incremental,\nwhich means that the behavior of gc.collect() changes slightly:\n\ngc.collect(1): Performs an increment of garbage collection,\nrather than collecting generation 1.\nOther calls to gc.collect() are unchanged.\n\n\nAn OSError is now raised by getpass.getuser()\nfor any failure to retrieve a username,\ninstead of ImportError on non-Unix platforms\nor KeyError on Unix platforms where the password database is empty.\nThe value of the mode attribute of gzip.GzipFile\nis now a string ('rb' or 'wb') instead of an integer (1 or 2).\nThe value of the mode attribute of the readable file-like object\nreturned by zipfile.ZipFile.open() is now 'rb' instead of 'r'.\n(Contributed by Serhiy Storchaka in gh-115961.)\nmailbox.Maildir now ignores files with a leading dot (.).\n(Contributed by Zackery Spytz in gh-65559.)\npathlib.Path.glob() and rglob() now return both\nfiles and directories if a pattern that ends with “**” is given,\nrather than directories only.\nAdd a trailing slash to keep the previous behavior and only match directories.\nThe threading module now expects the _thread module\nto have an _is_main_interpreter() function.\nThis function takes no arguments and returns True\nif the current interpreter is the main interpreter.\nAny library or application that provides a custom _thread module\nmust provide _is_main_interpreter(),\njust like the module’s other “private” attributes.\n(gh-112826.)", "code_blocks": []}, "porting-to-python-3-13 - changes-in-the-c-api": {"text": "Changes in the C API\n\n\nPython.h no longer includes the <ieeefp.h> standard header. It was\nincluded for the finite() function which is now provided by the\n<math.h> header. It should now be included explicitly if needed. Remove\nalso the HAVE_IEEEFP_H macro.\n(Contributed by Victor Stinner in gh-108765.)\nPython.h no longer includes these standard header files: <time.h>,\n<sys/select.h> and <sys/time.h>. If needed, they should now be\nincluded explicitly. For example, <time.h> provides the clock() and\ngmtime() functions, <sys/select.h> provides the select()\nfunction, and <sys/time.h> provides the futimes(), gettimeofday()\nand setitimer() functions.\n(Contributed by Victor Stinner in gh-108765.)\nOn Windows, Python.h no longer includes the <stddef.h> standard\nheader file. If needed, it should now be included explicitly. For example, it\nprovides offsetof() function, and size_t and ptrdiff_t types.\nIncluding <stddef.h> explicitly was already needed by all other\nplatforms, the HAVE_STDDEF_H macro is only defined on Windows.\n(Contributed by Victor Stinner in gh-108765.)\nIf the Py_LIMITED_API macro is defined, Py_BUILD_CORE,\nPy_BUILD_CORE_BUILTIN and Py_BUILD_CORE_MODULE macros\nare now undefined by <Python.h>.\n(Contributed by Victor Stinner in gh-85283.)\nThe old trashcan macros Py_TRASHCAN_SAFE_BEGIN and Py_TRASHCAN_SAFE_END\nwere removed. They should be replaced by the new macros Py_TRASHCAN_BEGIN\nand Py_TRASHCAN_END.\nA tp_dealloc function that has the old macros, such as:\nstatic void\nmytype_dealloc(mytype *p)\n{\n    PyObject_GC_UnTrack(p);\n    Py_TRASHCAN_SAFE_BEGIN(p);\n    ...\n    Py_TRASHCAN_SAFE_END\n}\n\n\nshould migrate to the new macros as follows:\nstatic void\nmytype_dealloc(mytype *p)\n{\n    PyObject_GC_UnTrack(p);\n    Py_TRASHCAN_BEGIN(p, mytype_dealloc)\n    ...\n    Py_TRASHCAN_END\n}\n\n\nNote that Py_TRASHCAN_BEGIN has a second argument which\nshould be the deallocation function it is in. The new macros were\nadded in Python 3.8 and the old macros were deprecated in Python 3.11.\n(Contributed by Irit Katriel in gh-105111.)\n\n\n\nPEP 667 introduces several changes\nto frame-related functions:\n\nThe effects of mutating the dictionary returned from\nPyEval_GetLocals() in an optimized scope have changed.\nNew dict entries added this way will now only be visible to\nsubsequent PyEval_GetLocals() calls in that frame,\nas PyFrame_GetLocals(), locals(),\nand FrameType.f_locals no longer access\nthe same underlying cached dictionary.\nChanges made to entries for actual variable names and names added via\nthe write-through proxy interfaces will be overwritten on subsequent calls\nto PyEval_GetLocals() in that frame.\nThe recommended code update depends on how the function was being used,\nso refer to the deprecation notice on the function for details.\nCalling PyFrame_GetLocals() in an optimized scope\nnow returns a write-through proxy rather than a snapshot\nthat gets updated at ill-specified times.\nIf a snapshot is desired, it must be created explicitly\n(e.g. with PyDict_Copy()),\nor by calling the new PyEval_GetFrameLocals() API.\nPyFrame_FastToLocals() and PyFrame_FastToLocalsWithError()\nno longer have any effect.\nCalling these functions has been redundant since Python 3.11,\nwhen PyFrame_GetLocals() was first introduced.\nPyFrame_LocalsToFast() no longer has any effect.\nCalling this function is redundant now that PyFrame_GetLocals()\nreturns a write-through proxy for optimized scopes.", "code_blocks": ["static void\nmytype_dealloc(mytype *p)\n{\n    PyObject_GC_UnTrack(p);\n    Py_TRASHCAN_SAFE_BEGIN(p);\n    ...\n    Py_TRASHCAN_SAFE_END\n}\n", "static void\nmytype_dealloc(mytype *p)\n{\n    PyObject_GC_UnTrack(p);\n    Py_TRASHCAN_BEGIN(p, mytype_dealloc)\n    ...\n    Py_TRASHCAN_END\n}\n"]}, "regression-test-changes": {"text": "Regression Test Changes\n\n\nPython built with configure --with-pydebug now\nsupports a -X presite=package.module command-line\noption. If used, it specifies a module that should be imported early\nin the lifecycle of the interpreter, before site.py is executed.\n(Contributed by Łukasz Langa in gh-110769.)", "code_blocks": []}}}
{"index": 16, "python_version": "3.14", "url": "https://docs.python.org/3.14/whatsnew/3.14.html", "sections": {"summary-release-highlights": {"text": "Summary – Release highlights", "code_blocks": []}, "new-features - pep-649-deferred-evaluation-of-annotations": {"text": "PEP 649: Deferred Evaluation of Annotations\n\nThe annotations on functions, classes, and modules are no\nlonger evaluated eagerly. Instead, annotations are stored in special-purpose\nannotate functions and evaluated only when\nnecessary. This is specified in PEP 649 and PEP 749.\nThis change is designed to make annotations in Python more performant and more\nusable in most circumstances. The runtime cost for defining annotations is\nminimized, but it remains possible to introspect annotations at runtime.\nIt is usually no longer necessary to enclose annotations in strings if they\ncontain forward references.\nThe new annotationlib module provides tools for inspecting deferred\nannotations. Annotations may be evaluated in the VALUE\nformat (which evaluates annotations to runtime values, similar to the behavior in\nearlier Python versions), the FORWARDREF format\n(which replaces undefined names with special markers), and the\nSOURCE format (which returns annotations as strings).\nThis example shows how these formats behave:\n>>> from annotationlib import get_annotations, Format\n>>> def func(arg: Undefined):\n...     pass\n>>> get_annotations(func, format=Format.VALUE)\nTraceback (most recent call last):\n  ...\nNameError: name 'Undefined' is not defined\n>>> get_annotations(func, format=Format.FORWARDREF)\n{'arg': ForwardRef('Undefined')}\n>>> get_annotations(func, format=Format.SOURCE)\n{'arg': 'Undefined'}\n\n\n\nImplications for annotated code\n\nIf you define annotations in your code (for example, for use with a static type\nchecker), then this change probably does not affect you: you can keep\nwriting annotations the same way you did with previous versions of Python.\nYou will likely be able to remove quoted strings in annotations, which are frequently\nused for forward references. Similarly, if you use from __future__ import annotations\nto avoid having to write strings in annotations, you may well be able to\nremove that import. However, if you rely on third-party libraries that read annotations,\nthose libraries may need changes to support unquoted annotations before they\nwork as expected.\n\n\nImplications for readers of __annotations__\n\nIf your code reads the __annotations__ attribute on objects, you may want\nto make changes in order to support code that relies on deferred evaluation of\nannotations. For example, you may want to use annotationlib.get_annotations()\nwith the FORWARDREF format, as the dataclasses\nmodule now does.\n\n\nRelated changes\n\nThe changes in Python 3.14 are designed to rework how __annotations__\nworks at runtime while minimizing breakage to code that contains\nannotations in source code and to code that reads __annotations__. However,\nif you rely on undocumented details of the annotation behavior or on private\nfunctions in the standard library, there are many ways in which your code may\nnot work in Python 3.14. To safeguard your code against future changes,\nuse only the documented functionality of the annotationlib module.\n\n\nfrom __future__ import annotations\n\nIn Python 3.7, PEP 563 introduced the from __future__ import annotations\ndirective, which turns all annotations into strings. This directive is now\nconsidered deprecated and it is expected to be removed in a future version of Python.\nHowever, this removal will not happen until after Python 3.13, the last version of\nPython without deferred evaluation of annotations, reaches its end of life.\nIn Python 3.14, the behavior of code using from __future__ import annotations\nis unchanged.", "code_blocks": [">>> from annotationlib import get_annotations, Format\n>>> def func(arg: Undefined):\n...     pass\n>>> get_annotations(func, format=Format.VALUE)\nTraceback (most recent call last):\n  ...\nNameError: name 'Undefined' is not defined\n>>> get_annotations(func, format=Format.FORWARDREF)\n{'arg': ForwardRef('Undefined')}\n>>> get_annotations(func, format=Format.SOURCE)\n{'arg': 'Undefined'}\n"]}, "new-features - improved-error-messages": {"text": "Improved Error Messages\n\n\nWhen unpacking assignment fails due to incorrect number of variables, the\nerror message prints the received number of values in more cases than before.\n(Contributed by Tushar Sadhwani in gh-122239.)\n>>> x, y, z = 1, 2, 3, 4\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n    x, y, z = 1, 2, 3, 4\n    ^^^^^^^\nValueError: too many values to unpack (expected 3, got 4)", "code_blocks": [">>> x, y, z = 1, 2, 3, 4\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n    x, y, z = 1, 2, 3, 4\n    ^^^^^^^\nValueError: too many values to unpack (expected 3, got 4)\n"]}, "other-language-changes": {"text": "Other Language Changes\n\n\nIncorrect usage of await and asynchronous comprehensions\nis now detected even if the code is optimized away by the -O\ncommand line option. For example, python -O -c 'assert await 1'\nnow produces a SyntaxError. (Contributed by Jelle Zijlstra in gh-121637.)\nWrites to __debug__ are now detected even if the code is optimized\naway by the -O command line option. For example,\npython -O -c 'assert (__debug__ := 1)' now produces a\nSyntaxError. (Contributed by Irit Katriel in gh-122245.)\nAdded class methods float.from_number() and complex.from_number()\nto convert a number to float or complex type correspondingly.\nThey raise an error if the argument is a string.\n(Contributed by Serhiy Storchaka in gh-84978.)", "code_blocks": []}, "new-modules": {"text": "New Modules\n\n\nannotationlib: For introspecting annotations.\nSee PEP 749 for more details.\n(Contributed by Jelle Zijlstra in gh-119180.)", "code_blocks": []}, "improved-modules - ast": {"text": "ast\n\n\nAdded ast.compare() for comparing two ASTs.\n(Contributed by Batuhan Taskaya and Jeremy Hylton in bpo-15987.)\nAdd support for copy.replace() for AST nodes.\n(Contributed by Bénédikt Tran in gh-121141.)\nDocstrings are now removed from an optimized AST in optimization level 2.\n(Contributed by Irit Katriel in gh-123958.)", "code_blocks": []}, "improved-modules - ctypes": {"text": "ctypes\n\n\nThe layout of bit fields\nin Structure and Union\nnow matches platform defaults (GCC/Clang or MVSC) more closely.\nIn particular, fields no longer overlap.\n(Contributed by Matthias Görgens in gh-97702.)\nThe Structure._layout_ class attribute can now be set\nto help match a non-default ABI.\n(Contributed by Petr Viktorin in gh-97702.)", "code_blocks": []}, "improved-modules - dis": {"text": "dis\n\n\nAdded support for rendering full source location information of\ninstructions, rather than only the line number.\nThis feature is added to the following interfaces via the show_positions\nkeyword argument:\n\ndis.Bytecode,\ndis.dis(), dis.distb(), and\ndis.disassemble().\n\nThis feature is also exposed via dis --show-positions.\n(Contributed by Bénédikt Tran in gh-123165.)", "code_blocks": []}, "improved-modules - fractions": {"text": "fractions\n\nAdded support for converting any objects that have the\nas_integer_ratio() method to a Fraction.\n(Contributed by Serhiy Storchaka in gh-82017.)", "code_blocks": []}, "improved-modules - functools": {"text": "functools\n\n\nAdded support to functools.partial() and\nfunctools.partialmethod() for functools.Placeholder sentinels\nto reserve a place for positional arguments.\n(Contributed by Dominykas Grigonis in gh-119127.)", "code_blocks": []}, "improved-modules - http": {"text": "http\n\nDirectory lists and error pages generated by the http.server\nmodule allow the browser to apply its default dark mode.\n(Contributed by Yorik Hansen in gh-123430.)", "code_blocks": []}, "improved-modules - json": {"text": "json\n\nAdd notes for JSON serialization errors that allow to identify the source\nof the error.\n(Contributed by Serhiy Storchaka in gh-122163.)\nEnable json module to work as a script using the -m switch: python -m json.\nSee the JSON command-line interface documentation.\n(Contributed by Trey Hunner in gh-122873.)", "code_blocks": []}, "improved-modules - operator": {"text": "operator\n\n\nTwo new functions operator.is_none and operator.is_not_none\nhave been added, such that operator.is_none(obj) is equivalent\nto obj is None and operator.is_not_none(obj) is equivalent\nto obj is not None.\n(Contributed by Raymond Hettinger and Nico Mexis in gh-115808.)", "code_blocks": []}, "improved-modules - datetime": {"text": "datetime\n\nAdd datetime.time.strptime() and datetime.date.strptime().\n(Contributed by Wannes Boeykens in gh-41431.)", "code_blocks": []}, "improved-modules - os": {"text": "os\n\n\nAdded the os.environ.refresh() method to update\nos.environ with changes to the environment made by os.putenv(),\nby os.unsetenv(), or made outside Python in the same process.\n(Contributed by Victor Stinner in gh-120057.)", "code_blocks": []}, "improved-modules - pathlib": {"text": "pathlib\n\n\nAdd methods to pathlib.Path to recursively copy or move files and\ndirectories:\n\ncopy() copies a file or directory tree to a destination.\ncopy_into() copies into a destination directory.\nmove() moves a file or directory tree to a destination.\nmove_into() moves into a destination directory.\n\n(Contributed by Barney Gale in gh-73991.)", "code_blocks": []}, "improved-modules - pdb": {"text": "pdb\n\n\nHard-coded breakpoints (breakpoint() and pdb.set_trace()) now\nreuse the most recent Pdb instance that calls\nset_trace(), instead of creating a new one each time.\nAs a result, all the instance specific data like display and\ncommands are preserved across hard-coded breakpoints.\n(Contributed by Tian Gao in gh-121450.)\nAdded a new argument mode to pdb.Pdb. Disabled restart\ncommand when pdb is in inline mode.\n(Contributed by Tian Gao in gh-123757.)", "code_blocks": []}, "improved-modules - pickle": {"text": "pickle\n\n\nSet the default protocol version on the pickle module to 5.\nFor more details, please see pickle protocols.\nAdd notes for pickle serialization errors that allow to identify the source\nof the error.\n(Contributed by Serhiy Storchaka in gh-122213.)", "code_blocks": []}, "improved-modules - symtable": {"text": "symtable\n\n\nExpose the following symtable.Symbol methods:\n\nis_free_class()\nis_comp_iter()\nis_comp_cell()\n\n(Contributed by Bénédikt Tran in gh-120029.)", "code_blocks": []}, "improved-modules - unicodedata": {"text": "unicodedata\n\n\nThe Unicode database has been updated to Unicode 16.0.0.", "code_blocks": []}, "optimizations - asyncio": {"text": "asyncio\n\n\nasyncio now uses double linked list implementation for native tasks\nwhich speeds up execution by 10% on standard pyperformance benchmarks and\nreduces memory usage.\n(Contributed by Kumar Aditya in gh-107803.)", "code_blocks": []}, "deprecated - pending-removal-in-python-3-15": {"text": "Pending Removal in Python 3.15\n\n\nctypes:\n\nThe undocumented ctypes.SetPointerType() function\nhas been deprecated since Python 3.13.\n\n\nhttp.server:\n\nThe obsolete and rarely used CGIHTTPRequestHandler\nhas been deprecated since Python 3.13.\nNo direct replacement exists.\nAnything is better than CGI to interface\na web server with a request handler.\nThe --cgi flag to the python -m http.server\ncommand-line interface has been deprecated since Python 3.13.\n\n\nimportlib: __package__ and __cached__ will cease to be set or\ntaken into consideration by the import system (gh-97879).\nlocale:\n\nThe getdefaultlocale() function\nhas been deprecated since Python 3.11.\nIts removal was originally planned for Python 3.13 (gh-90817),\nbut has been postponed to Python 3.15.\nUse getlocale(), setlocale(),\nand getencoding() instead.\n(Contributed by Hugo van Kemenade in gh-111187.)\n\n\npathlib:\n\nPurePath.is_reserved()\nhas been deprecated since Python 3.13.\nUse os.path.isreserved() to detect reserved paths on Windows.\n\n\nplatform:\n\njava_ver() has been deprecated since Python 3.13.\nThis function is only useful for Jython support, has a confusing API,\nand is largely untested.\n\n\nthreading:\n\nRLock() will take no arguments in Python 3.15.\nPassing any arguments has been deprecated since Python 3.14,\nas the  Python version does not permit any arguments,\nbut the C version allows any number of positional or keyword arguments,\nignoring every argument.\n\n\ntyping:\n\nThe undocumented keyword argument syntax for creating\nNamedTuple classes\n(e.g. Point = NamedTuple(\"Point\", x=int, y=int))\nhas been deprecated since Python 3.13.\nUse the class-based syntax or the functional syntax instead.\nThe typing.no_type_check_decorator() decorator function\nhas been deprecated since Python 3.13.\nAfter eight years in the typing module,\nit has yet to be supported by any major type checker.\n\n\nwave:\n\nThe getmark(), setmark(),\nand getmarkers() methods of\nthe Wave_read and Wave_write classes\nhave been deprecated since Python 3.13.", "code_blocks": []}, "deprecated - pending-removal-in-python-3-16": {"text": "Pending Removal in Python 3.16\n\n\nbuiltins:\n\nBitwise inversion on boolean types, ~True or ~False\nhas been deprecated since Python 3.12,\nas it produces surprising and unintuitive results (-2 and -1).\nUse not x instead for the logical negation of a Boolean.\nIn the rare case that you need the bitwise inversion of\nthe underlying integer, convert to int explicitly (~int(x)).\n\n\narray:\n\nThe 'u' format code (wchar_t)\nhas been deprecated in documentation since Python 3.3\nand at runtime since Python 3.13.\nUse the 'w' format code (Py_UCS4)\nfor Unicode characters instead.\n\n\nshutil:\n\nThe ExecError exception\nhas been deprecated since Python 3.14.\nIt has not been used by any function in shutil since Python 3.4,\nand is now an alias of RuntimeError.\n\n\nsymtable:\n\nThe Class.get_methods method\nhas been deprecated since Python 3.14.\n\n\nsys:\n\nThe _enablelegacywindowsfsencoding() function\nhas been deprecated since Python 3.13.\nUse the PYTHONLEGACYWINDOWSFSENCODING environment variable instead.\n\n\ntarfile:\n\nThe undocumented and unused TarFile.tarfile attribute\nhas been deprecated since Python 3.13.", "code_blocks": []}, "deprecated - pending-removal-in-future-versions": {"text": "Pending Removal in Future Versions\n\nThe following APIs will be removed in the future,\nalthough there is currently no date scheduled for their removal.\n\nargparse: Nesting argument groups and nesting mutually exclusive\ngroups are deprecated.\narray’s 'u' format code (gh-57281)\nbuiltins:\n\nbool(NotImplemented).\nGenerators: throw(type, exc, tb) and athrow(type, exc, tb)\nsignature is deprecated: use throw(exc) and athrow(exc) instead,\nthe single argument signature.\nCurrently Python accepts numeric literals immediately followed by keywords,\nfor example 0in x, 1or x, 0if 1else 2.  It allows confusing and\nambiguous expressions like [0x1for x in y] (which can be interpreted as\n[0x1 for x in y] or [0x1f or x in y]).  A syntax warning is raised\nif the numeric literal is immediately followed by one of keywords\nand, else, for, if,\nin, is and or.  In a future release it\nwill be changed to a syntax error. (gh-87999)\nSupport for __index__() and __int__() method returning non-int type:\nthese methods will be required to return an instance of a strict subclass of\nint.\nSupport for __float__() method returning a strict subclass of\nfloat: these methods will be required to return an instance of\nfloat.\nSupport for __complex__() method returning a strict subclass of\ncomplex: these methods will be required to return an instance of\ncomplex.\nDelegation of int() to __trunc__() method.\nPassing a complex number as the real or imag argument in the\ncomplex() constructor is now deprecated; it should only be passed\nas a single positional argument.\n(Contributed by Serhiy Storchaka in gh-109218.)\n\n\ncalendar: calendar.January and calendar.February constants are\ndeprecated and replaced by calendar.JANUARY and\ncalendar.FEBRUARY.\n(Contributed by Prince Roshan in gh-103636.)\ncodeobject.co_lnotab: use the codeobject.co_lines() method\ninstead.\ndatetime:\n\nutcnow():\nuse datetime.datetime.now(tz=datetime.UTC).\nutcfromtimestamp():\nuse datetime.datetime.fromtimestamp(timestamp, tz=datetime.UTC).\n\n\ngettext: Plural value must be an integer.\nimportlib:\n\nload_module() method: use exec_module() instead.\ncache_from_source() debug_override parameter is\ndeprecated: use the optimization parameter instead.\n\n\nimportlib.metadata:\n\nEntryPoints tuple interface.\nImplicit None on return values.\n\n\nlogging: the warn() method has been deprecated\nsince Python 3.3, use warning() instead.\nmailbox: Use of StringIO input and text mode is deprecated, use\nBytesIO and binary mode instead.\nos: Calling os.register_at_fork() in multi-threaded process.\npydoc.ErrorDuringImport: A tuple value for exc_info parameter is\ndeprecated, use an exception instance.\nre: More strict rules are now applied for numerical group references\nand group names in regular expressions.  Only sequence of ASCII digits is now\naccepted as a numerical reference.  The group name in bytes patterns and\nreplacement strings can now only contain ASCII letters and digits and\nunderscore.\n(Contributed by Serhiy Storchaka in gh-91760.)\nsre_compile, sre_constants and sre_parse modules.\nshutil: rmtree()’s onerror parameter is deprecated in\nPython 3.12; use the onexc parameter instead.\nssl options and protocols:\n\nssl.SSLContext without protocol argument is deprecated.\nssl.SSLContext: set_npn_protocols() and\nselected_npn_protocol() are deprecated: use ALPN\ninstead.\nssl.OP_NO_SSL* options\nssl.OP_NO_TLS* options\nssl.PROTOCOL_SSLv3\nssl.PROTOCOL_TLS\nssl.PROTOCOL_TLSv1\nssl.PROTOCOL_TLSv1_1\nssl.PROTOCOL_TLSv1_2\nssl.TLSVersion.SSLv3\nssl.TLSVersion.TLSv1\nssl.TLSVersion.TLSv1_1\n\n\nsysconfig.is_python_build() check_home parameter is deprecated and\nignored.\nthreading methods:\n\nthreading.Condition.notifyAll(): use notify_all().\nthreading.Event.isSet(): use is_set().\nthreading.Thread.isDaemon(), threading.Thread.setDaemon():\nuse threading.Thread.daemon attribute.\nthreading.Thread.getName(), threading.Thread.setName():\nuse threading.Thread.name attribute.\nthreading.currentThread(): use threading.current_thread().\nthreading.activeCount(): use threading.active_count().\n\n\ntyping.Text (gh-92332).\nunittest.IsolatedAsyncioTestCase: it is deprecated to return a value\nthat is not None from a test case.\nurllib.parse deprecated functions: urlparse() instead\n\nsplitattr()\nsplithost()\nsplitnport()\nsplitpasswd()\nsplitport()\nsplitquery()\nsplittag()\nsplittype()\nsplituser()\nsplitvalue()\nto_bytes()\n\n\nurllib.request: URLopener and\nFancyURLopener style of invoking requests is\ndeprecated. Use newer urlopen() functions and methods.\nwsgiref: SimpleHandler.stdout.write() should not do partial\nwrites.\nxml.etree.ElementTree: Testing the truth value of an\nElement is deprecated. In a future release it\nwill always return True. Prefer explicit len(elem) or\nelem is not None tests instead.\nzipimport.zipimporter.load_module() is deprecated:\nuse exec_module() instead.", "code_blocks": []}, "removed - argparse": {"text": "argparse\n\n\nRemove the type, choices, and metavar parameters\nof argparse.BooleanOptionalAction.\nThey were deprecated since 3.12.", "code_blocks": []}, "removed - id1": {"text": "ast\n\n\nRemove the following classes. They were all deprecated since Python 3.8,\nand have emitted deprecation warnings since Python 3.12:\n\nast.Num\nast.Str\nast.Bytes\nast.NameConstant\nast.Ellipsis\n\nUse ast.Constant instead. As a consequence of these removals,\nuser-defined visit_Num, visit_Str, visit_Bytes,\nvisit_NameConstant and visit_Ellipsis methods on custom\nast.NodeVisitor subclasses will no longer be called when the\nNodeVisitor subclass is visiting an AST. Define a visit_Constant\nmethod instead.\nAlso, remove the following deprecated properties on ast.Constant,\nwhich were present for compatibility with the now-removed AST classes:\n\nast.Constant.n\nast.Constant.s\n\nUse ast.Constant.value instead.\n(Contributed by Alex Waygood in gh-119562.)", "code_blocks": []}, "removed - id2": {"text": "asyncio\n\n\nRemove the following classes and functions. They were all deprecated and\nemitted deprecation warnings since Python 3.12:\n\nasyncio.AbstractChildWatcher\nasyncio.SafeChildWatcher\nasyncio.MultiLoopChildWatcher\nasyncio.FastChildWatcher\nasyncio.ThreadedChildWatcher\nasyncio.PidfdChildWatcher\nasyncio.AbstractEventLoopPolicy.get_child_watcher()\nasyncio.AbstractEventLoopPolicy.set_child_watcher()\nasyncio.get_child_watcher()\nasyncio.set_child_watcher()\n\n(Contributed by Kumar Aditya in gh-120804.)", "code_blocks": []}, "removed - collections-abc": {"text": "collections.abc\n\n\nRemove collections.abc.ByteString. It had previously raised a\nDeprecationWarning since Python 3.12.", "code_blocks": []}, "removed - email": {"text": "email\n\n\nRemove the isdst parameter from email.utils.localtime().\n(Contributed by Hugo van Kemenade in gh-118798.)", "code_blocks": []}, "removed - importlib": {"text": "importlib\n\n\nRemove deprecated importlib.abc classes:\n\nimportlib.abc.ResourceReader\nimportlib.abc.Traversable\nimportlib.abc.TraversableResources\n\nUse importlib.resources.abc classes instead:\n\nimportlib.resources.abc.Traversable\nimportlib.resources.abc.TraversableResources\n\n(Contributed by Jason R. Coombs and Hugo van Kemenade in gh-93963.)", "code_blocks": []}, "removed - itertools": {"text": "itertools\n\n\nRemove itertools support for copy, deepcopy, and pickle operations.\nThese had previously raised a DeprecationWarning since Python 3.12.\n(Contributed by Raymond Hettinger in gh-101588.)", "code_blocks": []}, "removed - id3": {"text": "pathlib\n\n\nRemove support for passing additional keyword arguments to\npathlib.Path. In previous versions, any such arguments are ignored.\nRemove support for passing additional positional arguments to\npathlib.PurePath.relative_to() and\nis_relative_to(). In previous versions, any such\narguments are joined onto other.", "code_blocks": []}, "removed - pty": {"text": "pty\n\n\nRemove deprecated pty.master_open() and pty.slave_open().\nThey had previously raised a DeprecationWarning since Python 3.12.\nUse pty.openpty() instead.\n(Contributed by Nikita Sobolev in gh-118824.)", "code_blocks": []}, "removed - sqlite3": {"text": "sqlite3\n\n\nRemove version and version_info from sqlite3.\n(Contributed by Hugo van Kemenade in gh-118924.)\nDisallow using a sequence of parameters with named placeholders.\nThis had previously raised a DeprecationWarning since Python 3.12;\nit will now raise a sqlite3.ProgrammingError.\n(Contributed by Erlend E. Aasland in gh-118928 and gh-101693.)", "code_blocks": []}, "removed - typing": {"text": "typing\n\n\nRemove typing.ByteString. It had previously raised a\nDeprecationWarning since Python 3.12.", "code_blocks": []}, "removed - urllib": {"text": "urllib\n\n\nRemove deprecated Quoter class from urllib.parse.\nIt had previously raised a DeprecationWarning since Python 3.11.\n(Contributed by Nikita Sobolev in gh-118827.)", "code_blocks": []}, "removed - others": {"text": "Others\n\n\nUsing NotImplemented in a boolean context will now raise a TypeError.\nIt had previously raised a DeprecationWarning since Python 3.9. (Contributed\nby Jelle Zijlstra in gh-118767.)\nThe int() built-in no longer delegates to\n__trunc__(). Classes that want to support conversion to\ninteger must implement either __int__() or\n__index__(). (Contributed by Mark Dickinson in gh-119743.)", "code_blocks": []}, "porting-to-python-3-14 - changes-in-the-python-api": {"text": "Changes in the Python API\n\n\nfunctools.partial is now a method descriptor.\nWrap it in staticmethod() if you want to preserve the old behavior.\n(Contributed by Serhiy Storchaka and Dominykas Grigonis in gh-121027.)", "code_blocks": []}, "build-changes": {"text": "Build Changes", "code_blocks": []}, "c-api-changes - id4": {"text": "New Features\n\n\nAdd PyLong_GetSign() function to get the sign of int objects.\n(Contributed by Sergey B Kirpichev in gh-116560.)\nAdd a new PyUnicodeWriter API to create a Python str\nobject:\n\nPyUnicodeWriter_Create().\nPyUnicodeWriter_Discard().\nPyUnicodeWriter_Finish().\nPyUnicodeWriter_WriteChar().\nPyUnicodeWriter_WriteUTF8().\nPyUnicodeWriter_WriteUCS4().\nPyUnicodeWriter_WriteWideChar().\nPyUnicodeWriter_WriteStr().\nPyUnicodeWriter_WriteRepr().\nPyUnicodeWriter_WriteSubstring().\nPyUnicodeWriter_Format().\nPyUnicodeWriter_DecodeUTF8Stateful().\n\n(Contributed by Victor Stinner in gh-119182.)\n\nAdd PyIter_NextItem() to replace PyIter_Next(),\nwhich has an ambiguous return value.\n(Contributed by Irit Katriel and Erlend Aasland in gh-105201.)\nPy_Finalize() now deletes all interned strings. This\nis backwards incompatible to any C-Extension that holds onto an interned\nstring after a call to Py_Finalize() and is then reused after a\ncall to Py_Initialize().  Any issues arising from this behavior will\nnormally result in crashes during the exectuion of the subsequent call to\nPy_Initialize() from accessing uninitialized memory. To fix, use\nan address sanitizer to identify any use-after-free coming from\nan interned string and deallocate it during module shutdown.\n(Contribued by Eddie Elizondo in gh-113601.)\nAdd new functions to convert C <stdint.h> numbers from/to Python\nint:\n\nPyLong_FromInt32()\nPyLong_FromInt64()\nPyLong_FromUInt32()\nPyLong_FromUInt64()\nPyLong_AsInt32()\nPyLong_AsInt64()\nPyLong_AsUInt32()\nPyLong_AsUInt64()\n\n(Contributed by Victor Stinner in gh-120389.)\n\nAdd PyBytes_Join(sep, iterable) function,\nsimilar to sep.join(iterable) in Python.\n(Contributed by Victor Stinner in gh-121645.)\nAdd Py_HashBuffer() to compute and return the hash value of a buffer.\n(Contributed by Antoine Pitrou and Victor Stinner in gh-122854.)\nAdd functions to get and set the current runtime Python configuration\n(PEP 741):\n\nPyConfig_Get()\nPyConfig_GetInt()\nPyConfig_Set()\nPyConfig_Names()\n\n(Contributed by Victor Stinner in gh-107954.)\n\nAdd functions to configure the Python initialization (PEP 741):\n\nPyInitConfig_Create()\nPyInitConfig_Free()\nPyInitConfig_GetError()\nPyInitConfig_GetExitCode()\nPyInitConfig_HasOption()\nPyInitConfig_GetInt()\nPyInitConfig_GetStr()\nPyInitConfig_GetStrList()\nPyInitConfig_FreeStrList()\nPyInitConfig_SetInt()\nPyInitConfig_SetStr()\nPyInitConfig_SetStrList()\nPyInitConfig_AddModule()\nPy_InitializeFromInitConfig()\n\n(Contributed by Victor Stinner in gh-107954.)\n\nAdd PyType_GetBaseByToken() and Py_tp_token slot for easier\nsuperclass identification, which attempts to resolve the type checking issue mentioned in PEP 630\n(gh-124153).", "code_blocks": []}, "c-api-changes - id5": {"text": "Porting to Python 3.14\n\n\nIn the limited C API 3.14 and newer, Py_TYPE() and\nPy_REFCNT() are now implemented as an opaque function call to hide\nimplementation details.\n(Contributed by Victor Stinner in gh-120600 and gh-124127.)", "code_blocks": []}, "c-api-changes - id6": {"text": "Deprecated\n\n\nMacros Py_IS_NAN, Py_IS_INFINITY\nand Py_IS_FINITE are soft deprecated,\nuse instead isnan, isinf and\nisfinite available from math.h\nsince C99.  (Contributed by Sergey B Kirpichev in gh-119613.)\nasyncio.iscoroutinefunction() is deprecated\nand will be removed in Python 3.16,\nuse inspect.iscoroutinefunction() instead.\n(Contributed by Jiahao Li and Kumar Aditya in gh-122875.)\n\n\nPending Removal in Python 3.15\n\n\nThe bundled copy of libmpdecimal.\nThe PyImport_ImportModuleNoBlock():\nUse PyImport_ImportModule() instead.\nPyWeakref_GetObject() and PyWeakref_GET_OBJECT():\nUse PyWeakref_GetRef() instead.\nPy_UNICODE type and the Py_UNICODE_WIDE macro:\nUse wchar_t instead.\nPython initialization functions:\n\nPySys_ResetWarnOptions():\nClear sys.warnoptions and warnings.filters instead.\nPy_GetExecPrefix():\nGet sys.exec_prefix instead.\nPy_GetPath():\nGet sys.path instead.\nPy_GetPrefix():\nGet sys.prefix instead.\nPy_GetProgramFullPath():\nGet sys.executable instead.\nPy_GetProgramName():\nGet sys.executable instead.\nPy_GetPythonHome():\nGet PyConfig.home\nor the PYTHONHOME environment variable instead.\n\n\n\n\n\nPending Removal in Future Versions\n\nThe following APIs are deprecated and will be removed,\nalthough there is currently no date scheduled for their removal.\n\nPy_TPFLAGS_HAVE_FINALIZE:\nUnneeded since Python 3.8.\nPyErr_Fetch():\nUse PyErr_GetRaisedException() instead.\nPyErr_NormalizeException():\nUse PyErr_GetRaisedException() instead.\nPyErr_Restore():\nUse PyErr_SetRaisedException() instead.\nPyModule_GetFilename():\nUse PyModule_GetFilenameObject() instead.\nPyOS_AfterFork():\nUse PyOS_AfterFork_Child() instead.\nPySlice_GetIndicesEx():\nUse PySlice_Unpack() and PySlice_AdjustIndices() instead.\nPyUnicode_AsDecodedObject():\nUse PyCodec_Decode() instead.\nPyUnicode_AsDecodedUnicode():\nUse PyCodec_Decode() instead.\nPyUnicode_AsEncodedObject():\nUse PyCodec_Encode() instead.\nPyUnicode_AsEncodedUnicode():\nUse PyCodec_Encode() instead.\nPyUnicode_READY():\nUnneeded since Python 3.12\nPyErr_Display():\nUse PyErr_DisplayException() instead.\n_PyErr_ChainExceptions():\nUse _PyErr_ChainExceptions1() instead.\nPyBytesObject.ob_shash member:\ncall PyObject_Hash() instead.\nPyDictObject.ma_version_tag member.\nThread Local Storage (TLS) API:\n\nPyThread_create_key():\nUse PyThread_tss_alloc() instead.\nPyThread_delete_key():\nUse PyThread_tss_free() instead.\nPyThread_set_key_value():\nUse PyThread_tss_set() instead.\nPyThread_get_key_value():\nUse PyThread_tss_get() instead.\nPyThread_delete_key_value():\nUse PyThread_tss_delete() instead.\nPyThread_ReInitTLS():\nUnneeded since Python 3.7.", "code_blocks": []}, "c-api-changes - id9": {"text": "Removed\n\n\nCreating immutable types with mutable\nbases was deprecated since 3.12 and now raises a TypeError.", "code_blocks": []}}}
